var OfficeBrowserFeedback;(function(a){(function(a){(function(a){a[a.Error=0]="Error";a[a.Warning=1]="Warning";a[a.Info=2]="Info";a[a.Verbose=3]="Verbose";a[a.Spam=4]="Spam"})(a.LogLevel||(a.LogLevel={}));var b=a.LogLevel;a.NetworkingMgr=null})(a.Networking||(a.Networking={}));var b=a.Networking})(OfficeBrowserFeedback||(OfficeBrowserFeedback={}));var OfficeBrowserFeedback;(function(a){(function(a){var b=function(){function a(){this.UlsLevelMap={}}a.prototype.Init=function(a,b){this.telemetryCatID=a;this.feedbackDataCatID=b;this.UlsLevelMap[2]=Diag.ULSTraceLevel.info;this.UlsLevelMap[1]=Diag.ULSTraceLevel.warning;this.UlsLevelMap[0]=Diag.ULSTraceLevel.error;this.UlsLevelMap[3]=Diag.ULSTraceLevel.verbose;this.UlsLevelMap[4]=Diag.ULSTraceLevel.spam};a.prototype.Dismiss=function(){};a.prototype.SendTrace=function(a,b){Diag.ULS.sendTraceTag(4477014,this.telemetryCatID,this.UlsLevelMap[a],"{0}",b)};a.prototype.LogFeedbackData=function(a){Diag.ULS.sendTraceTag(4477015,this.feedbackDataCatID,Diag.ULSTraceLevel.info,"{0}",a)};return a}();a.DefaultNetworkingMgr=b;a.NetworkingMgr=new a.DefaultNetworkingMgr})(a.Networking||(a.Networking={}));var b=a.Networking})(OfficeBrowserFeedback||(OfficeBrowserFeedback={}));var OfficeBrowserFeedback;(function(c){(function(a){function b(){var a=800;return window.innerWidth?window.innerWidth<a:true}a.IsNarrow=b})(c.WindowProperties||(c.WindowProperties={}));var i=c.WindowProperties;(function(a){a.UseNarrowScreenLayout=false;(function(a){a.AriaLive="aria-live";a.AriaSelected="aria-Selected";a.Form="form";a.HRef="href";a.MaxLength="maxlength";a.Name="name";a.Placeholder="placeholder";a.Role="role";a.Source="src";a.TabIndex="tabindex";a.Target="target";a.Type="type";a.Value="value"})(a.AttributeName||(a.AttributeName={}));var c=a.AttributeName;(function(a){a.BlankWindow="_blank";a.Button="button";a.Checkbox="checkbox";a.Checked="checked";a.False="false";a.FeedbackOverall="feedbackOverall";a.One="1";a.Polite="polite";a.Submit="submit";a.Text="text";a.TextAreaMaxLength="1000";a.True="true";a.Unchecked="unchecked"})(a.AttributeValue||(a.AttributeValue={}));var b=a.AttributeValue;(function(a){a.CLCID="CLCID"})(a.UrlParameters||(a.UrlParameters={}));var d=a.UrlParameters;(function(a){a.Screenshot=false})(a.Brs||(a.Brs={}));var k=a.Brs;(function(a){a.BackgroundBlue="officeBrowserFeedbackBackgroundBLue";a.BackgroundGrey="officeBrowserFeedbackBackgroundGrey";a.FeedbackFormContainer="officeBrowserFeedbackFormContainer";a.FeedbackFormComment="officeBrowserFeedbackComment";a.FeedbackFormSubmitButtonContainer="officeBrowserFeedbackSubmitButtonContainer";a.FeedbackFormSubmitButton="officeBrowserFeedbackSubmitButton";a.FeedbackQuestionMiddleText="officeBrowserFeedbackQuestionMiddleText";a.FeedbackOverallAnchor="officeBrowserFeedbackOverallAnchor";a.FeedbackOverallImage="officeBrowserFeedbackOverallImage";a.FeedbackOverallText="officeBrowserFeedbackOverallText";a.FontSubtitle="officeBrowserFeedbackFontSubtitle";a.FontText="officeBrowserFeedbackFontText";a.FontTitle="officeBrowserFeedbackFontTitle";a.FormContainer="officeBrowserFeedbackFormContainer";a.FullWidth20pxHeight="officeBrowserFeedbackFullWidth20pxHeight";a.OverlayMinWidth="officeBrowserFeedbackOverlayMinWidth";a.Hidden="officeBrowserFeedbackHidden";a.MarginLeft36px="officeBrowserFeedbackMarginLeft36px";a.Narrow="officeBrowserFeedbackNarrowLayout";a.LineHeight="officeBrowserFeedbackLineHeight";a.PadLeft36px="officeBrowserFeedbackPadLeft36px";a.ShowRightBorder="officeBrowserFeedbackShowRightBorder";a.SlideLeft="slideLeft";a.TextAlignLeft="officeBrowserFeedbackTextAlignLeft";a.Visible="officeBrowserFeedbackVisible";a.LinkDiv="officeBrowserFeedbackLinkDiv";a.Link="officeBrowserFeedbackLink";a.TextAlginLeft="officeBrowserFeedbackTextAlginLeft"})(a.Classes||(a.Classes={}));var f=a.Classes;(function(a){a.ColumnSeparatorDiv="officeBrowserFeedbackColumnSeparatorDiv";a.FeedbackFormsWrapper="officeBrowserFeedbackFormsWrapper";a.FeedbackOverallDontLikeAnchor="officeBrowserFeedbackOverallDontLikeAnchor";a.FeedbackOverallDontLikeDiv="officeBrowserFeedbackOverallDontLikeDiv";a.FeedbackOverallDontLikeImage="officeBrowserFeedbackOverallDontLikeImage";a.FeedbackOverallDontLikeText="officeBrowserFeedbackOverallDontLikeText";a.FeedbackOverallLikeAnchor="officeBrowserFeedbackOverallLikeAnchor";a.FeedbackOverallLikeDiv="officeBrowserFeedbackOverallLikeDiv";a.FeedbackOverallLikeImage="officeBrowserFeedbackOverallLikeImage";a.FeedbackOverallLikeText="officeBrowserFeedbackOverallLikeText";a.FeedbackOverallSuggestionAnchor="officeBrowserFeedbackOverallSuggestAnchor";a.FeedbackOverallSuggestionDiv="officeBrowserFeedbackOverallSuggestDiv";a.FeedbackOverallSuggestionImage="officeBrowserFeedbackOverallSuggestImage";a.FeedbackOverallSuggestionText="officeBrowserFeedbackOverallSuggestText";a.FeedbackQuestionLeftText="officeBrowserFeedbackQuestionLeftText";a.FeedbackTitle="officeBrowserFeedbackTitle";a.LeftFormContainer="officeBrowserFeedbackLeftFormContainer";a.MainContainer="officeBrowserFeedbackMainContainer";a.MainContentHolder="officeBrowserFeedbackMainContentHolder";a.MiddleFormContainer="officeBrowserFeedbackMiddleFormContainer";a.OverlayBackground="officeBrowserFeedbackOverlayBackground";a.PlaceHolderDiv1="officeBrowserFeedbackPlaceHolderDiv1";a.PlaceHolderDiv2="officeBrowserFeedbackPlaceHolderDiv2";a.PrivacyStatementLink="officeBrowserFeedbackPrivacyStatementLink";a.PrivacyStatementLinkDiv="officeBrowserFeedbackPrivacyStatementLinkDiv";a.RightFormContainer="officeBrowserFeedbackRightFormContainer";a.SimpleFeedbackFormContainer="officeBrowserFeedbackContainer";a.SimpleFeedbackFormQuestionMiddleText="officeBrowserFeedbackQuestionMiddleText";a.SimpleFeedbackFormComment="officeBrowserFeedbackComment";a.SimpleFeedbackFormScreenshotContainer="officeBrowserFeedbackScreenshotContainer";a.SimpleFeedbackFormScreenshotCheckboxText="officeBrowserFeedbackScreenshotCheckboxText";a.SimpleFeedbackFormScreenshotCheckbox="officeBrowserFeedbackScreenshotCheckbox";a.SimpleFeedbackFormScreenshotText="officeBrowserFeedbackScreenshotText";a.SimpleFeedbackFormSubmitButtonContainer="officeBrowserFeedbackSubmitButtonContainer";a.SimpleFeedbackFormSubmitButton="officeBrowserFeedbackSubmitButton";a.ContactInfoFormContainer="officeBrowserFeedbackContactInfoContainer";a.ContactInfoFormQuestionMiddleText="officeBrowserFeedbackContactInfoQuestionMiddleText";a.ContactInfoFormComment="officeBrowserFeedbackContactInfoComment";a.ContactInfoFormEmailText="officeBrowserFeedbackContactInfoEmailText";a.ContactInfoFormEmailInput="officeBrowserFeedbackContactInfoEmailInput";a.ContactInfoFormSubmitButtonContainer="officeBrowserFeedbackContactInfoSubmitButtonContainer";a.ContactInfoFormSubmitButton="officeBrowserFeedbackContactInfoSubmitButton";a.UservoiceLinkFormContainer="officeBrowserFeedbackUservoiceLinkFormContainer";a.UservoiceLinkFormQuestionMiddleText="officeBrowserFeedbackUservoiceLinkFormQuestionMiddleText";a.UservoiceLinkFormMiddleText="officeBrowserFeedbackUservoiceLinkFormMiddleText";a.UservoiceLinkFormAnchorContainer="officeBrowserFeedbackUservoiceLinkFormAnchorContainer";a.UservoiceLinkFormAnchor="officeBrowserFeedbackUservoiceLinkFormAnchor";a.UservoiceLinkFormCloseButtonContainer="officeBrowserFeedbackUservoiceLinkFormCloseButtonContainer";a.UservoiceLinkFormCloseButton="officeBrowserFeedbackUservoiceLinkFormCloseButton";a.FeedbackQuestionMiddleText="officeBrowserFeedbackQuestionMiddleText";a.FeedbackComment="officeBrowserFeedbackComment";a.SubmitButton="officeBrowserFeedbackSubmitButton";a.SubmitButtonContainer="officeBrowserFeedbackSubmitButtonContainer"})(a.IDs||(a.IDs={}));var l=a.IDs;(function(a){a.Esc=27})(a.Keys||(a.Keys={}));var h=a.Keys;(function(a){a.Pause=100})(a.Numbers||(a.Numbers={}));var g=a.Numbers;(function(a){a.Dislike="dislike";a.Like="like";a.Idea="idea"})(a.FeedbackType||(a.FeedbackType={}));var e=a.FeedbackType;(function(a){a.Anchor="A";a.Div="DIV";a.Form="FORM";a.Img="IMG";a.Input="INPUT";a.TextArea="TEXTAREA"})(a.Tags||(a.Tags={}));var i=a.Tags;(function(a){a.PrivacyStatementLink="http://go.microsoft.com/fwlink/?LinkID=390004";function b(c,d,a){var b=d+c;if(a)b+=a;return b}a.CreateURL=b;(function(a){var b=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1");a.Extension;if(b)a.Extension=".svg";else a.Extension=".png";a.FrownIcon;a.LightBulbIcon;a.SmileIcon})(a.Images||(a.Images={}));var c=a.Images})(a.Urls||(a.Urls={}));var j=a.Urls})(c.Constants||(c.Constants={}));var a=c.Constants;(function(b){function i(f,b){var e=b?a.Classes.Hidden:a.Classes.Visible,d=b?a.Classes.Visible:a.Classes.Hidden;c(f,e,d)}b.SetElementVisibility=i;function j(b){var a=document.getElementById(b);a!=null&&a.parentNode!=null&&a.parentNode.removeChild(a)}b.DeleteElementById=j;function f(c,b){var a=document.getElementById(c);if(!a)return;a.className=a.className+" "+b}b.AddClassById=f;function d(c,b){var a=document.getElementById(c);if(!a)return;a.className=a.className.split(new RegExp("\\b"+b+"\\b","i")).join(" ");a.className=a.className.split(/\s+/).join(" ")}b.DeleteClassById=d;function c(a,c,b){d(a,c);f(a,b)}b.DeleteAndAddClassesById=c;function m(b){for(var d=b.length,a=0;a<d;a++){var c=new Image;c.src=b[a];if(typeof window.officeBrowserFeedbackCachedImages=="undefined")window.officeBrowserFeedbackCachedImages=[];window.officeBrowserFeedbackCachedImages.push(c)}}b.CacheImages=m;function h(d,c,b){var a=document.getElementById(d);a&&a.setAttribute(c,b)}b.SetAttributeOnHtmlElement=h;function g(){var a=-1,b=window.navigator.userAgent;if(b.indexOf("Trident")>-1){var c=new RegExp("Trident/([0-9]{1,}[.0-9]{0,})");if(c.exec(b)!=null){a=parseFloat(RegExp.$1);a+=4}}return a}b.GetInternetExplorerVersion=g;function l(b){var c=a.Urls.PrivacyStatementLink;if(b&&b>0)c=c+"&"+a.UrlParameters.CLCID+"=0x"+b.toString(16);return c}b.GetPrivacyUrl=l;function k(a){var c=e.GetData(),b=c.UservoiceUrl;a&&e.RemoveData("UservoiceUrl");return b}b.GetUservoiceUrl=k})(c.Utils||(c.Utils={}));var b=c.Utils;(function(d){d.Strings;(function(e){(function(a){a[a.SimpleFeedbackForm=0]="SimpleFeedbackForm";a[a.ContactInfoFeedbackForm=1]="ContactInfoFeedbackForm";a[a.UservoiceLinkFeedbackForm=2]="UservoiceLinkFeedbackForm"})(e.FeedbackFormTemplate||(e.FeedbackFormTemplate={}));var o=e.FeedbackFormTemplate;e.ActiveFormTemplates;function f(b){switch(b){case 0:return a.IDs.SimpleFeedbackFormContainer;case 1:return a.IDs.ContactInfoFormContainer;case 2:return a.IDs.UservoiceLinkFormContainer;default:return a.IDs.SimpleFeedbackFormContainer}}e.GetFormContainerIdFromFormTemplate=f;function g(b){switch(b){case 0:return a.IDs.SimpleFeedbackFormQuestionMiddleText;case 1:return a.IDs.ContactInfoFormQuestionMiddleText;case 2:return a.IDs.UservoiceLinkFormQuestionMiddleText;default:return a.IDs.SimpleFeedbackFormQuestionMiddleText}}e.GetMiddleTextIdFromFormTemplate=g;function m(b){switch(b){case d.Strings.l_DontLike:return g(e.ActiveFormTemplates[a.FeedbackType.Dislike]);case d.Strings.l_Like:return g(e.ActiveFormTemplates[a.FeedbackType.Like]);case d.Strings.l_Suggestion:return g(e.ActiveFormTemplates[a.FeedbackType.Idea]);default:return g(0)}}e.GetMiddleTextIdFromOptionString=m;function l(b){switch(b){case d.Strings.l_DontLike:return f(e.ActiveFormTemplates[a.FeedbackType.Dislike]);case d.Strings.l_Like:return f(e.ActiveFormTemplates[a.FeedbackType.Like]);case d.Strings.l_Suggestion:return f(e.ActiveFormTemplates[a.FeedbackType.Idea]);default:return f(0)}}e.GetFormContainerIdFromOptionString=l;function n(f){return{id:a.IDs.OverlayBackground,classes:[c.Constants.Classes.OverlayMinWidth],children:[{id:a.IDs.MainContainer,children:[{id:a.IDs.MainContentHolder,tag:a.Tags.Form,classes:[a.Classes.Hidden],children:[{id:a.IDs.LeftFormContainer,classes:[a.Classes.FormContainer],children:[{id:a.IDs.FeedbackTitle,classes:[a.Classes.FontTitle,a.Classes.TextAlignLeft,a.Classes.LineHeight],innerText:d.Strings.l_FeedbackTitle},{id:a.IDs.ColumnSeparatorDiv,children:[{id:a.IDs.FeedbackQuestionLeftText,classes:[a.Classes.FontSubtitle,a.Classes.TextAlignLeft,a.Classes.LineHeight],innerText:d.Strings.l_FeedbackOverall},{id:a.IDs.FeedbackOverallLikeAnchor,classes:[a.Classes.FeedbackOverallAnchor,a.Classes.BackgroundGrey],tag:a.Tags.Anchor,attributes:[{name:a.AttributeName.HRef,value:"#"},{name:a.AttributeName.Value,value:d.Strings.l_Like},{name:a.AttributeName.Role,value:a.AttributeValue.Button},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}],children:[{id:a.IDs.FeedbackOverallLikeImage,classes:[a.Classes.FeedbackOverallImage],tag:a.Tags.Img},{id:a.IDs.FeedbackOverallLikeText,classes:[a.Classes.FontText,a.Classes.FeedbackOverallText,a.Classes.LineHeight],innerText:d.Strings.l_Like}]},{id:a.IDs.PlaceHolderDiv1,classes:[a.Classes.FullWidth20pxHeight]},{id:a.IDs.FeedbackOverallDontLikeAnchor,classes:[a.Classes.FeedbackOverallAnchor,a.Classes.BackgroundGrey],tag:a.Tags.Anchor,attributes:[{name:a.AttributeName.HRef,value:"#"},{name:a.AttributeName.Value,value:d.Strings.l_DontLike},{name:a.AttributeName.Role,value:a.AttributeValue.Button},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}],children:[{id:a.IDs.FeedbackOverallDontLikeImage,classes:[a.Classes.FeedbackOverallImage],tag:a.Tags.Img},{id:a.IDs.FeedbackOverallDontLikeText,classes:[a.Classes.FontText,a.Classes.FeedbackOverallText,a.Classes.LineHeight],innerText:d.Strings.l_DontLike}]},{id:a.IDs.PlaceHolderDiv2,classes:[a.Classes.FullWidth20pxHeight]},{id:a.IDs.FeedbackOverallSuggestionAnchor,classes:[a.Classes.FeedbackOverallAnchor,a.Classes.BackgroundGrey],tag:a.Tags.Anchor,attributes:[{name:a.AttributeName.HRef,value:"#"},{name:a.AttributeName.Value,value:d.Strings.l_Suggestion},{name:a.AttributeName.Role,value:a.AttributeValue.Button},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}],children:[{id:a.IDs.FeedbackOverallSuggestionImage,classes:[a.Classes.FeedbackOverallImage],tag:a.Tags.Img},{id:a.IDs.FeedbackOverallSuggestionText,classes:[a.Classes.FontText,a.Classes.FeedbackOverallText,a.Classes.LineHeight],innerText:d.Strings.l_Suggestion}]}]},{id:a.IDs.PrivacyStatementLinkDiv,classes:[a.Classes.FontText,a.Classes.LineHeight,a.Classes.TextAlignLeft],children:[{id:a.IDs.PrivacyStatementLink,tag:a.Tags.Anchor,innerText:d.Strings.l_PrivacyStatement,attributes:[{name:a.AttributeName.HRef,value:b.GetPrivacyUrl(f)},{name:a.AttributeName.Target,value:a.AttributeValue.BlankWindow},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}]}]}]},{id:a.IDs.MiddleFormContainer,classes:[a.Classes.FormContainer,a.Classes.Hidden],children:k().children}]}]}]}}e.GenerateSchema=n;function k(){var b=[];b[e.ActiveFormTemplates[a.FeedbackType.Like]]=true;b[e.ActiveFormTemplates[a.FeedbackType.Dislike]]=true;b[e.ActiveFormTemplates[a.FeedbackType.Idea]]=true;var c={id:a.IDs.FeedbackFormsWrapper,children:[]};b[0]&&c.children.push(j());b[1]&&c.children.push(i());b[2]&&c.children.push(h());return c}e.GenerateForms=k;function j(){return{id:a.IDs.SimpleFeedbackFormContainer,classes:[a.Classes.Hidden,a.Classes.FeedbackFormContainer],children:[{id:a.IDs.SimpleFeedbackFormQuestionMiddleText,classes:[a.Classes.FeedbackQuestionMiddleText,a.Classes.FontSubtitle,a.Classes.MarginLeft36px,a.Classes.LineHeight,a.Classes.TextAlignLeft],attributes:[{name:a.AttributeName.AriaLive,value:a.AttributeValue.Polite}]},{id:a.IDs.SimpleFeedbackFormComment,classes:[a.Classes.FeedbackFormComment,a.Classes.FontText,a.Classes.MarginLeft36px],tag:a.Tags.TextArea,attributes:[{name:a.AttributeName.Name,value:a.IDs.SimpleFeedbackFormComment},{name:a.AttributeName.Placeholder,value:d.Strings.l_CommentPlaceholder},{name:a.AttributeName.MaxLength,value:a.AttributeValue.TextAreaMaxLength},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}]},{id:a.IDs.SimpleFeedbackFormScreenshotContainer,classes:[a.Classes.MarginLeft36px],children:[{id:a.IDs.SimpleFeedbackFormScreenshotCheckboxText,brs:a.Brs.Screenshot,children:[{id:a.IDs.SimpleFeedbackFormScreenshotCheckbox,tag:a.Tags.Input,attributes:[{name:a.AttributeName.Name,value:a.IDs.SimpleFeedbackFormScreenshotCheckbox},{name:a.AttributeName.Type,value:a.AttributeValue.Checkbox},{name:a.AttributeName.Value,value:a.AttributeValue.Unchecked},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}]},{id:a.IDs.SimpleFeedbackFormScreenshotText,classes:[a.Classes.FontText,a.Classes.TextAlignLeft,a.Classes.LineHeight],innerText:d.Strings.l_IncludeScreenshot}]}]},{id:a.IDs.SimpleFeedbackFormSubmitButtonContainer,classes:[a.Classes.FeedbackFormSubmitButtonContainer,a.Classes.MarginLeft36px],children:[{id:a.IDs.SimpleFeedbackFormSubmitButton,classes:[a.Classes.FeedbackFormSubmitButton,a.Classes.FontText,a.Classes.LineHeight],tag:a.Tags.Input,attributes:[{name:a.AttributeName.Type,value:a.AttributeValue.Submit},{name:a.AttributeName.Value,value:d.Strings.l_Submit},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}]}]}]}}e.GenerateSimpleFeedbackForm=j;function i(){return{id:a.IDs.ContactInfoFormContainer,classes:[a.Classes.Hidden,a.Classes.FeedbackFormContainer],children:[{id:a.IDs.ContactInfoFormQuestionMiddleText,classes:[a.Classes.FeedbackQuestionMiddleText,a.Classes.FontSubtitle,a.Classes.MarginLeft36px,a.Classes.LineHeight,a.Classes.TextAlignLeft],attributes:[{name:a.AttributeName.AriaLive,value:a.AttributeValue.Polite}]},{id:a.IDs.ContactInfoFormComment,classes:[a.Classes.FeedbackFormComment,a.Classes.FontText,a.Classes.MarginLeft36px],tag:a.Tags.TextArea,attributes:[{name:a.AttributeName.Name,value:a.IDs.SimpleFeedbackFormComment},{name:a.AttributeName.Placeholder,value:d.Strings.l_CommentPlaceholder},{name:a.AttributeName.MaxLength,value:a.AttributeValue.TextAreaMaxLength},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}]},{id:a.IDs.ContactInfoFormEmailText,classes:[a.Classes.FontText,a.Classes.MarginLeft36px,a.Classes.LineHeight,a.Classes.TextAlignLeft],innerText:d.Strings.l_EmailRequest,attributes:[{name:a.AttributeName.AriaLive,value:a.AttributeValue.Polite}]},{id:a.IDs.ContactInfoFormEmailInput,classes:[a.Classes.FeedbackFormComment,a.Classes.FontText,a.Classes.MarginLeft36px],tag:a.Tags.Input,attributes:[{name:a.AttributeName.Type,value:a.AttributeValue.Text},{name:a.AttributeName.Name,value:a.IDs.ContactInfoFormEmailInput},{name:a.AttributeName.MaxLength,value:a.AttributeValue.TextAreaMaxLength},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}]},{id:a.IDs.ContactInfoFormSubmitButtonContainer,classes:[a.Classes.FeedbackFormSubmitButtonContainer,a.Classes.MarginLeft36px],children:[{id:a.IDs.ContactInfoFormSubmitButton,classes:[a.Classes.FeedbackFormSubmitButton,a.Classes.FontText,a.Classes.LineHeight],tag:a.Tags.Input,attributes:[{name:a.AttributeName.Type,value:a.AttributeValue.Submit},{name:a.AttributeName.Value,value:d.Strings.l_Submit},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}]}]}]}}e.GenerateContactInfoFeedbackForm=i;function h(){return{id:a.IDs.UservoiceLinkFormContainer,classes:[a.Classes.Hidden,a.Classes.FeedbackFormContainer],children:[{id:a.IDs.UservoiceLinkFormQuestionMiddleText,classes:[a.Classes.FeedbackQuestionMiddleText,a.Classes.FontSubtitle,a.Classes.MarginLeft36px,a.Classes.LineHeight,a.Classes.TextAlignLeft],attributes:[{name:a.AttributeName.AriaLive,value:a.AttributeValue.Polite}]},{id:a.IDs.UservoiceLinkFormMiddleText,classes:[a.Classes.FontText,a.Classes.MarginLeft36px,a.Classes.LineHeight,a.Classes.TextAlignLeft],innerText:d.Strings.l_UservoiceInformation,attributes:[{name:a.AttributeName.AriaLive,value:a.AttributeValue.Polite}]},{id:a.IDs.UservoiceLinkFormAnchorContainer,classes:[a.Classes.LinkDiv,a.Classes.MarginLeft36px,a.Classes.FontText,a.Classes.LineHeight,a.Classes.TextAlignLeft],children:[{id:a.IDs.UservoiceLinkFormAnchor,classes:[a.Classes.Link],tag:a.Tags.Anchor,innerText:b.GetUservoiceUrl(false),attributes:[{name:a.AttributeName.HRef,value:b.GetUservoiceUrl(true)},{name:a.AttributeName.Target,value:a.AttributeValue.BlankWindow},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}]}]},{id:a.IDs.UservoiceLinkFormCloseButtonContainer,classes:[a.Classes.FeedbackFormSubmitButtonContainer,a.Classes.MarginLeft36px],children:[{id:a.IDs.UservoiceLinkFormCloseButton,classes:[a.Classes.FeedbackFormSubmitButton,a.Classes.FontText,a.Classes.LineHeight],tag:a.Tags.Input,attributes:[{name:a.AttributeName.Type,value:a.AttributeValue.Submit},{name:a.AttributeName.Value,value:d.Strings.l_Close},{name:a.AttributeName.TabIndex,value:a.AttributeValue.One}]}]}]}}e.GenerateUservoiceLinkFeedbackForm=h})(d.Layout||(d.Layout={}));var e=d.Layout;function f(b){if(typeof b.brs=="undefined")b.brs=true;if(!b.brs)return null;if(!b.tag)b.tag=a.Tags.Div;var d=document.createElement(b.tag);if(b.attributes)for(var e,c=0;c<b.attributes.length;c++){e=b.attributes[c];d.setAttribute(e.name,e.value)}if(b.id)d.id=b.id;if(b.classes){var i=b.classes.join(" ");d.className=i}if(b.innerText)d.innerHTML=b.innerText;if(b.children)for(c=0;c<b.children.length;c++){var h=b.children[c];if(h){var g=f(h);g&&d.appendChild(g)}}return d}d.HtmlElementFromJson=f;function h(c){b.SetElementVisibility(e.GetFormContainerIdFromFormTemplate(e.ActiveFormTemplates[a.FeedbackType.Dislike]),false);b.SetElementVisibility(e.GetFormContainerIdFromFormTemplate(e.ActiveFormTemplates[a.FeedbackType.Like]),false);b.SetElementVisibility(e.GetFormContainerIdFromFormTemplate(e.ActiveFormTemplates[a.FeedbackType.Idea]),false);if(a.UseNarrowScreenLayout){b.SetElementVisibility(a.IDs.LeftFormContainer,false);b.SetElementVisibility(a.IDs.MiddleFormContainer,true);b.SetElementVisibility(c,true)}else{b.AddClassById(a.IDs.ColumnSeparatorDiv,a.Classes.ShowRightBorder);b.SetElementVisibility(a.IDs.MiddleFormContainer,true);b.SetElementVisibility(c,true);b.AddClassById(a.IDs.LeftFormContainer,a.Classes.SlideLeft);b.AddClassById(a.IDs.MiddleFormContainer,a.Classes.SlideLeft)}}d.MainContentHolderSlideLeft=h;function k(c,l,m,h){d.Strings=l;if(h)e.ActiveFormTemplates=h;else{e.ActiveFormTemplates={};e.ActiveFormTemplates[a.FeedbackType.Dislike]=0;e.ActiveFormTemplates[a.FeedbackType.Like]=0;e.ActiveFormTemplates[a.FeedbackType.Idea]=0}a.UseNarrowScreenLayout=i.IsNarrow();var j=f(e.GenerateSchema(m));document.body.insertBefore(j,document.body.firstChild);a.Urls.Images.FrownIcon=a.Urls.CreateURL("feedback_frown",c,a.Urls.Images.Extension);a.Urls.Images.LightBulbIcon=a.Urls.CreateURL("feedback_lightbulb",c,a.Urls.Images.Extension);a.Urls.Images.SmileIcon=a.Urls.CreateURL("feedback_smile",c,a.Urls.Images.Extension);var k=[a.Urls.Images.FrownIcon,a.Urls.Images.LightBulbIcon,a.Urls.Images.SmileIcon];b.CacheImages(k);b.SetAttributeOnHtmlElement(a.IDs.FeedbackOverallDontLikeImage,a.AttributeName.Source,a.Urls.Images.FrownIcon);b.SetAttributeOnHtmlElement(a.IDs.FeedbackOverallLikeImage,a.AttributeName.Source,a.Urls.Images.SmileIcon);b.SetAttributeOnHtmlElement(a.IDs.FeedbackOverallSuggestionImage,a.AttributeName.Source,a.Urls.Images.LightBulbIcon);b.SetElementVisibility(a.IDs.OverlayBackground,true);if(b.GetInternetExplorerVersion()>9||b.GetInternetExplorerVersion()==-1)setTimeout(g,a.Numbers.Pause*8);else g();a.UseNarrowScreenLayout&&b.AddClassById(a.IDs.OverlayBackground,a.Classes.Narrow)}d.Init=k;function g(){b.SetElementVisibility(a.IDs.MainContentHolder,true);var c=document.getElementsByTagName("a")[0];c&&c.focus()}d.ShowUi=g;function j(){b.SetElementVisibility(a.IDs.OverlayBackground,false);b.DeleteElementById(a.IDs.OverlayBackground)}d.Dismiss=j})(c.UI||(c.UI={}));var d=c.UI;(function(g){function z(a,c,b){if(a.addEventListener)a.addEventListener(c,b,false);else a.attachEvent&&a.attachEvent("on"+c,b)}function y(a,c,b){if(a.removeEventListener)a.removeEventListener(c,b,false);else a.detachEvent&&a.detachEvent("on"+c,b)}function j(a){if(a.stopPropagation)a.stopPropagation();else a.cancelBubble=true}function k(a){if(a.preventDefault)a.preventDefault();else a.returnValue=false}function i(d,c,b){var a=document.getElementById(d);a&&z(a,c,b)}function h(d,c,b){var a=document.getElementById(d);a&&y(a,c,b)}function C(){var b=document.getElementById(a.IDs.OverlayBackground);b&&b.focus();z(window,"keyup",x);i(a.IDs.FeedbackOverallLikeAnchor,"click",w);i(a.IDs.FeedbackOverallDontLikeAnchor,"click",r);i(a.IDs.FeedbackOverallSuggestionAnchor,"click",p);i(a.IDs.OverlayBackground,"click",q);i(a.IDs.MainContainer,"click",t);i(a.IDs.SimpleFeedbackFormScreenshotCheckbox,"click",l);i(a.IDs.SimpleFeedbackFormSubmitButton,"click",m);i(a.IDs.ContactInfoFormSubmitButton,"click",o);i(a.IDs.UservoiceLinkFormAnchor,"click",v);i(a.IDs.UservoiceLinkFormCloseButton,"click",n)}g.Init=C;function B(){y(window,"keyup",x);h(a.IDs.FeedbackOverallLikeAnchor,"click",w);h(a.IDs.FeedbackOverallDontLikeAnchor,"click",r);h(a.IDs.FeedbackOverallSuggestionAnchor,"click",p);h(a.IDs.OverlayBackground,"click",q);h(a.IDs.MainContainer,"click",t);h(a.IDs.SimpleFeedbackFormScreenshotCheckbox,"click",l);h(a.IDs.SimpleFeedbackFormSubmitButton,"click",m);h(a.IDs.ContactInfoFormSubmitButton,"click",o);h(a.IDs.UservoiceLinkFormAnchor,"click",v);h(a.IDs.UservoiceLinkFormCloseButton,"click",n)}g.Dismiss=B;function x(b){if(b.keyCode==a.Keys.Esc){k(b);j(b);c.Networking.NetworkingMgr.SendTrace(2,{Keyboard:"Escape key pressed, Office browser feedback UI dismissed"});f(false)}}g.FeedbackKeyHandler=x;function q(a){k(a);j(a);c.Networking.NetworkingMgr.SendTrace(2,{Mouse:"Mouse click on the background area, Office browser feedback UI dismissed"});f(false)}g.FeedbackOverlayBackgroundHandler=q;function t(a){j(a)}g.FeedbackMainContainerHandler=t;function u(a,b){k(a);j(a);A(b)}function A(h){var f;b.DeleteAndAddClassesById(a.IDs.FeedbackOverallLikeAnchor,a.Classes.BackgroundBlue,a.Classes.BackgroundGrey);b.DeleteAndAddClassesById(a.IDs.FeedbackOverallDontLikeAnchor,a.Classes.BackgroundBlue,a.Classes.BackgroundGrey);b.DeleteAndAddClassesById(a.IDs.FeedbackOverallSuggestionAnchor,a.Classes.BackgroundBlue,a.Classes.BackgroundGrey);b.DeleteAndAddClassesById(h,a.Classes.BackgroundGrey,a.Classes.BackgroundBlue);b.SetAttributeOnHtmlElement(a.IDs.FeedbackOverallLikeAnchor,a.AttributeName.AriaSelected,a.AttributeValue.False);b.SetAttributeOnHtmlElement(a.IDs.FeedbackOverallDontLikeAnchor,a.AttributeName.AriaSelected,a.AttributeValue.False);b.SetAttributeOnHtmlElement(a.IDs.FeedbackOverallSuggestionAnchor,a.AttributeName.AriaSelected,a.AttributeValue.False);b.SetAttributeOnHtmlElement(h,a.AttributeName.AriaSelected,a.AttributeValue.True);var g=document.getElementById(h),j=d.Layout.GetMiddleTextIdFromOptionString(g.getAttribute(a.AttributeName.Value)),c=document.getElementById(j);if(!g||!c)return;switch(g.getAttribute(a.AttributeName.Value)){case d.Strings.l_DontLike:f=a.FeedbackType.Dislike;c.innerHTML=d.Strings.l_WhatDontLike;break;case d.Strings.l_Suggestion:f=a.FeedbackType.Idea;c.innerHTML=d.Strings.l_WhatSuggest;break;default:f=a.FeedbackType.Like;c.innerHTML=d.Strings.l_WhatLike}e.AddData(a.AttributeValue.FeedbackOverall,f);d.MainContentHolderSlideLeft(d.Layout.GetFormContainerIdFromOptionString(g.getAttribute(a.AttributeName.Value)));var i=document.getElementById(a.IDs.SimpleFeedbackFormComment);i&&i.focus()}g.HandleFeedbackOverall=A;function w(b){u(b,a.IDs.FeedbackOverallLikeAnchor)}g.FeedbackOverallLikeHandler=w;function r(b){u(b,a.IDs.FeedbackOverallDontLikeAnchor)}g.FeedbackOverallDontLikeHandler=r;function p(b){u(b,a.IDs.FeedbackOverallSuggestionAnchor)}g.FeedbackOverallSuggestionHandler=p;function l(c){j(c);var b=document.getElementById(a.IDs.SimpleFeedbackFormScreenshotCheckbox);if(b)b.getAttribute(a.AttributeName.Value)==a.AttributeValue.Checked?b.setAttribute(a.AttributeName.Value,a.AttributeValue.Unchecked):b.setAttribute(a.AttributeName.Value,a.AttributeValue.Checked)}g.SimpleFeedbackFormScreenshotCheckboxHandler=l;function m(b){k(b);j(b);s(a.IDs.SimpleFeedbackFormContainer)}g.SimpleFeedbackFormSubmitButtonHandler=m;function o(b){k(b);j(b);s(a.IDs.ContactInfoFormContainer)}g.ContactInfoFormSubmitButtonHandler=o;function n(a){k(a);j(a);c.Networking.NetworkingMgr.SendTrace(2,"User clicked close button on UserVoice form.");f(false)}g.UservoiceLinkFormCloseButtonHandler=n;function v(a){j(a);c.Networking.NetworkingMgr.SendTrace(2,"User clicked link to UserVoice forum.")}g.UservoiceLinkFormLinkHandler=v;function s(i){var b=document.getElementById(i);if(!b)b=document.getElementById(a.IDs.MainContentHolder);if(b){for(var h=b.querySelectorAll(a.Tags.Input+", "+a.Tags.TextArea),g=0;g<h.length;g++){var d=h[g];switch(d.getAttribute(a.AttributeName.Type)){case a.AttributeValue.Submit:break;default:e.AddData(d.getAttribute(a.AttributeName.Name),d.value)}}e.AddData("PageUrl",window.location.href);e.AddData("BrowserUserAgent",window.navigator.userAgent);c.Networking.NetworkingMgr.LogFeedbackData(e.GetData());f(true)}else{c.Networking.NetworkingMgr.SendTrace(0,"Specified DOM element or MainContentHolder not found");f(false)}}g.LogFeedbackDataFromElementById=s})(c.Events||(c.Events={}));var h=c.Events;(function(a){var b={};function f(b){if(b!=null)for(var c in b)a.AddData(c,b[c])}a.Init=f;function d(c,a){b[c]=a}a.AddData=d;function c(a){delete b[a]}a.RemoveData=c;function e(){return b}a.GetData=e})(c.FeedbackData||(c.FeedbackData={}));var e=c.FeedbackData,g;function j(f,k,j,b,i,m,l,a){c.Networking.NetworkingMgr.Init(b,i);e.Init(l);d.Init(f,k,m,a);h.Init();g=j;c.Networking.NetworkingMgr.SendTrace(2,{OFeedback:"Office browser feedback UI opened"})}c.InitAll=j;function f(a){h.Dismiss();d.Dismiss();c.Networking.NetworkingMgr.Dismiss();g(a)}c.DismissAll=f})(OfficeBrowserFeedback||(OfficeBrowserFeedback={}));