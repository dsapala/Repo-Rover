function StopEventPropagation(n){n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}function ExpandHeader(){var n=document.getElementById("sw_bar"),i,r,t;return n.style.display="block",typeof $!="undefined"&&($(document).keydown(OnSwitcherDialogKeyDown),$(document).keyup(OnSwitcherDialogKeyUp),$("#sw_bar").toggleClass("closeAnimation",!1)),i=document.getElementById("h_bar"),r=i.clientHeight+"px",window.setTimeout(function(){n.style.top=r},0),window.setTimeout(function(){n.style.opacity=1},0),document.getElementById("sw_barBG").style.display="block",t=document.getElementById("sw_Outlook"),t!=null&&t.focus(),!1}function OnSwitcherLauncherKeyDown(n){n.which==32&&ExpandHeader()}function CollapseHeader(){var n=document.getElementById("sw_bar");return typeof $!="undefined"&&$("#sw_bar").toggleClass("closeAnimation",!0),n.style.top="30px",n.style.opacity="0",window.setTimeout(function(){n.style.display="none"},200),document.getElementById("sw_barBG").style.display="none",typeof $!="undefined"&&($(document).unbind("keydown",OnSwitcherDialogKeyDown),$(document).unbind("keyup",OnSwitcherDialogKeyUp)),!1}function DismissPopupBanner(n){var i=new Date,u,r,t;return i.setTime(i.getTime()+15552e6),document.cookie=n+"=1; expires="+i.toGMTString()+"; path=/",u=document.getElementById("h_popup"),u.style.display="none",r=document.getElementById("h_bar"),r.className=r.className.replace(/HeaderPopupShown/,""),t=document.getElementById("b_content"),t&&(t.className=t.className.replace(/HeaderPopupShown/,"")),!1}function OnSwitcherDialogKeyDown(n){var t;if(n.which==9){var i="sw_Outlook",r="sw_OfficeDotCom",e=document.getElementById("sw_bar"),u=r,f=i;n.shiftKey&&(u=i,f=r);n.target&&n.target.id==u&&(n.preventDefault(),StopEventPropagation(n),t=document.getElementById(f),t!=null&&t.focus())}}function OnSwitcherDialogKeyUp(n){if(n.which==27){CollapseHeader();var t=document.getElementById("h_logoChev");t!=null&&t.focus()}}function BypassSignInControl(){return g_hrdOverride?(HandleShowNext({nextScreen:g_hrdOverride}),!0):!1}function ShowPersistentSignInControl(){BypassSignInControl()||(g_persistentDialog=!0,MakeSignInControlVisible())}function ShowSignInControl(){if(!BypassSignInControl()){var n=document.getElementById("h_overlay");if(n.style.display=="block"){HideSignInControl();return}g_persistentDialog=!1;MakeSignInControlVisible();typeof $!="undefined"&&$(document).keyup(onSignInDialogKeyUp);n.onclick=HideSignInControl}}function MakeSignInControlVisible(){typeof $!="undefined"&&$("#h_signiniframe").addClass("iframeloading");g_hrdTimeout=window.setInterval(function(){SendClickInfo(g_msaLoginUrl,"hrd_hrdloadtimeout");window.location=g_msaLoginUrl},1e4);document.getElementById("h_overlay").style.display="block";document.getElementById("h_signincntrl").style.display="block";document.getElementById("h_signiniframe").src=g_hrdIframeUrl}function HideSignInControl(){document.getElementById("h_overlay").style.display=="none"||g_persistentDialog||(document.getElementById("h_overlay").style.display="none",document.getElementById("h_signincntrl").style.display="none",document.getElementById("h_signiniframe").src="",document.getElementById("h_signiniframe").innerhtml="",typeof $!="undefined"&&$(document).unbind("keyup",HideSignInControl),SendClickInfo("","hrd_canceldialog"),window.removeEventListener?window.removeEventListener("resize",PositionHrd):window.detachEvent("onresize",PositionHrd))}function onSignInDialogKeyUp(n){n.which==27&&HideSignInControl()}function hideAllDropDownMenus(){for(var r,i,t=document.querySelectorAll(".linkWithMenu.selected"),n=0;n<t.length;n++)t[n].className=t[n].className.replace(" selected","");for(r=document.querySelectorAll(".dropDownMenu"),i=0;i<r.length;i++)r[i].style.display="none"}function toggleDropDownMenu(n,t,i){var u=document.getElementById(t),r=document.getElementById(i);u&&r&&(r.style.display=="inline"?hideAllDropDownMenus():(hideAllDropDownMenus(),u.className+=" selected",r.style.display="inline",StopEventPropagation(n)))}function OnSwitcherTileMouseDown(){if(window.addEventListener){var n=this;n.className+=" tilePressed"}}function RestoreSwitcherTileVisuals(){var t=GetSwitcherTiles(),n;if(t!=null)for(n=0;n<t.length;n++)t[n].className=t[n].className.replace(" tilePressed","")}function GetSwitcherTiles(){var n=document.getElementById("sw_tileList"),t=null;return n!=null&&typeof n.getElementsByClassName!="undefined"&&(t=n.getElementsByClassName("swTile")),t}function AttachSwitcherTileEvents(){var n,t;if(window.addEventListener&&(document.body&&document.body.addEventListener&&document.body.addEventListener("mouseup",RestoreSwitcherTileVisuals),n=GetSwitcherTiles(),n!=null))for(t=0;t<n.length;t++)n[t].addEventListener("mousedown",OnSwitcherTileMouseDown),n[t].addEventListener("dragstart",function(n){n.preventDefault()})}function HRDListener(n){var i=document.createElement("a"),r=document.createElement("a"),t;if((i.href=g_hrdIframeUrl,r.href=n.origin,r.hostname==i.hostname)&&window.JSON&&window.JSON.parse){if(t=JSON.parse(n.data),!t||!t.op){window.location=g_msaLoginUrl;return}switch(t.op){case"ShowNext":HandleShowNext(t);break;case"LaunchUrl":HandleLaunchUrl(t);break;case"CancelDialog":HideSignInControl();break;case"OnReady":HandleOnHrdReady(t);break;default:return}}}function RegisterHRDListener(){window.addEventListener?window.addEventListener("message",HRDListener):window.attachEvent("onmessage",HRDListener)}function AppendOrReplaceQueryParameter(n,t,i){var r,u;return/^[^?#]*&/.test(n)?n:(t=encodeURIComponent(t),i=encodeURIComponent(i),r=new RegExp("(^[^#]*?[?&])"+t.replace(/[.*()]/g,"\\$1")+"(=.*?|)(&|#|$)","i"),r.test(n)?n.replace(r,"$1"+t+"="+i+"$3"):(u=/^[^#]*?\?/.test(n)?"&":"?",n.replace(/(#|$)/,u+t+"="+i+"$1")))}function HandleShowNext(n){var t,i,r,u;if(n.nextScreen){t="";i="";switch(n.nextScreen){case"0":t=g_signupUrl;i="hrd_signup";break;case"1":t=g_msaLoginUrl;i="hrd_signin";break;case"2":r=g_orgIdLoginUrl;r=n.federationProvider!=null?"https://portal."+n.federationProvider:g_orgIdLoginUrl;t=r;i="hrd_orgid";break;case"3":t=g_msaPasswordResetUrl;i="hrd_resetpassword";break;default:return}n.emailAddress&&(u=n.nextScreen=="2"&&!n.federationProvider?"login_hint":"username",t=AppendOrReplaceQueryParameter(t,u,n.emailAddress));SendClickInfo(t,i);window.location=t}}function PositionHrd(){var i;if(typeof $!="undefined"){var n=$("#h_signincntrl"),r=$("#h_bar"),u=r.offset().top+r.height(),t=$("#f_bar");n.css("top","50%");n.css("margin-top",-n.height()/2);n.offset().top<u&&(n.css("margin-top",0),n.css("top",u));i=n.offset().top+n.height();t.css("position","");t.css("top","");t.css("margin-top","");t.offset().top<i&&(t.css("position","absolute"),t.css("top",i),t.css("margin-top","0"))}}function HandleOnHrdReady(n){if(g_hrdTimeout!=null&&(window.clearInterval(g_hrdTimeout),g_hrdTimeout=null),typeof $!="undefined"){var t=$("#h_signincntrl"),i=$("#h_signiniframe");i.removeClass("iframeloading");n.calcHeightPx&&n.calcHeightPx>t.height()&&(t.height(n.calcHeightPx),t.css("margin-top",-n.calcHeightPx/2),i.height(n.calcHeightPx));PositionHrd()}window.addEventListener?window.addEventListener("resize",PositionHrd):window.attachEvent("onresize",PositionHrd);SendClickInfo("","hrd_hrdloaded");SetStaticAssetsFrameUrl()}function HandleLaunchUrl(n){n.url&&(window.location=n.url)}function hasCookie(n){for(var r,u=n+"=",i=document.cookie.split(";"),t=0;t<i.length;t++)if(r=i[t].trim(),r.indexOf(u)==0)return!0;return!1}function GetOrgIdDestinationUrl(){if(g_authType=="OrgId"&&(typeof g_orgidDestinationUrl=="undefined"||!g_orgidDestinationUrl)){var n="GetServerUserInfo.ashx?auth=2&nf=1";typeof g_cid!="undefined"&&g_cid&&(n+="&pcid="+g_cid);typeof $!="undefined"&&$.ajax({url:n,type:"GET",dataType:"json",success:function(n,t,i){if(typeof n!="undefined"&&n&&typeof n.durl!="undefined"&&n.durl)g_orgidDestinationUrl=n.durl,g_createNewClicked&&NavigateToCreateNewDocument();else{var r=null,u=null;typeof i!="undefined"&&i&&(r=i.status,u=i.getResponseHeader("X-CorrelationId"));Diag.ULS.sendTraceTag(6936135,g_msoulscat_Wac_WebAppsPortal,Diag.ULSTraceLevel.info,"GetServerUserInfo [textStatus: {0}] [status:{1}] [CorrelationId: {2}]",t,r,u);OnGetServerUserInfoCallFailed()}},error:function(n,t,i){var r=null,u=null;typeof n!="undefined"&&n&&(r=n.status,u=n.getResponseHeader("X-CorrelationId"));Diag.ULS.sendTraceTag(6936136,g_msoulscat_Wac_WebAppsPortal,Diag.ULSTraceLevel.warning,"GetServerUserInfo [textStatus: {0}] [status:{1}] [errorThrown: {2}] [CorrelationId: {3}]",t,r,i,u);OnGetServerUserInfoCallFailed()},beforeSend:function(n){n.setRequestHeader("X-Key",g_canary)}})}}function OnGetServerUserInfoCallFailed(){g_createNewClicked?NavigateToErrorPage(3):g_getServerUserInfoCallFailed=!0}function NavigateToErrorPage(n){var t=g_createNewErrorPage;typeof n!="undefined"&&n&&(t=AppendOrReplaceQueryParameter(t,"ec",n));t=AppendOrReplaceQueryParameter(t,"pcid",typeof g_cid!="undefined"?g_cid:"unknown");window.location.href=t}function CreateNewDocument(n){if(g_createNewClicked=!0,!n||(g_createNewDocumentTargetUrl=n),ShowLoadingSpinnerOnPanel(),g_getServerUserInfoCallFailed){NavigateToErrorPage(4);return}(g_authType!="OrgId"||g_orgidDestinationUrl&&g_orgidDestinationUrl.length>0)&&NavigateToCreateNewDocument()}function ShowLoadingSpinnerOnPanel(){var n=document.getElementById("b_dialogpanel");n.innerHTML="";n.className+=" iframeloading";setTimeout(function(){g_createNewNavigated?NavigateToErrorPage(6):NavigateToErrorPage(5)},g_createNewTimeout)}function NavigateToCreateNewDocument(){var n,t,i;if(g_authType=="WindowsLiveId"&&!hasCookie("PPLState")||g_authType=="OrgId"&&!hasCookie("AADState")){Diag.ULS.sendTraceTag(7473307,g_msoulscat_Wac_WebAppsPortal,Diag.ULSTraceLevel.info,"User has signed out [PageCorrelation: {0}]",typeof g_cid!="undefined"?g_cid:"unknown");window.location.href=g_signedOutUrl;return}n=g_createNewDocumentTargetUrl;g_authType=="OrgId"&&g_orgidDestinationUrl&&g_orgidDestinationUrl.length>0&&(n=n+"&destinationUrl="+escape(g_orgidDestinationUrl));n=n+"&ct="+(new Date).getTime();typeof g_cid!="undefined"&&g_cid&&(n=n+"&pcid="+g_cid);t=document.createElement("form");t.setAttribute("method","POST");t.setAttribute("action",n);i=document.createElement("input");i.setAttribute("name","Canary");i.setAttribute("value",g_canary);i.setAttribute("type","hidden");t.appendChild(i);document.body.appendChild(t);t.submit();g_createNewNavigated=!0}function SetStaticAssetsFrameUrl(){typeof g_staticAssetUrl!="undefined"&&g_staticAssetUrl&&window.setTimeout(function(){var n=document.getElementById("preloadframe");n!=null&&(n.src=g_staticAssetUrl)},1e3)}function SetWarmupFrameUrl(){typeof g_dnsWarmupDelay!="undefined"&&typeof g_dnsWarmupUrls!="undefined"&&g_dnsWarmupUrls&&g_dnsWarmupUrls.length>0&&window.setTimeout(function(){for(var n,t=0;t<g_dnsWarmupUrls.length;t++)n=document.createElement("iframe"),n.style.display="none",n.sandbox="",document.body.appendChild(n),n.id="warmupiframe"+t,n.src=g_dnsWarmupUrls[t]},g_dnsWarmupDelay)}function InitializeLogging(){Diag.ULS.setUlsHost(new Diag.UploadingUlsHost(g_sid,"/start/"+Diag.UploadingUlsHost.defaultRemoteUlsUrl));g_loggingInitialized=!0;SendBrowserInfo()}function DisposeLogging(){Diag.ULS.get_host().dispose()}function SendClickInfo(n,t){if(typeof Diag!="undefined"){var i={};i.destUrl=n;i.urlId=t;i.pageName=typeof g_PageName!="undefined"?g_PageName:"unknown";i.pageUrl=window.location.href;i.pageCorrelationId=typeof g_cid!="undefined"?g_cid:"unknown";Diag.ULS.sendTraceTag(6686497,g_msoulscat_Wac_WebAppsPortal,Diag.ULSTraceLevel.info,"{0}",i)}}function SendBrowserInfo(){if(typeof performance!="undefined"&&window.performance!=null){var n={};n.redir=window.performance.navigation.redirectCount;n.pageCorrelationId=typeof g_cid!="undefined"?g_cid:"unknown";Diag.ULS.sendTraceTag(7148097,g_msoulscat_Wac_WebAppsPortal,Diag.ULSTraceLevel.info,"{0}",n)}}function OnError(n){g_loggingInitialized&&Diag.ULS.sendTraceTag(7135579,g_msoulscat_Wac_WebAppsPortal,Diag.ULSTraceLevel.error,"{0}.\r\n{1}",n.message,n.stack)}var g_persistentDialog,g_hrdTimeout,g_msoulscat_Wac_WebAppsPortal,g_loggingInitialized;Diag.ULSCat.prototype.msoulscat_Story_Site=1100;Diag.ULSCat.prototype.msoulscat_Story_RequestManager=1101;Diag.ULSCat.prototype.msoulscat_Story_AddContent=1102;Diag.ULSCat.prototype.msoulscat_Story_Storyline=1103;Diag.ULSCat.prototype.msoulscat_Story_Automation=1104;Diag.ULSCat.prototype.msoulscat_Story_Preview=1105;Diag.ULSCat.prototype.msoulscat_Story_InteractionModel=1106;Diag.ULSCat.prototype.msoulscat_Story_Feedback=1107;Diag.ULSCat.prototype.msoulscat_Story_FeedbackData=1108;Diag.ULSCat.prototype.msoulscat_Story_ContextualUI=1109;Diag.ULSCat.prototype.msoulscat_Story_DocumentImport=1110;Diag.ULSCat.prototype.msoulscat_Story_Style=1111;Diag.ULSCat.registerEnum("Diag.ULSCat",!1);g_persistentDialog=!1;g_hrdTimeout=null;window.onclick=hideAllDropDownMenus;window.addEventListener&&window.addEventListener("load",AttachSwitcherTileEvents);var g_createNewClicked=!1,g_getServerUserInfoCallFailed=!1,g_createNewNavigated=!1;g_msoulscat_Wac_WebAppsPortal=349;g_loggingInitialized=!1;window.addEventListener?window.addEventListener("error",OnError,!1):window.attachEvent("onerror"+event,OnError);