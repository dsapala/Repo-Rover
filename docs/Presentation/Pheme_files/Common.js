function fidoCallback(){}function onYouTubeIframeAPIReady(){Common.YouTubeAPILoader.onAPILoaded()}var Aria,__extends,CommonBindings,StoryAppEdit,EmbedHostType,Flags,CommonSettings,ResourceManager,State,O365ShellService,CancellationSource,Cookie,PageType,Telemetry,Point,EdgeSegment,BaseRect,Rect,RemoveEditor,Color,Delete,FlightList,Glyphs,HashMap,Icons,UX,ActionLogger,ClientAction,WatchableSwitchesTransport,DocumentIngestion,FeatureDetection,FlightClientSettings,Identity,Feedback,OfficeBrowserFeedback,ImageUtils,Containers,UnitTestMode,CommonMain,StoryAudience,SharingManager,StoryLog,StoryLogUtilities,StoryManager,MonitoredScope,StoryReference,StoryViewMode,TextShadow,Utilities,StoryTile,Common,YT,StoryApp,FileUploader;(function(n){n.Attributes={Atomic:"aria-atomic",Busy:"aria-busy",Controls:"aria-controls",Describedby:"aria-describedby",Disabled:"aria-disabled",Dropeffect:"aria-dropeffect",Flowto:"aria-flowto",Grabbed:"aria-grabbed",Haspopup:"aria-haspopup",Hidden:"aria-hidden",Invalid:"aria-invalid",Label:"aria-label",Labelledby:"aria-labelledby",Live:"aria-live",Owns:"aria-owns",Relevant:"aria-relevant",Autocomplete:"aria-autocomplete",Checked:"aria-checked",Expanded:"aria-expanded",Level:"aria-level",Multiline:"aria-multiline",Multiselectable:"aria-multiselectable",Orientation:"aria-orientation",Pressed:"aria-pressed",Readonly:"aria-readonly",Required:"aria-required",Selected:"aria-selected",Sort:"aria-sort",Valuemax:"aria-valuemax",Valuemin:"aria-valuemin",Valuenow:"aria-valuenow",Valuetext:"aria-valuetext",Activedescendant:"aria-activedescendant",Posinset:"aria-posinset",Setsize:"aria-setsize",Role:"role",TabIndex:"tabindex"};n.CheckboxState={True:"true",False:"false",Mixed:"mixed"};n.BooleanState={True:"true",False:"false"}})(Aria||(Aria={})),function(n){n.Roles={Alert:"alert",Alertdialog:"alertdialog",Application:"application",Article:"article",Banner:"banner",Button:"button",Checkbox:"checkbox",Columnheader:"columnheader",Combobox:"combobox",Complementary:"complementary",Contentinfo:"contentinfo",Definition:"definition",Dialog:"dialog",Directory:"directory",Document:"document",Form:"form",Grid:"grid",Gridcell:"gridcell",Group:"group",Heading:"heading",Img:"img",Link:"link",List:"list",Listbox:"listbox",Listitem:"listitem",Log:"log",Main:"main",Marquee:"marquee",Math:"math",Menu:"menu",Menubar:"menubar",Menuitem:"menuitem",Menuitemcheckbox:"menuitemcheckbox",Menuitemradio:"menuitemradio",Navigation:"navigation",Note:"note",Option:"option",Presentation:"presentation",Progressbar:"progressbar",Radio:"radio",Radiogroup:"radiogroup",Region:"region",Row:"row",Rowgroup:"rowgroup",Rowheader:"rowheader",Scrollbar:"scrollbar",Search:"search",Separator:"separator",Slider:"slider",Spinbutton:"spinbutton",Status:"status",Tab:"tab",Tablist:"tablist",Tabpanel:"tabpanel",Textbox:"textbox",Timer:"timer",Toolbar:"toolbar",Tooltip:"tooltip",Tree:"tree",Treegrid:"treegrid",Treeitem:"treeitem"}}(Aria||(Aria={})),function(n){var t;(function(n){var t;(function(n){(function(n){n[n.Canvas=0]="Canvas";n[n.StoryLine=1]="StoryLine";n[n.OOUI=2]="OOUI"})(n.AuthoringState||(n.AuthoringState={}));var t=n.AuthoringState})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n){var t=this;t._element=n}return n.prototype.updateClassName=function(n,t){var i=this;i._element.className=t},n}();n.BindingBase=t})(t=n.ClassName||(n.ClassName={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n,t,i){var r=this;r._element=n;r._viewElement=i}return n.prototype.updateCopyHtml=function(n,t){var i=this,r=$(t).html();$(i._element).html(r)},n}();n.BindingBase=t})(t=n.CopyHtml||(n.CopyHtml={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var u,i,t,r;(function(n){n[n.Full=0]="Full";n[n.GlyphOnly=1]="GlyphOnly";n[n.Overflow=2]="Overflow"})(n.MenuItemState||(n.MenuItemState={}));u=n.MenuItemState,function(n){n[n.Step1=0]="Step1";n[n.Step2=1]="Step2";n[n.Step3=2]="Step3";n[n.Step4=3]="Step4";n[n.NextToLastStep=n.Step4]="NextToLastStep";n[n.LastStep=4]="LastStep"}(n.MenuResizeStep||(n.MenuResizeStep={}));i=n.MenuResizeStep;t=function(){function n(){}return n}();n.MenuChunkData=t;r=function(){function n(n){var t=this;t._element=n;t._visible=!1;t._menuChunks=[];t._notifyMenuItemResize=TDB.notifierTag(8788033,t)}return n.prototype.updateVisible=function(n,t){var i=this;i._visible=t.visible;i._widthBuffer=t.widthBuffer;i._visible&&(i._resizeHandler||(i._resizeHandler=Utilities.onResize(i.updateLayout,i)),i.updateLayout());!i._visible&&i._resizeHandler&&(i._resizeHandler.dispose(),i._resizeHandler=undefined)},n.prototype.updateChunks=function(n,t){var i=this,e,r,f,o,u;for(i._widthBuffer=t.widthBuffer,n.watch(i._notifyMenuItemResize),i._menuChunks=t.menuChunks,e=i._menuChunks.length,r=0;r<e;r++)for(f=i._menuChunks[r].getMenuItems(n),o=f.length,u=0;u<o;u++)f[u].viewElementVisible.getWatchedValue(n);i.updateLayout()},n.prototype.updateLayout=function(){var n=this,r,u,o;if(n._visible&&n._menuChunks!=null&&n._menuChunks.length!=0){var i=$(n._element).innerWidth()+n._widthBuffer,h=n._menuChunks.length,t=0;for(r=0;r<h;r++){var f=n._menuChunks[r],s=f.getMenuItems(),c=s.length,e=0;for(f.getOverflowButtonVisible()&&(e+=f.getOverflowButtonWidth()),u=0;u<c;u++)o=s[u],o.viewElementVisible.getValue()&&(e+=o.getItemWidth());t+=e}TDB.applyUpdate(function(){t>=i?n.shrinkLayout(i,t):t<i&&n.growLayout(i,t)},5)}},n.prototype.shrinkLayout=function(n,i){for(var o=this,u={},c=1,s=i,v,r,f,l,h;s>=n&&c<=4;){for(v=o._menuChunks.length,r=v-1;s>=n&&r>=0;){for(u[r]===undefined&&(u[r]=new t,u[r].menuChunk=o._menuChunks[r],u[r].overflowVisible=u[r].menuChunk.getOverflowButtonVisible(),u[r].overflowElementChange=0),f=u[r],f.currentProjectedWidth=s,l=f.menuChunk.getMenuItems(),h=l.length-1;f.currentProjectedWidth>=n&&h>=0;){var e=l[h],y=e.viewElementVisible.getValue(),a=e.stateMap[c];if(y&&a!==undefined&&a!==e.state.getValue())switch(a){case 1:if(!o.shrinkToGlyphOnly(e,f))return;break;case 2:o.showInOverflow(e,f)}h--}s=f.currentProjectedWidth;r--}c++}},n.prototype.growLayout=function(n,r){var s=this,f={},h,c,v,u,e;if(!(n<=r))for(h=i.NextToLastStep,c=r;h>=0;){for(v=s._menuChunks.length,u=0;u<v;){f[u]===undefined&&(f[u]=new t,f[u].menuChunk=s._menuChunks[u],f[u].overflowVisible=f[u].menuChunk.getOverflowButtonVisible(),f[u].overflowElementChange=0);e=f[u];e.currentProjectedWidth=c;for(var y=e.menuChunk.getMenuItems(),w=y.length,l=0;l<w;){var o=y[l],b=o.viewElementVisible.getValue(),a=o.stateMap[h],p=o.state.getValue();if(b&&a!==undefined&&a!==p)if(p===2){if(!s.hideInOverflow(o,a,n,e))return}else if(!s.growToFull(o,n,e))return;l++}c=e.currentProjectedWidth;u++}h--}},n.prototype.shrinkToGlyphOnly=function(n,t){var r=this,i;return n.state.getValue()!=0?!0:n.needToRecalcWidth(1)?(n.state.setValue(1),r._notifyMenuItemResize.notify(),!1):(i=n.getItemWidth(),n.state.setValue(1),t.currentProjectedWidth=t.currentProjectedWidth-i+n.getItemWidth(),!0)},n.prototype.showInOverflow=function(n,t){var u=this,r,i;n.state.getValue()!=2&&(r=n.getItemWidth(),n.state.setValue(2),t.overflowElementChange++,i=0,!t.overflowVisible&&t.menuChunk.predictOverflowButtonVisible(t.overflowElementChange)&&(t.overflowVisible=!0,i+=t.menuChunk.getOverflowButtonWidth()),t.currentProjectedWidth=t.currentProjectedWidth-r+i)},n.prototype.hideInOverflow=function(n,t,i,r){var e=this,f,u;if(n.state.getValue()!=2||t==2)return!0;if(n.needToRecalcWidth(t))return n.state.setValue(t),e._notifyMenuItemResize.notify(),!1;if(f=n.getWidthForState(t),r.overflowElementChange--,u=0,r.overflowVisible&&!r.menuChunk.predictOverflowButtonVisible(r.overflowElementChange)&&(u=r.menuChunk.getOverflowButtonWidth()),r.currentProjectedWidth+f-u<i)u!=0&&(r.overflowVisible=!1),r.currentProjectedWidth=r.currentProjectedWidth+f-u,n.state.setValue(t);else return!1;return!0},n.prototype.growToFull=function(n,t,i){var u=this;if(n.state.getValue()!==1)return!0;if(n.needToRecalcWidth(0))return n.state.setValue(0),u._notifyMenuItemResize.notify(),!1;var f=n.getWidthForState(0),e=n.getItemWidth(),r=i.currentProjectedWidth-e+f;if(r<t)i.currentProjectedWidth=r,n.state.setValue(0);else return!1;return!0},n.prototype.dispose=function(){var n=this;n._resizeHandler&&(n._resizeHandler.dispose(),n._resizeHandler=undefined)},n}();n.BindingBase=r})(t=n.DynamicMenu||(n.DynamicMenu={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n,t,i){this._transitionDefault="opacity 0.3s ease";var r=this;r._element=n;r._viewElement=i;r._visible=!0;r._disabled=!1;r._overrideDisplay=!0}return n.prototype.init=function(n){var t=this;if(t._disabled=n.disabled,!t._disabled){t._transitionIn=n.transitionIn?n.transitionIn:t._transitionDefault;t._transitionOut=n.transitionOut?n.transitionOut:t._transitionDefault;n.visibleInit!=t._visible&&(t._visible=n.visibleInit);n.overrideDisplay!==undefined&&(t._overrideDisplay=n.overrideDisplay);t._element.style.transition=t._visible?t._transitionIn:t._transitionOut;t._element.style.opacity=t._visible?"1":"0";!t._visible&&t._overrideDisplay&&(t._element.style.display="none");t._transitionEndHandler=function(i){i.target==t._element&&(t._visible&&n.onVisible&&n.context&&n.onVisible.apply(n.context),!t._visible&&n.onHidden&&n.context&&n.onHidden.apply(n.context),!t._visible&&t._overrideDisplay&&(t._element.style.display="none"))};$(t._element).on("transitionend",t._transitionEndHandler)}},n.prototype.updateFadeVisible=function(n,t){var i=this,r,u;i._disabled||i._visible!=t.visible&&(i._visible=t.visible,t.transitionIn&&(i._transitionIn=t.transitionIn),t.transitionOut&&(i._transitionOut=t.transitionOut),i._visible&&i._overrideDisplay&&(i._element.style.display=""),r=i._visible?i._transitionIn:i._transitionOut,i._element.style.transition=r,u=t.transitionDelay!==undefined?t.transitionDelay:0,setTimeout(function(){i._element.style.opacity=i._visible?"1":"0"},u),r=="none"&&!i._visible&&i._overrideDisplay&&(i._element.style.display="none"))},n.prototype.dispose=function(){var n=this;n._transitionEndHandler&&$(n._element).off("transitionend",n._transitionEndHandler)},n}();n.BindingBase=t})(t=n.FadeVisible||(n.FadeVisible={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){(function(n){n[n.Up=0]="Up";n[n.Left=1]="Left";n[n.Right=2]="Right";n[n.Down=3]="Down"})(n.Direction||(n.Direction={}));var u=n.Direction,t=["calloutTop-in 366ms linear 1 both","calloutLeft-in 366ms linear 1 both","calloutRight-in 366ms linear 1 both","calloutBottom-in 366ms linear 1 both"],i=["calloutTop-out 200ms linear 1 both","calloutLeft-out 200ms linear 1 both","calloutRight-out 200ms linear 1 both","calloutBottom-out 200ms linear 1 both"],r=function(){function n(n,t,i){this.animationEndEventString="webkitAnimationEnd oanimationend MSAnimationEnd animationend";var r=this;r._element=n;r._viewElement=i;r._visible=!1;r._disabled=!1;r._delay="1.0s";r._direction=0;r._animationEndHandler=function(){r._visible||(r._element.style.display="none")}}return n.prototype.init=function(n){var t=this;if(t._disabled=n.disabled,!t._disabled){n.visibleInit!=t._visible&&(t._visible=n.visibleInit);n.delay!==undefined&&(t._delay=n.delay);n.direction!==undefined&&(t._direction=n.direction);t._visible||(t._element.style.display="none");t._element.style.opacity=t._visible?"1":"0";t._element.style.transition="opacity 200ms linear";$(t._element).on(t.animationEndEventString,t._animationEndHandler)}},n.prototype.updateCalloutFade=function(n,r){var u=this;u._disabled||u._visible!==r.visible&&(u._visible=r.visible,u._visible&&(u._element.style.display=""),platform.setImmediate(function(){u._visible?(u._element.style.animation=t[u._direction],u._element.style.animationDelay=u._delay,platform.setImmediate(function(){u._element.style.transitionDelay=u._delay;u._element.style.opacity="1"})):(u._element.style.animation=i[u._direction],u._element.style.animationDelay="0s",u._element.style.transitionDelay="0s",u._element.style.opacity="0",setTimeout(function(){u._element.style.animation="none";u._element.style.display="none";u.dispose()},210))}))},n.prototype.dispose=function(){var n=this;n._animationEndHandler&&$(n._element).off(n.animationEndEventString,n._animationEndHandler)},n}();n.BindingBase=r})(t=n.CalloutFade||(n.CalloutFade={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n){var t=this;t._element=n;t._updateCalled=!1;t._scrollMargin=0}return n.prototype.init=function(n){var t=this;t._scrollMargin=n},n.prototype.updateScrollIntoView=function(n,t){var i=this,f,o,u;if(!i._updateCalled){i._updateCalled=!0;return}for(var e=$(i._element).offset().top,s=e+$(i._element).outerHeight(),r=i._element;r.parentNode!=undefined;){if($(r).css("overflow-y")=="auto"||$(r).css("overflow-y")=="scroll"){f=$(r).offset().top;o=f+$(r).height();t&&f>e-i._scrollMargin||f>s-i._scrollMargin?(u=$(r).scrollTop(),u-=f-e+i._scrollMargin,$(r).scrollTop(u)):(t&&s+i._scrollMargin>o||e+i._scrollMargin>o)&&(u=$(r).scrollTop(),u+=s-o+i._scrollMargin,$(r).scrollTop(u));break}r=r.parentNode}},n}();n.BindingBase=t})(t=n.ScrollIntoView||(n.ScrollIntoView={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n){var t=this;t._element=n}return n.prototype.updateSelectText=function(n,t){var i=this;n.watchValue(t)&&i._element.select()},n}();n.BindingBase=t})(t=n.SelectText||(n.SelectText={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n,t,i){var r=this;r._element=n;r._viewElement=i}return n.prototype.init=function(){var n=this;n._element.style.transition=".367s";n._element.style.transform="translateX(-100%)";n._element.style.display="";n._transitionEndHandler=function(t){t.target==n._element&&(n._visible||(n._element.style.display="none"))};$(n._element).on("transitionend",n._transitionEndHandler)},n.prototype.updateSlidePaneVisible=function(n,t){var i=this;i._visible!==t&&(i._visible=t,i._visible&&(i._element.style.display=""),setTimeout(function(){i._element.style.transform=i._visible?"":"translateX(-100%)"},0))},n.prototype.dispose=function(){var n=this;n._transitionEndHandler&&$(n._element).off("transitionend",n._transitionEndHandler)},n}();n.BindingBase=t})(t=n.SlidePaneVisible||(n.SlidePaneVisible={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n,t,i){var r=this;r._element=n;r._viewElement=i}return n.prototype.init=function(n){var t=this;t._visible=n;n||(t._element.style.display="none")},n.prototype.updateSlideVisible=function(n,t){var i=this,r;i._visible!==t.visible&&(i._visible=t.visible,r=t.duration!=undefined?t.duration:200,$(i._element).stop(!0,!0),t.visible?$(i._element).slideDown({duration:r,complete:function(n,r){t.done&&t.done.call(i._viewElement,n,r)}}):$(i._element).slideUp({duration:r,complete:function(n,r){t.done&&t.done.call(i._viewElement,n,r)}}))},n}();n.BindingBase=t})(t=n.SlideVisible||(n.SlideVisible={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r){n.call(this,null);var u=this;u._element=t;u._viewElement=r}return __extends(t,n),t.prototype.init=function(n){var t=this;t._updateWidth=n;t.addResource(Utilities.onResize(t.setWidth,t));setTimeout(function(){t.setWidth()},0)},t.prototype.setWidth=function(){var n=this,t=$(n._element).width();n._updateWidth.call(n._viewElement,t)},t}(Disposable);n.BindingBase=t})(t=n.WidthWatcher||(n.WidthWatcher={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){function t(n,t){n=Utilities.safeCallback(n);var i=function(t){n.call(i.context,t)};return i.context=t,t=null,i}var i=function(){function n(n){var t=this;t._element=n;t._playerReady=!1}return n.prototype.dispose=function(){if(this._player&&(this._player.destroy(),this._player=null,this._events))for(var n in this._events)delete this._events[n].context},n.prototype.updateCreate=function(n,i){var r=this,u,f;if(r.dispose(),i.videoId){u=i.playerEvents;r._events={};for(f in u)r._events[f]=t(u[f],i.playerEventsContext);r.initPlayer({videoId:i.videoId,playerVars:i.playerParams,events:r._events},i.playerCallback,i.playerCallbackContext)}},n.prototype.updateResize=function(n,t){var i=this;i._playerWidth=t.width;i._playerHeight=t.height;i._player&&i._player.setSize(t.width,t.height)},n.prototype.initPlayer=function(n,t,i){var r=this;Common.YouTubeAPILoader.isAPILoaded()?r.createPlayer(n,t,i):Common.YouTubeAPILoader.queueWork(function(){return r.createPlayer(n,t,i)})},n.prototype.createPlayer=function(n,t,i){var r=this,u;r._playerWidth!==undefined&&(n.width=r._playerWidth);r._playerHeight!==undefined&&(n.height=r._playerHeight);u=document.createElement("div");r._element.appendChild(u);r._player=new YT.Player(u,n);t.call(i,r._player)},n}();n.BindingBase=i})(t=n.YouTubePlayer||(n.YouTubePlayer={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r,u,f){var e,o;n.call(this,t,i,r);e=this;e._ve=r;e._classNameArgs=f;o=e._classNameWatcher=TDB.watcherTag(4800663,e,u,e._resolveClassName);u._subscribeToWatchable(o,2);e._classNameWatcher.resolve()}return __extends(t,n),t.prototype.update=function(n){var t=this;n==2&&t._classNameWatcher.resolve()},t.prototype._resolveClassName=function(n){var t=this,i=t._classNameArgs.call(t._ve,n);t.updateClassName(n,i)},t}(n.BindingBase);n.Binding=t})(t=n.ClassName||(n.ClassName={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r,u,f,e){var o,s;n.call(this,t,i,r);o=this;o._ve=r;o.init(f);o._fadeVisibleArgs=e;s=o._fadeVisibleWatcher=TDB.watcherTag(4800663,o,u,o._resolveFadeVisible);u._subscribeToWatchable(s,2);o._fadeVisibleWatcher.resolve()}return __extends(t,n),t.prototype.update=function(n){var t=this;n==2&&t._fadeVisibleWatcher.resolve()},t.prototype._resolveFadeVisible=function(n){var t=this,i=t._fadeVisibleArgs.call(t._ve,n);t.updateFadeVisible(n,i)},t}(n.BindingBase);n.Binding=t})(t=n.FadeVisible||(n.FadeVisible={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r,u,f,e){var o,s;n.call(this,t,i,r);o=this;o._ve=r;o.init(f);o._scrollIntoViewArgs=e;s=o._scrollIntoViewWatcher=TDB.watcherTag(4800663,o,u,o._resolveScrollIntoView);u._subscribeToWatchable(s,4)}return __extends(t,n),t.prototype.update=function(n){var t=this;n==4&&t._scrollIntoViewWatcher.resolve()},t.prototype._resolveScrollIntoView=function(n){var t=this,i=t._scrollIntoViewArgs.call(t._ve,n);t.updateScrollIntoView(n,i)},t}(n.BindingBase);n.Binding=t})(t=n.ScrollIntoView||(n.ScrollIntoView={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r,u,f){var e,o;n.call(this,t,i,r);e=this;e._ve=r;e.init();e._slidePaneVisibleArgs=f;o=e._slidePaneVisibleWatcher=TDB.watcherTag(4800663,e,u,e._resolveSlidePaneVisible);u._subscribeToWatchable(o,4)}return __extends(t,n),t.prototype.update=function(n){var t=this;n==4&&t._slidePaneVisibleWatcher.resolve()},t.prototype._resolveSlidePaneVisible=function(n){var t=this,i=t._slidePaneVisibleArgs.call(t._ve,n);t.updateSlidePaneVisible(n,i)},t}(n.BindingBase);n.Binding=t})(t=n.SlidePaneVisible||(n.SlidePaneVisible={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r,u,f,e){var o,s;n.call(this,t,i,r);o=this;o._ve=r;o.init(f);o._slideVisibleArgs=e;s=o._slideVisibleWatcher=TDB.watcherTag(4800663,o,u,o._resolveSlideVisible);u._subscribeToWatchable(s,4)}return __extends(t,n),t.prototype.update=function(n){var t=this;n==4&&t._slideVisibleWatcher.resolve()},t.prototype._resolveSlideVisible=function(n){var t=this,i=t._slideVisibleArgs.call(t._ve,n);t.updateSlideVisible(n,i)},t}(n.BindingBase);n.Binding=t})(t=n.SlideVisible||(n.SlideVisible={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r,u,f){var e,o;n.call(this,t,i,r);e=this;e._ve=r;e._selectTextArgs=f;o=e._selectTextWatcher=TDB.watcherTag(4800663,e,u,e._resolveSelectText);u._subscribeToWatchable(o,4)}return __extends(t,n),t.prototype.update=function(n){var t=this;n==4&&t._selectTextWatcher.resolve()},t.prototype._resolveSelectText=function(n){var t=this,i=t._selectTextArgs.call(t._ve,n);t.updateSelectText(n,i)},t}(n.BindingBase);n.Binding=t})(t=n.SelectText||(n.SelectText={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r,u,f){n.call(this,t,i,r);var e=this;e._ve=r;e.init(f)}return __extends(t,n),t.prototype.update=function(){},t}(n.BindingBase);n.Binding=t})(t=n.WidthWatcher||(n.WidthWatcher={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r,u,f){var e,o;n.call(this,t,i,r);e=this;e._ve=r;e._copyHtmlArgs=f;o=e._copyHtmlWatcher=TDB.watcherTag(4800663,e,u,e._resolveCopyHtml);u._subscribeToWatchable(o,4)}return __extends(t,n),t.prototype.update=function(n){var t=this;n==4&&t._copyHtmlWatcher.resolve()},t.prototype._resolveCopyHtml=function(n){var t=this,i=t._copyHtmlArgs.call(t._ve,n);t.updateCopyHtml(n,i)},t}(n.BindingBase);n.Binding=t})(t=n.CopyHtml||(n.CopyHtml={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r,u,f,e){var o,s;n.call(this,t,i,r);o=this;o._ve=r;o._createArgs=f;s=o._createWatcher=TDB.watcherTag(4800663,o,u,o._resolveCreate);u._subscribeToWatchable(s,2);o._resizeArgs=e;s=o._resizeWatcher=TDB.watcherTag(4800663,o,u,o._resolveResize);u._subscribeToWatchable(s,2);o._createWatcher.resolve();o._resizeWatcher.resolve()}return __extends(t,n),t.prototype.update=function(n){var t=this;n==2&&(t._createWatcher.resolve(),t._resizeWatcher.resolve())},t.prototype._resolveCreate=function(n){var t=this,i=t._createArgs.call(t._ve,n);t.updateCreate(n,i)},t.prototype._resolveResize=function(n){var t=this,i=t._resizeArgs.call(t._ve,n);t.updateResize(n,i)},t}(n.BindingBase);n.Binding=t})(t=n.YouTubePlayer||(n.YouTubePlayer={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r,u,f,e){var o,s;n.call(this,t,i,r);o=this;o._ve=r;o._visibleArgs=f;s=o._visibleWatcher=TDB.watcherTag(4800663,o,u,o._resolveVisible);u._subscribeToWatchable(s,4);o._chunksArgs=e;s=o._chunksWatcher=TDB.watcherTag(4800663,o,u,o._resolveChunks);u._subscribeToWatchable(s,4)}return __extends(t,n),t.prototype.update=function(n){var t=this;n==4&&(t._visibleWatcher.resolve(),t._chunksWatcher.resolve())},t.prototype._resolveVisible=function(n){var t=this,i=t._visibleArgs.call(t._ve,n);t.updateVisible(n,i)},t.prototype._resolveChunks=function(n){var t=this,i=t._chunksArgs.call(t._ve,n);t.updateChunks(n,i)},t}(n.BindingBase);n.Binding=t})(t=n.DynamicMenu||(n.DynamicMenu={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r,u,f,e){var o,s;n.call(this,t,i,r);o=this;o._ve=r;o.init(f);o._calloutFadeArgs=e;s=o._calloutFadeWatcher=TDB.watcherTag(4800663,o,u,o._resolveCalloutFade);u._subscribeToWatchable(s,2);o._calloutFadeWatcher.resolve()}return __extends(t,n),t.prototype.update=function(n){var t=this;n==2&&t._calloutFadeWatcher.resolve()},t.prototype._resolveCalloutFade=function(n){var t=this,i=t._calloutFadeArgs.call(t._ve,n);t.updateCalloutFade(n,i)},t}(n.BindingBase);n.Binding=t})(t=n.CalloutFade||(n.CalloutFade={}))})(t=n.Bindings||(n.Bindings={}))})(t=n.View||(n.View={}))}(CommonBindings||(CommonBindings={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function t(n,t,i){var r=this;r._storyId=n;r._storyTitle=t;r._castUrl=i}return t.createAndShow=function(n,i,r){if(!BRSDialog.showIfAuthoringDisabled()){var u=new t(n,i,r);u.initDialog()}},t.prototype.initDialog=function(){var t=this,i=t._storyTitle?ResourceManager.ResolveString(Resources.SharingCastEditOwnerDialogBodyWithStoryTitle,[t._storyTitle]):Resources.SharingCastEditOwnerDialogBody,r={title:Resources.SharingCastEditOwnerDialogTitle,messages:[i],lightDismiss:!1,dialogType:2,buttonsArgs:[{caption:Resources.SharingCastEditOwnerDialogReturn,dismissOnAction:!1,onAction:function(){t._castUrl&&(window.location.href=decodeURIComponent(Utilities.query.fetch("done")))}},{caption:Resources.SharingCastEditOwnerDialogSignin,isDefault:!0,dismissOnAction:!1,onAction:function(){t.signIn()}}]};t._dlg=n.View.Common.DialogManager.createAndShow(r)},t.prototype.signIn=function(){var n=this;n._dlg.close();Identity.SignInHelper(!1,null)},t}();t.CastEditOwnerDialog=i})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=n.View.ViewElements,r=function(){function t(n){var t=this;t._expectedUser=n}return t.createAndShow=function(n){if(!BRSDialog.showIfAuthoringDisabled()){var i=new t(n);i.initDialog()}},t.prototype.initDialog=function(){var t=this,f={dialogType:2,lightDismiss:!0,buttonsArgs:[{caption:Resources.SignIn,isDefault:!0,isNeutralButton:!0,dismissOnAction:!1,onAction:function(){t._expectedUser.isTenantUser?Identity.RedirectSignIn("",Identity.c_OrgId):Identity.RedirectSignIn("",Identity.c_MSAccount)}}]},r,u;t._dlg=n.View.Common.DialogManager.createDialog(f);r={user:t._expectedUser,message:Resources.EditStoryNoUserDialogMessage};u=new i.EditStoryDialogVE(t._dlg,r);t._dlg.updateContent(u);n.View.Common.DialogManager.showDialog(t._dlg)},t}();t.EditStoryNoUserDialog=r})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=n.View.ViewElements,r=function(){function t(n,t){var i=this;i._currentUserEmail=n;i._expectedUser=t}return t.createAndShow=function(n,i){if(!BRSDialog.showIfAuthoringDisabled()){var r=new t(n,i);r.initDialog()}},t.prototype.initDialog=function(){var t=this,f={dialogType:2,lightDismiss:!0,buttonsArgs:[{caption:Resources.SignIn,isDefault:!0,isNeutralButton:!0,dismissOnAction:!1,onAction:function(){t.signIn()}}]},r,u;t._dlg=n.View.Common.DialogManager.createDialog(f);r={user:t._expectedUser,message:ResourceManager.ResolveString(Resources.EditStoryWrongUserDialogMessage,[t._currentUserEmail])};u=new i.EditStoryDialogVE(t._dlg,r);t._dlg.updateContent(u);n.View.Common.DialogManager.showDialog(t._dlg)},t.prototype.signIn=function(){var n=this;n._dlg.close();Identity.SignInHelper(!1,null)},t}();t.EditStoryWrongUserDialog=r})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function i(n,t){var i=this;i._lookupId=n;t&&(i._publishCallback=t)}return i.createAndShowPublish=function(n,t){var u=this,r=new i(n,t);r.showPublish()},i.createAndShowUnpublish=function(n,t){var u=this,r=new i(n,t);r.showUnpublish()},i.prototype.showPublish=function(){var r=this,u={title:Resources.SharingCastPublishDialogTitle,messages:[Resources.SharingCastPublishDialogBody],width:i.s_dialogWidth,noFocus:!0,dialogType:1,buttonsArgs:[{caption:Resources.ButtonCancel,id:"idshButtonDismiss",isNeutralButton:!0},{caption:Resources.SharingCastPublish,onAction:$.proxy(this.onPublishButtonOK,this),isDefault:!0,dismissOnAction:!1,id:"idshButtonOK"}]};r._dlg=n.View.Common.DialogManager.createAndShow(u);var f=$("<a>",{text:Resources.AttributionLink,href:Resources.AttributionLinkUrl}).attr("target","_blank"),e=$("<span>").text(Resources.AttributionMessage).html(),o=Utilities.formatString(e,[f[0].outerHTML]),s=$("<div>").append($("<p>").html(o)),h=new t.DialogHtmlContainerVE(r._dlg,{innerHTML:s.html()});r._dlg.updateContent(h)},i.prototype.showUnpublish=function(){var t=this,r={title:Resources.SharingCastPublishRemoveConfirmationDialogTitle,messages:[Resources.SharingCastPublishRemoveConfirmationDialogBody],width:i.s_dialogWidth,noFocus:!0,dialogType:1,buttonsArgs:[{caption:Resources.ButtonCancel,id:"idshButtonDismiss",isNeutralButton:!0},{caption:Resources.SharingCastPublishRemove,onAction:$.proxy(this.onUnpublishButtonOK,this),isDefault:!0,dismissOnAction:!1,id:"idshButtonOK"}]};t._dlg=n.View.Common.DialogManager.createAndShow(r)},i.prototype.onPublishButtonOK=function(){var r=this,u,f;n.View.Common.DialogManager.closeCurrentDialog();u=new t.DialogLoadingSpinnerVE(r._dlg);f={dialogType:2,title:Resources.SharingCastPublishDialogTitle,width:i.s_dialogWidth,contentVE:u};r._dlg=n.View.Common.DialogManager.createAndShow(f);SharingManager.publishSwayToCast(r._lookupId,$.proxy(r.onSuccess,r),$.proxy(r.onError,r))},i.prototype.onUnpublishButtonOK=function(){var r=this,u,f;n.View.Common.DialogManager.closeCurrentDialog();u=new t.DialogLoadingSpinnerVE(r._dlg);f={dialogType:2,title:Resources.SharingCastPublishRemoveConfirmationDialogTitle,width:i.s_dialogWidth,contentVE:u};r._dlg=n.View.Common.DialogManager.createAndShow(f);SharingManager.unpublishFromCast(r._lookupId,0,$.proxy(r.onSuccess,r),$.proxy(r.onError,r))},i.prototype.onSuccess=function(n){var t=this;t._publishCallback&&t._publishCallback(n.castId,n.castViewUrl);t._dlg.close()},i.prototype.onError=function(n,t,i){var r=this;if(n.status==410){r._publishCallback&&r._publishCallback(null,null);r._dlg.close();return}$.browser.webkit&&n.status==0&&t=="error"&&i==""?setTimeout($.proxy(function(){this.showError()},this),1e3):this.showError(t,i)},i.prototype.showError=function(){var r=this,t;n.View.Common.DialogManager.closeCurrentDialog();t={dialogType:4,title:Resources.SharingCastPublishErrorDialogTitle,messages:[Resources.SharingCastPublishErrorDialogBody],width:i.s_dialogWidth,noFocus:!0,buttonsArgs:[{caption:Resources.ButtonOK,isDefault:!0,dismissOnAction:!0,isNeutralButton:!0,id:"idshButtonClose"}]};r._dlg=n.View.Common.DialogManager.createAndShow(t)},i.s_dialogWidth=548,i}();t.PublishCastDialog=i})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var i=function(){function n(){}return n}(),t;n.StoryClipboardData=i;t=function(){function n(n){var t=this;t._args=n}return n.prototype.handleEvent=function(n){var t=this;return t._args.handleEvent?t._args.handleEvent(n):0},n.prototype.isInterestingKeyEvent=function(n,t){if(t){var i=Utilities.isMacOsX?n.metaKey:n.ctrlKey;if(i&&!n.altKey&&!n.shiftKey&&t.contains(String.fromCharCode(n.which)))return!0}return!1},n.prototype.prepareForCopy=function(n,t){var i=this,r;t&&(i.saveState(),i.clearState(),setTimeout(function(){i.restoreState()},0));r=i.getCopyDiv();r.empty();r.show();$("<textarea id='copyarea'><\/textarea>").val(n).appendTo(r).focus().select();setTimeout(function(){i.getCopyDiv().empty().hide()},0)},n.prototype.prepareForPaste=function(){var n=this,t,i;n.saveState();n.clearState();t=n.getPasteDiv();t.empty();t.show();$("<textarea id='pastearea'><\/textarea>").val(" ").appendTo(t).focus().select();i=n.getSpecializedPasteEventName();$(document).on(i,function(t){$(document).off(i);var r=n.getPasteData(t);return n.useCustomPasteAction(r)?(n.paste(r),n.getPasteDiv().empty().hide(),t.preventDefault(),!1):!0})},n.prototype.getPasteEventName=function(){var n=this;return n._args.getPasteEventName?n._args.getPasteEventName():""},n.prototype.paste=function(n){var t=this;t._args.paste&&t._args.paste(n)},n.prototype.useCustomPasteAction=function(n){var t=this;return t._args.useCustomPasteAction?t._args.useCustomPasteAction(n):!1},n.prototype.getCopyDiv=function(){var n=this;return n._args.getCopyDiv?n._args.getCopyDiv():undefined},n.prototype.getPasteDiv=function(){var n=this;return n._args.getPasteDiv?n._args.getPasteDiv():undefined},n.prototype.clearState=function(){var n=this;if(n._args.clearState)return n._args.clearState()},n.prototype.restoreState=function(){var n=this;if(n._args.restoreState)return n._args.restoreState()},n.prototype.saveState=function(){var n=this;if(n._args.saveState)return n._args.saveState()},n.prototype.getPasteData=function(n){var t=Utilities.isIE()?window.clipboardData:n.originalEvent.clipboardData,i=Utilities.isIE()?"Text":"text/plain";return t.getData(i)},n.prototype.getSpecializedPasteEventName=function(){var n=this;return"paste."+n.getPasteEventName()},n}();n.CopyPasteImplementationBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryAppEdit||(StoryAppEdit={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function t(){var n=this}return t.createAndShow=function(n){return(new t).show(n)},t.prototype.show=function(t){var i=this,r=[{caption:t.acceptButtonText,isDefault:!0,dismissOnAction:!0}],u={title:t.title,dialogType:2,lightDismiss:!1,messages:t.messages,buttonsArgs:r};return i._dlg=n.View.Common.DialogManager.createDialog(u),n.View.Common.DialogManager.showDialog(i._dlg),i._dlg},t}();t.MessageDialog=i})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=n.View.ViewElements,r=function(){function t(){var n=this}return t.createAndShow=function(n){var i=new t;return i.show(n)},t.prototype.show=function(t){var r=this,f=[{caption:t.acceptButtonText,isDefault:!0,dismissOnAction:!1,onAction:function(){r.onCommit(t.onAccept,t.context)}}],e={title:t.title,noFocus:!1,dialogType:2,lightDismiss:!0,buttonsArgs:f,allowCancel:t.allowEsc},u;return r._dlg=n.View.Common.DialogManager.createDialog(e),u=new i.DialogTextInputVE(r._dlg,{description:t.textInputDescription?t.textInputDescription:"",initialValue:t.initialValue,textInputCss:t.textInputCss,placeholder:t.textInputPlaceholder?t.textInputPlaceholder:"",onEnter:function(){r._dlg.buttonsArgs().getValue()[0].setFocus();r.onCommit(t.onAccept,t.context)}}),r._dlg.updateContent(u),n.View.Common.DialogManager.showDialog(r._dlg),r._dlg},t.prototype.onCommit=function(n,t){var i=this,r=i._dlg.getContent(),u=r.value.getValue();n.call(t,u)},t}();t.TextInputDialog=r})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function i(){var n=this}return i.createAndShow=function(n){return(new i).show(n)},i.prototype.show=function(i){var r=this,f={title:i,dialogType:2,lightDismiss:!1},u;return r._dlg=n.View.Common.DialogManager.createDialog(f),u=new t.DialogLoadingSpinnerVE(r._dlg),r._dlg.updateContent(u),n.View.Common.DialogManager.showDialog(r._dlg),r._dlg},i}();t.ProgressDialog=i})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function i(){var n=this}return i.createAndShow=function(){(new i).show()},i.prototype.show=function(){var i=this,u={title:Resources.SwitchingAccountsTitle,dialogType:2},r;i._dlg=n.View.Common.DialogManager.createDialog(u);r=new t.DialogLoadingSpinnerVE(i._dlg);i._dlg.updateContent(r);n.View.Common.DialogManager.showDialog(i._dlg)},i}();t.SwitchingAccountsDialog=i})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=n.Common,r=function(){function t(){var n=this}return t.createAndShow=function(n){(new t).show(n)},t.prototype.show=function(t){var r=this,u={title:Resources.SyncedStoryDialogTitle,dialogType:2,width:500,lightDismiss:!0,buttonsArgs:[{caption:Resources.SyncedStoryDialogSyncButton,isDefault:!0,onAction:function(){i.UserStories.getInstance().onLoadingStory(t)}},{caption:Resources.ButtonClose,dismissOnAction:!0}]};r._dlg=n.View.Common.DialogManager.createDialog(u);r._dlg.updateContentMessage([Resources.SyncedStoryDialogDescription]);n.View.Common.DialogManager.showDialog(r._dlg)},t}();t.SyncStoryDialog=r})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function i(n,t,r){var u=this;u._storyId=n;u._editToken=t;u._storyTitle=r;i.dialogTitle=Resources.EditTokenRetrievalDialogTitle}return i.createAndShow=function(n,t,r){if(!BRSDialog.showIfAuthoringDisabled()){var u=new i(n,t,r);u.show()}},i.prototype.show=function(){var t=this,r={title:i.dialogTitle,dialogType:2};r.messages=t._storyTitle?[ResourceManager.ResolveString(Resources.EditTokenRetrievalDialogDescription,[t._storyTitle])]:[Resources.EditTokenRetrievalDialogDescriptionNoTitle];r.buttonsArgs=[{caption:Resources.EditTokenRetrievalDialogEditButton,isDefault:!0,dismissOnAction:!1,onAction:function(){t.retrieveEditToken()}},{caption:Resources.EditTokenRetrievalDialogViewOnlyButton,dismissOnAction:!1,onAction:function(){n.Common.UserStories.getInstance().onLoadingStory(t._storyId,!1,!0)&&(window.location.href=n.Common.UrlHelper.getInstance().viewUrl(t._storyId))}}];t._dlg=n.View.Common.DialogManager.createAndShow(r)},i.prototype.retrieveEditToken=function(){var r=this;n.View.Common.DialogManager.closeCurrentDialog();t.ProgressDialog.createAndShow(i.dialogTitle);$.ajax(n.Common.UrlHelper.getInstance().addAuthorUrl(r._storyId,r._editToken),{name:"EditTokenRetrieval",description:"Retrieving edit token",type:"POST",success:function(){n.Common.UserStories.getInstance().onLoadingStory(r._storyId)&&(window.location.href=n.Common.UrlHelper.getInstance().viewUrl(r._storyId))},error:function(n,t,i){r.showError(t,i)}})},i.prototype.showError=function(){var i=this,t;n.View.Common.DialogManager.closeCurrentDialog();t={title:Resources.EditTokenRetrievalDialogTitle,dialogType:2,messages:[Resources.EditTokenRetrievalDialogGenericError],buttonArgs:[{caption:Resources.ButtonOK,isDefault:!0,dismissOnAction:!0}]};i._dlg=n.View.Common.DialogManager.createAndShow(t)},i.prototype.createBaseDialogArgs=function(){return{title:Resources.EditTokenRetrievalDialogTitle,dialogType:2}},i}();t.EditTokenRetrievalDialog=i})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){n[n.none=0]="none";n[n.dd=1]="dd";n[n.ddprofile=2]="ddprofile"}(EmbedHostType||(EmbedHostType={})),function(n){var t;(function(n){var i=function(n){function i(){n.apply(this,arguments)}return __extends(i,n),i.prototype.addHandler=function(n,i,r){var u=new t(this,n,i,r);this.addResource(u)},i.prototype.fire=function(n){this.resources.forEach(function(t){return t.fire(n)})},i}(DisposableHolder),t;n.EventSource=i;t=function(){function n(n,t,i,r){this.event=n;this.parent=t;this.context=i;this.handler=r;this.parent&&this.parent.addResource(this)}return n.prototype.fire=function(n){this.handler&&this.handler.call(this.context,n)},n.prototype.dispose=function(){this.event&&this.event.removeResource(this);this.parent&&this.parent.removeResource(this);this.event=null;this.context=null;this.handler=null;this.parent=null},n}();n.EventRegistration=t})(t=n.Common||(n.Common={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i=function(){function i(){this.createStoryDisabled=!1}return i.getInstance=function(){return i.instance||(i.instance=new i),i.instance},i.setInstance=function(n){i.instance=n},i.clearInstance=function(){i.instance=undefined},i.prototype.onLoadingStory=function(n,t,i){return t===void 0&&(t=!0),i===void 0&&(i=t),!0},i.prototype.createStoryOrSignIn=function(i){var r=CommonSettings.IsAuthenticated&&t.Environment.getInstance().shouldShowAuthoringEntrypoints();if(StoryLog.StructuredTraceTag(9213016,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"CommonMain : createStoryOrSignIn",{CurrentPage:window.location.pathname,EntryPoint:i,IsAuthenticated:CommonSettings.IsAuthenticated.toString(),AnonUserId:CommonSettings.AnonUserId,CreatingStory:r.toString()}),r){this.submitCreateStory("");return}if(CommonSettings.IsAuthenticated){window.location.assign(n.Common.UrlHelper.getInstance().mySwaysUrl());return}Identity.SignInHelper(!1,null);return},i.prototype.submitCreateStory=function(t){BRSDialog.showIfAuthoringDisabled()||this.createStoryDisabled||n.RequestManager.ensureValidCanary(function(){var n=$("#hCreateNewForm");t!==null&&$('<input type="hidden" name="storyTitle" value="'+t+'">').appendTo(n);Cookie.setPageRequestInfo(n.attr("action"));n.submit();this.createStoryDisabled=!0})},i.prototype.submitCreateStoryFromOffice=function(){BRSDialog.showIfAuthoringDisabled()||this.createStoryDisabled||$("#officeFileInput").click()},i}();t.UserStories=i})(t=n.Common||(n.Common={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t=function(){function n(n){this.commonSettings=n}return n.getInstance=function(){return n.instance||(n.instance=new n(CommonSettings)),n.instance},n.setInstance=function(t){n.instance=t},n.prototype.isInternalUser=function(){var n=this.commonSettings&&this.commonSettings.FlightSettings?this.commonSettings.FlightSettings:null;return n&&n.isInternal},n.prototype.isUserOnFlight=function(n){var r=!1,t="",f=this.commonSettings&&this.commonSettings.FlightSettings?this.commonSettings.FlightSettings:null,u,e,i;if(f&&(t=f.flightName,t))for(u=t.split(";"),e=u.length,i=0;i<e;i++)if(u[i]==n){r=!0;break}return ActionLogger.RecordClientAction(new ClientAction.UserFlightAssignmentData(n,t,r)),r},n.prototype.getDisplayName=function(){return this.commonSettings.DisplayName},n.prototype.getUserName=function(){return this.commonSettings.DisplayName},n.prototype.getUserPicture=function(){return Icons.Doughboy20Icon},n.prototype.getUserEmail=function(){return this.commonSettings.EmailAddress},n}();n.UserState=t})(t=n.Common||(n.Common={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t=function(){function t(t,i){i===void 0&&(i=!0);this.windowSize=TDB.watchableTag(9213015,null,{w:innerWidth,h:innerHeight});this.availableBandwidth=0;this.commonSettings=t;this.clientOnline=TDB.watchableTag(9266253,this,i);this.clientOnlineChanged=new n.EventSource(null)}return t.getInstance=function(){return t.instance||(t.instance=new t(CommonSettings)),t.instance},t.setInstance=function(n){t.instance=n},t.clearInstance=function(){t.instance=undefined},t.prototype.getWindowSize=function(n){return this.windowSize.getWatchedValue(n)},t.prototype.updateWindowSize=function(){var n=$(window);this.windowSize.setValue({w:n.width(),h:n.height()})},t.prototype.getAvailableBandwidth=function(){return this.availableBandwidth},t.prototype.setAvailableBandwidth=function(n){this.availableBandwidth=n},t.prototype.shouldShowAuthoringEntrypoints=function(){var n=this.windowSize.getValue().w>=600,t=this.commonSettings.ClientDevice!="Mobile";return n&&t},t.prototype.inDowntimeDeployment=function(){return this.commonSettings.DowntimeDeployment},t.prototype.isProductionEnvironment=function(){return!(this.commonSettings.EnvironmentName==t.IntName||this.commonSettings.EnvironmentName==t.DevFabricName||this.commonSettings.EnvironmentName==t.SingleBox||this.commonSettings.EnvironmentName==t.ScaledBox||this.commonSettings.EnvironmentName==t.WeeklyName)},t.prototype.areInternalFeaturesEnabled=function(){return this.commonSettings&&this.commonSettings.FlightSettings&&this.commonSettings.FlightSettings.areInternalFeaturesEnabled},t.prototype.shouldDisplayInternalFeaturesButton=function(){return this.areInternalFeaturesEnabled()},t.prototype.getClientOnlineWatcher=function(){return this.clientOnline},t.prototype.isClientOnline=function(n){return this.clientOnline.getWatchedValue(n)},t.prototype.subscribeToIsClientOnline=function(n,t,i){this.clientOnlineChanged.addHandler(n,t,i)},t.ProductionName="Production",t.DevFabricName="DevFabric",t.IntName="Int",t.SingleBox="SingleBox_Cloud",t.ScaledBox="ScaledPr_Cloud",t.WeeklyName="Weekly",t}();n.Environment=t})(t=n.Common||(n.Common={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){(function(n){n[n.Mobile=1]="Mobile";n[n.Tablet=2]="Tablet";n[n.Laptop=3]="Laptop";n[n.Desktop=4]="Desktop"})(n.DeviceType||(n.DeviceType={}));var t=n.DeviceType})(t=n.Common||(n.Common={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){n.officeAppSwitcherButtonId="OfficeAppSwitcherButton";n.swayButtonId="SwayButton";n.swayButtonRightClick="SwayButtonRigthClick";n.internalFeaturesEnabledButtonId="InternalFearuresEnabledButton";n.signInButtonId="SignInButton";n.tutorialVideosButtonId="TutorialVideosButton";n.getStartedTopButtonId="GetStartedButtonTop";n.getStartedBottomButtonId="GetStartedButtonBottom";n.mySwaysHeaderButtonId="MySwaysHeaderButton";n.createNewButtonId="CreateNewButton";n.addFeedbackButtonId="FeedbackButton";n.userButtonID="UserButton";n.signOutButtonId="SignOutButton";n.overflowButtonId="OverflowButtonId";n.carouselPreviousButtonId="CarouselPreviousButton";n.carouselNextButtonId="CarouselNextButton";n.howToVideosPreviousButtonId="HowToVideosPreviousButton";n.howToVideosNextButtonId="HowToVideosNextButton";n.followFacebookId="FollowUsOnFacebookButton";n.followTwitterId="FollowUsOnTwitterButton";n.followBlogkId="FollowUsOnBlogButton";n.disableInternalFeaturesId="DisableInternalFeaturesButton";n.mySwayOverflowId="MySwaysOverflowButton";n.chevronId="ChevronButton";n.platformiOSButtonId="PlatformiOS";n.platformiPadButtonId="PlatformiPad";n.platformiPhoneButtonId="PlatformiPhone";n.platformWebButtonId="PlatformWeb";n.platformWindowsButtonId="PlatformWindows";n.MiddlePartHorisontalIcon_Reports="Reports";n.MiddlePartHorisontalIcon_Presentations="Presentations";n.MiddlePartHorisontalIcon_Newsletters="Newsletters";n.MiddlePartHorisontalIcon_PersonalStories="PersonalStories"})(t=n.TelemetryConstants||(n.TelemetryConstants={}))})(t=n.Common||(n.Common={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function t(){}return t.createAndShow=function(i){var r=new t,u=n.View.Common.DialogManager.getCurrentDialog(),f=!1;u||(u=r.createDialog(),f=!0);r.dialogContent=new n.View.ViewElements.AuthoringDialogContentVE(u,i);u.updateContent(r.dialogContent);f?(u.setOnShowingCallback($.proxy(r.onShowing,r)),n.View.Common.DialogManager.showDialog(u)):r.onShowing()},t.prototype.onShowing=function(){var n=this;n.dialogContent.onShowing()},t.prototype.createDialog=function(){var i={caption:ResourceManager.ResolveString(Resources.AuthenticationDialogNextButtonCaption),id:"SingleSignIn",onAction:function(){var n=t.getContent(),i=n.getEmailAddressText();Identity.SingleSignIn(i)}},r={title:ResourceManager.ResolveString(Resources.AuthenticationDialogTitleEmail),messages:[ResourceManager.ResolveString(Resources.AuthenticationDialogMessage)],css:"AuthenticationDialogEmail",dialogType:1,lightDismiss:!0,buttonsArgs:[i]},t=n.View.Common.DialogManager.createDialog(r);return t},t}();t.AuthoringDialog=i})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(t){var i=function(i){function r(n,r){var u=this,f;i.call(this,n);f={description:"EmailAddressInput",placeholder:ResourceManager.ResolveString(Resources.AuthenticationDialogEmailPlaceholderText),cssClass:"EmailAddressInput",text:r.emailId,inputType:"email"};u.emailAddressTextBox=new t.TextBoxVE(u,f);u.authDialogArgs=r}return __extends(r,i),r.prototype.keyUp=function(t){var r=this,i;return t.keyCode===KeyCodeType.EnterKey?(r.emailAddressTextBox.setDomFocus(!1),i=r.emailAddressTextBox.getText(),i?n.Common.DialogManager.closeCurrentDialog(function(){Identity.SingleSignIn(i)}):Identity.SingleSignIn(i),6):t.keyCode===KeyCodeType.EscapeKey?(n.Common.DialogManager.closeCurrentDialog(),6):0},r.prototype.emailAddressTextBoxArgs=function(){var n=this;return n.emailAddressTextBox},r.prototype.errorMessageTextArgs=function(){var n=this;return n.authDialogArgs.showErrorMessage?(StoryLog.TraceTag(8258891,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User entered an invalid email message."),ResourceManager.ResolveString(Resources.AuthenticationDialogInvalidEmailIdMessage)):""},r.prototype.emailFormAttrArgs=function(){return{autocomplete:"off"}},r.prototype.onEmailSubmit=function(){return!1},r.prototype.emailFormEventsInitArgs=function(){var n=this;return{submit:n.onEmailSubmit}},r.prototype.getFocusChildren=function(){var n=this;return[n.emailAddressTextBox]},r.prototype.onShowing=function(){var n=this;n.emailAddressTextBox.setFocus()},r.prototype.getEmailAddressText=function(){var n=this;return n.emailAddressTextBox.getText()},r}(TDB.FocusableViewElement);t.AuthoringDialogContentVEBase=i})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t);var r=this;r.buttonId=i.buttonId;r._visible=TDB.watchableTag(5830559,r,i.visible!==undefined?i.visible:!0);r.visible=r._visible;r._isMouseDown=TDB.watchableTag(5830560,r,!1);r.isMouseDown=r._isMouseDown;r._isMouseOver=TDB.watchableTag(5830561,r,!1);r.isMouseOver=r._isMouseOver;r.context=i.context?i.context:r;r.click=i.click;r.down=i.down;r.up=i.up;r._cssClass=TDB.watchableTag(5830562,r,i.cssClass?i.cssClass:"");r.cssClass=r._cssClass;r._cssClassFocused=TDB.watchableTag(5830563,r,i.cssClassFocused?i.cssClassFocused:"");r.cssClassFocused=r._cssClassFocused;r._cssClassActive=TDB.watchableTag(5830592,r,i.cssClassActive?i.cssClassActive:"");r.cssClassActive=r._cssClassActive;r._cssClassHover=TDB.watchableTag(5830593,r,i.cssClassHover?i.cssClassHover:"");r.cssClassHover=r._cssClassHover;r._cssClassPressed=TDB.watchableTag(5830594,r,i.cssClassPressed?i.cssClassPressed:"");r.cssClassPressed=r._cssClassPressed;r._cssClassDisabled=TDB.watchableTag(8405845,r,i.cssClassDisabled?i.cssClassDisabled:"");r.cssClassDisabled=r._cssClassDisabled;r.cssClassSelected=i.cssClassSelected?i.cssClassSelected:"";r._style=TDB.watchableTag(5906573,r,i.style?i.style:null);r.style=r._style;r._isActive=TDB.watchableTag(5830595,r,!1);r.isActive=r._isActive;r.toggleActive=i.toggleActive?i.toggleActive:!1;r._scrollIntoView=TDB.notifierTag(5830596,r);r.ulsCategory=i.ulsCategory?i.ulsCategory:Diag.ULSCat.msoulscat_Story_InteractionModel;r._attr=TDB.watchableTag(7115999,r,i.attr?i.attr:null);r.attr=r._attr;r.onFocusUpdated=i.onFocusUpdated;r.onFocusContext=i.onFocusContext;r.onMouseOver=i.onMouseOver;r.role=i.role;r.tabIndex=i.tabIndex;r.hasPopup=i.hasPopup;r.nativeKeyboardHandling=i.nativeKeyboardHandling;i.telemetry_id!=null&&(r.telemetry_id=i.telemetry_id);i.shortcutIdentifiers&&(r.shortcutProcessor=i.shortcutProcessor,r.shortcutIdentifiers=i.shortcutIdentifiers.map(function(n){return TDB.ShortcutIdentifier.createShortcutIdentifier(n)}),r.registerShortcut(r.shortcutIdentifiers,r,r.shortcutProcessor))}return __extends(t,n),t.prototype.wrapperScrollIntoViewInitArgs=function(){return 0},t.prototype.ifButtonWrapperArgs=function(n){var t=this;return n.watchValue(t.visible)},t.prototype.isVisible=function(n){var t=this;return t.visible.getWatchedValue(n)},t.prototype.wrapperScrollIntoViewArgs=function(n){var t=this;return n.watch(t._scrollIntoView),!0},t.prototype.getWrapperClass=function(n){var t=this,h=n.watchValue(t.cssClass),c=n.watchValue(t.enabled),l=t.isFocused(n),a=n.watchValue(t.isActive),v=n.watchValue(t.isMouseOver),y=n.watchValue(t.isMouseDown),r=t.isButtonSelected&&n.watchValue(t.isButtonSelected),u=" "+n.watchValue(t.cssClassFocused),f=" "+n.watchValue(t.cssClassActive),e=" "+n.watchValue(t.cssClassHover),o=" "+n.watchValue(t.cssClassPressed),s=" "+n.watchValue(t.cssClassDisabled),i=h+" ButtonVE";if(c){if(y&&o!==" "&&(i=i+o),l&&u!==" ")return i+u+(r?" "+t.cssClassSelected:"");if(v&&e!==" ")return i+e;if(a&&f!==" ")return i+f;if(r&&t.cssClassSelected)return i+" "+t.cssClassSelected}else if(i+=" ButtonVEDisabled",s!==" ")return i+s;return i},t.prototype.setVisible=function(n){var t=this;if(t.visible!==t._visible)throw new Error("Cannot set visible if it has been overriden.");t._visible.setValue(n)},t.prototype.setCssClass=function(n){var t=this;if(t.cssClass!==t._cssClass)throw new Error("Cannot set the css class if it has been overriden.");t._cssClass.setValue(n)},t.prototype.setCssClassFocused=function(n){var t=this;if(t.cssClassFocused!==t._cssClassFocused)throw new Error("Cannot set the css class focused if it has been overriden.");t._cssClassFocused.setValue(n)},t.prototype.setCssClassActive=function(n){var t=this;if(t.cssClassActive!==t._cssClassActive)throw new Error("Cannot set the css class active if it has been overriden.");t._cssClassActive.setValue(n)},t.prototype.setCssClassHover=function(n){var t=this;if(t.cssClassHover!==t._cssClassHover)throw new Error("Cannot set the css class hover if it has been overriden.");t._cssClassHover.setValue(n)},t.prototype.setStyle=function(n){var t=this;if(t.style!==t._style)throw new Error("Cannot set the style if it has been overriden.");t._style.setValue(n)},t.prototype.setAttr=function(n){var t=this;if(t.attr!==t._attr)throw new Error("Cannot set the attr if it has been overriden.");t._attr.setValue(n)},t.prototype.getWrapperAttr=function(n){var t=this;return t.getButtonWrapperAttributes(n)},t.prototype.setActive=function(n){var t=this;if(t.isActive!==t._isActive)throw new Error("Cannot set active if it has been overriden.");t._isActive.setValue(n)},t.prototype.keyDown=function(n){var t=this,i=0;switch(n.keyCode){case KeyCodeType.EnterKey:i=t.nativeKeyboardHandling?1:t.enterKeyDown(n);break;case KeyCodeType.SpaceKey:i=t.nativeKeyboardHandling?1:t.spaceKeyDown(n)}return i},t.prototype.enterKeyDown=function(n){var t=this;return t.action(n)?0:6},t.prototype.spaceKeyDown=function(n){var t=this;return t.action(n)?0:6},t.prototype.onMouseOverWrapper=function(n){var t=this;t.context&&t.onMouseOver&&t.onMouseOver.call(t.context,n)},t.prototype.mouseOver=function(){var n=this;n.onMouseOverWrapper(!0);return TDB.applyUpdate(function(){return n._isMouseOver.setValue(!0)},3),!0},t.prototype.mouseOut=function(){var n=this;n.onMouseOverWrapper(!1);return TDB.applyUpdate(function(){n._isMouseDown.setValue(!1);n._isMouseOver.setValue(!1)},3),!0},t.prototype.mouseDown=function(n){var t=this;return(TDB.applyUpdate(function(){return t._isMouseDown.setValue(!0)}),t.enabled.getValue()&&t.context&&t.down)?t.down.call(t.context,n):!1},t.prototype.mouseUp=function(n){var t=this;return(TDB.applyUpdate(function(){return t._isMouseDown.setValue(!1)}),t.enabled.getValue()&&t.context&&t.up)?t.up.call(t.context,n):!1},t.prototype.getButtonId=function(){return this.buttonId},t.prototype.mouseClicked=function(n){var t=this;return(StoryLog.ReportAnalyticsTelemetry(t.telemetry_id),ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(t.buttonId,t.ulsCategory)),t.enabled.getValue())?t.action(n):!1},t.prototype.handleShortcutKey=function(n){var t=this;return t.visible.getValue()?t.action(n)?0:6:0},t.prototype.contextMenu=function(n){var t=this;return n.preventDefault&&(n.stopPropagation(),n.preventDefault()),ActionLogger.RecordClientAction(new ClientAction.ButtonRightClickAction(t.buttonId,t.ulsCategory)),!1},t.prototype.action=function(n){var t=this;t.toggleActive&&TDB.applyUpdate(function(){return t._isActive.setValue(!t._isActive.getValue())});return t.onAction(n)},t.prototype.onAction=function(n){var t=this;return t.click&&t.context?t.click.call(t.context,n):!0},t.prototype.getButtonWrapperAttributes=function(n,t,i){var u=this,r=n.watchValue(u.attr)||{};return r[Aria.Attributes.Role]=u.role?u.role:undefined,r[Aria.Attributes.Label]=t?t:undefined,r[Aria.Attributes.Haspopup]=u.hasPopup?Aria.BooleanState.True:undefined,r.title=t?t:undefined,i&&Obj.extend(r,i),r},t.prototype.toString=function(){var t=this,r=t.text,u=t._attr,i=u?u.getValue():null;return n.prototype.toString.call(this)+" Visible="+t.isVisible()+" Enabled="+t.isEnabled()+" Text='"+(r?r.toString():"<none>")+"' Title='"+(i&&i.title!==""?i.title:"<none>")+"'"},t.prototype.dispose=function(){n.prototype.dispose.call(this);var t=this;t.shortcutIdentifiers&&(t.unregisterShortcut(t.shortcutIdentifiers,t,t.shortcutProcessor),t.shortcutIdentifiers=null,t.shortcutProcessor=null)},t}(TDB.FocusableDomViewElement);n.ButtonVE=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t,i);var r=this;r._isChecked=TDB.watchableTag(6865804,r,i.checked?i.checked:!1);r.isChecked=r._isChecked;r.click=i.click;r.text=i.text}return __extends(t,n),t.prototype.setChecked=function(n){var t=this;if(t.isChecked!==t._isChecked)throw new Error("Cannot set checked if it has been overriden.");t._isChecked.setValue(n)},t.prototype.getChecked=function(n){var t=this;return t.isChecked.getWatchedValue(n)},t.prototype.getWrapperClass=function(n){var t=this,o=t.enabled.getWatchedValue(n),s=n?n.watchValue(t.cssClass):t.cssClass.getValue(),i=s;if(o){var h=t.isFocused(n),c=t.isChecked.getWatchedValue(n),l=t.isMouseOver.getWatchedValue(n),a=t.isMouseDown.getWatchedValue(n),r=" "+t.cssClassFocused.getWatchedValue(n),u=" "+t.cssClassActive.getWatchedValue(n),f=" "+t.cssClassHover.getWatchedValue(n),e=" "+t.cssClassPressed.getWatchedValue(n);if(a&&e!==" ")return i+e;if(h&&r!==" ")return i+r;if(l&&f!==" ")return i+f;if(c&&u!==" ")return i+u}return i},t.prototype.getLabel=function(){var n=this;return n.text},t.prototype.mouseClicked=function(t){var i=this;return t.which!==1?!0:n.prototype.mouseClicked.call(this,t)},t.prototype.onAction=function(n){var t=this;return(n.target instanceof HTMLInputElement&&n.target.type.toLowerCase()==="checkbox"||TDB.applyUpdate(function(){t._isChecked.setValue(!t.isChecked.getValue())}),t.enabled.getValue()&&t.context&&t.click)?t.click.call(t.context,n):!1},t.prototype.getCheckboxWrapperAttributes=function(t,i,r){var f=this,u=n.prototype.getButtonWrapperAttributes.call(this,t,r);return u[Aria.Attributes.Checked]=i?Aria.CheckboxState.True:Aria.CheckboxState.False,u},t}(n.ButtonVE);n.CheckboxVE=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t){n.call(this,t)}return __extends(t,n),t.prototype.getMenuControlsInfo=function(){throw new Error("Method not implemented by subclass.");},t}(TDB.FocusableViewElement);n.CompoundMenuElement=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){var r=this;n.call(this,t);r.visible=i.visible||TDB.watchableTag(8942668,r,!0)}return __extends(t,n),t.prototype.ifHeaderWrapperArgs=function(n){var t=this;return n.watchValue(t.visible)},t.prototype.getCreateMenuItemArgs=function(){throw new Error("Method not implemented by subclass.");},t.prototype.getOverflowArgs=function(){throw new Error("Method not implemented by subclass.");},t}(TDB.FocusableViewElement);n.CustomMenuControl=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t);var r=this;r._args=i;r._value=TDB.watchableTag(7874569,r,i.initialValue?i.initialValue:"");r.value=r._value}return __extends(t,n),t.prototype.wrapperClassNameArgs=function(){var n=this;return n._args.wrapperCss},t.prototype.descriptionTextArgs=function(){var n=this;return n._args.description},t.prototype.labelTextArgs=function(){var n=this;return n._args.label?n._args.label:""},t.prototype.textInputAttrArgs=function(){var n=this;return{placeholder:n._args.placeholder?n._args.placeholder:""}},t.prototype.textInputClassNameArgs=function(){var n=this;return n._args.textInputCss},t.prototype.textInputValueInitArgs=function(){var n=this;return{context:n._value,getValue:n._value.getWatchedValue,setValue:n._value.setValue}},t.prototype.keyPress=function(n){var t=this;return n.keyCode==KeyCodeType.EnterKey&&t._args.onEnter?(t._args.onEnter.call(t._args.context),6):0},t}(TDB.FocusableDomViewElement);n.DialogTextInputVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(){var n=this;n.currentCalloutID=TDB.watchableTag(9310465,n,0)}return n.prototype.getCurrentCalloutID=function(n){var t=this;return t.currentCalloutID.getWatchedValue(n)},n.prototype.getCurrentCalloutStartTime=function(){var n=this;return n.currentCalloutStartTime},n.prototype.updateCallout=function(n){var t=this;TDB.applyUpdate(function(){t.currentCalloutID.setValue(n)},8);t.currentCalloutStartTime=platform.now()},n.prototype.clearCallouts=function(){var n=this;TDB.applyUpdate(function(){n.currentCalloutID.setValue(0)},8)},n.prototype.setup=function(){},n}();n.CalloutManager=t})(t=n.FRE||(n.FRE={}))})(t=n.Common||(n.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=n.View.Common.FRE,u,r;(function(n){n[n.None=0]="None";n[n.TopLeft=1]="TopLeft";n[n.TopRight=2]="TopRight";n[n.Left=3]="Left";n[n.Right=4]="Right";n[n.BottomLeft=5]="BottomLeft";n[n.BottomRight=6]="BottomRight"})(t.BeakPosition||(t.BeakPosition={}));u=t.BeakPosition;r=function(n){function r(i,r){n.call(this,i);var u=this;u.calloutID=r.calloutID;u.isVisible=TDB.watcherTag(9310466,u,u,u.computeCalloutVisible);u.headerText=r.headerText;u.bodyText=r.bodyText?r.bodyText:"";u.beakPosition=TDB.watchableTag(9310467,u,r.beakPosition);u.delay=r.delay?r.delay:t.CalloutVE.DefaultDelay;u.cssClassName="segoeUI calloutView "+r.className}return __extends(r,n),r.prototype.computeCalloutVisible=function(n){var t=this;return i.getCalloutManager().getCurrentCalloutID(n)==t.calloutID},r.prototype.calloutBoxCalloutFadeInitArgs=function(){var t=this,i=t.beakPosition.getValue(),n;switch(i){case 3:n=1;break;case 4:n=2;break;case 5:case 6:n=3;break;default:n=0}return{delay:t.delay+"s",direction:n}},r.prototype.calloutBoxCalloutFadeArgs=function(n){var t=this;return{visible:n.watchValue(t.isVisible)}},r.prototype.calloutBeakClassNameArgs=function(n){var i=this,r=n.watchValue(i.beakPosition),t="calloutBeak calloutBeak-";switch(r){case 3:t+="left";break;case 1:t+="topLeft";break;case 2:t+="topRight";break;case 3:t+="left";break;case 4:t+="right";break;case 5:t+="bottomLeft";break;case 6:t+="bottomRight";break;default:return""}return t},r.prototype.calloutBoxClassNameArgs=function(){var n=this;return n.cssClassName},r.prototype.calloutHeaderTextArgs=function(){var n=this;return n.headerText},r.prototype.calloutHeaderStyleArgs=function(){var n=this;return n.bodyText.length===0?{fontSize:"15px"}:{fontSize:"18px",marginBottom:"8px"}},r.prototype.calloutBodyTextArgs=function(){var n=this;return n.bodyText},r.prototype.closeButtonArgs=function(){var n=this,i={buttonId:62,context:n,click:n.closeButtonClicked,clipClass:Glyphs.CalloutCloseButtonClip,glyphClass:Glyphs.CalloutCloseButtonGlyph,cssClass:"calloutCloseButton",cssClassFocused:"calloutCloseButtonFocused",cssClassHover:"calloutCloseButtonHover",cssClassPressed:"calloutCloseButtonPressed",description:Resources.CalloutCloseButton};return new t.GlyphButtonVE(n,i)},r.prototype.closeButtonClicked=function(){var n=this;return i.CommonFirstRunHelper.logFirstRunExperienceAction(9,17),i.getCalloutManager().clearCallouts(),!1},r.prototype.mouseClicked=function(){return!1},r.prototype.mouseOver=function(){return!1},r.prototype.mouseDown=function(){return!1},r.prototype.calloutBoxEventsInitArgs=function(){var n=this;return{mouseover:n.mouseOver}},r.prototype.calloutBoxAttrArgs=function(){return{title:""}},r.DefaultDelay=.8,r}(TDB.FocusableViewElement);t.CalloutVEBase=r})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){function r(){return t||(t=CommonSettings.ContextualFirstRunEnabled?new n.CalloutManager:new n.NullCalloutManager),t}var t,i;(function(n){n[n.None=0]="None";n[n.TitleJack=1]="TitleJack";n[n.PreviewHeader=2]="PreviewHeader";n[n.PlayButton=3]="PlayButton";n[n.ReturnToAuthoring=4]="ReturnToAuthoring";n[n.UndoButton=5]="UndoButton";n[n.VerticalNavigation=6]="VerticalNavigation";n[n.PanoramaNavigation=7]="PanoramaNavigation";n[n.ExpoNavigation=8]="ExpoNavigation";n[n.PhotoStack=9]="PhotoStack";n[n.DetailView=10]="DetailView"})(n.CalloutID||(n.CalloutID={}));i=n.CalloutID;n.getCalloutManager=r})(t=n.FRE||(n.FRE={}))})(t=n.Common||(n.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){(function(n){n[n.SwayLoaded=0]="SwayLoaded";n[n.JackClicked=1]="JackClicked";n[n.PreviewEntered=2]="PreviewEntered";n[n.PlayEntered=3]="PlayEntered";n[n.ReturnToAuthoringClicked=4]="ReturnToAuthoringClicked";n[n.RemixClicked=5]="RemixClicked";n[n.UndoClicked=6]="UndoClicked";n[n.Navigated=7]="Navigated";n[n.VerticalNavigated=8]="VerticalNavigated";n[n.PanoramaNavigated=9]="PanoramaNavigated";n[n.ExpoNavigated=10]="ExpoNavigated";n[n.WorldChanged=11]="WorldChanged";n[n.ThresholdContentAdded=12]="ThresholdContentAdded";n[n.DetailViewEnter=13]="DetailViewEnter";n[n.DetailViewExit=14]="DetailViewExit";n[n.StackSeen=15]="StackSeen";n[n.StackClicked=16]="StackClicked";n[n.CalloutCloseButtonClicked=17]="CalloutCloseButtonClicked";n[n.CalloutPhasedOut=18]="CalloutPhasedOut"})(n.FirstRunActionType||(n.FirstRunActionType={}));var i=n.FirstRunActionType,t=function(){function n(n){var t=this;t.args=n}return n.prototype.getFirstRunActionArgs=function(){var n=this;return n.args},n}();n.FirstRunAction=t})(t=n.FRE||(n.FRE={}))})(t=n.Common||(n.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){var i=function(){function i(){}return i.showFirstRunExperience=function(t){var r;return r=t===2&&n.Common.Environment.getInstance().shouldShowAuthoringEntrypoints?parseInt(Cookie.getCookie(i.AuthoringCountCookieName))||0:parseInt(Cookie.getCookie(i.ConsumptionCountCookieName))||0,r<=i.FirstRunExperienceCount&&CommonSettings.ContextualFirstRunEnabled},i.incrementCookieCount=function(n){var t=Cookie.getCookie(n),i=0;t&&(i=parseInt(t));Cookie.setCookie(n,(++i).toString(),{})},i.logFirstRunExperienceAction=function(n,i){var r=t.getCalloutManager(),u=r.getCurrentCalloutID(),f=r.getCurrentCalloutStartTime(),e=platform.now(),o=e-f,s=new ClientAction.FirstRunExperienceData(n,i,u,o);ActionLogger.RecordClientAction(s)},i.FirstRunExperienceCount=3,i.AuthoringCountCookieName="AuthoringExperienceCount",i.ConsumptionCountCookieName="ConsumptionExperienceCount",i}();t.CommonFirstRunHelper=i})(i=t.FRE||(t.FRE={}))})(i=t.Common||(t.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t={titleJack:{id:1,completionAction:1,showOnlyInAuthoringMode:!0},verticalNavigation:{id:6,completionAction:7,showOnlyInAuthoringMode:!1},panoramaNavigation:{id:7,completionAction:7,showOnlyInAuthoringMode:!1},expoNavigation:{id:8,completionAction:7,showOnlyInAuthoringMode:!1},playButton:{id:3,completionAction:3,showOnlyInAuthoringMode:!0},returnToAuthoring:{id:4,completionAction:4,showOnlyInAuthoringMode:!0},undoButton:{id:5,completionAction:6,showOnlyInAuthoringMode:!0},previewHeader:{id:2,completionAction:2,showOnlyInAuthoringMode:!1},detailView:{id:10,completionAction:14,showOnlyInAuthoringMode:!1},photoStack:{id:9,completionAction:16,showOnlyInAuthoringMode:!1}},i=function(){function i(){}return i.swayLoaded=function(){var i={type:0,triggeredCallouts:[t.titleJack]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.jackClicked=function(){n.getFirstRunManager().applyAction(new n.FirstRunAction({type:1,triggeredCallouts:[]}))},i.previewEnteredFromVertical=function(){var i={type:2,triggeredCallouts:[t.verticalNavigation,t.playButton]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.previewEnteredFromPanorama=function(){var i={type:2,triggeredCallouts:[t.panoramaNavigation,t.playButton]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.previewEnteredFromExpo=function(){var i={type:2,triggeredCallouts:[t.expoNavigation,t.playButton]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.playEnteredFromVertical=function(){var i={type:3,triggeredCallouts:[t.verticalNavigation,t.returnToAuthoring]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.playEnteredFromPanorama=function(){var i={type:3,triggeredCallouts:[t.panoramaNavigation,t.returnToAuthoring]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.playEnteredFromExpo=function(){var i={type:3,triggeredCallouts:[t.expoNavigation,t.returnToAuthoring]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.previewEnteredNoOverflow=function(){var i={type:2,triggeredCallouts:[t.playButton]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.playEnteredNoOverflow=function(){var i={type:3,triggeredCallouts:[t.returnToAuthoring]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.returnToAuthoringClicked=function(){n.getFirstRunManager().applyAction(new n.FirstRunAction({type:4,triggeredCallouts:[]}))},i.remixClicked=function(){var i={type:5,triggeredCallouts:[t.undoButton]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.undoClicked=function(){n.getFirstRunManager().applyAction(new n.FirstRunAction({type:6,triggeredCallouts:[]}))},i.navigatedFromPreview=function(){var i={type:7,triggeredCallouts:[t.playButton]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.navigatedFromPlay=function(){var i={type:7,triggeredCallouts:[t.returnToAuthoring]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.thresholdContentAdded=function(){var i={type:12,triggeredCallouts:[t.previewHeader]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.detailViewEntered=function(){var i={type:13,triggeredCallouts:[t.detailView]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.detailViewExited=function(){n.getFirstRunManager().applyAction(new n.FirstRunAction({type:14,triggeredCallouts:[]}))},i.stackSeen=function(){var i={type:15,triggeredCallouts:[t.photoStack]};n.getFirstRunManager().applyAction(new n.FirstRunAction(i))},i.stackClicked=function(){n.getFirstRunManager().applyAction(new n.FirstRunAction({type:16,triggeredCallouts:[]}))},i}();n.FirstRunTriggers=i})(t=n.FRE||(n.FRE={}))})(t=n.Common||(n.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){var i=function(){function i(){var n=this;n.currentCompletionAction=null;n.alreadySeenCallouts=[];n.calloutManager=t.getCalloutManager();n.extraClicks=0}return i.prototype.setup=function(){var n=this;n.currentCompletionAction=0;n.extraClicks=0;n.calloutManager&&n.calloutManager.updateCallout(0)},i.prototype.addFirstRunInterval=function(n,t,i){var r=this;if(r.timerMap[n])throw Error(n+" already exists in the FirstRunManager.timerMap");r.timerMap[n]=setInterval(t,i)},i.prototype.removeFirstRunInterval=function(n){var t=this;clearTimeout(t.timerMap[n]);delete t.timerMap[n]},i.prototype.handleClick=function(){var n=this;return n.extraClicks++,n.extraClicks>=3&&(t.CommonFirstRunHelper.logFirstRunExperienceAction(36,18),n.calloutManager.clearCallouts(),n.extraClicks=0),n.extraClicks},i.prototype.applyAction=function(i){var r=this,e,u,f;for(i.getFirstRunActionArgs().type===r.currentCompletionAction&&(t.CommonFirstRunHelper.logFirstRunExperienceAction(35,r.currentCompletionAction),r.calloutManager.clearCallouts(),r.extraClicks=-1),e=i.getFirstRunActionArgs().triggeredCallouts,u=0;u<e.length;u++)if(f=e[u],!r.alreadySeenCallouts[f.id]&&(!f.showOnlyInAuthoringMode||CommonSettings.IsAuthenticated&&CommonSettings.IsEnabled&&n.Common.Environment.getInstance().shouldShowAuthoringEntrypoints()))return r.triggerFirstRunCallout(f),!0;return!1},i.prototype.triggerFirstRunCallout=function(n){var t=this;t.calloutManager&&t.calloutManager.updateCallout(n.id);t.alreadySeenCallouts[n.id]=!0;t.extraClicks=-1;t.currentCompletionAction=n.completionAction},i.firstElementDelay=2,i}();t.FirstRunManager=i})(i=t.FRE||(t.FRE={}))})(i=t.Common||(t.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){function r(){return t||i(!1),t}function i(i){return t=i?new n.FirstRunManager:new n.NullFirstRunManager,t.setup(),t}var t;n.getFirstRunManager=r;n.initializeFirstRunManager=i})(t=n.FRE||(n.FRE={}))})(t=n.Common||(n.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(){}return n.prototype.getCurrentCalloutID=function(){return 0},n.prototype.getCurrentCalloutStartTime=function(){return null},n.prototype.updateCallout=function(){},n.prototype.clearCallouts=function(){},n.prototype.setup=function(){},n}();n.NullCalloutManager=t})(t=n.FRE||(n.FRE={}))})(t=n.Common||(n.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(){}return n.prototype.setup=function(){},n.prototype.handleClick=function(){return 0},n.prototype.applyAction=function(){return!1},n}();n.NullFirstRunManager=t})(t=n.FRE||(n.FRE={}))})(t=n.Common||(n.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t);var r=this;r._user=i.user;r._message=i.message}return __extends(t,n),t.prototype.messageTextArgs=function(){var n=this;return n._message},t.prototype.imageAttrArgs=function(){var n=this,t=Icons.Doughboy72Icon;return n._user.thumbnailUrl?t=n._user.thumbnailUrl:n._user.thumbnailUrlSmall&&(t=n._user.thumbnailUrlSmall),{src:t}},t.prototype.nameTextArgs=function(){var n=this;return n._user.displayName},t.prototype.domainTextArgs=function(){var n=this;return n._user.domain},t}(TDB.FocusableViewElement);n.EditStoryDialogVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t);var r=this;r.message=TDB.watchableTag(5858714,r,i.message);r.visible=i.visible}return __extends(t,n),t.prototype.ifLoadingMessageArgs=function(n){var t=this;return n.watchValue(t.visible)},t.prototype.textTextArgs=function(n){var t=this;return n.watchValue(t.message)},t.prototype.textClassNameArgs=function(){return"AddContentLoadingText"},t.prototype.getVisible=function(n){var t=this;return t.visible.getWatchedValue(n)},t.prototype.animationAttrArgs=function(){var n=this;return{src:CommonSettings.ContentBaseUrl+"Loading.2X2X8.gif"}},t}(TDB.ViewElement);n.LoadingMessageVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=CommonBindings.View.Bindings.DynamicMenu,i=function(){function i(t){var i=this,u,r,f,e;i.viewElement=t.viewElement;i.overflowViewElement=t.overflowViewElement;i.glyphOnlyViewElementClass=t.glyphOnlyViewElementClass;i.viewElementClass=TDB.watchableTag(8788034,i,t.viewElementClass?t.viewElementClass:"");i.noTextClass=t.noTextClass;i.textClass=TDB.watchableTag(8788035,i,t.textClass?t.textClass:"");i.widthBuffer=t.widthBuffer;i._stateWidths={};i._stateWidths[2]=0;i.state=TDB.watchableTag(8788036,i,0);i.viewElementVisible=TDB.watchableTag(8788037,i,!0);i.stateMap=t.stateMap;i.viewElement instanceof n.GlyphButtonVE&&(u=i.viewElement,t.glyphOnlyViewElementClass&&(u.cssClass=TDB.watcherTag(8788038,i,r,i.buttonCssClass)),t.noTextClass&&(u.textClass=TDB.watcherTag(8788039,i,r,i.buttonTextCssClass)));i.viewElement instanceof n.ButtonVE&&(r=i.viewElement,r.visible=TDB.watcherTag(8788040,i,r,i.menuItemVisible));i.viewElement instanceof n.CustomMenuControl&&(f=i.viewElement,f.visible=TDB.watcherTag(8942669,i,f,i.menuItemVisible));i.overflowViewElement instanceof n.ButtonVE&&(e=i.overflowViewElement,e.visible=TDB.watcherTag(8788041,i,e,i.overflowItemVisible))}return i.prototype.buttonTextCssClass=function(n){var t=this,r=t.state.getWatchedValue(n),i=t.textClass.getWatchedValue(n);return r==1&&(i+=" "+t.noTextClass),i},i.prototype.buttonCssClass=function(n){var t=this,r=t.state.getWatchedValue(n),i=t.viewElementClass.getWatchedValue(n);return r==1&&(i+=" "+t.glyphOnlyViewElementClass),i},i.prototype.hasText=function(){var t=this,i;return t.viewElement instanceof n.GlyphButtonVE?(i=t.viewElement,i.text.getValue()!=""):!0},i.prototype.hasGlyph=function(){var t=this;return t.viewElement instanceof n.GlyphButtonVE},i.prototype.needToRecalcWidth=function(n){var t=this;return t._stateWidths[n]==undefined},i.prototype.getItemWidth=function(){var n=this,t=n.state.getValue(),i;return n.needToRecalcWidth(t)&&(i=$(n.viewElement.findFirstNode()).outerWidth(!0),n.widthBuffer!==undefined&&(i+=n.widthBuffer),n._stateWidths[t]=i),n._stateWidths[t]},i.prototype.getWidthForState=function(n){var t=this;return t._stateWidths[n]},i.prototype.menuItemVisible=function(n){var t=this,i=t.state.getWatchedValue(n)==2,r=t.viewElementVisible.getWatchedValue(n);return!i&&r},i.prototype.overflowItemVisible=function(n){var t=this,i=t.state.getWatchedValue(n)==2,r=t.viewElementVisible.getWatchedValue(n);return i&&r},i.createGlyphButtonStateMap=function(){var n={};return n[t.MenuResizeStep.NextToLastStep-1]=0,n[t.MenuResizeStep.NextToLastStep]=1,n[4]=2,n},i.createStaticElementStateMap=function(){return{}},i.createGenericButtonStateMap=function(){var n={};return n[t.MenuResizeStep.NextToLastStep]=0,n[4]=2,n},i.createLowPriorityStateMap=function(){var n={};return n[0]=0,n[1]=2,n},i.createStaggeredGlyphButtonStateMap=function(){var n={};return n[1]=0,n[t.MenuResizeStep.NextToLastStep]=1,n[4]=2,n},i}();n.MenuItem=i})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(t){var i=function(i){function r(n,t){i.call(this,n);var r=this;r._args=t;r._isVisible=TDB.watchableTag(6062816,r,!1);r._args.isPinned||r.createDismissButton()}return __extends(r,i),r.prototype.createDismissButton=function(){var n=this,i={buttonId:185,clipClass:Glyphs.ClosePaneClip,glyphClass:Glyphs.ClosePaneGlyph,hoverGlyphClass:Glyphs.ClosePaneHoverFocus,focusedGlyphClass:Glyphs.ClosePaneHoverFocus,pressedGlyphClass:Glyphs.ClosePanePressed,context:n,cssClass:"NotificationDismissButton",click:n.dismissClick,description:Resources.DismissButtonDescription};n._dismissButton=new t.GlyphButtonVE(n,i)},r.prototype.show=function(){var n=this;TDB.applyUpdate(function(){n._isVisible.setValue(!0)})},r.prototype.hide=function(n){var t=this;t._onComplete=n;TDB.applyUpdate(function(){t._isVisible.setValue(!1)})},r.prototype.textTextArgs=function(){var n=this;return n.getText()},r.prototype.privacyLinkTextArgs=function(){var n=this;return n._args.addPrivacyLink?ResourceManager.ResolveString(Resources.CookieNotificationPrivacyLinkText):""},r.prototype.getText=function(){var n=this;return n._args.text},r.prototype.wrapperSlideVisibleInitArgs=function(){return!1},r.prototype.wrapperStyleArgs=function(){var n=this,t={};return n._args.backgroundColor&&(t.backgroundColor=n._args.backgroundColor),t},r.prototype.textStyleArgs=function(){var n=this,t={};return n._args.textColor&&(t.color=n._args.textColor),t},r.prototype.privacyLinkStyleArgs=function(){var n=this,t={};return n._args.textColor&&(t.color=n._args.textColor),t},r.prototype.onSlideComplete=function(){var n=this;n._onComplete&&setTimeout(function(){n._onComplete();n._onComplete=undefined},0)},r.prototype.wrapperSlideVisibleArgs=function(n){var t=this;return{visible:n.watchValue(t._isVisible),done:t.onSlideComplete}},r.prototype.dismissButtonArgs=function(){var n=this;return n._dismissButton},r.prototype.dismissClick=function(){var n=this;return n.dismiss(),!1},r.prototype.dismiss=function(){n.Common.NotificationBarManager.getInstance().clearNotification()},r.prototype.mouseClicked=function(n){var t=this;return t._args.onClick?t._args.onClick.call(t,n):!1},r}(TDB.FocusableViewElement);t.NotificationBarVEBase=i})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(t){var i=function(i){function r(n,r){i.call(this,n,48);var u=this;u._domEventRegister=t.DomEventRegister.setRoot(u);u.setupDialogManager();u._pageView=r.createView(u);this.removeResource(u._pageView);u.setupNotificationBarManager()}return __extends(r,i),r.prototype.clearFocus=function(n){var t=this;n&&(t.lastActivationChain=undefined);r.clearDomFocus()},r.clearDomFocus=function(){var n,t;try{n=document.body;n!=undefined&&n!==document.activeElement&&(typeof n.setActive=="function"?n.setActive():document.activeElement!=undefined&&typeof document.activeElement.blur=="function"&&document.activeElement.blur());t=window?window.getSelection():undefined;t!=undefined&&typeof t.removeAllRanges=="function"&&t.removeAllRanges()}catch(i){StoryLog.TraceTag(8722117,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Failed to clear DOM focus: "+i)}},r.prototype.notifySelectionStateChanged=function(){},r.prototype.getActiveListItem=function(){var n=this;return n.activeChild},r.prototype.setActiveListItem=function(n){var t=this,i=t.getActiveListItem();n&&n!==i&&(t.activeChild=n);t.activeChild=n},r.prototype.activateListItem=function(n){var i=this,t=i.getActiveListItem();n&&n!==t&&n.canActivate()&&!n.isActive()&&(i.setActiveListItem(n),n.enter(),n.setActive(!0),t&&(t.setActive(!1),t.exit()))},r.prototype.onChildActiveStateChanged=function(n,i){var u=this,r;i&&(u.lastActivationChain=n,n&&(r=n.firstOrDefault(function(n){return n instanceof t.RegionViewElement}),r&&u.activateListItem(r)))},r.prototype.setupNotificationBarManager=function(){var r=this,t,i;n.Common.NotificationBarManager.getInstance().setContext(r._pageView);!1&&CommonSettings.UnsupportedBrowser&&(t=n.Common.NotificationBarManager.getInstance(),i={text:Resources.UnsupportedBrowserMessage},t.createAndShowNotificationBar(i,!1))},r.prototype.setupDialogManager=function(){var t=this;n.Common.DialogManager.setContext(t)},r.prototype.pageViewArgs=function(){var n=this;return n._pageView},r.prototype.dialogArgs=function(n){var t=this;return t.getCurrentDialog(n)},r.prototype.registerEventHandler=function(n){var t=this;t._domEventRegister.registerEventHandler(n)},r.prototype.unregisterEventHandler=function(n){var t=this;t._domEventRegister.unregisterEventHandler(n)},r.prototype.dialogWrapperFadeVisibleInitArgs=function(){return{}},r.prototype.dialogWrapperFadeVisibleArgs=function(n){var t=this;return!!t.getCurrentDialog(n)},r.prototype.onActivateChild=function(n){var i=this,t=n;return t.enter(),i.activateListItem(t),!0},r.prototype.getActivatableChildren=function(){var t=this,n=function(n){return n instanceof TDB.FocusablePanelViewElement&&n.panelType&2?n:null};return t.traverseFocusable(function(t){var i=n(t);return i&&i.canActivate()?i:null},function(t){var i=n(t);return!i||(i.panelType&64)!=0})},r.prototype.getCurrentDialog=function(t){return n.Common.DialogManager.getCurrentDialog(t)},r.prototype.handleShortcutKey=function(n){var t=this,i=t.getShortcutElements(TDB.ShortcutIdentifier.createShortcutIdentifierFromEvent(n));return i.length>0?t.executeShortcutElements(i,n):0},r}(TDB.FocusablePanelViewElement);t.PageRootVEBase=i})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){var r=this;n.call(this,t);r.model=i}return __extends(t,n),t.prototype.spanMessageTextArgs=function(){var n=this;return n.model.message},t.prototype.spanMessageClassNameArgs=function(){var n=this;return n.model.messageCss?n.model.messageCss:""},t}(TDB.FocusableViewElement);n.SpanMessageVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r){r===void 0&&(r=0);n.call(this,t,1|r);var u=this;u.visible=i?i:TDB.watchableTag(8713932,u,!1);u.shouldExternalEventBeHandled=!0}return __extends(t,n),t.prototype.setControllingElement=function(n){var t=this;t.controllingElement=n},t.prototype.isVisible=function(n){var t=this;return t.visible.getWatchedValue(n)},t.prototype.setVisible=function(n){var t=this;TDB.applyUpdate(function(){return t.visible.setValue(n)},4)},t.prototype.suspend=function(){var n=this;n.setVisible(!1)},t.prototype.resume=function(){var n=this;if(n.setVisible(!0),n.activeChild)n.onActivateChild(n.activeChild)},t.prototype.toggle=function(){var n=this,t=n.isVisible(),i=n.isEntered();t&&i?n.hide():n.show()},t.prototype.show=function(){var n=this;n.enter()},t.prototype.hide=function(){var n=this;n.exit()},t.prototype.onEntering=function(){var n=this;n.saveFocus();n.setVisible(!0)},t.prototype.onExiting=function(){var n=this;n.setVisible(!1);n.restoreFocus()},t.prototype.firstChanceMouseEvent=function(n,t,i){for(var r=this;i&&i!==r&&i!==r.controllingElement;)i=i.parent;return i?!0:r.onExternalMouseEvent(n,t,i)},t.prototype.onExternalMouseEvent=function(n,t){var i=this;return i.isEntered()?(t===(i.shouldExternalEventBeHandled?1:3)&&i.shouldExit(!0)&&i.escape(),i.shouldExternalEventBeHandled):!0},t.prototype.onRestoreFocus=function(){return!0},t.prototype.saveFocus=function(){var n=this;n.originallyFocused=document.activeElement instanceof HTMLElement?document.activeElement:null},t.prototype.restoreFocus=function(){var n=this;n.onRestoreFocus(n.originallyFocused)&&n.originallyFocused&&n.originallyFocused.focus()},t.prototype.getAriaAttributes=function(n){var i=this,t={},r=i.isEntered(n);return t[Aria.Attributes.Role]=Aria.Roles.Group,t[Aria.Attributes.Expanded]=r?Aria.BooleanState.True:Aria.BooleanState.False,t},t.prototype.clearFocus=function(){var t=this;t.exit();n.prototype.clearFocus.call(this)},t}(TDB.FocusablePanelViewElement);n.PopupBaseVE=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n,i,r){t.call(this,n,i|2);var u=this;u.activatable=r;u.isCurrentListViewItem=TDB.watchableTag(8713933,u,!1)}return __extends(i,t),i.prototype.setFocus=function(){var n=this;n.enter()},i.prototype.onEntering=function(){var n=this,t=n.getListView();t.activateListItem(n)},i.prototype.activateItem=function(){var n=this,t=n.getListView();return t.activateListItem(n),n.isActive()},i.prototype.canActivate=function(n){var t=this;return t.activatable?t.activatable.getWatchedValue(n):!0},i.prototype.setActive=function(n){var t=this;TDB.applyUpdate(function(){return t.isCurrentListViewItem.setValue(n)});t.activationHandler&&t.activationHandler(n)},i.prototype.isActive=function(n){var t=this;return t.isCurrentListViewItem.getWatchedValue(n)},i.prototype.setSelected=function(n){var t=this,i;t.isSelectable()&&(i=t.getListView(),i.notifySelectionStateChanged(this,n))},i.prototype.isSelectable=function(){return!1},i.prototype.isSelected=function(){return!1},i.prototype.getListView=function(){for(var i=this,t=i.parent;t;){if(t instanceof n.PageRootVEBase)return t;t=t.parent}return null},i.prototype.activationChanged=function(n){var t=this;t.activationHandler=n},i.prototype.dispose=function(){t.prototype.dispose.call(this);var n=this;n.activationHandler=undefined},i.prototype.firstChanceMouseEvent=function(n,t,i){var r=this;return r.parent?r.parent.firstChanceMouseEvent(n,t,i):!0},i}(TDB.FocusablePanelViewElement);n.RegionViewElement=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t);var r=this;r._args=i;r.telemetryId=i.telemetryId;r._style=TDB.watchableTag(7910620,r,i.style?i.style:null);r.style=r._style;r.tabIndex=i.tabIndex}return __extends(t,n),t.prototype.textAreaAttrArgs=function(){var n=this,i=n._args.cssClass||"",t={"class":i};return n._args.placeholder&&(t.placeholder=n._args.placeholder),n._args.rows&&(t.rows=n._args.rows),t},t.prototype.onFocus=function(){return this.setFocus(),!1},t.prototype.mouseClicked=function(){var n=this;return ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(n.telemetryId,Diag.ULSCat.msoulscat_Story_Storyline)),!1},t.prototype.contextMenu=function(){var n=this;return ActionLogger.RecordClientAction(new ClientAction.ButtonRightClickAction(n.telemetryId,Diag.ULSCat.msoulscat_Story_Storyline)),!1},t.prototype.textAreaStyleArgs=function(n){var t=this;return t.style.getWatchedValue(n)},t.prototype.setStyle=function(n){var t=this;if(t.style!=t._style)throw new Error("Cannot set the style if it has been overriden.");t._style.setValue(n)},t.prototype.textAreaValueInitArgs=function(){var n=this;return{context:n._args.context,setValue:n._args.setValue,getValue:n._args.getValue}},t.prototype.keyDown=function(n){var i=this,t=0;switch(n.keyCode){case KeyCodeType.UpArrowKey:case KeyCodeType.DownArrowKey:case KeyCodeType.SpaceKey:case KeyCodeType.EnterKey:case KeyCodeType.DeleteKey:case KeyCodeType.BackspaceKey:case KeyCodeType.HomeKey:case KeyCodeType.EndKey:t=1}return t},t.prototype.firstChanceMouseEvent=function(t,i,r){var u=this;return u.setDomFocus(!1),u.setDomFocus(!0),n.prototype.firstChanceMouseEvent.call(this,t,i,r)},t}(TDB.FocusableDomViewElement);n.TextAreaVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t);var r=this;r._args=i;r._selectText=TDB.watcherTag(6063818,r,r,r.calculateSelectText);r._text=i.textWatchable||TDB.watchableTag(6423107,r,i.text||"")}return __extends(t,n),t.prototype.getText=function(n){var t=this;return t._text.getWatchedValue(n)},t.prototype.getDescription=function(){var n=this;return n._args.description},t.prototype.setText=function(n){var t=this;TDB.applyUpdate(function(){t._text.setValue(n)})},t.prototype.calculateSelectText=function(n){var t=this;return t._args.selectTextOnFocus&&t.isFocused(n)},t.prototype.textAttrArgs=function(){var n=this,i=n._args.cssClass||"",r=n._args.inputType||"",u=n._args.autocomplete?"on":"off",t={"class":i,type:r,autocomplete:u};return n._args.readOnly&&(t.readonly="readonly"),n._args.placeholder&&(t.placeholder=n._args.placeholder),n._args.maxLength&&(t.maxlength=""+n._args.maxLength),n._args.description&&(t["aria-label"]=n._args.description),n._args.name&&(t.name=n._args.name),t},t.prototype.textSelectTextArgs=function(){var n=this;return n._selectText},t.prototype.mouseClicked=function(){var n=this;return n.setFocus(),!1},t.prototype.textValueInitArgs=function(){var n=this;return{context:n._text,setValue:n._text.setValue,getValue:n._text.getWatchedValue}},t}(TDB.FocusableDomViewElement);n.TextBoxVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n,i){var r=this;t.call(this,n);r._args=i}return __extends(i,t),i.prototype.ifThumbnailBorderArgs=function(n){var t=this;return t._args.isVisible?t._args.isVisible.getWatchedValue(n):!0},i.prototype.innerBorderClassNameArgs=function(n){var t=this;return t._args.isPressed&&t._args.isPressed.getWatchedValue(n)?"ThumbnailInnerBorderPressed":t._args.isHovered&&t._args.isHovered.getWatchedValue(n)?"ThumbnailInnerBorderHovered":t._args.isFocused&&t._args.isFocused.getWatchedValue(n)?"ThumbnailInnerBorderFocused":t._args.isSelected&&t._args.isSelected.getWatchedValue(n)?"ThumbnailInnerBorderSelected":t._args.useDarkerStyle?"ThumbnailInnerBorderRestDark":"ThumbnailInnerBorderRest"},i.prototype.outerBorderClassNameArgs=function(n){var t=this;return t._args.isFocused&&t._args.isFocused.getWatchedValue(n)?"ThumbnailOuterBorderFocused":t._args.isSelected&&t._args.isSelected.getWatchedValue(n)?"ThumbnailOuterBorderSelected":"ThumbnailOuterBorderRest"},i.prototype.selectedIconWrapperStyleArgs=function(n){var t=this,i=t._args.isSelected&&t._args.isSelected.getWatchedValue(n)?"":"none";return{display:i,position:"absolute",right:"0px",top:"0px"}},i.prototype.selectedIconArgs=function(){var t={clipClass:Glyphs.SelectedIconGrayClip,glyphClass:Glyphs.SelectedIconGrayGlyph};return new n.GlyphVE(this,t)},i}(TDB.ViewElement);n.ThumbnailBorderVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t);var r=this;r.hasFocus=TDB.watchableTag(8987294,r,!1);r.context=i.context;r.click=i.click;r._isChecked=TDB.watchableTag(8987295,r,i.checked);r.isChecked=r._isChecked;r.descriptionChecked=i.descriptionChecked;r.descriptionUnchecked=i.descriptionUnchecked;r.buttonId=i.buttonId}return __extends(t,n),t.prototype.setChecked=function(n){var t=this;if(t.isChecked!==t._isChecked)throw new Error("Cannot set checked if it has been overridden.");t._isChecked.setValue(n)},t.prototype.keyDown=function(n){var i=this,t=0;switch(n.keyCode){case KeyCodeType.EnterKey:t=i.enterKeyDown(n);break;case KeyCodeType.SpaceKey:t=i.spaceKeyDown(n)}return t},t.prototype.handleToggleEvent=function(n){var t=this;return t.clickWrapper(n)?0:6},t.prototype.enterKeyDown=function(n){var t=this;return t.handleToggleEvent(n)},t.prototype.spaceKeyDown=function(n){var t=this;return t.handleToggleEvent(n)},t.prototype.onGainingFocus=function(){var n=this;TDB.applyUpdate(function(){n.hasFocus.setValue(!0)})},t.prototype.onLosingFocus=function(){var n=this;TDB.applyUpdate(function(){n.hasFocus.setValue(!1)})},t.prototype.mouseClicked=function(n){var t=this;return n.which!=1?!0:t.clickWrapper(n)},t.prototype.contextMenu=function(n){return n.preventDefault&&(n.stopPropagation(),n.preventDefault()),!1},t.prototype.clickWrapper=function(n){var t=this;return(t.buttonId&&ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(t.buttonId,Diag.ULSCat.msoulscat_Story_Site)),n.target instanceof HTMLInputElement&&n.target.type.toLowerCase()==="checkbox"||TDB.applyUpdate(function(){t._isChecked.setValue(!t._isChecked.getValue())}),t.enabled.getValue()&&t.context&&t.click)?t.click.call(t.context,n):!1},t.prototype.wrapperEventsInitArgs=function(){var n=this;return{click:n.clickWrapper}},t.prototype.checkboxCheckedInitArgs=function(){var n=this;return n._isChecked},t.prototype.wrapperAttrArgs=function(n){var t=this,i=n.watchValue(t._isChecked);return t.getToggleSwitchWrapperAttributes(n,i?t.descriptionChecked:t.descriptionUnchecked)},t.prototype.getToggleSwitchWrapperAttributes=function(n,t){var r=this,i={};return i[Aria.Attributes.Role]="checkbox",i[Aria.Attributes.Label]=t?t:undefined,i.title=t?t:undefined,i},t}(TDB.FocusableDomViewElement);n.ToggleSwitchVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t="http://go.microsoft.com/fwlink/?LinkID=524989",i="http://go.microsoft.com/fwlink/?LinkID=521839",r="http://go.microsoft.com/fwlink/?LinkId=618893",u=function(u){function f(n){u.call(this,n,undefined,4);var t=this;t._clientVersion=TDB.watchableTag(9302562,t,"");t.createAboutLinkButtons()}return __extends(f,u),f.prototype.wrapperAttrArgs=function(){var n=this;return{role:Aria.Roles.Region}},f.prototype.wrapperSlideVisibleInitArgs=function(){return!1},f.prototype.wrapperSlideVisibleArgs=function(n){var t=this;return{visible:n.watchValue(t.visible)}},f.prototype.paneTitleTextArgs=function(){return Resources.AboutPaneTitle},f.prototype.productNameTextArgs=function(){return Resources.ProductNameShort},f.prototype.productNameAttrArgs=function(n){var t=this;return{"aria-label":t.productNameTextArgs(n),role:Aria.Roles.Textbox}},f.prototype.productVersionTextArgs=function(n){var t=this;return n.watchValue(t._clientVersion)},f.prototype.productVersionAttrArgs=function(n){var t=this;return{"aria-label":t.productVersionTextArgs(n),role:Aria.Roles.Textbox}},f.prototype.updateProductVersion=function(n){var t=this;TDB.applyUpdate(function(){var i=Resources.VersionLabel;t._clientVersion.setValue(ResourceManager.ResolveString(i,[n]))})},f.prototype.pictureAttrArgs=function(n){var t=this;return{src:Icons.Sway42Icon,"aria-label":t.productNameTextArgs(n),role:Aria.Roles.Img}},f.prototype.licenseTermsLinkArgs=function(){var n=this;return n._licenseTermsLink},f.prototype.privacyLinkArgs=function(){var n=this;return n._privacyLink},f.prototype.thirdPartyLinkArgs=function(){var n=this;return n._thirdPartyLink},f.prototype.createAboutLinkButtons=function(){var u=this,o={buttonId:0,context:u,cssClass:"aboutSwayLinks",text:TDB.watchableTag(9302563,u,Resources.LicenseTermsLink),description:Resources.LicenseTermsLink,url:t},f,e;u._licenseTermsLink=new n.LinkButtonVE(u,o);f={buttonId:1,context:u,cssClass:"aboutSwayLinks",text:TDB.watchableTag(9302592,u,Resources.PrivacyLink),description:Resources.PrivacyLink,url:i};u._privacyLink=new n.LinkButtonVE(u,f);e={buttonId:2,context:u,cssClass:"aboutSwayLinks",text:TDB.watchableTag(9302593,u,Resources.ThirdPartyLink),description:Resources.ThirdPartyLink,url:r};u._thirdPartyLink=new n.LinkButtonVE(u,e)},f}(n.PopupBaseVE);n.AboutPaneVEBase=u})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n,i){t.call(this,n,undefined,4);var r=this;r._args=i;r._currentAccount=TDB.watcherTag(9049751,r,r,r.createCurrentAccountTile);r._otherAccounts=TDB.mappedWatcherTag(9049752,r,r,r.getOtherAccounts,r.createAccountTile);r.createNewAccountButtons()}return __extends(i,t),i.prototype.wrapperSlideVisibleInitArgs=function(){return!1},i.prototype.wrapperSlideVisibleArgs=function(n){var t=this;return{visible:n.watchValue(t.visible)}},i.prototype.paneTitleTextArgs=function(){return Resources.ManageAccounts},i.prototype.currentAccountHeadingTextArgs=function(){return Resources.CurrentAccount},i.prototype.currentAccountArgs=function(){var n=this;return n._currentAccount},i.prototype.switchAccountHeadingTextArgs=function(){return Resources.SwitchAccount},i.prototype.ifSwitchAccountsHeadingArgs=function(n){var t=this,i=t._args.accountManager.getOtherAccounts(n);return i.length>0},i.prototype.otherAccountsArgs=function(n){var t=this;return t._otherAccounts.getWatchedValue(n)},i.prototype.newMsaButtonArgs=function(){var n=this;return n._newMsaButton},i.prototype.newOrgIdButtonArgs=function(){var n=this;return n._newOrgIdButton},i.prototype.createNewAccountButtons=function(){var t=this,r={buttonId:3,clipClass:Glyphs.AccountMsaIconClip,glyphClass:Glyphs.AccountMsaIconGlyph,glyphWrapperClass:"newAccountPicture",click:t.addNewMsaAccount,context:t,cssClass:"newAccountButton accountFocusableButton",text:Resources.AddMsaAccount,textClass:"newAccountText",description:Resources.AddMsaAccount},i;t._newMsaButton=new n.GlyphButtonVE(t,r);i={buttonId:4,clipClass:Glyphs.AccountOrgIdIconClip,glyphClass:Glyphs.AccountOrgIdIconGlyph,glyphWrapperClass:"newAccountPicture",click:t.addNewOrgIdAccount,context:t,cssClass:"newAccountButton accountFocusableButton",text:Resources.AddOrgIdAccount,textClass:"newAccountText",description:Resources.AddOrgIdAccount};t._newOrgIdButton=new n.GlyphButtonVE(t,i)},i.prototype.createCurrentAccountTile=function(n){var t=this,i=t._args.accountManager.getCurrentAccount().getWatchedValue(n);return t.createAccountTile(i)},i.prototype.getOtherAccounts=function(n){var t=this;return t._args.accountManager.getOtherAccounts(n)},i.prototype.createAccountTile=function(t){var i=this,r=i._args.accountManager.getCurrentAccount().getValue()!=t,u={accountInfo:t,isEnabled:r};return new n.AccountTileVE(i,u)},i.prototype.addNewMsaAccount=function(){return $.ajax({type:"GET",url:"addaccount?type=MSA",timeout:0}),!1},i.prototype.addNewOrgIdAccount=function(){return $.ajax({type:"GET",url:"addaccount?type=AAD",timeout:0}),!1},i}(n.PopupBaseVE);n.AccountsPaneVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t,i);var r=this;r._args=i}return __extends(t,n),t.prototype.wrapperStyleArgs=function(){var t=this,n={};return n.cursor=t._args.isEnabled?"pointer":"default",n},t.prototype.wrapperClassNameArgs=function(n){var t=this;return t.getWrapperClass(n)},t.prototype.getProfilePic=function(){var n=this,t=Icons.Doughboy48Icon;return n._args.accountInfo&&n._args.accountInfo.pictureUrl&&(t=n._args.accountInfo.pictureUrl),t},t.prototype.pictureAttrArgs=function(){var n=this;return{src:n.getProfilePic()}},t.prototype.getUserName=function(){var n=this,t="";return n._args.accountInfo&&n._args.accountInfo.friendlyName&&(t=n._args.accountInfo.friendlyName),t},t.prototype.userNameTextArgs=function(){var n=this;return n.getUserName()},t.prototype.getUserEmail=function(){var n=this,t="";return n._args.accountInfo&&n._args.accountInfo.signInName&&(t=n._args.accountInfo.signInName),t},t.prototype.userEmailTextArgs=function(){var n=this;return n.getUserEmail()},t}(n.ButtonVE);n.AccountSwitchVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n,i){t.call(this,n);var r=this;r._args=i;r.createSwitchButton();r.createDeleteButton()}return __extends(i,t),i.prototype.createSwitchButton=function(){var t=this,i={accountInfo:t._args.accountInfo,isEnabled:t._args.isEnabled,buttonId:7,cssClass:"accountSwitchButton accountFocusableButton",description:"",context:t,click:t.switchAccountClicked};t._accountSwitch=new n.AccountSwitchVE(t,i)},i.prototype.switchAccountClicked=function(){var t=this;return t._args.isEnabled&&($.ajax({type:"GET",url:"switchaccount?id="+t._args.accountInfo.id,timeout:0}),n.SwitchingAccountsDialog.createAndShow(),t.clearFocus()),!1},i.prototype.createDeleteButton=function(){var t=this,i={buttonId:5,glyphClass:Glyphs.SignOutButtonGlyph,clipClass:Glyphs.SignOutButtonClip,cssClass:"accountDeleteButton accountFocusableButton",description:Resources.SignOut,context:t,click:t.removeAccountClicked};t._deleteButton=new n.GlyphButtonVE(t,i)},i.prototype.removeAccountClicked=function(){var n=this;return $.ajax({type:"GET",url:"removeaccount?id="+n._args.accountInfo.id,timeout:0}),n.parent.updateActiveChild(4,1),!1},i.prototype.accountSwitchArgs=function(){var n=this;return n._accountSwitch},i.prototype.deleteButtonArgs=function(){var n=this;return n._deleteButton},i}(TDB.FocusableViewElement);n.AccountTileVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n){t.call(this,n);var i=this;i.createProfileSettingsButton();i.createSignOutButton()}return __extends(i,t),i.prototype.createSignOutButton=function(){var t=this,i={buttonId:52,context:t,click:t.signOutButtonClicked,cssClass:"headerUserMenuButton",cssClassHover:"headerUserMenuButtonHover",text:Resources.SignOut};t._signOutButton=new n.TextButtonVE(t,i)},i.prototype.signOutButtonClicked=function(){return Identity.SignOutHelper(),!1},i.prototype.signOutArgs=function(){var n=this;return n._signOutButton},i.prototype.createProfileSettingsButton=function(){var t=this,i={buttonId:48,context:t,click:t.profileSettingsButtonClicked,cssClass:"headerUserMenuButton",cssClassHover:"headerUserMenuButtonHover",text:Resources.AccountSettings};t._profileSettingsButton=new n.TextButtonVE(t,i)},i.prototype.profileSettingsButtonClicked=function(){return window.location.href=CommonSettings.AccountSettingsUrl,!1},i.prototype.profileSettingsArgs=function(){var n=this;return n._profileSettingsButton},i}(TDB.FocusableViewElement);n.UserMenuVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t,i);var r=this;r._userState=i.userState}return __extends(t,n),t.prototype.wrapperClassNameArgs=function(n){var r=this,t="userInfoWrapper",i=r.getWrapperClass(n);return i&&(t+=" "+i),t},t.prototype.wrapperEventsInitArgs=function(){var n=this;return{mouseover:n.mouseOver,mouseout:n.mouseOut}},t.prototype.wrapperStyleArgs=function(n){var t=this;return n.watchValue(t.style)},t.prototype.wrapperAttrArgs=function(n){var i=this,t=n.watchValue(i.attr);return t=t?t:{},t.disabled=n.watchValue(i.enabled)?undefined:"true",t[Aria.Attributes.Label]=i._userState.getDisplayName(n),t[Aria.Attributes.Role]=Aria.Roles.Button,t},t.prototype.userPictureAttrArgs=function(n){var t=this;return{src:t._userState.getUserPicture(n)}},t.prototype.userNameTextArgs=function(n){var t=this;return t._userState.getUserName(n)},t.prototype.userEmailTextArgs=function(n){var t=this;return t._userState.getUserEmail(n)},t}(n.ButtonVE);n.UserInfoVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i=function(){function i(){}return i.getInstance=function(){return i.instance||(i.instance=new i),i.instance},i.setInstance=function(n){i.instance=n},i.clearInstance=function(){i.instance=undefined},i.prototype.GoToMyStories=function(){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(44,Diag.ULSCat.msoulscat_Story_Site));CommonMain.goToMyStoriesOrSignIn("AppBarAction : GoToMyStories")},i.prototype.CreateNewStory=function(){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(32,Diag.ULSCat.msoulscat_Story_Site));t.UserStories.getInstance().createStoryOrSignIn("AppBarAction : CreateNewStory")},i.prototype.ShowFeedback=function(n){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(39,Diag.ULSCat.msoulscat_Story_Site));Feedback.OnFeedbackClick(n)},i.prototype.OpenAboutPane=function(){},i.prototype.OpenUserProfile=function(){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(48,Diag.ULSCat.msoulscat_Story_Site));window.location.assign(CommonSettings.AccountSettingsUrl)},i.prototype.SignIn=function(){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(51,Diag.ULSCat.msoulscat_Story_Site));Identity.SignInHelper(!1,null)},i.prototype.SignOut=function(){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(52,Diag.ULSCat.msoulscat_Story_Site));window.location.assign(CommonSettings.SignOutUrl)},i.prototype.OpenTutorialVideos=function(){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(54,Diag.ULSCat.msoulscat_Story_Site));window.open(n.Common.UrlHelper.getInstance().tutorialVideosUrl())},i.prototype.ToggleInternalFlight=function(){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(43,Diag.ULSCat.msoulscat_Story_Site));window.location.assign(n.Common.UrlHelper.getInstance().internalFlightUrl())},i}();t.AppBarAction=i})(t=n.Common||(n.Common={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var e=CommonBindings.View.Bindings.DynamicMenu,i=n.Common,r=n.Common.TelemetryConstants,f,u;(function(n){n[n.MyStories=0]="MyStories";n[n.CreateNew=1]="CreateNew";n[n.Edit=2]="Edit";n[n.Style=3]="Style";n[n.Feedback=4]="Feedback";n[n.User=5]="User";n[n.SignIn=6]="SignIn";n[n.Preview=7]="Preview";n[n.Share=8]="Share";n[n.Overflow=9]="Overflow";n[n.Remix=10]="Remix";n[n.Redo=11]="Redo";n[n.Undo=12]="Undo";n[n.Panels=13]="Panels";n[n.ShareToFacebook=14]="ShareToFacebook";n[n.ShareToTwitter=15]="ShareToTwitter";n[n.ShareToLink=16]="ShareToLink";n[n.Fullscreen=17]="Fullscreen";n[n.Authors=18]="Authors";n[n.ShareThis=19]="ShareThis";n[n.InternalFeatures=20]="InternalFeatures";n[n.RefreshStories=21]="RefreshStories";n[n.TutorialVideos=22]="TutorialVideos";n[n.Cast=23]="Cast";n[n.Hamburger=24]="Hamburger";n[n.Home=25]="Home";n[n.Content=26]="Content";n[n.Cards=27]="Cards";n[n.Design=28]="Design";n[n.Navigation=29]="Navigation"})(t.AppBarButtonLabel||(t.AppBarButtonLabel={}));f=t.AppBarButtonLabel;u=function(n){function u(t,i){n.call(this,t,2);var r=this;r._model=i;r._buttonLabels={};r._farButtons=[];r._nearButtons=[];r._menuItems={};r.createOverflowMenu(i);r.createHomeButton(i);r.notifyMenuRefresh=TDB.notifierTag(8971672,r)}return __extends(u,n),u.prototype.addFarButton=function(n,t,i,r){var u=this;if(u._buttonLabels[t])throw new Error("Adding multiple buttons under same label: "+t);u._buttonLabels[t]=n;u._farButtons.push(n);t!=9&&u.createMenuItems(n,t,i,r)},u.prototype.addNearButton=function(n,t,i,r){var u=this;if(u._buttonLabels[t])throw new Error("Adding multiple buttons under same label: "+t);u._buttonLabels[t]=n;u._nearButtons.push(n);u.createMenuItems(n,t,i,r)},u.prototype.createMenuItems=function(n,i,r,u){var o=this,e,s,f;if(n instanceof t.CompoundMenuElement)for(e=n.getMenuControlsInfo(),s=e.length,f=0;f<s;f++)o.createMenuItem(e[f].viewElement,e[f].label,e[f].createMenuItemArgs,e[f].overflowArgs);else o.createMenuItem(n,i,r,u)},u.prototype.createMenuItem=function(n,i,r,u){var f=this,e;if(!r)throw new Error("We need menu item args to do any usefule work here.");u&&(r.overflowViewElement=n instanceof t.LinkButtonVE?f.getOverflowMenu().addOverflowLinkButton(u):f.getOverflowMenu().addOverflowGlyphButton(u));e=new t.MenuItem(r);r.viewElementVisible!==undefined&&(e.viewElementVisible=r.viewElementVisible);f._menuItems[i]=e},u.prototype.removeButton=function(n){var t=this,i,r;t._buttonLabels[n]&&(i=t._farButtons.indexOf(t._buttonLabels[n]),i>-1&&t._farButtons.splice(i,1),r=t._nearButtons.indexOf(t._buttonLabels[n]),r>-1&&t._nearButtons.splice(r,1),t._buttonLabels[n].dispose(),delete t._buttonLabels[n]);t._menuItems[n]&&delete t._menuItems[n]},u.prototype.createButtonArgs=function(n,t,i,r,u,f,e){return{buttonId:i,context:n,cssClass:u?u:"headerFarButton",cssClassActive:"headerFarButtonActive",cssClassHover:"headerFarButtonHover",cssClassFocused:"headerFarButtonFocused",cssClassPressed:"headerFarButtonPressed",shortcutIdentifiers:f,shortcutProcessor:e,click:t,telemetry_id:r}},u.prototype.addFarTextButton=function(n,i,r,u,f,e,o,s,h,c,l){var v=this,y=v.createButtonArgs(n,i,f,e,o,s,h),a,p,w;return y.text=r,a=new t.TextButtonVE(v,y),p={viewElement:a,stateMap:l?l:t.MenuItem.createGenericButtonStateMap()},c!=null&&(w={context:n,click:i,text:r,label:c,buttonId:f}),v.addFarButton(a,u,p,w),a},u.prototype.addFarLinkButton=function(n,i,r,u,f,e,o,s,h,c,l,a){var v=this,y=v.createButtonArgs(n,i,e,o,s,h,c),p,w,b;return y.text=TDB.watchableTag(8982729,v,r),y.url=u,y.cssClass+=" linkFarButtonWrapper",p=new t.LinkButtonVE(v,y),w={viewElement:p,stateMap:a?a:t.MenuItem.createGenericButtonStateMap()},l!=null&&(b={context:n,click:i,text:r,label:l,buttonId:e,url:u}),v.addFarButton(p,f,w,b),p},u.prototype.addFarGlyphButton=function(n,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){var g=this,k=g.createButtonArgs(n,i,e,s,h),d,nt,tt;return k.glyphClass=r,k.clipClass=u,k.textPlacementRight=!0,k.textClass="headerFarButtonText",k.description=o,k.text=l,k.textClass=a,k.hasPopup=c,k.glyphCssClassWatchable=w,k.calloutArgs=b,d=new t.GlyphButtonVE(g,k),nt={viewElement:d,textClass:a,noTextClass:v,stateMap:p?p:t.MenuItem.createGlyphButtonStateMap()},y!=null&&(tt={context:n,click:i,text:l,label:y,buttonId:e}),g.addFarButton(d,f,nt,tt),d},u.prototype.createHomeButton=function(n){var i=this;i._homeButton=new t.HomeButtonVE(i,{isEditMode:n.isEditMode});i.addResource(i._homeButton);i.createMenuItem(i._homeButton,25,{viewElement:i._homeButton,stateMap:t.MenuItem.createStaticElementStateMap()})},u.prototype.removeHomeButton=function(){var n=this;n._homeButton.dispose();n._homeButton=undefined;n._menuItems[25]&&delete n._menuItems[25]},u.prototype.createOverflowMenu=function(n){var i=this,r;i._overflowVisible=TDB.watchableTag(6344908,i,!1);r={userState:n.userState,currentStory:n.currentStory,visible:i._overflowVisible};i._overflowMenu=new t.OverflowMenuVE(i,r)},u.prototype.addSignInButton=function(){var n=this;n.addFarTextButton(n,n.signInClicked,Resources.SignIn,6,51,r.signInButtonId)},u.prototype.signInClicked=function(){return i.AppBarAction.getInstance().SignIn(),!1},u.prototype.addFeedbackButton=function(){var n=this;n.addFarTextButton(n,n.addFeedbackButtonClicked,Resources.GiveFeedback,4,39,r.addFeedbackButtonId)},u.prototype.addFeedbackButtonClicked=function(){var n=this,t;return StoryLog.ReportAnalyticsTelemetry(r.addFeedbackButtonId),t=n._model.currentStory?n._model.currentStory.getStoryId():"",i.AppBarAction.getInstance().ShowFeedback(t),!1},u.prototype.addCreateNewButton=function(){var n=this;CommonSettings.IsEnabled&&i.Environment.getInstance().shouldShowAuthoringEntrypoints()&&n.addFarTextButton(n,n.createNewClicked,Resources.CreateNew,1,32,r.createNewButtonId)},u.prototype.createNewClicked=function(){return i.AppBarAction.getInstance().CreateNewStory(),!1},u.prototype.addUserButton=function(){var n=this;n.addFarTextButton(n,n.toggleOverflowMenu,CommonSettings.DisplayName||CommonSettings.EmailAddress,5,48,r.userButtonID)},u.prototype.addMyStoriesButton=function(){var n=this;i.Environment.getInstance().inDowntimeDeployment()||n.addFarLinkButton(n,n.myStoriesClicked,Resources.MyRemixes,i.UrlHelper.getInstance().mySwaysUrl(),0,44,r.mySwaysHeaderButtonId,"headerFarButton ButtonVE")},u.prototype.myStoriesClicked=function(n){return n.preventDefault(),i.AppBarAction.getInstance().GoToMyStories(),!1},u.prototype.addTutorialVideosButton=function(n){var u=this;CommonSettings.SiteTutorialVideosEnabled&&u.addFarLinkButton(u,u.tutorialVideosClicked,Resources.Tutorials,i.UrlHelper.getInstance().tutorialVideosUrl(),22,54,r.tutorialVideosButtonId,n!==undefined?n:"headerFarButton ButtonVE",null,null,11,t.MenuItem.createLowPriorityStateMap())},u.prototype.tutorialVideosClicked=function(n){return n.preventDefault(),i.AppBarAction.getInstance().OpenTutorialVideos(),!1},u.prototype.addInternalFeaturesButton=function(){var n=this;i.Environment.getInstance().shouldDisplayInternalFeaturesButton()&&n.addFarTextButton(n,n.toggleInternalFlightClicked,Resources.InternalFeatures,20,43,r.internalFeaturesEnabledButtonId,"headerFarButtonDynamic internalHeaderButtonDynamic",null,null,null,t.MenuItem.createLowPriorityStateMap())},u.prototype.toggleInternalFlightClicked=function(){return i.AppBarAction.getInstance().ToggleInternalFlight(),!1},u.prototype.addOverflowButton=function(){var n=this,u="headerFarButtonDynamic",t;i.Environment.getInstance().shouldDisplayInternalFeaturesButton()&&(u="headerFarButtonDynamic overflowInternalEnabledDynamic");t=n.addFarGlyphButton(n,n.toggleOverflowMenu,Glyphs.OverflowMenuButtonGlyph,Glyphs.OverflowMenuButtonClip,9,45,Resources.OverFlowButtonDescription,r.overflowButtonId,u,!0);n._overflowMenu.setControllingElement(t);t.visible=TDB.watcherTag(9049753,n,n,n.calcOverflowButtonVisible)},u.prototype.addHamburgerButton=function(){var n=this,i;n._hamburgerMenu=new t.HamburgerMenuVE(n);i={buttonId:46,description:Resources.OverFlowButtonDescription,glyphClass:Glyphs.HamburgerMenuButtonGlyph,clipClass:Glyphs.HamburgerMenuButtonClip,cssClass:"AppBarHamburgerButton",cssClassHover:"headerFarButtonHover",cssClassActive:"headerFarButtonActive",cssClassFocused:"headerFarButtonFocused",cssClassPressed:"headerFarButtonPressed",context:n._hamburgerMenu,click:n._hamburgerMenu.toggleClicked,hasPopup:!0};n._hamburgerButton=new t.GlyphButtonVE(n,i);n._hamburgerMenu.setControllingElement(n._hamburgerButton);n.createMenuItem(n._hamburgerButton,24,{viewElement:n._hamburgerButton,stateMap:t.MenuItem.createStaticElementStateMap()})},u.prototype.toggleOverflowMenu=function(){var n=this;return n._overflowMenu.toggle(),!1},u.prototype.setOverflowVisible=function(n){var t=this;n?t._overflowMenu.show():t._overflowMenu.hide()},u.prototype.homeButtonArgs=function(){var n=this;return n._homeButton},u.prototype.ifHamburgerPlaceholderArgs=function(){var n=this;return!!n._hamburgerButton},u.prototype.nearButtonsArgs=function(){var n=this;return n._nearButtons},u.prototype.farButtonsArgs=function(){var n=this;return n._farButtons},u.prototype.hamburgerButtonArgs=function(){var n=this;return n._hamburgerButton},u.prototype.hamburgerMenuArgs=function(){var n=this;return n.getHamburgerMenu()},u.prototype.getHamburgerMenu=function(){var n=this;return n._hamburgerMenu},u.prototype.overflowMenuArgs=function(){var n=this;return n.getOverflowMenu()},u.prototype.getOverflowMenu=function(){var n=this;return n._overflowMenu},u.prototype.hasButton=function(n){var t=this;return!!t._buttonLabels[n]},u.prototype.getButton=function(n){var t=this;return t._buttonLabels[n]},u.prototype.clickButton=function(n){var t=this;t._buttonLabels[n].mouseClicked(undefined)},u.prototype.commandWrapperDynamicMenuVisibleArgs=function(){return{visible:!0,widthBuffer:0}},u.prototype.commandWrapperDynamicMenuChunksArgs=function(n){var t=this;return i.Environment.getInstance().isClientOnline(n),n.watch(t.notifyMenuRefresh),{menuChunks:[t],widthBuffer:0}},u.prototype.addMenuItemIfValid=function(n,t){var i=this;i._menuItems[t]!==undefined&&n.push(i._menuItems[t])},u.prototype.getMenuItems=function(){var n=this,t=[],i;n.addMenuItemIfValid(t,25);n.addMenuItemIfValid(t,0);n.addMenuItemIfValid(t,1);n.addMenuItemIfValid(t,6);n.addMenuItemIfValid(t,21);n.addMenuItemIfValid(t,12);n.addMenuItemIfValid(t,11);n.addMenuItemIfValid(t,23);n.addMenuItemIfValid(t,7);n.addMenuItemIfValid(t,10);n.addMenuItemIfValid(t,26);n.addMenuItemIfValid(t,18);n.addMenuItemIfValid(t,8);n.addMenuItemIfValid(t,27);n.addMenuItemIfValid(t,28);n.addMenuItemIfValid(t,29);n.addMenuItemIfValid(t,22);n.addMenuItemIfValid(t,20);for(i in n._menuItems)t.contains(n._menuItems[i])||n.addMenuItemIfValid(t,i);return t},u.prototype.getOverflowButtonWidth=function(){var t=this,n=t._buttonLabels[9];return n!==undefined?$(n.findFirstNode()).outerWidth(!0):0},u.prototype.calcOverflowButtonVisible=function(n){var r=this,i,t;if(!r._hamburgerButton)return!0;for(i=r.getMenuItems(n),t=0;t<i.length;t++)if(i[t].state.getWatchedValue(n)==2)return!0;return!1},u.prototype.getOverflowButtonVisible=function(){var i=this,n=i._buttonLabels[9];return n!==undefined&&n instanceof t.GlyphButtonVE?n.visible.getValue():!1},u.prototype.predictOverflowButtonVisible=function(){var n=this;return n.getOverflowButtonVisible()},u}(t.RegionViewElement);t.AppBarVEBase=u})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t){n.call(this,t);var i=this;i._progressMessage=TDB.watchableTag(7463834,i,"");i._isProgressVisible=TDB.watchableTag(7463835,i,!1)}return __extends(t,n),t.prototype.show=function(n){var t=this;(t._isProgressVisible.getValue()!=!0||t._progressMessage.getValue()!=n)&&TDB.applyUpdate(function(){t._progressMessage.setValue(n);t._isProgressVisible.setValue(!0)})},t.prototype.hide=function(){var n=this;n._isProgressVisible.getValue()!=!1&&TDB.applyUpdate(function(){n._isProgressVisible.setValue(!1)})},t.prototype.ifBlockingProgressArgs=function(n){var t=this;return n.watchValue(t._isProgressVisible)},t.prototype.BlockingMessageTextArgs=function(n){var t=this;return n.watchValue(t._progressMessage)},t.prototype.BlockingProgressGifAttrArgs=function(){return{src:CommonSettings.ContentBaseUrl+"whitespinner.32x32.gif"}},t}(TDB.ViewElement);n.BlockingProgressVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=n.Common,r=n.Common.TelemetryConstants,f=n.View.ViewElements,e,u;(function(n){n[n.Preview=0]="Preview";n[n.MyStories=1]="MyStories";n[n.CreateNew=2]="CreateNew";n[n.Download=3]="Download";n[n.Feedback=4]="Feedback";n[n.User=5]="User";n[n.SignIn=6]="SignIn";n[n.SignOut=7]="SignOut";n[n.AccessibilityView=8]="AccessibilityView";n[n.DuplicateStory=9]="DuplicateStory";n[n.InternalFeatures=10]="InternalFeatures";n[n.TutorialVideos=11]="TutorialVideos";n[n.Share=12]="Share";n[n.Authors=13]="Authors";n[n.Undo=14]="Undo";n[n.Redo=15]="Redo";n[n.Remix=16]="Remix";n[n.Content=17]="Content";n[n.Cards=18]="Cards";n[n.Design=19]="Design";n[n.Navigation=20]="Navigation";n[n.AccessibilityViewExit=21]="AccessibilityViewExit"})(t.OverflowButtonLabel||(t.OverflowButtonLabel={}));e=t.OverflowButtonLabel;u=function(u){function e(n,t){u.call(this,n,t.visible,4);var i=this;i._args=t;i._overflowButtons=[];i._overflowButtonLabels={};i._downloadUrl=TDB.watchableTag(6386119,i,null);i.shouldExternalEventBeHandled=t.shouldExternalEventBeHandled!==undefined?t.shouldExternalEventBeHandled:!0}return __extends(e,u),e.prototype.addOverflowButton=function(n,t){var i=this;if(i._overflowButtonLabels[t])throw new Error("Adding multiple buttons under same label: "+t);i._overflowButtonLabels[t]=n;i._overflowButtons.push(n)},e.prototype.removeOverflowButton=function(n){var t=this,i,r;return t._overflowButtonLabels[n]?(i=t._overflowButtonLabels[n],r=t._overflowButtons.indexOf(t._overflowButtonLabels[n]),t._overflowButtons.splice(r,1),t._overflowButtonLabels[n].dispose(),delete t._overflowButtonLabels[n],i):undefined},e.prototype.addOverflowGlyphButton=function(n){var r=this,u,i;if(!n)throw new Error("We need some arguments to create a button");return u={buttonId:n.buttonId,clipClass:n.glyphClipClass?n.glyphClipClass:Glyphs.OverflowMenuItemButtonClip,glyphClass:n.glyphClass,glyphWrapperClass:n.glyphWrapperClass?n.glyphWrapperClass:"overflowMenuGlyph",cssClass:n.cssClass?n.cssClass:"overflowButton",cssClassActive:"overflowButtonActive",context:n.context,text:n.text,textClass:"overflowMenuText",description:n.text,telemetry_id:n.telemetry_id?n.telemetry_id:"",tooltip:n.tooltip?n.tooltip:null,shortcutIdentifiers:n.shortcutIdentifiers,shortcutProcessor:n.shortcutProcessor},i=new t.GlyphButtonVE(r,u),i.click=function(t){return r.hide(),n.click.call(this,t)},n.watchableText!==undefined&&(i.text=n.watchableText),n.enabled!==undefined&&(i.enabled=n.enabled),n.isActive!==undefined&&(i.isActive=n.isActive),r.addOverflowButton(i,n.label),i},e.prototype.addOverflowLinkButton=function(n){var r=this,u,i;if(!n)throw new Error("We need some arguments to create a button");return u={url:n.url,text:TDB.watchableTag(8982730,r,n.text),buttonId:n.buttonId,context:n.context,click:n.click,cssClass:n.cssClass?n.cssClass:"overflowButton overflowLinkButton",cssClassActive:"overflowButtonActive overflowLinkButton",textCssClass:TDB.watchableTag(8982731,r,"overflowMenuText segoeUI"),telemetry_id:n.telemetry_id?n.telemetry_id:""},i=new t.LinkButtonVE(r,u),i.click=function(t){return r.hide(),n.click.call(this,t)},n.enabled!==undefined&&(i.enabled=n.enabled),n.isActive!==undefined&&(i.isActive=n.isActive),r.addOverflowButton(i,n.label),i},e.prototype.addInternalFeaturesButton=function(){var n=this,t=i.Environment.getInstance(),u;(!t.isProductionEnvironment()||i.UserState.getInstance().isInternalUser())&&(u=t.areInternalFeaturesEnabled()?"Disable Internal Features":"Enable Internal Features",n.addOverflowGlyphButton({context:n,click:n.internalFeaturesButtonClicked,text:u,label:10,buttonId:43,cssClass:"overflowButton internalOverflowButton",telemetry_id:r.internalFeaturesEnabledButtonId}))},e.prototype.internalFeaturesButtonClicked=function(){return i.AppBarAction.getInstance().ToggleInternalFlight(),!1},e.prototype.addCreateNewButton=function(){var n=this,t=i.Environment.getInstance(),u;t.inDowntimeDeployment()||CommonSettings.IsEnabled&&t.shouldShowAuthoringEntrypoints()&&(u=n.addOverflowGlyphButton({context:n,click:n.createNewButtonClicked,text:Resources.CreateNew,glyphClass:Glyphs.OverflowMenuCreateNewButtonGlyph,label:2,buttonId:32,telemetry_id:r.createNewButtonId}),u.enabled=i.Environment.getInstance().getClientOnlineWatcher())},e.prototype.createNewButtonClicked=function(){var n=this;return n.exit(),i.AppBarAction.getInstance().CreateNewStory(),!1},e.prototype.addFeedbackButton=function(){var n=this,t=n.addOverflowGlyphButton({context:n,click:n.feedbackClicked,text:Resources.GiveFeedback,glyphClass:Glyphs.OverflowMenuFeedbackButtonGlyph,label:4,buttonId:39,enabled:i.Environment.getInstance().getClientOnlineWatcher(),telemetry_id:r.addFeedbackButtonId})},e.prototype.feedbackClicked=function(){var n=this,t;return n.hide(),t=n._args.currentStory?n._args.currentStory.getStoryId():"",i.AppBarAction.getInstance().ShowFeedback(t),!1},e.prototype.showDownloadArgs=function(){var n=this;return CommonSettings.EnableStoryDownload},e.prototype.downloadContainerAutoDownloadInitArgs=function(){var n=this;return{url:n._downloadUrl}},e.prototype.addDownloadButton=function(){var n=this;n.addOverflowGlyphButton({context:n,click:n.downloadClicked,text:Resources.DownloadStory,glyphClass:Glyphs.OverflowMenuDuplicateButtonGlyph,label:3,buttonId:35})},e.prototype.downloadClicked=function(){var n=this,t=i.UrlHelper.getInstance().getDownloadUrl(window.location.toString());return TDB.applyUpdate(function(){return n._downloadUrl.setValue(t)}),n.hide(),!1},e.prototype.addDuplicateStoryButton=function(n,t){var r=this,u=r.addOverflowGlyphButton({context:r,click:function(){return r.duplicateStoryClicked(t.call(n)),!1},text:Resources.DuplicateStory,glyphClass:Glyphs.OverflowMenuDuplicateButtonGlyph,label:9,buttonId:36,enabled:i.Environment.getInstance().getClientOnlineWatcher()})},e.prototype.duplicateStoryClicked=function(i){var r=this,u;(r.hide(),BRSDialog.showIfAuthoringDisabled())||(u=r._args.currentStory?r._args.currentStory.getLookupId():"",t.DuplicateStoryDialog.createAndShow(u,i,n.Common.UrlHelper.getInstance().mySwaysUrl()))},e.prototype.addMyStoriesButton=function(){var t=this;i.Environment.getInstance().inDowntimeDeployment()||t.addOverflowLinkButton({context:t,click:t.myStoriesButtonClicked,text:Resources.MyRemixes,url:n.Common.UrlHelper.getInstance().mySwaysUrl(),label:1,buttonId:44,telemetry_id:r.mySwayOverflowId})},e.prototype.myStoriesButtonClicked=function(n){var t=this;return t.exit(),n.preventDefault(),i.AppBarAction.getInstance().GoToMyStories(),!1},e.prototype.addTutorialVideosButton=function(t){var i=this;CommonSettings.SiteTutorialVideosEnabled&&i.addOverflowLinkButton({context:i,click:i.tutorialVideosButtonClicked,text:Resources.Tutorials,url:n.Common.UrlHelper.getInstance().tutorialVideosUrl(),label:11,cssClass:t,buttonId:54,telemetry_id:r.tutorialVideosButtonId})},e.prototype.tutorialVideosButtonClicked=function(){return i.AppBarAction.getInstance().OpenTutorialVideos(),!1},e.prototype.addUserButton=function(){var n=this,r={buttonId:48,context:n,click:n.userButtonClicked,userState:n._args.userState},i=new t.UserInfoVE(n,r);return n.addOverflowButton(i,5),i},e.prototype.userButtonClicked=function(){return i.AppBarAction.getInstance().OpenUserProfile(),!1},e.prototype.addSignOutButton=function(){var n=this,t=n.addOverflowGlyphButton({context:n,click:n.signOutButtonClicked,text:Resources.SignOut,label:7,buttonId:52,telemetry_id:r.signOutButtonId})},e.prototype.signOutButtonClicked=function(){return i.AppBarAction.getInstance().SignOut(),!1},e.prototype.addSignInButton=function(){var n=this;n.addOverflowGlyphButton({context:n,click:n.signInButtonClicked,text:Resources.SignIn,label:6,buttonId:51,telemetry_id:r.signInButtonId})},e.prototype.signInButtonClicked=function(){return i.AppBarAction.getInstance().SignIn(),!1},e.prototype.addAccessibilityViewButton=function(t){var i=this,u=n.Common.UrlHelper.getInstance().isAccessiblityView(),r=u&&!t&&n.Common.Environment.getInstance().areInternalFeaturesEnabled();i.addOverflowGlyphButton({context:i,shortcutIdentifiers:["Alt+Shift+VKey"],shortcutProcessor:f.DomEventRegister.getInstance().getRootPanelElement(),click:r?i.exitAccessibilityViewClicked:i.enterAccessibilityViewClicked,text:r?Resources.ExitAccessibilityView:Resources.AccessibilityView,label:r?21:8,buttonId:r?30:29,tooltip:r?Resources.ExitAccessibilityViewTooltip:Resources.AccessibilityViewTooltip});i.accessibleViewUsesNewTab=t},e.prototype.exitAccessibilityViewClicked=function(){var t=this,i,r;return ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(30,Diag.ULSCat.msoulscat_Story_Site)),i=t._args.currentStory?t._args.currentStory.getLookupId():"",r=n.Common.UrlHelper.getInstance().accessibilityViewUrl(i,!0),window.location.assign(r),!1},e.prototype.enterAccessibilityViewClicked=function(){var n=this;return ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(29,Diag.ULSCat.msoulscat_Story_Site)),n.navigateAccessibilityView(),!1},e.prototype.navigateAccessibilityView=function(){var t=this,i=window,u=t._args.currentStory?t._args.currentStory.getLookupId():"",r=n.Common.UrlHelper.getInstance().accessibilityViewUrl(u);return t.accessibleViewUsesNewTab?i=window.open(r,"_blank"):window.location.assign(r),i},e.prototype.wrapperAttrArgs=function(n){var t=this;return t.getAriaAttributes(n)},e.prototype.wrapperClassNameArgs=function(){var n=this,t="overflowWrapper overflowWrapperWeb";return n._args.cssClass&&(t+=" "+n._args.cssClass),t},e.prototype.wrapperSlideVisibleInitArgs=function(){return!1},e.prototype.wrapperSlideVisibleArgs=function(n){var t=this;return{visible:n.watchValue(t._args.visible)}},e.prototype.ifLastSyncTimeArgs=function(n){var t=this;return!t._args.currentStory||!i.Environment.getInstance().isClientOnline(n)?!1:t._args.currentStory.getLastSyncTime(n).length>0},e.prototype.lastSyncTimeTextArgs=function(n){var t=this,i=t._args.currentStory?t._args.currentStory.getLastSyncTime(n):"",r=new Date(i).toLocaleDateString(undefined,{month:"long",day:"numeric",hour:"numeric",minute:"numeric"});return ResourceManager.ResolveString(Resources.LastSyncTimeDescription,[r])},e.prototype.menuButtonsArgs=function(){var n=this;return n._overflowButtons},e.prototype.hasOverflowButton=function(n){var t=this;return!!t._overflowButtonLabels[n]},e.prototype.onRestoreFocus=function(){return!1},e}(t.PopupBaseVE);t.OverflowMenuVEBase=u})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n){t.call(this,n,undefined,4);var i=this;i._topButtons=[];i._middleButtons=[];i._bottomButtons=[]}return __extends(i,t),i.prototype.createAccountsPane=function(t){var i=this,r={accountManager:t};return i._accountsPane=new n.AccountsPaneVE(i,r),i._accountsPane},i.prototype.createAboutPane=function(){var t=this;return t._aboutPane=new n.AboutPaneVE(t),t._aboutPane},i.prototype.addTopButton=function(n){var t=this;t.addButton(n,t._topButtons)},i.prototype.addMiddleButton=function(n){var t=this;t.addButton(n,t._middleButtons)},i.prototype.addBottomButton=function(n){var t=this;t.addButton(n,t._bottomButtons)},i.prototype.addButton=function(n,t){var i=this;n&&(t.push(n),n.parent=i)},i.prototype.wrapperSlidePaneVisibleArgs=function(n){var t=this;return n.watchValue(t.visible)},i.prototype.wrapperClassNameArgs=function(){return"overflowWrapper hamburgerMenu"},i.prototype.titleTextArgs=function(){return Resources.ProductNameShort},i.prototype.titleFadeVisibleInitArgs=function(){return{overrideDisplay:!1,transitionIn:"opacity 0.366s ease",transitionOut:"opacity 0s ease"}},i.prototype.titleFadeVisibleArgs=function(n){var i=this,t=n.watchValue(i.visible),r=t?366:0;return{visible:t,transitionDelay:r}},i.prototype.topMenuButtonsArgs=function(){var n=this;return n._topButtons},i.prototype.middleMenuButtonsArgs=function(){var n=this;return n._middleButtons},i.prototype.bottomMenuButtonsArgs=function(){var n=this;return n._bottomButtons},i.prototype.aboutPaneArgs=function(){var n=this;return n._aboutPane},i.prototype.accountsPaneArgs=function(){var n=this;return n._accountsPane},i.prototype.onExiting=function(){var n=this;n._accountsPane&&n._accountsPane.hide();n._aboutPane&&n._aboutPane.hide();t.prototype.onExiting.call(this)},i.prototype.toggleClicked=function(){var n=this;return n.toggle(),!1},i.prototype.mouseClicked=function(){return!1},i}(n.PopupBaseVE);n.HamburgerMenuVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){var r=this;n.call(this,t);r._glyphClass=i.glyphClassWatchable||TDB.watchableTag(5830618,r,i.glyphClass?i.glyphClass:"");r._clipClass=i.clipClassWatchable||TDB.watchableTag(5830619,r,i.clipClass?i.clipClass:"");r._cssClass=i.cssClassWatchable||TDB.watchableTag(5830620,r,i.cssClass?i.cssClass:"");r.glyphVisible=i.glyphVisible}return __extends(t,n),t.prototype.ifWrapperArgs=function(n){var t=this;return t.glyphVisible?n.watchValue(t.glyphVisible):!0},t.prototype.getVisible=function(n){var t=this;return t.ifWrapperArgs(n)},t.prototype.wrapperClassNameArgs=function(n){var t=this;return n.watchValue(t._cssClass)},t.prototype.clipAttrArgs=function(n){var t=this,i=n.watchValue(t._clipClass);return{"class":i}},t.prototype.glyphAttrArgs=function(n){var t=this,i=n.watchValue(t._glyphClass);return{"class":i,src:CommonSettings.ContentBaseUrl+"story.png"}},t}(TDB.ViewElement);n.GlyphVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(i,r){t.call(this,i,r);var u=this;u.clipClass=TDB.watchableTag(5830602,u,r.clipClass?r.clipClass:"");u._glyphClass=TDB.watchableTag(5830603,u,r.glyphClass?r.glyphClass:"");u.glyphClass=u._glyphClass;u.focusedGlyphClass=TDB.watchableTag(5830604,u,r.focusedGlyphClass?r.focusedGlyphClass:"");u.pressedGlyphClass=TDB.watchableTag(5830605,u,r.pressedGlyphClass?r.pressedGlyphClass:"");u.hoverGlyphClass=TDB.watchableTag(5830606,u,r.hoverGlyphClass?r.hoverGlyphClass:"");u.activeGlyphClass=TDB.watchableTag(5830607,u,r.activeGlyphClass?r.activeGlyphClass:"");u.disabledGlyphClass=TDB.watchableTag(5830608,u,r.disabledGlyphClass?r.disabledGlyphClass:"");u.text=TDB.watchableTag(5830609,u,r.text?r.text:"");u.textClass=TDB.watchableTag(5830610,u,r.textClass?r.textClass:"");u.textHoverClass=TDB.watchableTag(5830611,u,r.textHoverClass?r.textHoverClass:"");u.textPressedClass=TDB.watchableTag(5830612,u,r.textPressedClass?r.textPressedClass:"");u.textFocusedClass=TDB.watchableTag(5830613,u,r.textFocusedClass?r.textFocusedClass:"");u.textActiveClass=TDB.watchableTag(5830614,u,r.textActiveClass?r.textActiveClass:"");u.textDisabledClass=TDB.watchableTag(5830615,u,r.textDisabledClass?r.textDisabledClass:"");u.description=TDB.watchableTag(5830616,u,r.description);u.tooltip=TDB.watchableTag(8987784,u,r.tooltip);u._textPlacementRight=r.textPlacementRight;u._textPlacementLeft=r.textPlacementLeft;u._glyphWrapperClass=r.glyphWrapperClass;u._glyphCssClassWatchable=r.glyphCssClassWatchable;u._useGlyphIconText=r.useGlyphIconText&&!n.GlyphButtonVE.isCurrentLocaleEA();u._glyphIconTextCssClass=r.glyphIconTextClass?r.glyphIconTextClass:"";u._calloutArgs=r.calloutArgs;u.telemetry_id=r.telemetry_id?r.telemetry_id:""}return __extends(i,t),i.prototype.glyphVEGlyphClass=function(n){var t=this,o=n.watchValue(t.glyphClass),s=n.watchValue(t.enabled),i,r,u,f,e;if(s){if(n.watchValue(t.isMouseDown)&&(i=n.watchValue(t.pressedGlyphClass),i))return i;if(n.watchValue(t.isMouseOver)&&(r=n.watchValue(t.hoverGlyphClass),r))return r;if(t.isFocused(n)&&(u=n.watchValue(t.focusedGlyphClass),u))return u;if(n.watchValue(t.isActive)&&(f=n.watchValue(t.activeGlyphClass),f))return f}else e=n.watchValue(t.disabledGlyphClass),e&&(o=e);return o},i.prototype.glyphVEClipClass=function(n){var t=this;return n.watchValue(t.clipClass)},i.prototype.wrapperClassNameArgs=function(n){var t=this;return t.getWrapperClass(n)},i.prototype.wrapperEventsInitArgs=function(){var n=this;return{mouseover:n.mouseOver,mouseout:n.mouseOut}},i.prototype.wrapperStyleArgs=function(n){var t=this;return n.watchValue(t.style)},i.prototype.wrapperAttrArgs=function(n){var t=this,u=n.watchValue(t.attr)||{},i=n.watchValue(t.description),r=n.watchValue(t.tooltip);return t.getButtonWrapperAttributes(n,i,{title:r?r:i,id:t.telemetry_id})},i.prototype.glyphWrapperStyleArgs=function(){var t=this,n="";if(t._textPlacementRight)n="left";else if(t._textPlacementLeft)n="right";else return{};return{float:n}},i.prototype.glyphVEArgs=function(){var t=this;if(!t._useGlyphIconText){var r=TDB.watcherTag(8713931,t,null,t.glyphVEGlyphClass),u=TDB.watcherTag(5830617,t,null,t.glyphVEClipClass),i=new n.GlyphVE(t,{cssClass:t._glyphWrapperClass,cssClassWatchable:t._glyphCssClassWatchable,glyphClassWatchable:r,clipClassWatchable:u});return i.addResource(r),i.addResource(u),i}return null},i.prototype.textClassNameArgs=function(n){var t=this,o=n.watchValue(t.textClass),s=n.watchValue(t.enabled),i,r,u,f,e;if(s){if(n.watchValue(t.isMouseDown)&&(i=n.watchValue(t.textPressedClass),i))return i;if(t.isFocused(n)&&(r=n.watchValue(t.textFocusedClass),r))return r;if(n.watchValue(t.isMouseOver)&&(u=n.watchValue(t.textHoverClass),u))return u;if(n.watchValue(t.isActive)&&(f=n.watchValue(t.textActiveClass),f))return f}else e=n.watchValue(t.textDisabledClass),e&&(o=e);return o},i.prototype.textTextArgs=function(n){var t=this;return n.watchValue(t.text)},i.prototype.glyphTextTextArgs=function(n){var t=this,i=n.watchValue(t.text);return t._useGlyphIconText&&i?i[0]:""},i.prototype.textStyleArgs=function(){var n=this;return n._textPlacementRight?{float:"left"}:n._textPlacementLeft?{float:"right"}:{}},i.prototype.glyphTextClassNameArgs=function(){var n=this;return n._glyphIconTextCssClass},i.prototype.ifGlyphTextArgs=function(){var n=this;return n._useGlyphIconText},i.prototype.setGlyphClass=function(n){var t=this;if(t.glyphClass!==t._glyphClass)throw new Error("Cannot set the glyph class if it has been overriden.");t._glyphClass.setValue(n)},i.prototype.includeLabelTextArgs=function(n){var t=this;return n.watchValue(t.text)!==""},i.prototype.calloutArgs=function(){var t=this;return t._calloutArgs?new n.CalloutVE(t,t._calloutArgs):null},i.prototype.toString=function(){var i=this,n=i.description.getValue();return t.prototype.toString.call(this)+" Description='"+(n?n:"<none>")+"'"},i.isCurrentLocaleEA=function(){return n.GlyphButtonVE._eaLanguages.indexOf(CommonSettings.UserLocaleString.toLowerCase())>=0},i._eaLanguages=["ja-jp","zh-cn","zh-tw","ko-kr"],i}(n.ButtonVE);n.GlyphButtonVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=n.Common.TelemetryConstants,r=function(r){function u(n,t){r.call(this,n);var i=this;i._isEditMode=t.isEditMode;i.createChildren()}return __extends(u,r),u.prototype.createChildren=function(){var n=this;n.createAppSwitcherButton()},u.prototype.createAppSwitcherButton=function(){var n=this,r={buttonId:57,context:n,click:ExpandHeader,cssClass:"appSwitcher",clipClass:Glyphs.AppSwitcherWaffleClip,glyphClass:Glyphs.AppSwitcherWaffleGlyph,description:Resources.AppSwitcherButtonDescription,telemetry_id:i.officeAppSwitcherButtonId};n._appSwitcherButton=new t.GlyphButtonVE(n,r)},u.prototype.homeLinkAttrArgs=function(){return{href:CommonSettings.IsRegisteredAuthor?n.Common.UrlHelper.getInstance().mySwaysUrl():n.Common.UrlHelper.getInstance().exploreUrl(),id:i.swayButtonId}},u.prototype.homeTextActiveTextArgs=function(){return Resources.ProductNameShort},u.prototype.homeLinkEventsInitArgs=function(){var n=this;return{click:n.onHomeLinkLeftClick,contextmenu:n.onHomeLinkRightClick}},u.prototype.onHomeLinkLeftClick=function(){return StoryLog.ReportAnalyticsTelemetry(i.swayButtonId),ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(41,Diag.ULSCat.msoulscat_Story_Site)),!0},u.prototype.onHomeLinkRightClick=function(){return StoryLog.ReportAnalyticsTelemetry(i.swayButtonRightClick),ActionLogger.RecordClientAction(new ClientAction.ButtonRightClickAction(41,Diag.ULSCat.msoulscat_Story_Site)),!0},u.prototype.appSwitcherArgs=function(){var n=this;return n._appSwitcherButton},u}(TDB.FocusableViewElement);t.HomeButtonVEBase=r})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n,i){t.call(this,n,i);var r=this;r._args=i;r.telemetry_id=i.telemetry_id?i.telemetry_id:""}return __extends(i,t),i.prototype.onClick=function(){return this._args.onclick&&this._args.onclick(),!0},i.prototype.linkEventsInitArgs=function(){return{click:this.onClick}},i.prototype.glyphArgs=function(){var t=this,i;return t._args.clipClass&&t._args.glyphClass?(i={clipClass:t._args.clipClass,glyphClass:t._args.glyphClass,cssClass:t._args.glyphCssClass},new n.GlyphVE(t,i)):null},i.prototype.linkClassNameArgs=function(){var n=this;return n._args.cssClass||""},i.prototype.textTextArgs=function(n){var t=this;return n.watchValue(t._args.text)},i.prototype.textClassNameArgs=function(n){var t=this;return t._args.textCssClass?n.watchValue(t._args.textCssClass):""},i.prototype.linkAttrArgs=function(){var n=this;return{href:n._args.url,id:n._args.telemetry_id}},i}(n.ButtonVE);n.LinkButtonVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(i,r){t.call(this,i);var u=this;u._shareThisWidgets=r.map(function(t){return new n.ShareThisWidgetVE(u,t)})}return __extends(i,t),i.prototype.shareThisWidgetsArgs=function(){var n=this;return n._shareThisWidgets},i}(TDB.FocusableViewElement);n.ShareThisWidgetGroupVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(i,r){t.call(this,i);this.classToButtonSettings={st_fblike_large:{buttonId:235,ariaDescription:Resources.FacebookLikeButtonDescription},st_facebook_large:{buttonId:234,ariaDescription:Resources.ShareToFacebookButtonDescription},st_facebook_custom:{buttonId:234,ariaDescription:Resources.ShareToFacebookButtonDescription},st_twitter_large:{buttonId:241,ariaDescription:Resources.ShareToTwitterButtonDescription},st_twitter_custom:{buttonId:241,ariaDescription:Resources.ShareToTwitterButtonDescription},st_yammer_large:{buttonId:242,ariaDescription:Resources.ShareToYammerButtonDescription},st_linkedin_large:{buttonId:237,ariaDescription:Resources.ShareToLinkedinButtonDescription},st_pinterest_large:{buttonId:239,ariaDescription:Resources.ShareToPinterestButtonDescription},st_googleplus_large:{buttonId:236,ariaDescription:Resources.ShareToGooglePlusButtonDescription},st_sharethis_large:{buttonId:240,ariaDescription:Resources.ShareUsingShareThisButtonDescription},st_sharethis_custom:{buttonId:240,ariaDescription:Resources.ShareUsingShareThisButtonDescription}};var u=this;if(u._widgetClassName=r.widgetClassName,u._buttonId=r.buttonId||u.classToButtonSettings[u._widgetClassName].buttonId,u._ariaDescription=r.ariaDescription||u.classToButtonSettings[u._widgetClassName].ariaDescription,u._shouldBubbleMouseClick=r.shouldBubbleMouseClick,u._glyphButton=null,u._titleWatcher=r.titleWatcher,u._urlOverride=r.urlOverride,u._isEditMode=r.storyViewMode===2,r.buttonGlyphVEArgs&&(u.setFocusable(!1),r.buttonGlyphVEArgs.context=u,r.buttonGlyphVEArgs.click=u.mouseClicked,r.buttonGlyphVEArgs.buttonId=238,u._glyphButton=new n.GlyphButtonVE(u,r.buttonGlyphVEArgs)),!u._buttonId)throw new Error("buttonId not defined for widget: "+u._widgetClassName);if(!u._ariaDescription)throw new Error("ariaDescription not defined for widget: "+u._widgetClassName);}return __extends(i,t),i.prototype.hasButtonArgs=function(){var n=this;return!!n._glyphButton},i.prototype.shareThisWidgetClassNameArgs=function(){var n=this;return n._widgetClassName},i.prototype.shareThisWidgetStyleArgs=function(){return{display:"inline-block"}},i.prototype.shareThisWidgetAttrArgs=function(){var n=this,t={},i,r,u,e,f,o;n._urlOverride&&(t.st_url=n._urlOverride);n._glyphButton||(t[Aria.Attributes.Role]=Aria.Roles.Button,t[Aria.Attributes.Label]=n._ariaDescription);i=n._titleWatcher?n._titleWatcher.getValue():"";r=i&&i.length>0;switch(n._widgetClassName){case"st_twitter_custom":case"st_twitter_large":r?(e=n._isEditMode?Resources.AuthorTweetMessageText:Resources.TweetMessageText,u=ResourceManager.ResolveString(e,[i])):u=n._isEditMode?Resources.AuthorTweetMessageNoTitleText:Resources.TweetMessageNoTitleText;t.st_msg=u;t.st_via="";t.st_title=" ";break;case"st_sharethis_custom":case"st_sharethis_large":r?(o=Resources.EmailSubjectText,f=ResourceManager.ResolveString(o,[i])):f=Resources.EmailSubjectNoTitleText;t.st_title=f}return t},i.prototype.customGlyphArgs=function(){var n=this;return n._glyphButton},i.prototype.keyDown=function(n){var r=this,t,i;switch(n.keyCode){case KeyCodeType.SpaceKey:case KeyCodeType.EnterKey:return t=r.getSpanNode(),t&&(i=$(t).find(".stButton"),i&&i.click()),6}return 0},i.prototype.mouseClicked=function(n){var t=this,i;return n.type=="keydown"?(i=t.getSpanNode(),i&&$(i).click(),!!t._shouldBubbleMouseClick):(ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(t._buttonId,Diag.ULSCat.msoulscat_Story_InteractionModel)),!!t._shouldBubbleMouseClick)},i.prototype.shareThisWidgetHtmlDisposeInitArgs=function(){var n=this;return{context:n,onDispose:n.shareThisHtmlDisposer}},i.prototype.shareThisHtmlDisposer=function(n){var i=window.stlib,r,t,u;if(n&&i&&i.buttonInfo&&i.buttonInfo.buttonList)for(r=i.buttonInfo.buttonList,t=0;t<r.length;t++)if(u=r[t],u.element==n){r.splice(t,1);break}},i.prototype.getSpanNode=function(){var t=this,n=t.children[0];return n?n.domElement:null},i.prototype.setEnabled=function(n){var i=this;i._glyphButton&&i._glyphButton.setEnabled(n);t.prototype.setEnabled.call(this,n)},i.processedAttr="st_processed",i}(TDB.FocusableDomViewElement);n.ShareThisWidgetVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=n.Common,r=function(r){function u(i,u){var f,e;r.call(this,i,u.flyoutVisibleWatchable,1);f=this;f._shareThisInitialized=!1;f._lookupId=u.lookupId;f._dismissOnMouseLeave=TDB.watchableTag(7952159,f,!0);f._onFocusContext=u.onFocusContext;f._onFocusUpdated=u.onFocusUpdated;f._dismissTimer=new Utilities.ScheduledTimeout(this,250);f._showFacebook=u.showFacebook;f._showTwitter=u.showTwitter;CommonSettings.DeepSocialCounters&&CommonSettings.DeepSocialCounters[0]&&(f._socialLike=new t.ShareThisWidgetVE(f,{widgetClassName:CommonSettings.DeepSocialCounters[0],shouldBubbleMouseClick:u.shouldBubbleMouseClick,titleWatcher:u.titleWatcher,storyViewMode:u.storyViewMode}));CommonSettings.DeepSocialServices&&(e=[],CommonSettings.DeepSocialServices.forEach(function(n){e.push({widgetClassName:n,shouldBubbleMouseClick:u.shouldBubbleMouseClick,titleWatcher:u.titleWatcher,storyViewMode:u.storyViewMode})}),e.length>0&&(f._socialWidgets=new t.ShareThisWidgetGroupVE(f,e)));f._copyTextButton=null;Utilities.supportsClipboard()&&(f._copyTextButton=new t.TextButtonVE(f,{context:f,buttonId:244,click:f.onCopyTextButtonClick,text:Resources.SocialFlyoutCopyButton,cssClass:"dlgButton SocialFlyoutCopyTextButton",cssClassFocused:"dlgButtonFocused",cssClassHover:"dlgButtonHovered",cssClassPressed:"dlgButtonPressed",textClass:"dlgButtonText SocialFlyoutCopyText"}));f._copyTextBox=new t.TextBoxVE(f,{description:Resources.ShareByLinkTextBoxDescription,readOnly:!0,selectTextOnFocus:!0,text:n.Common.UrlHelper.getInstance().shareLinkUrl(u.lookupId),cssClass:f._copyTextButton?"SocialFlyoutCopyTextBoxWithButton":"SocialFlyoutCopyTextBox"});f.initialActiveChild=f._copyTextBox;f._embedCodeButton=new t.GlyphButtonVE(f,{description:Resources.EmbedSway,context:f,clipClass:Glyphs.PreviewSmallEmbedIconClip,glyphClass:Glyphs.PreviewSmallEmbedIconGlyph,buttonId:245,click:f.onEmbedCodeButtonClick,cssClass:"SocialFlyoutEmbedButton",text:Resources.SocialFlyoutEmbedButton,textClass:"SocialFlyoutEmbedButtonText",textPlacementRight:!0});f.shouldExternalEventBeHandled=u.shouldExternalEventBeHandled}return __extends(u,r),u.prototype.setDismissTimer=function(){var n=this;n._dismissTimer.set(function(){n.hide()})},u.prototype.canAutoDismiss=function(n){var t=this;return t._dismissOnMouseLeave.getWatchedValue(n)},u.prototype.initializeShareThis=function(n){var t=this;!t._shareThisInitialized&&SharingManager.IsShareThisReady.getWatchedValue(n)&&(window.stButtons.locateElements(),t._shareThisInitialized=!0)},u.prototype.isShareThisReadyArgs=function(n){return SharingManager.IsShareThisReady.getWatchedValue(n)},u.prototype.buttonGroupsArgs=function(){var i=this,n=[];return i._showFacebook&&n.push(new t.GlyphButtonVE(this,{label:14,context:this,click:SharingManager.facebookFallbackClickHandler,glyphClass:Glyphs.PreviewFacebookIconGlyph,hoverGlyphClass:Glyphs.PreviewFacebookHoverIconGlyph,clipClass:Glyphs.PreviewFacebookIconClip,description:Resources.ShareToFacebookButtonDescription,buttonId:255,onFocusUpdated:function(){},cssClass:"consumptionButton roundStyle"})),i._showTwitter&&n.push(new t.GlyphButtonVE(this,{label:15,context:this,click:SharingManager.twitterFallbackClickHandler,glyphClass:Glyphs.PreviewTwitterIconGlyph,hoverGlyphClass:Glyphs.PreviewTwitterHoverIconGlyph,clipClass:Glyphs.PreviewTwitterIconClip,description:Resources.ShareToTwitterButtonDescription,buttonId:259,onFocusUpdated:function(){},cssClass:"consumptionButton roundStyle"})),n},u.prototype.flyoutContentWrapperStyleArgs=function(n){var t=320,r=i.Environment.getInstance().getWindowSize(n);return r.w<400&&(t=r.w-68),{width:t+"px"}},u.prototype.flyoutContentWrapperEventsInitArgs=function(){var n=this;return{}},u.prototype.flyoutContentWrapperFadeVisibleInitArgs=function(){return{}},u.prototype.flyoutContentWrapperFadeVisibleArgs=function(n){var t=this;return{visible:t.isVisible(n)}},u.prototype.flyoutHeaderTextArgs=function(){return Resources.SocialFlyoutHeader},u.prototype.socialLikeArgs=function(){var n=this;return n._socialLike},u.prototype.socialWidgetsArgs=function(){var n=this;return n._socialWidgets},u.prototype.embedCodeArgs=function(){var n=this;return n._embedCodeButton},u.prototype.copyTextBoxArgs=function(){var n=this;return n._copyTextBox},u.prototype.copyTextButtonArgs=function(){var n=this;return n._copyTextButton},u.prototype.setFocusIsolation=function(n){var t=this,i;t._dismissTimer.clear();i=t.isVisible();i!=n&&(n?(t._onFocusContext&&t._onFocusUpdated&&t._onFocusUpdated.call(t._onFocusContext,!0),t.show()):t.hide())},u.prototype.mouseEnter=function(){var n=this;return n.setFocusIsolation(!0),!1},u.prototype.mouseLeave=function(){var n=this;return n._dismissOnMouseLeave.getValue()&&n.setFocusIsolation(!1),!1},u.prototype.onCopyTextButtonClick=function(){var n=this;return window.clipboardData&&window.clipboardData.setData&&window.clipboardData.setData("Text",n._copyTextBox.getText()),!1},u.prototype.onEmbedCodeButtonClick=function(){var n=this;return t.StoryShareAction.embed(n._lookupId),!1},u.prototype.mouseClicked=function(){var n=this;return TDB.applyUpdate(function(){n._dismissOnMouseLeave.setValue(!1)}),!1},u.prototype.onExitingUpdates=function(){var n=this;TDB.applyUpdate(function(){n._dismissOnMouseLeave.setValue(!0)},1)},u.prototype.onExiting=function(){var n=this;n.onExitingUpdates();r.prototype.onExiting.call(this)},u.prototype.isFlyoutActive=function(n){var t=this;return t.isVisible(n)&&!t._dismissOnMouseLeave.getWatchedValue(n)},u}(t.PopupBaseVE);t.SocialFlyoutVEBase=r})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t,i);var r=this;r.text=i.textWatchable||TDB.watchableTag(5830622,r,i.text?i.text:"");r._id=i.id?i.id:"";r._textClass=TDB.watchableTag(5830623,r,i.textClass?i.textClass:"");r.textClass=r._textClass;r._textHoverClass=TDB.watchableTag(5830624,r,i.textHoverClass?i.textHoverClass:"");r.textHoverClass=r._textHoverClass;r._textFocusedClass=TDB.watchableTag(5830625,r,i.textFocusedClass?i.textFocusedClass:"");r.textFocusedClass=r._textFocusedClass;r._textActiveClass=TDB.watchableTag(5830626,r,i.textActiveClass?i.textActiveClass:"");r.textActiveClass=r._textActiveClass;r._textDisabledClass=TDB.watchableTag(5906574,r,i.textDisabledClass?i.textDisabledClass:"");r.textDisabledClass=r._textDisabledClass;r.description=TDB.watchableTag(8982784,r,i.description);i.telemetry_id!=null&&(r._id=i.telemetry_id)}return __extends(t,n),t.prototype.textClassNameArgs=function(n){var t=this,e=n.watchValue(t.textClass),o=n.watchValue(t.enabled),i,r,u,f;if(o){if(t.isFocused(n)&&(i=n.watchValue(t.textFocusedClass),i!==""))return i;if(n.watchValue(t.isMouseOver)&&(r=n.watchValue(t.textHoverClass),r!==""))return r;if(n.watchValue(t.isActive)&&(u=n.watchValue(t.textActiveClass),u!==""))return u}else f=n.watchValue(t._textDisabledClass),f!==""&&(e=f);return e},t.prototype.wrapperClassNameArgs=function(n){var t=this;return t.getWrapperClass(n)},t.prototype.wrapperAttrArgs=function(n){var t=this,i=n.watchValue(t.description);return t.getButtonWrapperAttributes(n,i,{title:i,id:t.telemetry_id,disabled:n.watchValue(t.enabled)?undefined:"true"})},t.prototype.wrapperEventsInitArgs=function(){var n=this;return{mouseover:n.mouseOver,mouseout:n.mouseOut}},t.prototype.wrapperStyleArgs=function(n){var t=this;return n.watchValue(t.style)},t.prototype.textTextArgs=function(n){var t=this;return n.watchValue(t.text)},t.prototype.setTextClass=function(n){var t=this;if(t.textClass!==t._textClass)throw new Error("Cannot set the text class if it has been overridden.");t._textClass.setValue(n)},t.prototype.setTextHoverClass=function(n){var t=this;if(t.textHoverClass!==t._textHoverClass)throw new Error("Cannot set the text hover class if it has been overridden.");t._textHoverClass.setValue(n)},t.prototype.setTextFocusedClass=function(n){var t=this;if(t.textFocusedClass!==t._textFocusedClass)throw new Error("Cannot set the text focused class if it has been overridden.");t._textFocusedClass.setValue(n)},t}(n.ButtonVE);n.TextButtonVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(t){var i=function(i){function r(n,t){i.call(this,n);this._buttonVE=null;var r=this;r._args=t;r._isLink=t.link;r.createButton()}return __extends(r,i),r.prototype.onButtonClick=function(t){var i=this;if(i._args.dismissOnAction!==!1)n.Common.DialogManager.closeCurrentDialog(function(){if(i._args.onAction)i._args.onAction(t,i._args)});else if(i._args.onAction)i._args.onAction(t,i._args);return!1},r.prototype.createButton=function(){var n=this,r,i;if(n.setFocusable(n._isLink),n._args.isNeutralButton){i={buttonId:123,context:n,click:n.onButtonClick,text:n._args.caption,cssClass:"dlgButtonNeutral segoeUI",cssClassActive:"dlgButtonNeutralActive",cssClassFocused:"dlgButtonNeutralFocused",cssClassHover:"dlgButtonNeutralHovered",cssClassPressed:"dlgButtonNeutralPressed",id:n._args.id,textClass:"dlgButtonText"};n._buttonVE=new t.TextButtonVE(n,i);return}if(n._args.isCheckbox){r={buttonId:123,context:n,click:n.onButtonClick,text:n._args.caption,cssClass:"dlgButton segoeUI",cssClassActive:"dlgButtonActive",cssClassFocused:"dlgButtonFocused",cssClassHover:"dlgButtonHovered",cssClassPressed:"dlgButtonPressed",id:n._args.id,textClass:"dlgButtonText"};n._buttonVE=new t.RegularCheckboxVE(n,r);return}n._isLink||(i={buttonId:123,context:n,click:n.onButtonClick,text:n._args.caption,cssClass:"dlgButton segoeUI",cssClassActive:"dlgButtonActive",cssClassFocused:"dlgButtonFocused",cssClassHover:"dlgButtonHovered",cssClassPressed:"dlgButtonPressed",id:n._args.id,textClass:"dlgButtonText"},n._buttonVE=new t.TextButtonVE(n,i))},r.prototype.isLinkArgs=function(){var n=this;return!!n._isLink},r.prototype.buttonArgs=function(){var n=this;return n._buttonVE},r.prototype.getArgs=function(){var n=this;return n._args},r.prototype.spanTextArgs=function(){var n=this;return n._args.caption},r.prototype.spanEventsInitArgs=function(){var n=this;return{click:n.onButtonClick}},r.prototype.FocusableInitArgs=function(){var n=this;return n._buttonVE?n._buttonVE.FocusableInitArgs():i.prototype.FocusableInitArgs.call(this)},r.prototype.setFocus=function(){var n=this;n._buttonVE?n._buttonVE.setFocus():n.setFocus()},r.prototype.isFocused=function(n){var t=this;return t._buttonVE?t._buttonVE.isFocused(n):i.prototype.isFocused.call(this,n)},r}(TDB.FocusableDomViewElement);t.DialogButtonVEBase=i})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t);this._message=null;var r=this;r._message=i.message}return __extends(t,n),t.prototype.contentParagraphTextArgs=function(){var n=this;return n._message},t}(TDB.FocusableViewElement);n.DialogMessageVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t);this._html=null;this._iframe={};this._isIframeVisible=!1;var r=this;i.innerHTML&&(r._html={innerHTML:i.innerHTML});i.iframe&&(r._isIframeVisible=!0,r._iframe=i.iframe)}return __extends(t,n),t.prototype.htmlContentsPropsArgs=function(){var n=this;return n._html},t.prototype.iframeContentsIframeArgs=function(){var n=this;return n._iframe},t.prototype.ifIframeContentsArgs=function(){var n=this;return n._isIframeVisible},t}(TDB.FocusableViewElement);n.DialogHtmlContainerVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t){n.call(this,t)}return __extends(t,n),t.prototype.loadingSpinnerAttrArgs=function(){return{src:CommonSettings.ContentBaseUrl+"loadingblackspinner.gif"}},t}(TDB.ViewElement);n.DialogLoadingSpinnerVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(t){(function(n){n[n.Question=1]="Question";n[n.Info=2]="Info";n[n.Warning=3]="Warning";n[n.Error=4]="Error"})(t.DialogType||(t.DialogType={}));var r=t.DialogType,i=function(i){function r(n,r){i.call(this,n);this._defaultFrostOpacity="0.25";this._allowCancel=!0;this._animationDuration=t.DialogVE._animateDuration;this._defaultButtonVE=null;var u=this;u._args=r;u._title=TDB.watchableTag(6362250,u,r.title);u._buttonsArgs=r.buttonsArgs;u._messages=r.messages?r.messages:[];u._messageVEs=TDB.watchableTag(6156813,u,[]);u._buttonVEs=TDB.watchableTag(6156814,u,[]);u._frostOpacity=TDB.watchableTag(6156815,u,r.frostOpacity?r.frostOpacity.toString():u._defaultFrostOpacity);u._isPositionChanged=TDB.notifierTag(6156817,u);r.allowCancel!==undefined&&(u._allowCancel=!!r.allowCancel);u._createMessageVEs(u._messages);u._createButtonVEs(u._buttonsArgs);u._contentVE=TDB.watchableTag(6156818,u,r.contentVE?r.contentVE:null)}return __extends(r,i),r.prototype.centerDialog=function(){var n=this;TDB.applyUpdate(function(){n._isPositionChanged.notify()})},r.prototype._createButtonVEs=function(n){var r=this,f=r._buttonVEs.getValue(),i,u;if(f.splice(0,f.length),n)for(i=0;i<n.length;i++)u=new t.DialogButtonVE(r,n[i]),r.addResource(u),f.push(u),n[i].isDefault&&(r._defaultButtonVE=u)},r.prototype._createMessageVEs=function(n){var u=this,r=u._messageVEs.getValue(),e,i,f;if(r.length>0)for(i=r.length-1;i>=0;i--)e=r[i],r.splice(i),e.dispose();if(n)for(i=0;i<n.length;i++)f=new t.DialogMessageVE(u,{message:n[i]}),u.addResource(f),r.push(f)},r.prototype._createContentVE=function(n){var t=this,i=t._contentVE.getValue();i&&i.dispose();TDB.applyUpdate(function(){t._contentVE.setValue(n);t.addResource(n)})},r.prototype.dialogWrapperStyleArgs=function(){var n=this,t={};return n._args.width&&(t={width:n._args.width+"px",paddingLeft:"22px",paddingRight:"22px"}),t},r.prototype.dialogWrapperCenterInitArgs=function(){var n=this;return{vertical:!0,horizontal:!!n._args.width}},r.prototype.dialogWrapperCenterArgs=function(n){var t=this;return n.watch(t._isPositionChanged),!0},r.prototype.titleTextArgs=function(n){var t=this;return t.getTitleText(n)},r.prototype.ifTitleArgs=function(n){var i=this,t=i.getTitleText(n);return t&&t.length>0},r.prototype.buttonsArgs=function(){var n=this;return n._buttonVEs},r.prototype.dialogMessageArgs=function(){var n=this;return n._messageVEs},r.prototype.contentArgs=function(){var n=this;return n._contentVE},r.prototype.frostAttrArgs=function(n){var t=this;return{opacity:n.watchValue(t._frostOpacity)}},r.prototype.frostEventsInitArgs=function(){var n=this;return{click:function(){return n._args.lightDismiss&&n.cancel(),!1}}},r.prototype.show=function(){var n=this,t;n._args.onShowing&&n._args.onShowing();n.centerDialog();i.prototype.show.call(this);t="";n._args.messages&&n._args.messages.length>0&&(t=n._args.messages[0]);ActionLogger.RecordClientAction(new ClientAction.DialogShownData(n._args.title,t,n._args.dialogType,n._args.dialogLogMessage))},r.prototype.close=function(n){var t=this;t.hide();n&&n();t._args.onClose&&t._args.onClose()},r.prototype.cancel=function(){var n=this;n.close(n._args.onCancel)},r.prototype.onEscape=function(){var n=this;n.cancel()},r.prototype.onExiting=function(){i.prototype.onExiting.call(this);var t=this;n.Common.DialogManager.removeDialog(t)},r.prototype.shouldExit=function(n){var t=this;return!n||t._allowCancel},r.prototype.updateContentMessage=function(n){var t=this;t._createMessageVEs(n);TDB.applyUpdate(function(){return t._messageVEs.notify()})},r.prototype.updateContent=function(n){var t=this;t._createContentVE(n)},r.prototype.getContent=function(n){var t=this;return t._contentVE.getWatchedValue(n)},r.prototype.updateButtons=function(n){var t=this;t._createButtonVEs(n);TDB.applyUpdate(function(){t._buttonVEs.notify()})},r.prototype.updateDialog=function(n){var t=this;n&&TDB.applyUpdate(function(){n.buttonsArgs&&(t._createButtonVEs(n.buttonsArgs),t._buttonVEs.notify());n.title&&t._title.setValue(n.title);n.messages&&(t._createMessageVEs(n.messages),t._messageVEs.notify());n.contentVE!==undefined&&t._createContentVE(n.contentVE)})},r.prototype.getTitleText=function(n){var t=this;return t._title.getWatchedValue(n)},r.prototype.setOnShowingCallback=function(n){var t=this;t._args.onShowing=n},r.prototype.setOnCloseCallback=function(n){var t=this;t._args.onClose=n},r.prototype.setFocusOnDefaultButton=function(){var n=this;n._defaultButtonVE&&n._defaultButtonVE.setFocus()},r.prototype.getButtons=function(){var n=this;return n._buttonsArgs},r.prototype.handleMouseEvent=function(){return!1},r.prototype.wrapperFadeVisibleInitArgs=function(){return{}},r.prototype.wrapperFadeVisibleArgs=function(n){var t=this;return{visible:t.isVisible(n)}},r.prototype.wrapperEventsInitArgs=function(){var n=this;return{}},r.prototype.wrapperCssArgs=function(){var n=this,t={dlgWrapperClass:!0};return n._args.css&&(t[n._args.css]=!0),t},r.prototype.add=function(n,t,r){i.prototype.add.call(this,n,t,r);i.prototype.show.call(this)},r._animateEaseIn="easeInBack",r._animateEaseOut="easeOutBack",r._animateResize="easeInSine",r._animateDuration=750,r}(t.PopupBaseVE);t.DialogVEBase=i})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t){n.call(this,t);var i=this}return __extends(t,n),t.prototype.inputFilePickerAttrArgs=function(){var n=this;return{accept:DocumentIngestion.DocumentIngestionAPI.getSupportedExtensionsList()}},t.prototype.inputFilePickerAutoUploadInitArgs=function(){var n=this;return{filesReadyForUpload:n.filesReadyForUpload}},t.prototype.filesReadyForUpload=function(n){var i=this,t=new ClientAction.SimpleClientActionData(155,Diag.ULSCat.msoulscat_Story_Site);t.setContext({FileSize:n[0].size,FileType:n[0].type,FileExtension:DocumentIngestion.DocumentIngestionAPI.getFileExtension(n[0].name)});ActionLogger.RecordClientAction(t);DocumentIngestion.DocumentIngestionAPI.CreateStoryFromDocument(new FileObject(n[0]))},t}(TDB.FocusableViewElement);n.DocIngestionFileInputVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=n.Common,r=function(){function r(n,t,i,u){var f=this;f.storyId=n;f.storyTitle=t;f.onDuplication=u;f.myStoriesUrl=i;r.dialogTitle=Resources.DuplicateStoryDialogTitle}return r.createAndShow=function(n,t,i,u){new r(n,t,i,u).show()},r.prototype.show=function(){var n=this,i={title:r.dialogTitle,acceptButtonText:Resources.DuplicateStoryDialogDuplicateButton,initialValue:n.storyTitle,textInputDescription:Resources.DuplicateStoryDialogDescription,textInputCss:"DuplicateStoryDialogTextInput",context:this,onAccept:function(){n.duplicate()},allowEsc:!0};n._dlg=t.TextInputDialog.createAndShow(i)},r.prototype.duplicate=function(){var i=this,f=i._dlg.getContent(),e=f.value.getValue(),u;n.View.Common.DialogManager.closeCurrentDialog();t.ProgressDialog.createAndShow(r.dialogTitle);u={title:e};$.ajax(n.Common.UrlHelper.getInstance().duplicateStoryUrl(i.storyId),{name:"DuplicatingStory",description:"Duplicating a story",type:"POST",data:JSON.stringify(u),contentType:n.RequestManager.JsonContentType,dataType:"json",success:function(n){if(r.updateDuplicationResponse&&(n=r.updateDuplicationResponse(n)),i.onDuplication&&n.storyTile)i.onDuplication(n.storyTile);i.showSuccess(n)},error:function(n,t,r){i.showError(t,r)}})},r.prototype.showSuccess=function(t){var f=this,u;n.View.Common.DialogManager.closeCurrentDialog();u={title:r.dialogTitle,noFocus:!1,dialogType:2,lightDismiss:!0};u.messages=[Resources.DuplicateStoryDialogSuccessMessage];u.buttonsArgs=[{caption:Resources.DuplicateStoryDialogEditButton,isDefault:!0,onAction:function(){i.UserStories.getInstance().onLoadingStory(t.id)&&(window.location.href=t.url)}}];f.myStoriesUrl&&u.buttonsArgs.push({caption:Resources.DuplicateStoryDialogMyStoriesButton,onAction:function(){window.location.href=f.myStoriesUrl}});f._dlg=n.View.Common.DialogManager.createAndShow(u)},r.prototype.showError=function(){var i=this,t;n.View.Common.DialogManager.closeCurrentDialog();t={title:r.dialogTitle,noFocus:!1,dialogType:2,lightDismiss:!0};t.messages=[Resources.DuplicateStoryDialogGenericError];t.buttonsArgs=[{caption:Resources.ButtonOK,isDefault:!0,dismissOnAction:!0}];i._dlg=n.View.Common.DialogManager.createAndShow(t)},r}();t.DuplicateStoryDialog=r})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t);var r=this;r._model=i;r._model.playerEvents.onError||(r._model.playerEvents.onError=r.onError)}return __extends(t,n),t.prototype.playerYouTubePlayerCreateArgs=function(n){var t=this,i=t._model.context;return{playerCallback:t.playerCallback,playerCallbackContext:t,playerEvents:t._model.playerEvents,playerEventsContext:t._model.context,playerParams:t._model.playerParams,videoId:t._model.getVideoId.call(i,n)}},t.prototype.playerYouTubePlayerResizeArgs=function(n){var t=this,i=t._model.context;return{width:t._model.getWidth?t._model.getWidth.call(i,n):-1,height:t._model.getHeight?t._model.getHeight.call(i,n):-1}},t.prototype.playerCallback=function(n){var t=this;t._player=n},t.prototype.playVideo=function(){var n=this;if(!n._player)throw new Error("Player has not yet been instantiated");n._player.playVideo()},t.prototype.pauseVideo=function(){var n=this;if(!n._player)throw new Error("Player has not yet been instantiated");n._player.pauseVideo()},t.prototype.stopVideo=function(){var n=this;if(!n._player)throw new Error("Player has not yet been instantiated");n._player.stopVideo()},t.prototype.seekVideo=function(n){var t=this;if(!t._player)throw new Error("Player has not yet been instantiated");t._player.seekTo(n,!0)},t.prototype.onError=function(n){var t="",i="";switch(n.data){case 2:t="The request contains an invalid parameter value.";i="For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.";break;case 5:t="The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.";break;case 100:t="The video requested was not found.";i="This error occurs when a video has been removed (for any reason) or has been marked as private.";break;case 101:t="The owner of the requested video does not allow it to be played in embedded players.";i="See http://apiblog.youtube.com/2011/12/understanding-playback-restrictions.html for more information.";break;case 150:t="The owner of the requested video does not allow it to be played in embedded players.";i="Google indicates this error as the same as 101. See http://apiblog.youtube.com/2011/12/understanding-playback-restrictions.html for more information.";break;default:t="unknown"}StoryLog.StructuredTraceTag(7422341,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Youtube player error",{url:this._player&&this._player.getVideoUrl?this._player.getVideoUrl():this._model&&this._model.getVideoPlayerDescriptor(),data:n.data.toString(),description:t,moreinfo:i})},t.prototype.playerWrapperClassNameArgs=function(){var n=this;return n._model.cssName},t.prototype.loadNewVideo=function(n){var t=this;if(!t._player||!t._player.loadVideoById)throw new Error("Player has not yet been instantiated");t._player.loadVideoById(n)},t}(TDB.ViewElement);n.YouTubePlayerVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={}));var FileObject=function(){function n(n,t){t===void 0&&(t="");n.name?this.createFromFile(n):this.createFromBlob(n,t)}return n.prototype.createFromBlob=function(n,t){this.blob=n;this.filename=t;this.lastModifiedDate=new Date},n.prototype.createFromFile=function(n){this.blob=n;this.filename=n.name;this.lastModifiedDate=n.lastModifiedDate},n.prototype.getName=function(){return this.filename},n.prototype.getType=function(){return this.blob.type},n.prototype.getBlob=function(){return this.blob},n.prototype.getSize=function(){return this.blob.size},n.prototype.getModelId=function(){return this.modelId},n.prototype.setModelId=function(n){this.modelId=n},n.createFileObjects=function(t){for(var r=[],i=0;i<t.length;i++)r.push(new n(t[i]));return r},n}(),FocusableViewElementObjectOM=function(n){function t(t){n.call(this,t);var i=this;i._id=IdGenerator.generate()}return __extends(t,n),t}(TDB.FocusableViewElement),FocusablePanelViewElementObjectOM=function(n){function t(t,i){n.call(this,t,i);var r=this;r._id=IdGenerator.generate()}return __extends(t,n),t}(TDB.FocusablePanelViewElement),StoryApp;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t,i)}return __extends(t,n),t.prototype.wrapperClassNameArgs=function(n){var t=this;return t.getWrapperClass(n)},t.prototype.wrapperEventsInitArgs=function(){var n=this;return{mouseover:n.mouseOver,mouseout:n.mouseOut}},t.prototype.wrapperStyleArgs=function(n){var t=this;return n.watchValue(t.style)},t.prototype.labelClassNameArgs=function(){return"CheckboxVELabel"},t.prototype.labelTextArgs=function(){var n=this;return n.getLabel()},t.prototype.checkboxCheckedInitArgs=function(){var n=this;return n._isChecked},t}(n.CheckboxVE);n.RegularCheckboxVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))})(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n,i){t.call(this,n,i);var r=this;r.descriptionDefault=i.descriptionDefault;r.descriptionChecked=i.descriptionChecked;r.descriptionUnchecked=i.descriptionUnchecked;r.descriptionUndefined=i.descriptionUndefined;r.cssClassCheckbox=i.cssClassCheckbox;r.richTextElementsChecked=i.richTextElementsChecked?i.richTextElementsChecked:[];r.richTextElementUnchecked=i.richTextElementsUnchecked?i.richTextElementsUnchecked:[]}return __extends(i,t),i.prototype.getCheckboxDescription=function(n){var t=this,i=t.getChecked(n)?t.descriptionChecked:t.descriptionUnchecked;return i?i:t.descriptionDefault},i.prototype.getCheckboxAttributes=function(n){var t=this;return t.getCheckboxWrapperAttributes(n,t.getChecked(n))},i.prototype.isFocusable=function(){return!1},i.prototype.wrapperClassNameArgs=function(n){var t=this;return t.getWrapperClass(n)},i.prototype.wrapperEventsInitArgs=function(){var n=this;return{mouseover:n.mouseOver,mouseout:n.mouseOut}},i.prototype.wrapperStyleArgs=function(n){var t=this;return n.watchValue(t.style)},i.prototype.ifButtonWrapperArgs=function(n){var r=this,i=t.prototype.ifButtonWrapperArgs.call(this,n);return i||(r.checkbox=null),i},i.prototype.checkboxArgs=function(){var t=this,i={description:t.descriptionDefault,buttonId:t.getButtonId(),clipClass:Glyphs.CardDeckCheckboxSelectedClip,cssClass:t.cssClassCheckbox,role:Aria.Roles.Checkbox};return t.checkbox=new n.GlyphButtonVE(t,i),t.checkbox.glyphClass=TDB.watcherTag(8971411,t,t.checkbox,t.checkmarkGlyphClass),t.checkbox.description=TDB.watcherTag(8987808,t,t.checkbox,t.getCheckboxDescription),t.checkbox.attr=TDB.watcherTag(8987809,t,t.checkbox,t.getCheckboxAttributes),t.checkbox.visible=t.visible,t.checkbox},i.prototype.checkmarkGlyphClass=function(n){var t=this,r=t.getChecked(n),i=t.checkbox.isMouseOver.getWatchedValue(n);return r?i?Glyphs.CardDeckCheckboxSelectedHoverGlyph:t.checkbox.isFocused(n)?Glyphs.CardDeckCheckboxSelectedStandardGlyph:Glyphs.CardDeckCheckboxSelectedGlyph:i?Glyphs.CardDeckCheckboxHoverGlyph:t.checkbox.isFocused(n)?Glyphs.CardDeckCheckboxKeyboardGlyph:Glyphs.CardDeckCheckboxUncheckedGlyph},i.prototype.messagePartsArgs=function(n){var t=this;return t.isChecked.getWatchedValue(n)?t.richTextElementsChecked:t.richTextElementUnchecked},i.prototype.labelEventsInitArgs=function(){var n=this;return{click:n.onAction}},i.prototype.setEnabled=function(n){var i=this;i.checkbox&&i.checkbox.setEnabled(n);t.prototype.setEnabled.call(this,n)},i.prototype.dispose=function(){var n=this;for(var i in n.richTextElementsChecked)n.richTextElementsChecked[i].dispose();for(i in n.richTextElementUnchecked)n.richTextElementUnchecked[i].dispose();t.prototype.dispose.call(this)},i}(n.CheckboxVE);n.RichCheckboxVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){n.call(this,t);var r=this;r._context=i.context;r._wrapperClass=i.wrapperClass;r._inputClass=i.inputClass;r._labelClass=i.labelClass;r._textClass=i.textClass;r._explanationClass=i.explanationTextClass;r._id=i.id;r._radioGroupName=i.radioGroupName;r._text=i.text;r._explanationText=i.explanationText;r._click=i.click;r.Checked=TDB.watchableTag(7611014,r,i.initiallyChecked)}return __extends(t,n),t.prototype.hasExplanationArgs=function(){return!!this._explanationText},t.prototype.wrapperClassNameArgs=function(){return this._wrapperClass},t.prototype.keyDown=function(n){var i=this,t=0;switch(n.keyCode){case KeyCodeType.EnterKey:t=i.onAction(n);break;case KeyCodeType.SpaceKey:t=i.onAction(n)}return t},t.prototype.mouseDown=function(n){var t=this;t.onAction(n);return!1},t.prototype.onAction=function(n){var t=this;if(TDB.applyUpdate(function(){t.Checked.setValue(!0)}),t._context&&t._click)t._click.call(t._context,n);else return 0;return 6},t.prototype.inputClassNameArgs=function(){return this._inputClass},t.prototype.labelClassNameArgs=function(){return this._labelClass},t.prototype.textClassNameArgs=function(){return this._textClass},t.prototype.explanationClassNameArgs=function(){return this._explanationClass},t.prototype.inputPropsArgs=function(){var n=this;return{id:n._id,name:n._radioGroupName}},t.prototype.labelAttrArgs=function(){var n=this;return{"for":n._id}},t.prototype.textTextArgs=function(){return this._text},t.prototype.explanationTextArgs=function(){return this._explanationText},t.prototype.inputEventsInitArgs=function(){var n=this;return{click:n._click.bind(n._context)}},t.prototype.inputCheckedInitArgs=function(){return this.Checked},t}(TDB.FocusableDomViewElement);n.RadioButtonVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(){}return n}();n.Answer=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(){}return n}();n.CheckboxAnswer=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){(function(n){n[n.Checkbox=1]="Checkbox"})(n.QuestionType||(n.QuestionType={}));var i=n.QuestionType,t=function(n){function t(t,i){n.call(this,t);var r=this;r.parent=t;r._args=i}return __extends(t,n),t.prototype.getAnswer=function(){throw new Error("called an abstract method");},t.prototype.ifQuestionTitleArgs=function(){var n=this;return!!n._args.question},t.prototype.questionTitleClassNameArgs=function(){return"SurveyQuestionTitle"},t.prototype.questionTitleTextArgs=function(){var n=this;return n._args.question},t.prototype.ifQuestionSubtitleArgs=function(){var n=this;return!!n._args.questionSubtitle},t.prototype.questionSubtitleClassNameArgs=function(){return"SurveyQuestionSubtitle"},t.prototype.questionSubtitleTextArgs=function(){var n=this;return n._args.questionSubtitle},t.prototype.ifQuestionExplanationArgs=function(){var n=this;return!!n._args.questionExplanation},t.prototype.questionExplanationClassNameArgs=function(){return"SurveyQuestionExplanation"},t.prototype.questionExplanationTextArgs=function(){var n=this;return n._args.questionExplanation},t}(TDB.FocusableViewElement);n.QuestionVE=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(i,r){var u,o,f,e;for(t.call(this,i,r),u=this,r.hasTextBox&&(o={placeholder:r.textBoxPlaceholder,selectTextOnFocus:!0,cssClass:r.textBoxCss?r.textBoxCss:"SurveyQuestionTextBox",maxLength:r.textBoxLength?r.textBoxLength:100,description:Resources.SurveyQuestionTextBoxDescription},u._textBox=new n.TextBoxVE(u,o),u._textBoxLabel=r.textBoxLabel),u._checkboxes=[],f=0;f<r.checkboxOptions.length;f++)e={buttonId:101,text:r.checkboxOptions[f]},r.hasTwoColumns&&(e.cssClass="SurveyQuestionCheckboxTwoColumnsWidth"),u._checkboxes.push(new n.RegularCheckboxVE(u,e));u._hasTwoColumns=r.hasTwoColumns}return __extends(i,t),i.prototype.getSelectedValues=function(){var n=this,t={};return n._checkboxes&&n._checkboxes.forEach(function(n){t[n.getLabel()]=n.isChecked.getValue()}),t},i.prototype.getTextBoxValue=function(){var n=this;return n._textBox?n._textBox.getText():""},i.prototype.getAnswer=function(){var i=this,t=new n.CheckboxAnswer;return t.checkboxOptions=i.getSelectedValues(),t.textboxValue=i.getTextBoxValue(),t},i.prototype.ifTextBoxArgs=function(){var n=this;return!!n._textBox},i.prototype.textBoxOptionClassNameArgs=function(){var n=this;return n._hasTwoColumns?"SurveyQuestionCheckboxTwoColumnsWidth":""},i.prototype.textBoxLabelClassNameArgs=function(){return"SurveyQuestionTextBoxText"},i.prototype.textBoxLabelTextArgs=function(){var n=this;return n._textBoxLabel},i.prototype.checkboxOptionsArgs=function(){var n=this;return n._checkboxes},i.prototype.textBoxArgs=function(){var n=this;return n._textBox},i}(n.QuestionVE);n.CheckboxQuestionVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(i,r){var u,f,e,o;for(t.call(this,i),u=this,u.parent=i,u._args=r,u._questionVEs={},f=0;f<u._args.questions.length;f++)e=u._args.questions[f],e.questionType==1&&(o=e,u._questionVEs[e.id]=new n.CheckboxQuestionVE(u,o))}return __extends(i,t),i.prototype.questionBoxesArgs=function(){var n=this,t=[];for(var i in n._questionVEs)t.push(n._questionVEs[i]);return t},i.prototype.getAnswers=function(){var n=this,t={};for(var i in n._questionVEs)t[i]=n._questionVEs[i].getAnswer();return t},i}(TDB.FocusableViewElement);n.SurveyBoxVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t){n.call(this,t);var i=this;i.selected=TDB.watchableTag(7893464,i,!1);i.visible=TDB.watchableTag(7893465,i,!0)}return __extends(t,n),t.prototype.tabClicked=function(){var n=this;return n.parent.tabClicked(n),!1},t}(TDB.FocusableViewElement);n.TabVE=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){var r=this;n.call(this,t);r._args=i;r._selectedTab=TDB.watchableTag(7893460,r,null);r._tabs=TDB.mappedWatcherOwnerTag(7893461,r,r,r.getTabKeys,r.tabConstructor);r._previouslySelectedTabIndex=-1}return __extends(t,n),t.prototype.tabsArgs=function(){var n=this;return n._tabs},t.prototype.getTabKeys=function(n){var t=this;return t._args.getTabKeys.call(t._args.context,n)},t.prototype.tabConstructor=function(n){var t=this,i=t._args.tabConstructor.call(t._args.context,t,n);if(i.parent!==t)throw new Error("The parent of the TabVE must be set to the this TabsVE.");return i},t.prototype.tabClicked=function(n){var t=this,i=t._tabs.getValue(),u=i.length,r=i.indexOf(n);t.selectTabIndex(r)},t.prototype.selectTabIndex=function(n){var t=this;t.changeStateOfTabIndex(n);t._args.tabSelected!==undefined&&t._args.tabSelected.call(t._args.context,n)},t.prototype.changeStateOfTabIndex=function(n){var t=this,i=t._tabs.getValue(),r=i.length;if(n<0||n>=i.length)throw new Error("Invalid tab index.");TDB.applyUpdate(function(){var r=t._selectedTab.getValue();r&&r.selected.setValue(!1);t._previouslySelectedTabIndex=i.indexOf(r);t._selectedTab.setValue(i[n]);t._selectedTab.getValue().selected.setValue(!0)})},t.prototype.getSelectedTabIndex=function(n){var t=this,i=t._selectedTab.getWatchedValue(n),r;return i?(r=n!=undefined?n.watchValue(t._tabs):t._tabs.getValue(),r.indexOf(i)):-1},t.prototype.getPreviouslySelectedTabIndex=function(){var n=this;return n._previouslySelectedTabIndex},t}(TDB.FocusableViewElement);n.TabHeaderVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){var r=this;n.call(this,t);r._args=i;r._rootTabs=TDB.mappedWatcherOwnerTag(7893462,r,r,r.getRootTabKeys,r.tabConstructor);r._breadcrumbs=TDB.watchableTag(7893463,r,[])}return __extends(t,n),t.prototype.tabsArgs=function(){var n=this;return n._rootTabs},t.prototype.breadcrumbsArgs=function(){var n=this;return n._breadcrumbs},t.prototype.getRootTabKeys=function(n){var t=this;return t._args.getRootTabKeys.call(t._args.context,n)},t.prototype.tabConstructor=function(n){var t=this,i=t._args.tabConstructor.call(t._args.context,t,n);if(i.parent!==t)throw new Error("The parent of the TabVE must be set to the this TabsVE.");return i},t.prototype.tabClicked=function(n){var t=this,i=t._rootTabs.getValue(),u=i.indexOf(n),o=i.length;if(u>=0)TDB.applyUpdate(function(){t._breadcrumbs.setValue([]);t.selectRootTabIndex(u)}),t._args.tabSelected!==undefined&&t._args.tabSelected.call(t._args.context,u,0);else{var f=t._breadcrumbs.getValue(),r=f.indexOf(n),e=i.indexOf(t._selectedRootTab);if(r<0)throw new Error("Selected unknown tab.");TDB.applyUpdate(function(){for(var n=0;n<o;n++)i[n].visible.setValue(e===n);f.splice(r+1);t._breadcrumbs.notify();f[r].selected.setValue(!0)});t._args.tabSelected!==undefined&&t._args.tabSelected.call(t._args.context,e,r+1)}},t.prototype.selectRootTabIndex=function(n){var t=this,i=t._rootTabs.getValue(),r=i.length;if(n<0||n>=i.length)throw new Error("Invalid tab index.");TDB.applyUpdate(function(){for(var u=0;u<r;u++)i[u].visible.setValue(!0);t._selectedRootTab&&t._selectedRootTab.selected.setValue(!1);t._breadcrumbs.setValue([]);t._selectedRootTab=i[n];t._selectedRootTab.selected.setValue(!0)});t._args.tabSelected!==undefined&&t._args.tabSelected.call(t._args.context,n,0)},t.prototype.selectedRootTabIndex=function(){var n=this;return n._selectedRootTab?n._rootTabs.getValue().indexOf(n._selectedRootTab):-1},t.prototype.navigateBack=function(){var n=this,t=n._breadcrumbs.getValue();t.length!==0&&(t.length===1?n.tabClicked(n._selectedRootTab):n.tabClicked(t[t.length-2]))},t.prototype.addBreadcrumb=function(n){var t=this,i,r;t._selectedRootTab&&(i=t._rootTabs.getValue(),r=i.length,TDB.applyUpdate(function(){for(var e,f,o,u=0;u<r;u++)i[u].visible.setValue(i[u]===t._selectedRootTab);for(e=t.tabConstructor(n),e.selected.setValue(!0),f=t._breadcrumbs.getValue(),f.push(e),t._breadcrumbs.notify(),t._selectedRootTab.selected.setValue(!1),o=f.length,u=0;u<o-1;u++)f[u].selected.setValue(!1)}))},t}(TDB.FocusableViewElement);n.TabPathHeaderVEBase=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=n.View.ViewElements,r=function(n){function t(t,r){var u=this,f;n.call(this,t);u._args=r;f={buttonId:19,text:r.text,context:u,click:u.tabClicked};u._textButtonVE=new i.TextButtonVE(u,f);u._textButtonVE.cssClass=TDB.watcherTag(7893466,u,u,u.textClass);u._textButtonVE.visible=u.visible}return __extends(t,n),t.prototype.textButtonVEArgs=function(){var n=this;return n._textButtonVE},t.prototype.textClass=function(n){var i=this,t=i._args.cssClass;return i._args.text==null&&(t!==""&&(t+=" "),t+="BasicContentPageTabInvisible"),n.watchValue(i.selected)&&(t!==""&&(t+=" "),t+=i._args.selectedClass),t},t}(t.TabVE);t.TextTabVEBase=r})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(i){var r=n.Common,u=function(n){function u(t){n.call(this,t);var i=this;i.createAppBar()}return __extends(u,n),u.prototype.notificationBarArgs=function(n){return t.Common.NotificationBarManager.getInstance().getCurrentNotificationBar(n)},u.prototype.createAppBar=function(){var n=this,t;n._appBar=new i.AppBarVE(n,{userState:r.UserState.getInstance(),isEditMode:!1});t=n._appBar.getOverflowMenu();n._appBar.addInternalFeaturesButton();t.addInternalFeaturesButton();CommonSettings.IsAuthenticated?CommonSettings.IsEnabled?r.Environment.getInstance().shouldShowAuthoringEntrypoints()?(n._appBar.addMyStoriesButton(),n._appBar.addTutorialVideosButton(),n._appBar.addOverflowButton(),t.addMyStoriesButton(),t.addCreateNewButton(),t.addFeedbackButton(),t.addUserButton(),t.addSignOutButton()):(n._appBar.addTutorialVideosButton(),n._appBar.addOverflowButton(),t.addMyStoriesButton(),t.addFeedbackButton(),t.addUserButton(),t.addSignOutButton()):(n._appBar.addTutorialVideosButton(),n._appBar.addFeedbackButton(),n._appBar.addUserButton(),t.addUserButton(),t.addSignOutButton()):(n._appBar.addTutorialVideosButton(),n._appBar.addSignInButton())},u.prototype.appBarArgs=function(){var n=this;return n.getAppBar()},u.prototype.getAppBar=function(){var n=this;return n._appBar},u}(TDB.FocusableViewElement);i.PageWithAppBarBaseVE=u})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var i=CommonBindings.View.Bindings,t=TDB.View.Bindings,fu=function(n){function t(t){this.constructing=!0;n.call(this,t);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new f.Cwrapper(u);i.add(this,n,t);r.push(i)},t}(n.AboutPaneVEBase),f,ri,e,ui,o,fi,s,ei,h,oi,c,si,l,hi,a,ci,v,li,y,ai,p,vi,w,yi,b,pi,k,wi,d,bi,g,ki,di,nt,gi,tt,nr,it,tr,rt,ir,ut,rr,ft,ur,et,fr,ot,er,st,or,ht,sr,ct,hr,lt,cr,at,lr,vt,ar,yt,vr,yr,pt,pr,wt,wr,bt,br,kt,kr,dt,dr,gt,gr,nu,ni,tu,r,iu,u,ru,ti,uu,ii;n.AboutPaneVE=fu,function(n){var l=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var e=this._context,o=document.createElement("div"),f;this.domElement=o;o._context=e;o.className="aboutPaneWrapper";this._AttrBinding=new t.Attr.Binding(o,r,e,this,e.wrapperAttrArgs);this._FocusableBinding=new t.Focusable.Binding(o,r,e,this,e.FocusableInitArgs());this._SlideVisibleBinding=new i.SlideVisible.Binding(o,r,e,this,e.wrapperSlideVisibleInitArgs(),e.wrapperSlideVisibleArgs);this.receivePhaseNotification(4);var s=null,h=this.children,f=new n.CpaneTitle(e);f.add(this,o,s);h.push(f);f=new n.C1(e);f.add(this,o,s);h.push(f);f=new n.C4(e);f.add(this,o,s);h.push(f);f=e.licenseTermsLinkArgs();f&&(f.add(this,o,s),h.push(f));f=e.thirdPartyLinkArgs();f&&(f.add(this,o,s),h.push(f));f=e.privacyLinkArgs();f&&(f.add(this,o,s),h.push(f));this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._FocusableBinding.update(n);this._SlideVisibleBinding.update(n)},u.prototype.disposeBindings=function(){this._FocusableBinding.dispose()},u}(TDB.ViewElement),r,u,f,e,o,s,h,c;n.Cwrapper=l;r=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="aboutPaneTitle";this._TextBinding=new t.Text.Binding(r,n,u,this,u.paneTitleTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CpaneTitle=r;u=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,r=document.createElement("div"),u;this.domElement=r;r._context=f;r.className="aboutTileWrapper";var e=null,o=this.children,u=new n.C2(f);u.add(this,r,e);o.push(u);u=new n.C3(f);u.add(this,r,e);o.push(u);this._addToDom(t,i)},i}(TDB.ViewElement);n.C1=u;f=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,r=document.createElement("center");this.domElement=r;r._context=u;var e=this.children,f=new n.Cpicture(u);f.add(this,r,null);e.push(f);this._addToDom(t,i)},i}(TDB.ViewElement);n.C2=f;e=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("img");this.domElement=r;r._context=u;r.className="aboutIcon";this._AttrBinding=new t.Attr.Binding(r,n,u,this,u.pictureAttrArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n)},i}(TDB.ViewElement);n.Cpicture=e;o=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,r=document.createElement("div"),u;this.domElement=r;r._context=f;r.className="aboutText";var e=null,o=this.children,u=new n.CproductName(f);u.add(this,r,e);o.push(u);u=new n.CproductVersion(f);u.add(this,r,e);o.push(u);this._addToDom(t,i)},i}(TDB.ViewElement);n.C3=o;s=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("div");this.domElement=u;u._context=r;u.className="aboutProductName";this._AttrBinding=new t.Attr.Binding(u,n,r,this,r.productNameAttrArgs);this._TextBinding=new t.Text.Binding(u,n,r,this,r.productNameTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._TextBinding.update(n)},i}(TDB.ViewElement);n.CproductName=s;h=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("div");this.domElement=u;u._context=r;u.className="aboutProductVersion";this._AttrBinding=new t.Attr.Binding(u,n,r,this,r.productVersionAttrArgs);this._TextBinding=new t.Text.Binding(u,n,r,this,r.productVersionTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._TextBinding.update(n)},i}(TDB.ViewElement);n.CproductVersion=h;c=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,i=document.createElement("div");this.domElement=i;i._context=r;i.className="aboutPaneDivider";this._addToDom(n,t)},t}(TDB.ViewElement);n.C4=c}(f||(f={}));ri=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new e.Cwrapper(u);i.add(this,n,t);r.push(i)},t}(n.AccountsPaneVEBase);n.AccountsPaneVE=ri,function(n){var l=function(t){function r(n){t.call(this,null);this._context=n}return __extends(r,t),r.prototype._create=function(t,r){var u=this._context,f=document.createElement("div"),e;this.domElement=f;f._context=u;f.className="accountsPaneWrapper";this._SlideVisibleBinding=new i.SlideVisible.Binding(f,t,u,this,u.wrapperSlideVisibleInitArgs(),u.wrapperSlideVisibleArgs);this.receivePhaseNotification(4);var o=null,s=this.children,e=new n.C1(u);e.add(this,f,o);s.push(e);e=new n.C3(u);e.add(this,f,o);s.push(e);this._addToDom(t,r)},r.prototype.onUpdate=function(n){this._SlideVisibleBinding.update(n)},r}(TDB.ViewElement),r,u,f,e,o,s,h,c;n.Cwrapper=l;r=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,u=document.createElement("div"),s,r;this.domElement=u;u._context=f;u.className="accountsPaneTop";var e=null,o=this.children,r=new n.CpaneTitle(f);r.add(this,u,e);o.push(r);r=new n.CcurrentAccountHeading(f);r.add(this,u,e);o.push(r);r=new TDB.SubTemplateInstructionVE(!1,f.currentAccountArgs());r.add(this,u,e);o.push(r);r=new n.CifSwitchAccountsHeading(f);r.add(this,u,e);o.push(r);s=TDB.watcherTag(4543753,f,null,f.otherAccountsArgs);r=new TDB.ForeachInstructionVE(!1,s);r.addResource(s);r.add(this,u,e);o.push(r);r=new n.C2(f);r.add(this,u,e);o.push(r);this._addToDom(t,i)},i}(TDB.ViewElement);n.C1=r;u=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="accountsPaneTitle";this._TextBinding=new t.Text.Binding(r,n,u,this,u.paneTitleTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CpaneTitle=u;f=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="accountsPaneHeading";this._TextBinding=new t.Text.Binding(r,n,u,this,u.currentAccountHeadingTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CcurrentAccountHeading=f;e=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifSwitchAccountsHeadingArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.CswitchAccountHeading(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE);n.CifSwitchAccountsHeading=e;o=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="accountsPaneHeading";this._TextBinding=new t.Text.Binding(r,n,u,this,u.switchAccountHeadingTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CswitchAccountHeading=o;s=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,i=document.createElement("div");this.domElement=i;i._context=r;i.className="accountsPaneContentPush";this._addToDom(n,t)},t}(TDB.ViewElement);n.C2=s;h=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,u=document.createElement("div"),r;this.domElement=u;u._context=f;u.className="accountsPaneBottom";var e=null,o=this.children,r=new n.C4(f);r.add(this,u,e);o.push(r);r=f.newMsaButtonArgs();r&&(r.add(this,u,e),o.push(r));r=f.newOrgIdButtonArgs();r&&(r.add(this,u,e),o.push(r));this._addToDom(t,i)},i}(TDB.ViewElement);n.C3=h;c=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,i=document.createElement("div");this.domElement=i;i._context=r;i.className="accountsPaneDivider";this._addToDom(n,t)},t}(TDB.ViewElement);n.C4=c}(e||(e={}));ui=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new o.Cwrapper(u);i.add(this,n,t);r.push(i)},t}(n.AccountSwitchVEBase);n.AccountSwitchVE=ui,function(n){var s=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("button"),o;this.domElement=e;e._context=f;this._FocusableBinding=new t.Focusable.Binding(e,r,f,this,f.FocusableInitArgs());this._ClassNameBinding=new i.ClassName.Binding(e,r,f,this,f.wrapperClassNameArgs);this._StyleBinding=new t.Style.Binding(e,r,f,this,f.wrapperStyleArgs);this.receivePhaseNotification(4);var s=null,h=this.children,o=new n.C1(f);o.add(this,e,s);h.push(o);o=new n.C2(f);o.add(this,e,s);h.push(o);this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._FocusableBinding.update(n);this._ClassNameBinding.update(n);this._StyleBinding.update(n)},u.prototype.disposeBindings=function(){this._FocusableBinding.dispose()},u}(TDB.ViewElement),r,u,f,e,o;n.Cwrapper=s;r=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,r=document.createElement("center");this.domElement=r;r._context=u;var e=this.children,f=new n.Cpicture(u);f.add(this,r,null);e.push(f);this._addToDom(t,i)},i}(TDB.ViewElement);n.C1=r;u=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("img");this.domElement=r;r._context=u;r.className="accountPicture clip48x48";this._AttrBinding=new t.Attr.Binding(r,n,u,this,u.pictureAttrArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n)},i}(TDB.ViewElement);n.Cpicture=u;f=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,r=document.createElement("div"),u;this.domElement=r;r._context=f;r.className="accountText";var e=null,o=this.children,u=new n.CuserName(f);u.add(this,r,e);o.push(u);u=new n.CuserEmail(f);u.add(this,r,e);o.push(u);this._addToDom(t,i)},i}(TDB.ViewElement);n.C2=f;e=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="accountName cutoffLongText";this._TextBinding=new t.Text.Binding(r,n,u,this,u.userNameTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CuserName=e;o=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="accountEmail cutoffLongText";this._TextBinding=new t.Text.Binding(r,n,u,this,u.userEmailTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CuserEmail=o}(o||(o={}));fi=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new s.C1(u);i.add(this,n,t);r.push(i)},t}(n.AccountTileVEBase);n.AccountTileVE=fi,function(n){var t=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var u=this._context,r=document.createElement("div"),i;this.domElement=r;r._context=u;r.className="accountTileWrapper";var f=null,e=this.children,i=u.accountSwitchArgs();i&&(i.add(this,r,f),e.push(i));i=u.deleteButtonArgs();i&&(i.add(this,r,f),e.push(i));this._addToDom(n,t)},t}(TDB.ViewElement);n.C1=t}(s||(s={}));ei=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=u.hamburgerButtonArgs();i&&(i.add(this,n,t),r.push(i));i=u.hamburgerMenuArgs();i&&(i.add(this,n,t),r.push(i));i=new h.CcommandWrapper(u);i.add(this,n,t);r.push(i)},t}(n.AppBarVEBase);n.AppBarVE=ei,function(n){var u=function(t){function r(n){t.call(this,null);this._context=n}return __extends(r,t),r.prototype._create=function(t,r){var f=this._context,e=document.createElement("div"),u;this.domElement=e;e._context=f;e.id="h_bar";e.className="headerNew";this._DynamicMenuBinding=new i.DynamicMenu.Binding(e,t,f,this,f.commandWrapperDynamicMenuVisibleArgs,f.commandWrapperDynamicMenuChunksArgs);this.receivePhaseNotification(4);var o=null,s=this.children,u=f.homeButtonArgs();u&&(u.add(this,e,o),s.push(u));f.ifHamburgerPlaceholderArgs()&&(u=new n.C1(f),u.add(this,e,o),s.push(u));for(var c=f.nearButtonsArgs(),h=0,l=c.length;h<l;++h)u=c[h],u.add(this,e,o),s.push(u);u=new n.C2(f);u.add(this,e,o);s.push(u);u=f.overflowMenuArgs();u&&(u.add(this,e,o),s.push(u));this._addToDom(t,r)},r.prototype.onUpdate=function(n){this._DynamicMenuBinding.update(n)},r.prototype.disposeBindings=function(){this._DynamicMenuBinding.dispose()},r}(TDB.ViewElement),t,r;n.CcommandWrapper=u;t=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,i=document.createElement("div");this.domElement=i;i._context=r;i.className="appBarHamburgerButtonPlaceholder";this._addToDom(n,t)},t}(TDB.ViewElement);n.C1=t;r=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var f=this._context,i=document.createElement("div"),e,o,u;this.domElement=i;i._context=f;i.id="h_farButtons";i.className="headerFarButtonWrapper";e=null;o=this.children;for(var s=f.farButtonsArgs(),r=0,h=s.length;r<h;++r)u=s[r],u.add(this,i,e),o.push(u);this._addToDom(n,t)},t}(TDB.ViewElement);n.C2=r}(h||(h={}));oi=function(n){function t(t){this.constructing=!0;n.call(this,t);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new c.CifBlockingProgress(u);i.add(this,n,t);r.push(i)},t}(n.BlockingProgressVEBase);n.BlockingProgressVE=oi,function(n){var e=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifBlockingProgressArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.C1(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE),i,r,u,f;n.CifBlockingProgress=e;i=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="BlockingProgress";var e=this.children,f=new n.C2(u);f.add(this,r,null);e.push(f);this._addToDom(t,i)},i}(TDB.ViewElement);n.C1=i;r=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,r=document.createElement("div"),u;this.domElement=r;r._context=f;r.className="BlockingProgressMessage";var e=null,o=this.children,u=new n.CBlockingMessage(f);u.add(this,r,e);o.push(u);u=new n.CBlockingProgressGif(f);u.add(this,r,e);o.push(u);this._addToDom(t,i)},i}(TDB.ViewElement);n.C2=r;u=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("p");this.domElement=u;u._context=r;this._TextBinding=new t.Text.Binding(u,n,r,this,r.BlockingMessageTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CBlockingMessage=u;f=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("img");this.domElement=u;u._context=r;this._AttrBinding=new t.Attr.Binding(u,n,r,this,r.BlockingProgressGifAttrArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n)},i}(TDB.ViewElement);n.CBlockingProgressGif=f}(c||(c={}));si=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new l.CifButtonWrapper(u);i.add(this,n,t);r.push(i)},t}(n.RegularCheckboxVEBase);n.RegularCheckboxVE=si,function(n){var e=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifButtonWrapperArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.Cwrapper(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE),r,u,f;n.CifButtonWrapper=e;r=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("div"),o;this.domElement=e;e._context=f;this._ClassNameBinding=new i.ClassName.Binding(e,r,f,this,f.wrapperClassNameArgs);this._EventsBinding=new t.Events.Binding(e,r,f,this,f.wrapperEventsInitArgs());this._StyleBinding=new t.Style.Binding(e,r,f,this,f.wrapperStyleArgs);var s=null,h=this.children,o=new n.Ccheckbox(f);o.add(this,e,s);h.push(o);o=new n.Clabel(f);o.add(this,e,s);h.push(o);this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._EventsBinding.update(n);this._StyleBinding.update(n)},u.prototype.disposeBindings=function(){this._EventsBinding.dispose()},u}(TDB.ViewElement);n.Cwrapper=r;u=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("input");this.domElement=r;r._context=u;r.setAttribute("type","checkbox");this._CheckedBinding=new t.Checked.Binding(r,n,u,this,u.checkboxCheckedInitArgs());this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._CheckedBinding.update(n)},i.prototype.disposeBindings=function(){this._CheckedBinding.dispose()},i}(TDB.ViewElement);n.Ccheckbox=u;f=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.labelClassNameArgs);this._TextBinding=new t.Text.Binding(f,n,u,this,u.labelTextArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._TextBinding.update(n)},r}(TDB.ViewElement);n.Clabel=f}(l||(l={}));hi=function(n){function t(t){this.constructing=!0;n.call(this,t);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new a.C1(u);i.add(this,n,t);r.push(i)},t}(n.DocIngestionFileInputVEBase);n.DocIngestionFileInputVE=hi,function(n){var u=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="docIngestionFileInput";var e=this.children,f=new n.C2(u);f.add(this,r,null);e.push(f);this._addToDom(t,i)},i}(TDB.ViewElement),i,r;n.C1=u;i=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,r=document.createElement("form");this.domElement=r;r._context=u;r.id="hCreateNewFromOfficeForm";r.className="hiddenContent";r.setAttribute("method","POST");r.setAttribute("enctype","multipart/form-data");r.setAttribute("encoding","multipart/form-data");var e=this.children,f=new n.CinputFilePicker(u);f.add(this,r,null);e.push(f);this._addToDom(t,i)},i}(TDB.ViewElement);n.C2=i;r=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("input");this.domElement=r;r._context=u;r.id="officeFileInput";r.setAttribute("type","file");this._AttrBinding=new t.Attr.Binding(r,n,u,this,u.inputFilePickerAttrArgs);this._AutoUploadBinding=new t.AutoUpload.Binding(r,n,u,this,u.inputFilePickerAutoUploadInitArgs());this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._AutoUploadBinding.update(n)},i}(TDB.ViewElement);n.CinputFilePicker=r}(a||(a={}));ci=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new v.CifWrapper(u);i.add(this,n,t);r.push(i)},t}(n.GlyphVEBase);n.GlyphVE=ci,function(n){var e=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifWrapperArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.Cwrapper(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE),r,u,f;n.CifWrapper=e;r=function(t){function r(n){t.call(this,null);this._context=n}return __extends(r,t),r.prototype._create=function(t,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,t,u,this,u.wrapperClassNameArgs);var o=this.children,e=new n.Cclip(u);e.add(this,f,null);o.push(e);this._addToDom(t,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n)},r}(TDB.ViewElement);n.Cwrapper=r;u=function(i){function r(n){i.call(this,null);this._context=n}return __extends(r,i),r.prototype._create=function(i,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;this._AttrBinding=new t.Attr.Binding(f,i,u,this,u.clipAttrArgs);this._DisableDragDropBinding=new t.DisableDragDrop.Binding(f,i,u,this);var o=this.children,e=new n.Cglyph(u);e.add(this,f,null);o.push(e);this._addToDom(i,r)},r.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._DisableDragDropBinding.update(n)},r.prototype.disposeBindings=function(){this._DisableDragDropBinding.dispose()},r}(TDB.ViewElement);n.Cclip=u;f=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("img");this.domElement=u;u._context=r;this._AttrBinding=new t.Attr.Binding(u,n,r,this,r.glyphAttrArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n)},i}(TDB.ViewElement);n.Cglyph=f}(v||(v={}));li=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new y.CifButtonWrapper(u);i.add(this,n,t);r.push(i)},t}(n.GlyphButtonVEBase);n.GlyphButtonVE=li,function(n){var s=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifButtonWrapperArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.Cwrapper(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE),r,u,f,e,o;n.CifButtonWrapper=s;r=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("button"),o;this.domElement=e;e._context=f;this._FocusableBinding=new t.Focusable.Binding(e,r,f,this,f.FocusableInitArgs());this._ClassNameBinding=new i.ClassName.Binding(e,r,f,this,f.wrapperClassNameArgs);this._EventsBinding=new t.Events.Binding(e,r,f,this,f.wrapperEventsInitArgs());this._ScrollIntoViewBinding=new i.ScrollIntoView.Binding(e,r,f,this,f.wrapperScrollIntoViewInitArgs(),f.wrapperScrollIntoViewArgs);this._StyleBinding=new t.Style.Binding(e,r,f,this,f.wrapperStyleArgs);this._AttrBinding=new t.Attr.Binding(e,r,f,this,f.wrapperAttrArgs);this.receivePhaseNotification(4);var s=null,h=this.children,o=new n.CglyphWrapper(f);o.add(this,e,s);h.push(o);o=new n.CincludeLabelText(f);o.add(this,e,s);h.push(o);o=f.calloutArgs();o&&(o.add(this,e,s),h.push(o));this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._FocusableBinding.update(n);this._ClassNameBinding.update(n);this._EventsBinding.update(n);this._ScrollIntoViewBinding.update(n);this._StyleBinding.update(n);this._AttrBinding.update(n)},u.prototype.disposeBindings=function(){this._FocusableBinding.dispose();this._EventsBinding.dispose()},u}(TDB.ViewElement);n.Cwrapper=r;u=function(i){function r(n){i.call(this,null);this._context=n}return __extends(r,i),r.prototype._create=function(i,r){var u=this._context,e=document.createElement("center"),f;this.domElement=e;e._context=u;this._StyleBinding=new t.Style.Binding(e,i,u,this,u.glyphWrapperStyleArgs);var o=null,s=this.children,f=u.glyphVEArgs();f&&(f.add(this,e,o),s.push(f));u.ifGlyphTextArgs()&&(f=new n.CglyphText(u),f.add(this,e,o),s.push(f));this._addToDom(i,r)},r.prototype.onUpdate=function(n){this._StyleBinding.update(n)},r}(TDB.ViewElement);n.CglyphWrapper=u;f=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;this._TextBinding=new t.Text.Binding(f,n,u,this,u.glyphTextTextArgs);this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.glyphTextClassNameArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._TextBinding.update(n);this._ClassNameBinding.update(n)},r}(TDB.ViewElement);n.CglyphText=f;e=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.includeLabelTextArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.Ctext(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE);n.CincludeLabelText=e;o=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.textClassNameArgs);this._TextBinding=new t.Text.Binding(f,n,u,this,u.textTextArgs);this._StyleBinding=new t.Style.Binding(f,n,u,this,u.textStyleArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._TextBinding.update(n);this._StyleBinding.update(n)},r}(TDB.ViewElement);n.Ctext=o}(y||(y={}));ai=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new p.C1(u);i.add(this,n,t);r.push(i)},t}(n.HomeButtonVEBase);n.HomeButtonVE=ai,function(n){var f=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,u=document.createElement("div"),r;this.domElement=u;u._context=f;u.className="homeButtonWrapper";var e=null,o=this.children,r=f.appSwitcherArgs();r&&(r.add(this,u,e),o.push(r));r=new n.C2(f);r.add(this,u,e);o.push(r);r=new n.ChomeLink(f);r.add(this,u,e);o.push(r);this._addToDom(t,i)},i}(TDB.ViewElement),i,r,u;n.C1=f;i=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,i=document.createElement("div");this.domElement=i;i._context=r;i.className="pipeNear";this._addToDom(n,t)},t}(TDB.ViewElement);n.C2=i;r=function(i){function r(n){i.call(this,null);this._context=n}return __extends(r,i),r.prototype._create=function(i,r){var u=this._context,f=document.createElement("a");this.domElement=f;f._context=u;f.className="homeLink activeHomeLink segoeUILight";this._AttrBinding=new t.Attr.Binding(f,i,u,this,u.homeLinkAttrArgs);this._EventsBinding=new t.Events.Binding(f,i,u,this,u.homeLinkEventsInitArgs());var o=this.children,e=new n.ChomeTextActive(u);e.add(this,f,null);o.push(e);this._addToDom(i,r)},r.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._EventsBinding.update(n)},r.prototype.disposeBindings=function(){this._EventsBinding.dispose()},r}(TDB.ViewElement);n.ChomeLink=r;u=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("span");this.domElement=r;r._context=u;r.className="homeText";this._TextBinding=new t.Text.Binding(r,n,u,this,u.homeTextActiveTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.ChomeTextActive=u}(p||(p={}));vi=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new w.CifButtonWrapper(u);i.add(this,n,t);r.push(i)},t}(n.LinkButtonVEBase);n.LinkButtonVE=vi,function(n){var f=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifButtonWrapperArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.Clink(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE),r,u;n.CifButtonWrapper=f;r=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("a"),o;this.domElement=e;e._context=f;this._ClassNameBinding=new i.ClassName.Binding(e,r,f,this,f.linkClassNameArgs);this._AttrBinding=new t.Attr.Binding(e,r,f,this,f.linkAttrArgs);this._EventsBinding=new t.Events.Binding(e,r,f,this,f.linkEventsInitArgs());this._FocusableBinding=new t.Focusable.Binding(e,r,f,this,f.FocusableInitArgs());this.receivePhaseNotification(4);var s=null,h=this.children,o=f.glyphArgs();o&&(o.add(this,e,s),h.push(o));o=new n.Ctext(f);o.add(this,e,s);h.push(o);this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._AttrBinding.update(n);this._EventsBinding.update(n);this._FocusableBinding.update(n)},u.prototype.disposeBindings=function(){this._EventsBinding.dispose();this._FocusableBinding.dispose()},u}(TDB.ViewElement);n.Clink=r;u=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("span");this.domElement=f;f._context=u;this._TextBinding=new t.Text.Binding(f,n,u,this,u.textTextArgs);this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.textClassNameArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._TextBinding.update(n);this._ClassNameBinding.update(n)},r}(TDB.ViewElement);n.Ctext=u}(w||(w={}));yi=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new b.CifLoadingMessage(u);i.add(this,n,t);r.push(i)},t}(n.LoadingMessageVEBase);n.LoadingMessageVE=yi,function(n){var o=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifLoadingMessageArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.C1(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE),r,u,f,e;n.CifLoadingMessage=o;r=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="LoadingMessage";var e=this.children,f=new n.C2(u);f.add(this,r,null);e.push(f);this._addToDom(t,i)},i}(TDB.ViewElement);n.C1=r;u=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,r=document.createElement("div"),u;this.domElement=r;r._context=f;r.className="LoadingMessageWrapper";var e=null,o=this.children,u=new n.Canimation(f);u.add(this,r,e);o.push(u);u=new n.Ctext(f);u.add(this,r,e);o.push(u);this._addToDom(t,i)},i}(TDB.ViewElement);n.C2=u;f=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("img");this.domElement=r;r._context=u;r.className="LoadingDots";this._AttrBinding=new t.Attr.Binding(r,n,u,this,u.animationAttrArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n)},i}(TDB.ViewElement);n.Canimation=f;e=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;this._TextBinding=new t.Text.Binding(f,n,u,this,u.textTextArgs);this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.textClassNameArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._TextBinding.update(n);this._ClassNameBinding.update(n)},r}(TDB.ViewElement);n.Ctext=e}(b||(b={}));pi=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new k.Cwrapper(u);i.add(this,n,t);r.push(i)},t}(n.NotificationBarVEBase);n.NotificationBarVE=pi,function(n){var f=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("div"),o;this.domElement=e;e._context=f;e.className="NotificationBar";this._SlideVisibleBinding=new i.SlideVisible.Binding(e,r,f,this,f.wrapperSlideVisibleInitArgs(),f.wrapperSlideVisibleArgs);this._StyleBinding=new t.Style.Binding(e,r,f,this,f.wrapperStyleArgs);this.receivePhaseNotification(4);var s=null,h=this.children,o=new n.Ctext(f);o.add(this,e,s);h.push(o);o=f.dismissButtonArgs();o&&(o.add(this,e,s),h.push(o));this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._SlideVisibleBinding.update(n);this._StyleBinding.update(n)},u}(TDB.ViewElement),r,u;n.Cwrapper=f;r=function(i){function r(n){i.call(this,null);this._context=n}return __extends(r,i),r.prototype._create=function(i,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;f.className="NotificationBarText segoeUI UnselectableText";this._TextBinding=new t.Text.Binding(f,i,u,this,u.textTextArgs);this._StyleBinding=new t.Style.Binding(f,i,u,this,u.textStyleArgs);var o=this.children,e=new n.CprivacyLink(u);e.add(this,f,null);o.push(e);this._addToDom(i,r)},r.prototype.onUpdate=function(n){this._TextBinding.update(n);this._StyleBinding.update(n)},r}(TDB.ViewElement);n.Ctext=r;u=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("a");this.domElement=r;r._context=u;r.className="NotifcationBarText";r.setAttribute("href","//go.microsoft.com/fwlink/p/?LinkId=316968");this._TextBinding=new t.Text.Binding(r,n,u,this,u.privacyLinkTextArgs);this._StyleBinding=new t.Style.Binding(r,n,u,this,u.privacyLinkStyleArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n);this._StyleBinding.update(n)},i}(TDB.ViewElement);n.CprivacyLink=u}(k||(k={}));wi=function(n){function t(t){this.constructing=!0;n.call(this,t);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new d.Cwrapper(u);i.add(this,n,t);r.push(i)},t}(n.HamburgerMenuVEBase);n.HamburgerMenuVE=wi,function(n){var h=function(t){function r(n){t.call(this,null);this._context=n}return __extends(r,t),r.prototype._create=function(t,r){var f=this._context,e=document.createElement("div"),u;this.domElement=e;e._context=f;this._ClassNameBinding=new i.ClassName.Binding(e,t,f,this,f.wrapperClassNameArgs);this._SlidePaneVisibleBinding=new i.SlidePaneVisible.Binding(e,t,f,this,f.wrapperSlidePaneVisibleArgs);this.receivePhaseNotification(4);var o=null,s=this.children,u=new n.C1(f);u.add(this,e,o);s.push(u);u=new n.C4(f);u.add(this,e,o);s.push(u);u=f.accountsPaneArgs();u&&(u.add(this,e,o),s.push(u));u=f.aboutPaneArgs();u&&(u.add(this,e,o),s.push(u));this._addToDom(t,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._SlidePaneVisibleBinding.update(n)},r}(TDB.ViewElement),r,u,f,e,o,s;n.Cwrapper=h;r=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,u=document.createElement("div"),r;this.domElement=u;u._context=f;u.className="hamburgerMenuTop";var o=null,s=this.children,r=new n.Ctitle(f);r.add(this,u,o);s.push(r);for(var h=f.topMenuButtonsArgs(),e=0,c=h.length;e<c;++e)r=h[e],r.add(this,u,o),s.push(r);r=new n.C2(f);r.add(this,u,o);s.push(r);for(var h=f.middleMenuButtonsArgs(),e=0,c=h.length;e<c;++e)r=h[e],r.add(this,u,o),s.push(r);r=new n.C3(f);r.add(this,u,o);s.push(r);this._addToDom(t,i)},i}(TDB.ViewElement);n.C1=r;u=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;f.className="hamburgerTitle";this._TextBinding=new t.Text.Binding(f,n,u,this,u.titleTextArgs);this._FadeVisibleBinding=new i.FadeVisible.Binding(f,n,u,this,u.titleFadeVisibleInitArgs(),u.titleFadeVisibleArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._TextBinding.update(n);this._FadeVisibleBinding.update(n)},r.prototype.disposeBindings=function(){this._FadeVisibleBinding.dispose()},r}(TDB.ViewElement);n.Ctitle=u;f=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,i=document.createElement("div");this.domElement=i;i._context=r;i.className="hamburgerMenuDivider";this._addToDom(n,t)},t}(TDB.ViewElement);n.C2=f;e=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,i=document.createElement("div");this.domElement=i;i._context=r;i.className="hamburgerMenuContentPush";this._addToDom(n,t)},t}(TDB.ViewElement);n.C3=e;o=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,r=document.createElement("div"),u;this.domElement=r;r._context=f;r.className="hamburgerMenuBottom";var o=null,s=this.children,u=new n.C5(f);u.add(this,r,o);s.push(u);for(var h=f.bottomMenuButtonsArgs(),e=0,c=h.length;e<c;++e)u=h[e],u.add(this,r,o),s.push(u);this._addToDom(t,i)},i}(TDB.ViewElement);n.C4=o;s=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,i=document.createElement("div");this.domElement=i;i._context=r;i.className="hamburgerMenuDivider";this._addToDom(n,t)},t}(TDB.ViewElement);n.C5=s}(d||(d={}));bi=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new g.C1(u);i.add(this,n,t);r.push(i)},t}(n.OverflowMenuVEBase);n.OverflowMenuVE=bi,function(n){var o=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.setAttribute("role","menu");var e=this.children,f=new n.Cwrapper(u);f.add(this,r,null);e.push(f);this._addToDom(t,i)},i}(TDB.ViewElement),r,u,f,e;n.C1=o;r=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("div"),o;this.domElement=e;e._context=f;e.setAttribute("role","group");this._AttrBinding=new t.Attr.Binding(e,r,f,this,f.wrapperAttrArgs);this._SlideVisibleBinding=new i.SlideVisible.Binding(e,r,f,this,f.wrapperSlideVisibleInitArgs(),f.wrapperSlideVisibleArgs);this._ClassNameBinding=new i.ClassName.Binding(e,r,f,this,f.wrapperClassNameArgs);this.receivePhaseNotification(4);var s=null,h=this.children,o=new n.CifLastSyncTime(f);o.add(this,e,s);h.push(o);for(var l=f.menuButtonsArgs(),c=0,a=l.length;c<a;++c)o=l[c],o.add(this,e,s),h.push(o);f.showDownloadArgs()&&(o=new n.CdownloadContainer(f),o.add(this,e,s),h.push(o));this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._SlideVisibleBinding.update(n);this._ClassNameBinding.update(n)},u}(TDB.ViewElement);n.Cwrapper=r;u=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifLastSyncTimeArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.ClastSyncTime(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE);n.CifLastSyncTime=u;f=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="overflowLastSyncTime";this._TextBinding=new t.Text.Binding(r,n,u,this,u.lastSyncTimeTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.ClastSyncTime=f;e=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("div");this.domElement=u;u._context=r;this._AutoDownloadBinding=new t.AutoDownload.Binding(u,n,r,this,r.downloadContainerAutoDownloadInitArgs());this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AutoDownloadBinding.update(n)},i}(TDB.ViewElement);n.CdownloadContainer=e}(g||(g={}));ki=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var f=this.children,r=this,i=r.pageViewArgs(),u;i&&(i.add(this,n,t),f.push(i));u=TDB.watcherTag(4543755,r,null,r.dialogArgs);i=new TDB.SubTemplateInstructionVE(!1,u);i.addResource(u);i.add(this,n,t);f.push(i)},t}(n.PageRootVEBase);n.PageRootVE=ki;di=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new nt.Cwrapper(u);i.add(this,n,t);r.push(i)},t}(n.RadioButtonVEBase);n.RadioButtonVE=di,function(n){var o=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("div"),o;this.domElement=e;e._context=f;this._FocusableBinding=new t.Focusable.Binding(e,r,f,this,f.FocusableInitArgs());this._ClassNameBinding=new i.ClassName.Binding(e,r,f,this,f.wrapperClassNameArgs);this.receivePhaseNotification(4);var s=null,h=this.children,o=new n.Cinput(f);o.add(this,e,s);h.push(o);o=new n.Clabel(f);o.add(this,e,s);h.push(o);this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._FocusableBinding.update(n);this._ClassNameBinding.update(n)},u.prototype.disposeBindings=function(){this._FocusableBinding.dispose()},u}(TDB.ViewElement),r,u,f,e;n.Cwrapper=o;r=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("input");this.domElement=f;f._context=u;f.setAttribute("type","radio");this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.inputClassNameArgs);this._CheckedBinding=new t.Checked.Binding(f,n,u,this,u.inputCheckedInitArgs());this._EventsBinding=new t.Events.Binding(f,n,u,this,u.inputEventsInitArgs());this._PropsBinding=new t.Props.Binding(f,n,u,this,u.inputPropsArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._CheckedBinding.update(n);this._EventsBinding.update(n);this._PropsBinding.update(n)},r.prototype.disposeBindings=function(){this._CheckedBinding.dispose();this._EventsBinding.dispose()},r}(TDB.ViewElement);n.Cinput=r;u=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("label"),o;this.domElement=e;e._context=f;this._ClassNameBinding=new i.ClassName.Binding(e,r,f,this,f.labelClassNameArgs);this._AttrBinding=new t.Attr.Binding(e,r,f,this,f.labelAttrArgs);var s=null,h=this.children,o=new n.Ctext(f);o.add(this,e,s);h.push(o);f.hasExplanationArgs()&&(o=new n.Cexplanation(f),o.add(this,e,s),h.push(o));this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._AttrBinding.update(n)},u}(TDB.ViewElement);n.Clabel=u;f=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("span");this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.textClassNameArgs);this._TextBinding=new t.Text.Binding(f,n,u,this,u.textTextArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._TextBinding.update(n)},r}(TDB.ViewElement);n.Ctext=f;e=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("span");this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.explanationClassNameArgs);this._TextBinding=new t.Text.Binding(f,n,u,this,u.explanationTextArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._TextBinding.update(n)},r}(TDB.ViewElement);n.Cexplanation=e}(nt||(nt={}));gi=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new tt.CifButtonWrapper(u);i.add(this,n,t);r.push(i)},t}(n.RichCheckboxVEBase);n.RichCheckboxVE=gi,function(n){var u=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifButtonWrapperArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.Cwrapper(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE),r;n.CifButtonWrapper=u;r=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("div"),o,e;this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.wrapperClassNameArgs);this._EventsBinding=new t.Events.Binding(f,n,u,this,u.wrapperEventsInitArgs());this._StyleBinding=new t.Style.Binding(f,n,u,this,u.wrapperStyleArgs);var s=null,h=this.children,e=u.checkboxArgs();e&&(e.add(this,f,s),h.push(e));o=TDB.watcherTag(4543753,u,null,u.messagePartsArgs);e=new TDB.ForeachInstructionVE(!0,o);e.addResource(o);e.add(this,f,s);h.push(e);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._EventsBinding.update(n);this._StyleBinding.update(n)},r.prototype.disposeBindings=function(){this._EventsBinding.dispose()},r}(TDB.ViewElement);n.Cwrapper=r}(tt||(tt={}));nr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new it.CshareThisWidget(u);i.add(this,n,t);r.push(i)},t}(n.ShareThisWidgetVEBase);n.ShareThisWidgetVE=nr,function(n){var r=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;this._AttrBinding=new t.Attr.Binding(f,n,u,this,u.shareThisWidgetAttrArgs);this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.shareThisWidgetClassNameArgs);this._FocusableBinding=new t.Focusable.Binding(f,n,u,this,u.FocusableInitArgs());this._HtmlDisposeBinding=new t.HtmlDispose.Binding(f,n,u,this,u.shareThisWidgetHtmlDisposeInitArgs());this._StyleBinding=new t.Style.Binding(f,n,u,this,u.shareThisWidgetStyleArgs);this.receivePhaseNotification(4);var o=this.children,e=u.customGlyphArgs();e&&(e.add(this,f,null),o.push(e));this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._ClassNameBinding.update(n);this._FocusableBinding.update(n);this._HtmlDisposeBinding.update(n);this._StyleBinding.update(n)},r.prototype.disposeBindings=function(){this._FocusableBinding.dispose();this._HtmlDisposeBinding.dispose()},r}(TDB.ViewElement);n.CshareThisWidget=r}(it||(it={}));tr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new rt.C1(u);i.add(this,n,t);r.push(i)},t}(n.ShareThisWidgetGroupVEBase);n.ShareThisWidgetGroupVE=tr,function(n){var t=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var f=this._context,i=document.createElement("div"),e,o,u;this.domElement=i;i._context=f;i.className="ShareThisGroup";e=null;o=this.children;for(var s=f.shareThisWidgetsArgs(),r=0,h=s.length;r<h;++r)u=s[r],u.add(this,i,e),o.push(u);this._addToDom(n,t)},t}(TDB.ViewElement);n.C1=t}(rt||(rt={}));ir=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);this._subscribeToWatchable(this._initializeShareThisWatcher=TDB.watcherTag(5796370,this,this,this.initializeShareThis),4);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new ut.CflyoutContentWrapper(u);i.add(this,n,t);r.push(i);this.receivePhaseNotification(4)},t.prototype.onUpdate=function(n){n===4&&this._initializeShareThisWatcher.resolve()},t}(n.SocialFlyoutVEBase);n.SocialFlyoutVE=ir,function(n){var h=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var e=this._context,o=document.createElement("div"),f;this.domElement=o;o._context=e;o.className="SocialFlyoutContentWrapper";this._FadeVisibleBinding=new i.FadeVisible.Binding(o,r,e,this,e.flyoutContentWrapperFadeVisibleInitArgs(),e.flyoutContentWrapperFadeVisibleArgs);this._EventsBinding=new t.Events.Binding(o,r,e,this,e.flyoutContentWrapperEventsInitArgs());this._StyleBinding=new t.Style.Binding(o,r,e,this,e.flyoutContentWrapperStyleArgs);var s=null,h=this.children,f=new n.CisShareThisReady(e);f.add(this,o,s);h.push(f);f=new n.CflyoutHeader(e);f.add(this,o,s);h.push(f);f=new n.C2(e);f.add(this,o,s);h.push(f);f=new n.C3(e);f.add(this,o,s);h.push(f);f=e.embedCodeArgs();f&&(f.add(this,o,s),h.push(f));this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._FadeVisibleBinding.update(n);this._EventsBinding.update(n);this._StyleBinding.update(n)},u.prototype.disposeBindings=function(){this._FadeVisibleBinding.dispose();this._EventsBinding.dispose()},u}(TDB.ViewElement),r,u,f,e,o,s;n.CflyoutContentWrapper=h;r=function(t){function i(n){var i=TDB.watcherTag(4519824,n,null,n.isShareThisReadyArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i,r){var f=this._context,e=this.children,u;switch(t){case!0:u=new n.C1(f);u.add(this,i,r);e.push(u)}},i}(TDB.SwitchInstructionVE);n.CisShareThisReady=r;u=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var u=this._context,i=document.createElement("div");this.domElement=i;i._context=u;i.className="SocialFlyoutLikeWrapper";var f=this.children,r=u.socialLikeArgs();r&&(r.add(this,i,null),f.push(r));this._addToDom(n,t)},t}(TDB.ViewElement);n.C1=u;f=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="SocialFlyoutHeader";this._TextBinding=new t.Text.Binding(r,n,u,this,u.flyoutHeaderTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CflyoutHeader=f;e=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="SocialFlyoutWidgetsWrapper";var e=this.children,f=new n.C1isShareThisReady(u);f.add(this,r,null);e.push(f);this._addToDom(t,i)},i}(TDB.ViewElement);n.C2=e;o=function(n){function t(t){var i=TDB.watcherTag(4519824,t,null,t.isShareThisReadyArgs);n.call(this,i);this.addResource(i);this._context=t}return __extends(t,n),t.prototype.buildChildren=function(n,t,i){var f=this._context,e=this.children,r;switch(n){case!0:r=f.socialWidgetsArgs();r&&(r.add(this,t,i),e.push(r));break;case!1:for(var o=f.buttonGroupsArgs(),u=0,s=o.length;u<s;++u)r=o[u],r.add(this,t,i),e.push(r)}},t}(TDB.SwitchInstructionVE);n.C1isShareThisReady=o;s=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var u=this._context,r=document.createElement("div"),i;this.domElement=r;r._context=u;var f=null,e=this.children,i=u.copyTextBoxArgs();i&&(i.add(this,r,f),e.push(i));i=u.copyTextButtonArgs();i&&(i.add(this,r,f),e.push(i));this._addToDom(n,t)},t}(TDB.ViewElement);n.C3=s}(ut||(ut={}));rr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new ft.CspanMessage(u);i.add(this,n,t);r.push(i)},t}(n.SpanMessageVEBase);n.SpanMessageVE=rr,function(n){var r=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("span");this.domElement=f;f._context=u;this._TextBinding=new t.Text.Binding(f,n,u,this,u.spanMessageTextArgs);this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.spanMessageClassNameArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._TextBinding.update(n);this._ClassNameBinding.update(n)},r}(TDB.ViewElement);n.CspanMessage=r}(ft||(ft={}));ur=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new et.CtextArea(u);i.add(this,n,t);r.push(i)},t}(n.TextAreaVEBase);n.TextAreaVE=ur,function(n){var i=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("textarea");this.domElement=u;u._context=r;this._AttrBinding=new t.Attr.Binding(u,n,r,this,r.textAreaAttrArgs);this._FocusableBinding=new t.Focusable.Binding(u,n,r,this,r.FocusableInitArgs());this._ValueBinding=new t.Value.Binding(u,n,r,this,r.textAreaValueInitArgs());this._StyleBinding=new t.Style.Binding(u,n,r,this,r.textAreaStyleArgs);this.receivePhaseNotification(4);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._FocusableBinding.update(n);this._ValueBinding.update(n);this._StyleBinding.update(n)},i.prototype.disposeBindings=function(){this._FocusableBinding.dispose();this._ValueBinding.dispose()},i}(TDB.ViewElement);n.CtextArea=i}(et||(et={}));fr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new ot.Ctext(u);i.add(this,n,t);r.push(i)},t}(n.TextBoxVEBase);n.TextBoxVE=fr,function(n){var r=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("input");this.domElement=f;f._context=u;f.setAttribute("type","text");this._AttrBinding=new t.Attr.Binding(f,n,u,this,u.textAttrArgs);this._FocusableBinding=new t.Focusable.Binding(f,n,u,this,u.FocusableInitArgs());this._SelectTextBinding=new i.SelectText.Binding(f,n,u,this,u.textSelectTextArgs);this._ValueBinding=new t.Value.Binding(f,n,u,this,u.textValueInitArgs());this.receivePhaseNotification(4);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._FocusableBinding.update(n);this._SelectTextBinding.update(n);this._ValueBinding.update(n)},r.prototype.disposeBindings=function(){this._FocusableBinding.dispose();this._ValueBinding.dispose()},r}(TDB.ViewElement);n.Ctext=r}(ot||(ot={}));er=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new st.CifButtonWrapper(u);i.add(this,n,t);r.push(i)},t}(n.TextButtonVEBase);n.TextButtonVE=er,function(n){var f=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifButtonWrapperArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.Cwrapper(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE),r,u;n.CifButtonWrapper=f;r=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("button");this.domElement=e;e._context=f;this._FocusableBinding=new t.Focusable.Binding(e,r,f,this,f.FocusableInitArgs());this._ClassNameBinding=new i.ClassName.Binding(e,r,f,this,f.wrapperClassNameArgs);this._EventsBinding=new t.Events.Binding(e,r,f,this,f.wrapperEventsInitArgs());this._ScrollIntoViewBinding=new i.ScrollIntoView.Binding(e,r,f,this,f.wrapperScrollIntoViewInitArgs(),f.wrapperScrollIntoViewArgs);this._StyleBinding=new t.Style.Binding(e,r,f,this,f.wrapperStyleArgs);this._AttrBinding=new t.Attr.Binding(e,r,f,this,f.wrapperAttrArgs);this.receivePhaseNotification(4);var s=this.children,o=new n.Ctext(f);o.add(this,e,null);s.push(o);this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._FocusableBinding.update(n);this._ClassNameBinding.update(n);this._EventsBinding.update(n);this._ScrollIntoViewBinding.update(n);this._StyleBinding.update(n);this._AttrBinding.update(n)},u.prototype.disposeBindings=function(){this._FocusableBinding.dispose();this._EventsBinding.dispose()},u}(TDB.ViewElement);n.Cwrapper=r;u=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.textClassNameArgs);this._TextBinding=new t.Text.Binding(f,n,u,this,u.textTextArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._TextBinding.update(n)},r}(TDB.ViewElement);n.Ctext=u}(st||(st={}));or=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new ht.Cwrapper(u);i.add(this,n,t);r.push(i)},t}(n.ToggleSwitchVEBase);n.ToggleSwitchVE=or,function(n){var u=function(i){function r(n){i.call(this,null);this._context=n}return __extends(r,i),r.prototype._create=function(i,r){var u=this._context,f=document.createElement("div"),e;this.domElement=f;f._context=u;f.className="ToggleSwitchWrapper";this._FocusableBinding=new t.Focusable.Binding(f,i,u,this,u.FocusableInitArgs());this._EventsBinding=new t.Events.Binding(f,i,u,this,u.wrapperEventsInitArgs());this._AttrBinding=new t.Attr.Binding(f,i,u,this,u.wrapperAttrArgs);this.receivePhaseNotification(4);var o=null,s=this.children,e=new n.Ccheckbox(u);e.add(this,f,o);s.push(e);e=new n.C1(u);e.add(this,f,o);s.push(e);this._addToDom(i,r)},r.prototype.onUpdate=function(n){this._FocusableBinding.update(n);this._EventsBinding.update(n);this._AttrBinding.update(n)},r.prototype.disposeBindings=function(){this._FocusableBinding.dispose();this._EventsBinding.dispose()},r}(TDB.ViewElement),i,r;n.Cwrapper=u;i=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("input");this.domElement=r;r._context=u;r.className="ToggleSwitchCheckbox";r.setAttribute("type","checkbox");this._CheckedBinding=new t.Checked.Binding(r,n,u,this,u.checkboxCheckedInitArgs());this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._CheckedBinding.update(n)},i.prototype.disposeBindings=function(){this._CheckedBinding.dispose()},i}(TDB.ViewElement);n.Ccheckbox=i;r=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,i=document.createElement("label");this.domElement=i;i._context=r;this._addToDom(n,t)},t}(TDB.ViewElement);n.C1=r}(ht||(ht={}));sr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var u=this.children,r=this,i;switch(r.isLinkArgs()){case!1:i=r.buttonArgs();i&&(i.add(this,n,t),u.push(i));break;case!0:i=new ct.Cspan(r);i.add(this,n,t);u.push(i)}},t}(n.DialogButtonVEBase);n.DialogButtonVE=sr,function(n){var i=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("span");this.domElement=u;u._context=r;u.className="dlgBtnLink btn segoeUI";this._TextBinding=new t.Text.Binding(u,n,r,this,r.spanTextArgs);this._EventsBinding=new t.Events.Binding(u,n,r,this,r.spanEventsInitArgs());this._FocusableBinding=new t.Focusable.Binding(u,n,r,this,r.FocusableInitArgs());this.receivePhaseNotification(4);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n);this._EventsBinding.update(n);this._FocusableBinding.update(n)},i.prototype.disposeBindings=function(){this._EventsBinding.dispose();this._FocusableBinding.dispose()},i}(TDB.ViewElement);n.Cspan=i}(ct||(ct={}));hr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new lt.CcontentParagraph(u);i.add(this,n,t);r.push(i)},t}(n.DialogMessageVEBase);n.DialogMessageVE=hr,function(n){var i=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("p");this.domElement=r;r._context=u;r.className="dlgContentP";this._TextBinding=new t.Text.Binding(r,n,u,this,u.contentParagraphTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CcontentParagraph=i}(lt||(lt={}));cr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new at.C1(u);i.add(this,n,t);r.push(i)},t}(n.DialogHtmlContainerVEBase);n.DialogHtmlContainerVE=cr,function(n){var u=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,f=document.createElement("div"),r;this.domElement=f;f._context=u;var e=null,o=this.children,r=new n.ChtmlContents(u);r.add(this,f,e);o.push(r);u.ifIframeContentsArgs()&&(r=new n.CiframeContents(u),r.add(this,f,e),o.push(r));this._addToDom(t,i)},i}(TDB.ViewElement),i,r;n.C1=u;i=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("div");this.domElement=u;u._context=r;this._PropsBinding=new t.Props.Binding(u,n,r,this,r.htmlContentsPropsArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._PropsBinding.update(n)},i}(TDB.ViewElement);n.ChtmlContents=i;r=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("iframe");this.domElement=u;u._context=r;this._IframeBinding=new t.Iframe.Binding(u,n,r,this,r.iframeContentsIframeArgs);this.receivePhaseNotification(4);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._IframeBinding.update(n)},i}(TDB.ViewElement);n.CiframeContents=r}(at||(at={}));lr=function(n){function t(t){this.constructing=!0;n.call(this,t);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new vt.C1(u);i.add(this,n,t);r.push(i)},t}(n.DialogLoadingSpinnerVEBase);n.DialogLoadingSpinnerVE=lr,function(n){var r=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,r=document.createElement("center");this.domElement=r;r._context=u;var e=this.children,f=new n.CloadingSpinner(u);f.add(this,r,null);e.push(f);this._addToDom(t,i)},i}(TDB.ViewElement),i;n.C1=r;i=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("img");this.domElement=u;u._context=r;this._AttrBinding=new t.Attr.Binding(u,n,r,this,r.loadingSpinnerAttrArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n)},i}(TDB.ViewElement);n.CloadingSpinner=i}(vt||(vt={}));ar=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new yt.CifButtonWrapper(u);i.add(this,n,t);r.push(i)},t}(n.UserInfoVEBase);n.UserInfoVE=ar,function(n){var h=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifButtonWrapperArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.Cwrapper(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE),r,u,f,e,o,s;n.CifButtonWrapper=h;r=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("button"),o;this.domElement=e;e._context=f;this._FocusableBinding=new t.Focusable.Binding(e,r,f,this,f.FocusableInitArgs());this._ClassNameBinding=new i.ClassName.Binding(e,r,f,this,f.wrapperClassNameArgs);this._EventsBinding=new t.Events.Binding(e,r,f,this,f.wrapperEventsInitArgs());this._ScrollIntoViewBinding=new i.ScrollIntoView.Binding(e,r,f,this,f.wrapperScrollIntoViewInitArgs(),f.wrapperScrollIntoViewArgs);this._StyleBinding=new t.Style.Binding(e,r,f,this,f.wrapperStyleArgs);this._AttrBinding=new t.Attr.Binding(e,r,f,this,f.wrapperAttrArgs);this.receivePhaseNotification(4);var s=null,h=this.children,o=new n.C1(f);o.add(this,e,s);h.push(o);o=new n.C2(f);o.add(this,e,s);h.push(o);this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._FocusableBinding.update(n);this._ClassNameBinding.update(n);this._EventsBinding.update(n);this._ScrollIntoViewBinding.update(n);this._StyleBinding.update(n);this._AttrBinding.update(n)},u.prototype.disposeBindings=function(){this._FocusableBinding.dispose();this._EventsBinding.dispose()},u}(TDB.ViewElement);n.Cwrapper=r;u=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,r=document.createElement("center");this.domElement=r;r._context=u;var e=this.children,f=new n.CuserPicture(u);f.add(this,r,null);e.push(f);this._addToDom(t,i)},i}(TDB.ViewElement);n.C1=u;f=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("img");this.domElement=r;r._context=u;r.className="userInfoPicture clip20x20";this._AttrBinding=new t.Attr.Binding(r,n,u,this,u.userPictureAttrArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n)},i}(TDB.ViewElement);n.CuserPicture=f;e=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,r=document.createElement("div"),u;this.domElement=r;r._context=f;r.className="userInfoContent";var e=null,o=this.children,u=new n.CuserName(f);u.add(this,r,e);o.push(u);u=new n.CuserEmail(f);u.add(this,r,e);o.push(u);this._addToDom(t,i)},i}(TDB.ViewElement);n.C2=e;o=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("p");this.domElement=r;r._context=u;r.className="segoeUI userNameDisplay";this._TextBinding=new t.Text.Binding(r,n,u,this,u.userNameTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CuserName=o;s=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("p");this.domElement=r;r._context=u;r.className="segoeUI userEmailDisplay";this._TextBinding=new t.Text.Binding(r,n,u,this,u.userEmailTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CuserEmail=s}(yt||(yt={}));vr=function(n){function t(t){this.constructing=!0;n.call(this,t);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=u.profileSettingsArgs();i&&(i.add(this,n,t),r.push(i));i=u.signOutArgs();i&&(i.add(this,n,t),r.push(i))},t}(n.UserMenuVEBase);n.UserMenuVE=vr;yr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new pt.Cwrapper(u);i.add(this,n,t);r.push(i)},t}(n.DialogVEBase);n.DialogVE=yr,function(n){var c=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("div"),o;this.domElement=e;e._context=f;this._FadeVisibleBinding=new i.FadeVisible.Binding(e,r,f,this,f.wrapperFadeVisibleInitArgs(),f.wrapperFadeVisibleArgs);this._EventsBinding=new t.Events.Binding(e,r,f,this,f.wrapperEventsInitArgs());this._CssBinding=new t.Css.Binding(e,r,f,this,f.wrapperCssArgs);this.receivePhaseNotification(4);var s=null,h=this.children,o=new n.Cfrost(f);o.add(this,e,s);h.push(o);o=new n.CdialogWrapper(f);o.add(this,e,s);h.push(o);this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._FadeVisibleBinding.update(n);this._EventsBinding.update(n);this._CssBinding.update(n)},u.prototype.disposeBindings=function(){this._FadeVisibleBinding.dispose();this._EventsBinding.dispose()},u}(TDB.ViewElement),r,u,f,e,o,s,h;n.Cwrapper=c;r=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("div");this.domElement=u;u._context=r;u.className="dlgFrost";this._AttrBinding=new t.Attr.Binding(u,n,r,this,r.frostAttrArgs);this._EventsBinding=new t.Events.Binding(u,n,r,this,r.frostEventsInitArgs());this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._EventsBinding.update(n)},i.prototype.disposeBindings=function(){this._EventsBinding.dispose()},i}(TDB.ViewElement);n.Cfrost=r;u=function(i){function r(n){i.call(this,null);this._context=n}return __extends(r,i),r.prototype._create=function(i,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;f.className="dlg segoeUI";f.setAttribute("role","dialog");this._StyleBinding=new t.Style.Binding(f,i,u,this,u.dialogWrapperStyleArgs);this._CenterBinding=new t.Center.Binding(f,i,u,this,u.dialogWrapperCenterInitArgs(),u.dialogWrapperCenterArgs);this.receivePhaseNotification(4);var o=this.children,e=new n.C1(u);e.add(this,f,null);o.push(e);this._addToDom(i,r)},r.prototype.onUpdate=function(n){this._StyleBinding.update(n);this._CenterBinding.update(n)},r.prototype.disposeBindings=function(){this._CenterBinding.dispose()},r}(TDB.ViewElement);n.CdialogWrapper=u;f=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,r=document.createElement("div"),u;this.domElement=r;r._context=f;r.className="dlgContent";var e=null,o=this.children,u=new n.C2(f);u.add(this,r,e);o.push(u);u=new n.C3(f);u.add(this,r,e);o.push(u);this._addToDom(t,i)},i}(TDB.ViewElement);n.C1=f;e=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,u=document.createElement("div"),r;this.domElement=u;u._context=f;u.className="dlgContentsContainer";var e=null,o=this.children,r=new n.CifTitle(f);r.add(this,u,e);o.push(r);r=new TDB.ForeachInstructionVE(!1,f.dialogMessageArgs());r.add(this,u,e);o.push(r);r=new TDB.SubTemplateInstructionVE(!1,f.contentArgs());r.add(this,u,e);o.push(r);this._addToDom(t,i)},i}(TDB.ViewElement);n.C2=e;o=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifTitleArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.Ctitle(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE);n.CifTitle=o;s=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="dlgTitle";this._TextBinding=new t.Text.Binding(r,n,u,this,u.titleTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.Ctitle=s;h=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,i=document.createElement("div");this.domElement=i;i._context=r;i.className="dlgButtons";var f=this.children,u=new TDB.ForeachInstructionVE(!1,r.buttonsArgs());u.add(this,i,null);f.push(u);this._addToDom(n,t)},t}(TDB.ViewElement);n.C3=h}(pt||(pt={}));pr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new wt.CplayerWrapper(u);i.add(this,n,t);r.push(i)},t}(n.YouTubePlayerVEBase);n.YouTubePlayerVE=pr,function(n){var r=function(t){function r(n){t.call(this,null);this._context=n}return __extends(r,t),r.prototype._create=function(t,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,t,u,this,u.playerWrapperClassNameArgs);var o=this.children,e=new n.Cplayer(u);e.add(this,f,null);o.push(e);this._addToDom(t,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n)},r}(TDB.ViewElement),t;n.CplayerWrapper=r;t=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,u=document.createElement("div");this.domElement=u;u._context=r;this._YouTubePlayerBinding=new i.YouTubePlayer.Binding(u,n,r,this,r.playerYouTubePlayerCreateArgs,r.playerYouTubePlayerResizeArgs);this._addToDom(n,t)},t.prototype.onUpdate=function(n){this._YouTubePlayerBinding.update(n)},t.prototype.disposeBindings=function(){this._YouTubePlayerBinding.dispose()},t}(TDB.ViewElement);n.Cplayer=t}(wt||(wt={}));wr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new bt.C1(u);i.add(this,n,t);r.push(i)},t}(n.SurveyBoxVEBase);n.SurveyBoxVE=wr,function(n){var t=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var f=this._context,i=document.createElement("div"),e,o,u;this.domElement=i;i._context=f;e=null;o=this.children;for(var s=f.questionBoxesArgs(),r=0,h=s.length;r<h;++r)u=s[r],u.add(this,i,e),o.push(u);this._addToDom(n,t)},t}(TDB.ViewElement);n.C1=t}(bt||(bt={}));br=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new kt.C1(u);i.add(this,n,t);r.push(i)},t}(n.CheckboxQuestionVEBase);n.CheckboxQuestionVE=br,function(n){var h=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,f=document.createElement("div"),r;this.domElement=f;f._context=u;f.className="SurveyQuestionWrapper";var e=null,o=this.children,r=new n.C2(u);r.add(this,f,e);o.push(r);u.ifQuestionSubtitleArgs()&&(r=new n.CquestionSubtitle(u),r.add(this,f,e),o.push(r));for(var h=u.checkboxOptionsArgs(),s=0,c=h.length;s<c;++s)r=h[s],r.add(this,f,e),o.push(r);u.ifTextBoxArgs()&&(r=new n.CtextBoxOption(u),r.add(this,f,e),o.push(r));this._addToDom(t,i)},i}(TDB.ViewElement),r,u,f,e,o,s;n.C1=h;r=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var u=this._context,f=document.createElement("div"),e,o,r;this.domElement=f;f._context=u;e=null;o=this.children;u.ifQuestionTitleArgs()&&(r=new n.CquestionTitle(u),r.add(this,f,e),o.push(r));u.ifQuestionExplanationArgs()&&(r=new n.CquestionExplanation(u),r.add(this,f,e),o.push(r));this._addToDom(t,i)},i}(TDB.ViewElement);n.C2=r;u=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("span");this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.questionTitleClassNameArgs);this._TextBinding=new t.Text.Binding(f,n,u,this,u.questionTitleTextArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._TextBinding.update(n)},r}(TDB.ViewElement);n.CquestionTitle=u;f=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("span");this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.questionExplanationClassNameArgs);this._TextBinding=new t.Text.Binding(f,n,u,this,u.questionExplanationTextArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._TextBinding.update(n)},r}(TDB.ViewElement);n.CquestionExplanation=f;e=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.questionSubtitleClassNameArgs);this._TextBinding=new t.Text.Binding(f,n,u,this,u.questionSubtitleTextArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._TextBinding.update(n)},r}(TDB.ViewElement);n.CquestionSubtitle=e;o=function(t){function r(n){t.call(this,null);this._context=n}return __extends(r,t),r.prototype._create=function(t,r){var f=this._context,e=document.createElement("div"),u;this.domElement=e;e._context=f;this._ClassNameBinding=new i.ClassName.Binding(e,t,f,this,f.textBoxOptionClassNameArgs);var o=null,s=this.children,u=new n.CtextBoxLabel(f);u.add(this,e,o);s.push(u);u=f.textBoxArgs();u&&(u.add(this,e,o),s.push(u));this._addToDom(t,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n)},r}(TDB.ViewElement);n.CtextBoxOption=o;s=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("div");this.domElement=f;f._context=u;this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.textBoxLabelClassNameArgs);this._TextBinding=new t.Text.Binding(f,n,u,this,u.textBoxLabelTextArgs);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n);this._TextBinding.update(n)},r}(TDB.ViewElement);n.CtextBoxLabel=s}(kt||(kt={}));kr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new dt.C1(u);i.add(this,n,t);r.push(i)},t}(n.TabHeaderVEBase);n.TabHeaderVE=kr,function(n){var t=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,i=document.createElement("div");this.domElement=i;i._context=r;var f=this.children,u=new TDB.ForeachInstructionVE(!0,r.tabsArgs());u.add(this,i,null);f.push(u);this._addToDom(n,t)},t}(TDB.ViewElement);n.C1=t}(dt||(dt={}));dr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new gt.C1(u);i.add(this,n,t);r.push(i)},t}(n.TabPathHeaderVEBase);n.TabPathHeaderVE=dr,function(n){var t=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var u=this._context,r=document.createElement("div"),i;this.domElement=r;r._context=u;var f=null,e=this.children,i=new TDB.ForeachInstructionVE(!0,u.tabsArgs());i.add(this,r,f);e.push(i);i=new TDB.ForeachInstructionVE(!1,u.breadcrumbsArgs());i.add(this,r,f);e.push(i);this._addToDom(n,t)},t}(TDB.ViewElement);n.C1=t}(gt||(gt={}));gr=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=u.textButtonVEArgs();i&&(i.add(this,n,t),r.push(i))},t}(n.TextTabVEBase);n.TextTabVE=gr;nu=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new ni.Cwrapper(u);i.add(this,n,t);r.push(i)},t}(n.DialogTextInputVEBase);n.DialogTextInputVE=nu,function(n){var e=function(t){function r(n){t.call(this,null);this._context=n}return __extends(r,t),r.prototype._create=function(t,r){var f=this._context,e=document.createElement("div"),u;this.domElement=e;e._context=f;this._ClassNameBinding=new i.ClassName.Binding(e,t,f,this,f.wrapperClassNameArgs);var o=null,s=this.children,u=new n.Cdescription(f);u.add(this,e,o);s.push(u);u=new n.Clabel(f);u.add(this,e,o);s.push(u);u=new n.CtextInput(f);u.add(this,e,o);s.push(u);this._addToDom(t,r)},r.prototype.onUpdate=function(n){this._ClassNameBinding.update(n)},r}(TDB.ViewElement),r,u,f;n.Cwrapper=e;r=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("p");this.domElement=u;u._context=r;this._TextBinding=new t.Text.Binding(u,n,r,this,r.descriptionTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.Cdescription=r;u=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("label");this.domElement=r;r._context=u;r.setAttribute("for","dialogTextInput");this._TextBinding=new t.Text.Binding(r,n,u,this,u.labelTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.Clabel=u;f=function(n){function r(t){n.call(this,null);this._context=t}return __extends(r,n),r.prototype._create=function(n,r){var u=this._context,f=document.createElement("input");this.domElement=f;f._context=u;f.setAttribute("type","text");f.id="dialogTextInput";this._AttrBinding=new t.Attr.Binding(f,n,u,this,u.textInputAttrArgs);this._ClassNameBinding=new i.ClassName.Binding(f,n,u,this,u.textInputClassNameArgs);this._ValueBinding=new t.Value.Binding(f,n,u,this,u.textInputValueInitArgs());this._FocusableBinding=new t.Focusable.Binding(f,n,u,this,u.FocusableInitArgs());this.receivePhaseNotification(4);this._addToDom(n,r)},r.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._ClassNameBinding.update(n);this._ValueBinding.update(n);this._FocusableBinding.update(n)},r.prototype.disposeBindings=function(){this._ValueBinding.dispose();this._FocusableBinding.dispose()},r}(TDB.ViewElement);n.CtextInput=f}(ni||(ni={}));tu=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var u=this.children,f=this,i=new r.CerrorMessage(f);i.add(this,n,t);u.push(i);i=new r.CemailForm(f);i.add(this,n,t);u.push(i)},t}(n.AuthoringDialogContentVEBase);n.AuthoringDialogContentVE=tu,function(n){var r=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="AuthenticationDialogEmailErrorMessage";this._TextBinding=new t.Text.Binding(r,n,u,this,u.errorMessageTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement),i;n.CerrorMessage=r;i=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("form");this.domElement=u;u._context=r;this._AttrBinding=new t.Attr.Binding(u,n,r,this,r.emailFormAttrArgs);this._EventsBinding=new t.Events.Binding(u,n,r,this,r.emailFormEventsInitArgs());var e=this.children,f=r.emailAddressTextBoxArgs();f&&(f.add(this,u,null),e.push(f));this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n);this._EventsBinding.update(n)},i.prototype.disposeBindings=function(){this._EventsBinding.dispose()},i}(TDB.ViewElement);n.CemailForm=i}(r||(r={}));iu=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,f=this,i=new u.Cmessage(f);i.add(this,n,t);r.push(i);i=new u.C1(f);i.add(this,n,t);r.push(i)},t}(n.EditStoryDialogVEBase);n.EditStoryDialogVE=iu,function(n){var e=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="EditStoryDialogMessage";this._TextBinding=new t.Text.Binding(r,n,u,this,u.messageTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement),i,r,u,f;n.Cmessage=e;i=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,u=document.createElement("div"),r;this.domElement=u;u._context=f;u.className="EditStoryDialogUserInfoWrapper";var e=null,o=this.children,r=new n.Cimage(f);r.add(this,u,e);o.push(r);r=new n.Cname(f);r.add(this,u,e);o.push(r);r=new n.Cdomain(f);r.add(this,u,e);o.push(r);this._addToDom(t,i)},i}(TDB.ViewElement);n.C1=i;r=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("img");this.domElement=r;r._context=u;r.className="EditStoryDialogUserInfoProfile";this._AttrBinding=new t.Attr.Binding(r,n,u,this,u.imageAttrArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._AttrBinding.update(n)},i}(TDB.ViewElement);n.Cimage=r;u=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="EditStoryDialogUserInfoName";this._TextBinding=new t.Text.Binding(r,n,u,this,u.nameTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.Cname=u;f=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="EditStoryDialogUserInfoDomain";this._TextBinding=new t.Text.Binding(r,n,u,this,u.domainTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.Cdomain=f}(u||(u={}));ru=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new ti.CifThumbnailBorder(u);i.add(this,n,t);r.push(i)},t}(n.ThumbnailBorderVEBase);n.ThumbnailBorderVE=ru,function(n){var o=function(t){function i(n){var i=TDB.watcherTag(4543754,n,null,n.ifThumbnailBorderArgs);t.call(this,i);this.addResource(i);this._context=n}return __extends(i,t),i.prototype.buildChildren=function(t,i){var u=this._context,f=this.children,r=new n.C1(u);r.add(this,t,i);f.push(r)},i}(TDB.IfInstructionVE),r,u,f,e;n.CifThumbnailBorder=o;r=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,u=document.createElement("div"),r;this.domElement=u;u._context=f;var e=null,o=this.children,r=new n.CinnerBorder(f);r.add(this,u,e);o.push(r);r=new n.CouterBorder(f);r.add(this,u,e);o.push(r);r=new n.CselectedIconWrapper(f);r.add(this,u,e);o.push(r);this._addToDom(t,i)},i}(TDB.ViewElement);n.C1=r;u=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,u=document.createElement("div");this.domElement=u;u._context=r;this._ClassNameBinding=new i.ClassName.Binding(u,n,r,this,r.innerBorderClassNameArgs);this._addToDom(n,t)},t.prototype.onUpdate=function(n){this._ClassNameBinding.update(n)},t}(TDB.ViewElement);n.CinnerBorder=u;f=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,u=document.createElement("div");this.domElement=u;u._context=r;this._ClassNameBinding=new i.ClassName.Binding(u,n,r,this,r.outerBorderClassNameArgs);this._addToDom(n,t)},t.prototype.onUpdate=function(n){this._ClassNameBinding.update(n)},t}(TDB.ViewElement);n.CouterBorder=f;e=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("div");this.domElement=u;u._context=r;this._StyleBinding=new t.Style.Binding(u,n,r,this,r.selectedIconWrapperStyleArgs);var e=this.children,f=r.selectedIconArgs();f&&(f.add(this,u,null),e.push(f));this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._StyleBinding.update(n)},i}(TDB.ViewElement);n.CselectedIconWrapper=e}(ti||(ti={}));uu=function(n){function t(t,i){this.constructing=!0;n.call(this,t,i);delete this.constructing}return __extends(t,n),t.prototype._create=function(n,t){var r=this.children,u=this,i=new ii.CcalloutBox(u);i.add(this,n,t);r.push(i)},t}(n.CalloutVEBase);n.CalloutVE=uu,function(n){var s=function(r){function u(n){r.call(this,null);this._context=n}return __extends(u,r),u.prototype._create=function(r,u){var f=this._context,e=document.createElement("div"),o;this.domElement=e;e._context=f;this._CalloutFadeBinding=new i.CalloutFade.Binding(e,r,f,this,f.calloutBoxCalloutFadeInitArgs(),f.calloutBoxCalloutFadeArgs);this._ClassNameBinding=new i.ClassName.Binding(e,r,f,this,f.calloutBoxClassNameArgs);this._EventsBinding=new t.Events.Binding(e,r,f,this,f.calloutBoxEventsInitArgs());this._AttrBinding=new t.Attr.Binding(e,r,f,this,f.calloutBoxAttrArgs);var s=null,h=this.children,o=new n.CcalloutBeak(f);o.add(this,e,s);h.push(o);o=new n.C1(f);o.add(this,e,s);h.push(o);o=new n.C2(f);o.add(this,e,s);h.push(o);this._addToDom(r,u)},u.prototype.onUpdate=function(n){this._CalloutFadeBinding.update(n);this._ClassNameBinding.update(n);this._EventsBinding.update(n);this._AttrBinding.update(n)},u.prototype.disposeBindings=function(){this._EventsBinding.dispose()},u}(TDB.ViewElement),r,u,f,e,o;n.CcalloutBox=s;r=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var r=this._context,u=document.createElement("div");this.domElement=u;u._context=r;this._ClassNameBinding=new i.ClassName.Binding(u,n,r,this,r.calloutBeakClassNameArgs);this._addToDom(n,t)},t.prototype.onUpdate=function(n){this._ClassNameBinding.update(n)},t}(TDB.ViewElement);n.CcalloutBeak=r;u=function(t){function i(n){t.call(this,null);this._context=n}return __extends(i,t),i.prototype._create=function(t,i){var f=this._context,r=document.createElement("div"),u;this.domElement=r;r._context=f;r.className="calloutText";var e=null,o=this.children,u=new n.CcalloutHeader(f);u.add(this,r,e);o.push(u);u=new n.CcalloutBody(f);u.add(this,r,e);o.push(u);this._addToDom(t,i)},i}(TDB.ViewElement);n.C1=u;f=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var r=this._context,u=document.createElement("div");this.domElement=u;u._context=r;u.className="calloutHeader";this._TextBinding=new t.Text.Binding(u,n,r,this,r.calloutHeaderTextArgs);this._StyleBinding=new t.Style.Binding(u,n,r,this,r.calloutHeaderStyleArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n);this._StyleBinding.update(n)},i}(TDB.ViewElement);n.CcalloutHeader=f;e=function(n){function i(t){n.call(this,null);this._context=t}return __extends(i,n),i.prototype._create=function(n,i){var u=this._context,r=document.createElement("div");this.domElement=r;r._context=u;r.className="calloutBody";this._TextBinding=new t.Text.Binding(r,n,u,this,u.calloutBodyTextArgs);this._addToDom(n,i)},i.prototype.onUpdate=function(n){this._TextBinding.update(n)},i}(TDB.ViewElement);n.CcalloutBody=e;o=function(n){function t(t){n.call(this,null);this._context=t}return __extends(t,n),t.prototype._create=function(n,t){var u=this._context,i=document.createElement("div");this.domElement=i;i._context=u;i.className="calloutCloseButtonWrapper";var f=this.children,r=u.closeButtonArgs();r&&(r.add(this,i,null),f.push(r));this._addToDom(n,t)},t}(TDB.ViewElement);n.C2=o}(ii||(ii={}))})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={}));Flags=function(){function n(t,i){if(this.type=t,this.value=i,!n.isValid(t,i))throw new Error("invalid value for flags");}return n.prototype.none=function(){return this.value===0},n.prototype.has=function(n){return(n&this.value)===n},n.prototype.includes=function(n){return(n.value&this.value)===n.value},n.prototype.set=function(n){this.value=this.value|n},n.prototype.unset=function(n){this.value=this.value&~n},n.prototype.raw=function(){return this.value},n.prototype.serialize=function(){return n.serialize(this.type,this.value)},n.prototype.reset=function(){this.value=0},n.serialize=function(n,t){for(var i,f,u=[],r=0;r<32;++r){if(i=1<<r,f=n[i],n[i]===undefined)break;t&i&&u.push(f)}return u.join(", ")},n.deserialize=function(t,i){var u=i.split(", "),r=u.map(function(n){return t[n]}).reduce(function(n,t){return n|t},0);if(!n.isValid(t,r))throw new Error("invalid value for flags");return r},n.isValid=function(n,t){for(var u,i=0,r=0;r<32;++r){if(u=1<<r,n[u]===undefined)break;i=i|u}return!(t&~i)},n}(),function(n){function t(n,t){return t!==undefined&&(n=Utilities.formatString(n,t)),n}function i(n,t,i){for(var s=[],r=n,f,u,e,o,c,h,l;;){for(f=r.length+1,u=-1,e=0;e<t.length;++e)o=r.indexOf("{"+e+"}"),o!=-1&&o<f&&(f=o,u=e);if(c="{"+u+"}",h=u!=-1?r.substr(0,f):r,h.length>0&&(l={message:h},s.push(new StoryApp.View.ViewElements.SpanMessageVE(i,l))),u==-1)break;else s.push(t[u]),r=r.substr(f+c.length)}return s}n.ResolveString=t;n.ResolveStringWithViewElements=i}(ResourceManager||(ResourceManager={}));State={DocumentUnloading:!1,PauseUpdates:!1,DisableRequestManager:!1},function(n){function u(){StoryLog.TraceTag(7734681,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"O365ShellService : RenderShellData : O365 Shell is ready to render.");$("#"+t).removeClass(r)}function i(n){typeof O365Shell=="undefined"?(StoryLog.TraceTag(7734682,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"O365ShellService : LoadShellData : O365Shell not defined yet."),setTimeout(function(){i(n)},1e3,n)):(StoryLog.TraceTag(7734683,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"O365ShellService : LoadShellData : O365 JS now available so start rendering shell."),O365Shell.SetData($.parseJSON(n)),O365Shell.RenderAsync({launcher:t},u,function(){}))}function f(){StoryLog.TraceTag(7734684,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"O365ShellService : GetShellServiceInfo : Getting Shell info needed to get O365 Shell JS and CSS");$.getJSON(CommonSettings.GetO365ShellInfoUrl,null,function(n){var r=$("<link href='"+n.CssUrl+"' rel='stylesheet' type='text/css' charset='UTF-8' />"),t;$(document.head).append(r);t=$("<script src='"+n.JsUrl+"' type='text/javascript'><\/script>");t.ready(i(n.NavBarDataJson));$(document.head).append(t)}).done(function(){StoryLog.TraceTag(9310545,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Successfully acquired O365 Shell info.")}).fail(function(){var n=StoryApp.Common.Environment.getInstance(),t=n.isProductionEnvironment()?Diag.ULSTraceLevel.error:Diag.ULSTraceLevel.warning;StoryLog.TraceTag(9310546,Diag.ULSCat.msoulscat_Story_Site,t,"Failed to acquire O365 Shell info.")})}var t="sw_bar",r="SwitcherLoading";n.GetShellServiceInfo=f}(O365ShellService||(O365ShellService={}));CancellationSource=function(){function n(){var n=this;n._completed=!1}return n.prototype.cancel=function(){var n=this,t=n._completed;n._completed=!0;!t&&n._onCancelled&&n._onCancelled()},n.prototype.registerOnCancelled=function(n,t){var i=this;if(i._onCancelled)throw new Error("Cancellation callback already registered.");n.pipe(function(){i._completed=!0});i._onCancelled=t},n}();Cookie=function(){function n(){}return n.getCookie=function(n){for(var t,i,f,u=document.cookie.split("; "),r=0;r<u.length;r++)if((t=u[r],i=t.indexOf("="),!(i<0))&&(f=t.substr(0,i),f===n))return t.substr(i+1);return null},n.setCookie=function(n,t,i){var r=n+"="+t;i.path&&(r+="; path="+i.path);i.domain&&(r+="; domain="+i.domain);i.maxAge&&(r+="; max-age="+i.maxAge);i.expires&&(r+="; expires="+i.expires.toUTCString());i.secure&&(r+="; secure");document.cookie=r},n.getAnonUserId=function(){return n.getCookie(n._anonUserCookieKey)},n.setODCSMForceRefresh=function(t){var i=new Date,r;i.setMinutes(i.getMinutes()+10);r={expires:i,path:"/"};n.setCookie(t,"true",r)},n.setPageRequestInfo=function(t){var f=(new Date).getTime().toString(),r=new Date,u,i;r.setTime(r.getTime()+1e3);u={expires:r,path:"/",secure:!0};n.setCookie(n._requestTimeCookieKey,f,u);n.setCookie(n._requestTargetCookieKey,t,u);i=new Date;i.setDate(i.getDate()-90);n.setCookie(n._redirectOperationCookieKey,"",{expires:i,path:"/"})},n._anonUserCookieKey="anonuserid",n._requestTimeCookieKey="pagerequesttime",n._requestTargetCookieKey="pagerequesttarget",n._redirectOperationCookieKey="pagerequestoperation",n}(),function(n){n[n.Basic=0]="Basic";n[n.SuggestedContent=1]="SuggestedContent";n[n.MyDevice=2]="MyDevice";n[n.AddSource=4]="AddSource";n[n.Camera=5]="Camera"}(PageType||(PageType={})),function(n){var t;(function(t){var r=n.Common,i;t.CurrentAppBarOM=null;i=function(n){function t(t){n.call(this);var i=this;i._appBar=t}return __extends(t,n),t.prototype.hasButton=function(n){var t=this;return t._appBar.getValue().hasButton(n)},t.prototype.clickButton=function(n){var t=this;return t._appBar.getValue().clickButton(n)},t.prototype.hasOverflowButton=function(n){var t=this;return t._appBar.getValue().getOverflowMenu().hasOverflowButton(n)},t.prototype.showFeedback=function(){r.AppBarAction.getInstance().ShowFeedback(null)},t}(ObjectOM);t.AppBarOM=i})(t=n.OM||(n.OM={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t=function(n){function t(){n.call(this)}return __extends(t,n),t.prototype.createStoryFromDocument=function(n,t,i,r){var u=this.convertBase64ContentToBlob(t,r),f;u.name=i;u.type=r;u.lastModifiedDate=new Date;f=new FileObject(u,i);DocumentIngestion.DocumentIngestionAPI.CreateStoryFromDocument(f,n)||n(null)},t.prototype.convertBase64ContentToBlob=function(n,t){for(var f,r=atob(n),u=new Array(r.length),i=0;i<r.length;i++)u[i]=r.charCodeAt(i);return f=new Uint8Array(u),new Blob([f],{type:t})},t}(ObjectOM);n.ImportFileOM=t})(t=n.OM||(n.OM={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t=function(n){function t(){n.call(this)}return __extends(t,n),t.prototype.isUserSignedIn=function(){return CommonSettings.IsAuthenticated},t.prototype.signOut=function(){return Identity.SignOutHelper()},t.prototype.signIn=function(){return Identity.SignInHelper(!1,null)},t.prototype.currentSwayUiLanguage=function(){return CommonSettings.UserLocaleString},t}(ObjectOM);n.SiteOM=t})(t=n.OM||(n.OM={}))}(StoryApp||(StoryApp={})),function(n){function r(n){var r=t[n];return r||(r=t[n]=new i),r}var i=function(){function n(){this.flags={};this.counts={}}return n.prototype.once=function(n){this.flags[n]=!0},n.prototype.count=function(n){this.counts[n]===undefined?this.counts[n]=1:++this.counts[n]},n.prototype.max=function(n,t){this.counts[n]=Math.max(this.counts[n]||0,t)},n.prototype.data=function(){return Obj.combine(this.flags,this.counts)},n.prototype.zeros=function(){for(var i=this,t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];t.forEach(function(n){return i.counts[n]=0})},n.prototype.toJSON=function(){return JSON.stringify(this.data())},n}(),t;n.UsageData=i;n.usage=r;t={}}(Telemetry||(Telemetry={}));Point=function(){function n(n,t){var i=this;i.left=n!==undefined?n:0;i.top=t!==undefined?t:0}return n.prototype.getDistanceToPoint=function(n){var t=this.left-n.left,i=this.top-n.top;return Math.sqrt(t*t+i*i)},n}(),function(n){n[n.Bottom=0]="Bottom";n[n.Right=1]="Right";n[n.Left=2]="Left";n[n.Top=3]="Top"}(EdgeSegment||(EdgeSegment={}));BaseRect=function(){function n(n,t,i,r){this.left=n;this.top=t;this.width=i;this.height=r}return n.prototype.flipped=function(){return new Rect(this.top,this.left,this.height,this.width)},n.prototype.clone=function(){return new n(this.left,this.top,this.width,this.height)},n.prototype.set=function(n){this.left=n.left;this.top=n.top;this.width=n.width;this.height=n.height},n.prototype.equals=function(n){return this.left==n.left&&this.top==n.top&&this.width==n.width&&this.height==n.height},n.prototype.bottom=function(){return this.top+this.height},n.prototype.setBottom=function(n){n>=this.top?this.height=n-this.top:(this.top=n,this.height=0)},n.prototype.right=function(){return this.left+this.width},n.prototype.setRight=function(n){n>=this.left?this.width=n-this.left:(this.left=n,this.width=0)},n.BoundingRect=function(n){var t,u,r,i;if(n.length===0)return null;for(t=n[0],u=n.length,r=1;r<u;r++)i=n[r],i.top<t.top&&(t.top=i.top),i.bottom()>t.bottom()&&t.setBottom(i.bottom()),i.left<t.left&&(t.left=i.left),i.right()>t.right()&&t.setRight(i.right());return t},n.prototype.containsPoint=function(n,t){return n<this.top||n>this.top+this.height?!1:t<this.left||t>this.left+this.width?!1:!0},n.prototype.containsRect=function(n){return this.containsPoint(n.top,n.left)&&this.containsPoint(n.bottom(),n.right())},n.prototype.overlapsRect=function(n){return this.left<n.right()&&n.left<this.right()&&this.top<n.bottom()&&n.top<this.bottom()},n.prototype.getCenter=function(){return new Point(this.left+this.width/2,this.top+this.height/2)},n.prototype.getDistanceToPoint=function(n){var t=this,i,r;return i=t.left<=n.left&&n.left<=t.right()?0:t.right()<n.left?n.left-t.right():t.left-n.left,r=t.bottom()>=n.top&&n.top>=t.top?0:t.top>n.top?t.top-n.top:n.top-t.bottom(),Math.sqrt(i*i+r*r)},n.prototype.getDistanceToPointFromExtendedEdge=function(n,t){var r=this,i=0;switch(t){case 0:i=Math.abs(r.bottom()-n.top);break;case 2:i=Math.abs(r.left-n.left);break;case 1:i=Math.abs(r.right()-n.left);break;case 3:i=Math.abs(r.top-n.top)}return i},n}();Rect=function(n){function t(t,i,r,u){n.call(this);this.flipped=BaseRect.prototype.flipped;this.set=BaseRect.prototype.set;this.equals=BaseRect.prototype.equals;this.bottom=BaseRect.prototype.bottom;this.setBottom=BaseRect.prototype.setBottom;this.right=BaseRect.prototype.right;this.setRight=BaseRect.prototype.setRight;this.containsPoint=BaseRect.prototype.containsPoint;this.containsRect=BaseRect.prototype.containsRect;this.getCenter=BaseRect.prototype.getCenter;this.getDistanceFromPoint=BaseRect.prototype.getDistanceToPoint;this.getDistanceToPointFromExtendedEdge=BaseRect.prototype.getDistanceToPointFromExtendedEdge;var f=this;f.left=t!==undefined?t:0;f.top=i!==undefined?i:0;f.width=r!==undefined?r:0;f.height=u!==undefined?u:0}return __extends(t,n),t.BoundingRect=BaseRect.BoundingRect,t}(ObjectOM),function(n){function t(n,t){ActionLogger.RecordClientAction(new ClientAction.RemoveEditorActionData);var i=StoryApp.Common.UrlHelper.getInstance().removeEditorUrl(t,n);return $.ajax(i,{name:"RemoveEditor",description:"Removes an editor from the list of editors",type:"POST",contentType:StoryApp.RequestManager.JsonContentType,dataType:"json"})}n.removeEditorRequest=t}(RemoveEditor||(RemoveEditor={}));Color=function(){function n(n,t,i,r){typeof n=="string"?(this.a=parseInt(n.substr(1,2),16)/255,this.r=parseInt(n.substr(3,2),16),this.g=parseInt(n.substr(5,2),16),this.b=parseInt(n.substr(7,2),16)):(this.r=n,this.g=t,this.b=i,this.a=r===undefined?1:r)}return n.toHex=function(n){var t=Math.round(n).toString(16);return t.length>2?t="ff":t.length<2&&(t="0"+t),t},n.prototype.toArgbString=function(){return"#"+n.toHex(this.a*255)+n.toHex(this.r)+n.toHex(this.g)+n.toHex(this.b)},n.prototype.toRGBAString=function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.a+")"},n.prototype.clone=function(){return new n(this.r,this.g,this.b,this.a)},n.prototype.blend=function(n){this.r=Math.round(n.r*n.a+this.r*this.a*(1-n.a));this.g=Math.round(n.g*n.a+this.g*this.a*(1-n.a));this.b=Math.round(n.b*n.a+this.b*this.a*(1-n.a));this.a=n.a+this.a*(1-n.a)},n}(),function(n){function t(n,t,i){ActionLogger.RecordClientAction(new ClientAction.DeleteStoryActionData);var r=StoryApp.Common.UrlHelper.getInstance().deleteStoryUrl(n);$.ajax(r,{name:"DeleteStory",description:"Delete a given remix",type:"POST",contentType:StoryApp.RequestManager.JsonContentType,dataType:"json"}).then(t,i)}n.deleteRequest=t}(Delete||(Delete={})),function(n){n.AAExperiment3Control="AAExperiment3Control";n.AAExperiment31="AAExperiment31";n.NewHomepageControl="NewHomepageControl";n.NewHomepage1="NewHomepage1";n.AA2ndExperimentControl="AA2ndExperimentControl";n.AA2ndExperiment1="AA2ndExperiment1";n.AAExperimentControl="AAExperimentControl";n.AAExperiment1="AAExperiment1";n.InsertTabRenameControl="InsertTabRenameControl";n.InsertTabRename1="InsertTabRename1";n.FocusPaneStringExpControl="FocusPaneStringExpControl";n.FocusPaneStringExp1="FocusPaneStringExp1";n.SearchboxControl="SearchboxControl";n.Searchbox1="Searchbox1";n.Searchbox2="Searchbox2";n.Searchbox3="Searchbox3"}(FlightList||(FlightList={}));Glyphs={CreateNew:"story_createNew",MySwaysDropdownClip:"clip16x8",MySwaysDropdownGlyph:"story_MySwaysDropdown",CreateFromDocClip:"clip22x22",CreateFromDocGlyph:"story_CreateFromDoc",CreateFromNewClip:"clip22x22",CreateFromNewGlyph:"story_CreateFromNew",DeleteIconClip:"clip31x30",DeleteIconGlyph:"story_DeleteIcon",DownloadIconClip:"clip30x30",DownloadIconGlyph:"story_Download",StoryOverflowClip:"clip36x36",StoryOverflowGlyph:"story_Overflow",StoryTileCoAuthorsIconClip:"clip36x36",StoryTileCoAuthorsIconGlyph:"story_StoryTileAuthorListIcon",StoryTileSyncIconClip:"clip36x36",StoryTileSyncIconGlyph:"story_StoryTileSyncIcon",ShareClip:"clip30x30",ShareGlyph:"story_Share",StoryTileDuplicateIconClip:"clip30x30",StoryTileDuplicateIconGlyph:"story_StoryTileDuplicate",UploadIconClip:"clip30x30",UploadIconGlyph:"story_Upload",ViewsIconClip:"clip11x8",ViewsIconGlyph:"story_ViewsIcon",TellYourFriendFacebookClip:"clip20x21",TellYourFriendFacebookGlyph:"story_TellYourFriendFacebook",TellYourFriendTwitterClip:"clip20x21",TellYourFriendTwitterGlyph:"story_TellYourFriendTwitter",NextClip:"clip11x16",NextGlyph:"story_ChevronRight",ChevronRightWhiteClip:"clip11x16",ChevronRightWhiteGlyph:"story_ChevronRight",ChevronLeftWhiteClip:"clip11x16",ChevronLeftWhiteGlyph:"story_ChevronLeft",PreviousClip:"clip11x16",PreviousGlyph:"story_ChevronLeft",FollowFacebookClip:"clip33x33",FollowFacebookGlyph:"story_FollowFacebook",FollowTwitterClip:"clip33x33",FollowTwitterGlyph:"story_FollowTwitter",FollowBlogClip:"clip33x33",FollowBlogGlyph:"story_FollowBlog",PlatformClip:"clip80x80",PlatformiOSGlyph:"story_PlatformiOS",PlatformiPadGlyph:"story_PlatformiPad",PlatformiPhoneGlyph:"story_PlatformiPhone",PlatformWebGlyph:"story_PlatformWeb",PlatformWindowsGlyph:"story_PlatformWindows",AccountMsaIconClip:"clip32x33",AccountMsaIconGlyph:"story_AccountMsa",AccountOrgIdIconClip:"clip32x33",AccountOrgIdIconGlyph:"story_AccountOrgId",SignOutButtonClip:"clip16x16",SignOutButtonGlyph:"story_SignOut",CaratClip:"clip8x4 dropdownCarat",CaratGlyph:"story_CaratSymbolGrey",ArrowClip:"clip16x16",CollapsedArrowGlyph:"story_CollapsedNormal",ExpandedArrowGlyph:"story_ExpandedNormal",ClosePaneClip:"clip10x10",ClosePaneGlyph:"story_ClosePane",ClosePaneHoverFocus:"story_ClosePaneHoverFocus",ClosePanePressed:"story_ClosePanePressed",LeftCaretClip:"clip12x12",LeftCaretGlyph:"story_LeftCaret",DownCaretClip:"clip12x12",DownCaretGlyph:"story_DownCaret",AppSwitcherWaffleClip:"clip50x50",AppSwitcherWaffleGlyph:"story_AppSwitcherWaffle",SwayIcon32Clip:"clip26x26",SwayIcon32Glyph:"story_SwayWhite",SwayWatermarkClip:"clip20x21",SwayWatermarkGlyph:"story_SwayWatermark",SwayWatermarkGrayGlyph:"story_SwayWatermarkGray",SelectedIconClip:"clip30x30",SelectedIconGlyph:"story_NodeSelected",SelectedIconGrayClip:"clip30x30",SelectedIconGrayGlyph:"story_NodeSelectedGray",ExpandGlyphClip:"clip8x12",ExpandClosedHoverKeyboardGlyph:"story_ExpandClosedHoverKeyboard",ExpandClosedPressedGlyph:"story_ExpandClosedPressed",ExpandClosedRestGlyph:"story_ExpandClosedRest",ExpandOpenHoverKeyboardGlyph:"story_ExpandOpenHoverKeyboard",ExpandOpenPressedGlyph:"story_ExpandOpenPressed",ExpandOpenRestGlyph:"story_ExpandOpenRest",SelectorArrowClip:"clip20x10",SelectorArrowGlyph:"story_SelectorArrow",BreadcrumbArrowClip:"clip16x16",BreadcrumbArrowGlyph:"story_CollapsedNormal",PlayButtonClip:"clip48x48",PlayButtonGlyph:"story_PlayNormal",PlayButtonSelected:"story_PlayPressed",PlayButtonHover:"story_PlayHover",SearchSmileyClip:"clip24x50",SearchSmileyGlyph:"story_FaceBookSmiley",SearchButtonClip:"clip18x18",SearchButtonGlyph:"story_MagGlassNormal",SearchButtonSelected:"story_MagGlassPressedSelected",SearchButtonHover:"story_MagGlassHover",SearchIcon:"story_SearchIcon",SearchIconHoverFocus:"story_SearchIconHoverFocus",SearchIconPressed:"story_SearchIconPressed",DrawerButtonClip:"clip32x20",DrawerButtonGlyphOpenDrawer:"story_DrawerButtonOpenDrawer",DrawerButtonGlyphCloseDrawer:"story_DrawerButtonCloseDrawer",SuggestedContentFeedbackInfoClip:"clip31x31",SuggestedContentFeedbackInfoGlyph:"story_SuggestedContentFeedbackInfoNormal",SuggestedContentFeedbackInfoHoverPressed:"story_SuggestedContentFeedbackInfoHoverPressed",ThumbUpButtonClip:"clip31x31",ThumbUpButtonGlyph:"story_ThumbUpNormal",ThumbUpButtonSelected:"story_ThumbUpPressedSelected",ThumbDownButtonClip:"clip31x31",ThumbDownButtonGlyph:"story_ThumbDownNormal",ThumbDownButtonSelected:"story_ThumbDownPressedSelected",AddContentMenuAddButtonClip:"clip24x24",AddContentMenuAddButtonGlyph:"story_AddButton",AddContentMenuAddButtonHoverFocusClip:"clip32x32",AddContentMenuAddButtonHoverFocusGlyph:"story_AddButtonHoverFocus",AddContentMenuAddButtonPressedClip:"clip32x32",AddContentMenuAddButtonPressedGlyph:"story_AddButtonPressed",ExpandedHoverClip:"clip16x16",ExpandedHoverGlyph:"story_ExpandedHover",AddContentCheckmarkWhiteClip:"clip20x20",AddContentCheckmarkWhiteGlyph:"story_CheckmarkWhite",AddContentCloseLegalClip:"clip10x10",AddContentCloseLegalGlyph:"story_CloseLegal",AddContentCloseLegalHoverFocusGlyph:"story_CloseLegalHoverFocus",AddContentCloseLegalPressedGlyph:"story_CloseLegalPressed",LeftArrowGreyClip:"clip25x25",LeftArrowGreyGlyph:"story_LeftArrowGrey",SelectedIconSmallClip:"clip20x20",SelectedIconSmallGlyph:"story_NodeSelectedSmall",CarouselNextClip:"clip10x16",CarouselNextGlyph:"story_CarouselNext",CarouselNextDisabledClip:"clip10x16",CarouselNextDisabledGlyph:"story_CarouselNextDisabled",CarouselNextHoverFocusClip:"clip10x16",CarouselNextHoverFocusGlyph:"story_CarouselNextHoverFocus",CarouselNextPressedClip:"clip10x16",CarouselNextPressedGlyph:"story_CarouselNextPressed",CarouselPreviousClip:"clip10x16",CarouselPreviousGlyph:"story_CarouselPrev",CarouselPreviousDisabledClip:"clip10x16",CarouselPreviousDisabledGlyph:"story_CarouselPrevDisabled",CarouselPreviousHoverFocusClip:"clip10x16",CarouselPreviousHoverFocusGlyph:"story_CarouselPrevHoverFocus",CarouselPreviousPressedClip:"clip10x16",CarouselPreviousPressedGlyph:"story_CarouselPrevPressed",DropdownChevronClip:"clip10x8",DropdownChevronGlyph:"story_DropdownChevron",WriteMenuOrganizeClip:"clip30x50",WriteMenuOrganizeGlyphActive:"story_OrganizeToggleIconActive",WriteMenuOrganizeGlyphInactive:"story_OrganizeToggleIconInactive",WriteAddIconClip:"clip20x20",WriteAddIconGlyph:"story_AddIconWhite",AddTextMenuAddClip:"clip24x24",AddTextMenuAddGlyph:"story_AddTextBlack",AddTextMenuAddFocus:"story_AddTextPink",EmbedIconClip:"clip26x26",EmbedIconGlyph:"story_EmbedIcon",OrganizeMenuClearSelectionClip:"clip24x24",OrganizeMenuClearSelectionGlyph:"story_ClearSelectionNormal",OrganizeMenuClearSelectionFocus:"story_ClearSelectionFocus",PreviewEditIconClip:"clip20x20",PreviewEditIconGlyph:"story_PreviewEditIcon",PreviewEmailIconClip:"clip32x32",PreviewEmailIconGlyph:"story_PreviewEmailIcon",PreviewEmbedIconClip:"clip32x32",PreviewEmbedIconGlyph:"story_PreviewEmbedIcon",PreviewEmbedHoverIconGlyph:"story_PreviewEmbedHoverIcon",PreviewEnterFullscreenIconClip:"clip20x20",PreviewEnterFullscreenIconGlyph:"story_PreviewEnterFullscreenIcon",PreviewExitFullscreenIconClip:"clip20x20",PreviewExitFullscreenIconGlyph:"story_PreviewExitFullscreenIcon",PreviewFacebookIconClip:"clip32x32",PreviewFacebookIconGlyph:"story_PreviewFacebookIcon",PreviewFacebookHoverIconGlyph:"story_PreviewFacebookHoverIcon",PreviewLinkIconClip:"clip32x32",PreviewLinkIconGlyph:"story_PreviewLinkIcon",PreviewLinkHoverIconGlyph:"story_PreviewLinkHoverIcon",PreviewOverflowIconClip:"clip20x20",PreviewOverflowIconGlyph:"story_PreviewOverflowIcon",PreviewShareIconClip:"clip32x32",PreviewShareIconGlyph:"story_PreviewShareIcon",PreviewShareThisIconClip:"clip20x20",PreviewShareThisIconGlyph:"story_PreviewShareThisIcon",PreviewSmallEmbedIconClip:"clip16x16",PreviewSmallEmbedIconGlyph:"story_PreviewSmallEmbedIcon",PreviewTwitterIconClip:"clip32x32",PreviewTwitterIconGlyph:"story_PreviewTwitterIcon",PreviewTwitterHoverIconGlyph:"story_PreviewTwitterHoverIcon",PreviewPopoutIconClip:"clip32x32",PreviewPopoutIconGlyph:"story_PreviewPopoutIcon",PreviewSwayEmbedIconClip:"clip24x24",PreviewSwayEmbedIconGlyph:"story_LogoSway24x24x32",PreviewOneDriveEmbedIconClip:"clip24x24",PreviewOneDriveEmbedIconGlyph:"story_LogoOneDrive24x24x32",PreviewOneDriveWordEmbedIconClip:"clip24x24",PreviewOneDriveWordEmbedIconGlyph:"story_LogoWord24x24x32",PreviewOneDriveExcelEmbedIconClip:"clip24x24",PreviewOneDriveExcelEmbedIconGlyph:"story_LogoExcel24x24x32",PreviewOneDrivePowerpointEmbedIconClip:"clip24x24",PreviewOneDrivePowerpointEmbedIconGlyph:"story_LogoPowerpoint24x24x32",EmphasisContextClip:"clip15x15",EmphasisContextNormalGlyph:"story_EmphasisContextNormal",TransformContextClip:"clip15x15",TransformContextNormalGlyph:"story_TransformContextNormal",EditContextClip:"clip15x15",EditContextNormalGlyph:"story_EditContextNormal",DeleteContextClip:"clip15x15",DeleteContextNormalGlyph:"story_DeleteContextNormal",MoodContextClip:"clip15x15",MoodContextNormalGlyph:"story_MoodContextNormal",EmphasisVeryClip:"clip16x16",EmphasisVeryGlyph:"story_Emphasis3Active",EmphasisMoreClip:"clip16x16",EmphasisMoreGlyph:"story_Emphasis2Active",EmphasisNoneClip:"clip16x16",EmphasisNoneGlyph:"story_Emphasis1Active",EmphasisLessClip:"clip16x16",EmphasisLessGlyph:"story_Emphasis0Active",CopyLinkContextClip:"clip16x16",CopyLinkContextNormalGlyph:"story_CopyLinkContextNormal",CalloutCloseButtonClip:"clip16x16",CalloutCloseButtonGlyph:"story_TeachingCalloutXSmall",MicrosoftIconClip:"clip14x14",MicrosoftIconGlyph:"story_WindowsIcon",EmailIconClip:"clip20x20",EmailIconGlyph:"story_EmailIcon",EmailIconGlyphHover:"story_EmailIconHover",EmbedShareIconClip:"clip20x20",EmbedShareIconGlyph:"story_EmbedShareIcon",EmbedShareIconGlyphHover:"story_EmbedShareIconHover",FacebookIconClip:"clip20x20",FacebookIconGlyph:"story_FacebookIcon",FacebookIconGlyphHover:"story_FacebookIconHover",LeftArrowWhiteClip:"clip30x30",LeftArrowWhiteGlyph:"story_LeftArrowWhite",LinkIconClip:"clip20x20",LinkIconGlyph:"story_LinkIcon",LinkIconGlyphHover:"story_LinkIconHover",AddAuthorIconClip:"clip20x20",AddAuthorIconGlyph:"story_AddAuthorIcon",TwitterIconClip:"clip20x20",TwitterIconGlyph:"story_TwitterIcon",TwitterIconGlyphHover:"story_TwitterIconHover",PresentButtonClip:"clip20x20",PresentButtonGlyph:"story_PresentIcon",SwayButtonClip:"clip16x16",SwayButtonGlyph:"story_MagicWandWhite",ShareButtonClip:"clip16x16",ShareButtonGlyph:"story_ShareIcon",OverflowMenuButtonClip:"clip20x20",OverflowMenuButtonGlyph:"story_OverflowMenuIcon",HamburgerMenuButtonClip:"clip24x24",HamburgerMenuButtonGlyph:"story_OverflowMenuHamburgerIcon",RefreshMenuButtonClip:"clip20x20",RefreshMenuButtonGlyph:"story_SyncNow",OverflowMenuItemButtonClip:"clip20x20",OverflowMenuCreateNewButtonGlyph:"story_OverflowMenuCreateNew",OverflowMenuDuplicateButtonGlyph:"story_OverflowMenuDuplicate",OverflowMenuFeedbackButtonGlyph:"story_OverflowMenuFeedback",OverflowMenuMySwaysButtonGlyph:"story_OverflowMenuMySways",OverflowMenuPreviewButtonGlyph:"story_OverflowMenuPreview",OverflowMenuOpenUrlButtonGlyph:"story_OverflowMenuOpenUrl",UndoButtonClip:"clip16x16",UndoButtonGlyph:"story_Undo",RedoButtonClip:"clip16x16",RedoButtonGlyph:"story_Redo",CoAuthorHeaderButtonClip:"clip16x16",CoAuthorHeaderButtonGlyph:"story_CoAuthorHeaderIcon",ShareThisIconClip:"clip20x20",ShareThisIconGlyph:"story_ShareThisIcon",ShareThisIconGlyphHover:"story_ShareThisHoverIcon",PlayHeaderButtonClip:"clip16x16",PlayHeaderButtonGlyph:"story_PlayHeader",AboutButtonClip:"clip20x20",AboutButtonGlyph:"story_AboutButton",PlaceholderClip:"clip24x24",ContentPlaceholderGlyph:"story_ContentPlaceholder",ImagePlaceholderGlyph:"story_ImagePlaceholder",TweetPlaceholderGlyph:"story_TweetPlaceholder",VideoPlaceholderGlyph:"story_VideoPlaceholder",AudioPlaceholderGlyph:"story_AudioPlaceholder",CardDeckContextMenuDeleteTeaserClip:"clip32x32",CardDeckContextMenuDeleteTeaserGlyph:"story_DeleteImage",CardDeckContextMenuDeleteTeaserHoverGlyph:"story_DeleteImageHover",CardDeckContextMenuDeleteTeaserKeyboardGlyph:"story_DeleteImageKeyboard",CardDeckContextMenuDeleteTeaserPressedGlyph:"story_DeleteImagePressed",ExpandedClip:"clip12x12",ExpandedGlyph:"story_Expanded",ExpandedWhiteGlyph:"story_ExpandedWhite",CollapsedGlyph:"story_Collapsed",VideoIconClip:"clip30x30",VideoIconGlyph:"story_VideoIcon",AudioIconClip:"clip30x30",AudioIconGlyph:"story_AudioIcon",EmphasizeWhiteIconClip:"clip15x15",EmphasizeWhiteIconGlyph:"story_EmphasizeWhiteIcon",TwitterIconLargeClip:"clip112x112",TwitterIconLargeGlyph:"story_TwitterIconLarge",TwitterIconSmallClip:"clip16x16",TwitterIconSmallGlyph:"story_TwitterIconSmall",BackgroundImagePlaceholderClip:"clip26x26",BackgroundImagePlaceholderGlyph:"story_BackgroundPlaceholder",CardDeckCloseClip:"clip10x10",CardDeckCloseGlyph:"story_CloseIcon",CardDeckOpenAndCloseClip:"clip10x16",CardDeckOpenAndCloseGlyph:"story_OpenAndCloseStoryline",CardDeckGrabHandlesClip:"clip12x6",CardDeckGrabHandlesGreyGlyph:"story_GrabHandlesGrey",CardDeckGrabHandlesTealGlyph:"story_GrabHandlesTeal",CardDeckCheckboxUncheckedClip:"clip16x16",CardDeckCheckboxUncheckedGlyph:"story_CheckboxUnchecked",CardDeckCheckboxHoverClip:"clip16x16",CardDeckCheckboxHoverGlyph:"story_CheckboxHover",CardDeckCheckboxKeyboardClip:"clip16x16",CardDeckCheckboxKeyboardGlyph:"story_CheckboxKeyboard",CardDeckCheckboxSelectedClip:"clip16x16",CardDeckCheckboxSelectedGlyph:"story_CheckboxSelectedCards",CardDeckCheckboxSelectedHoverClip:"clip16x16",CardDeckCheckboxSelectedHoverGlyph:"story_CheckboxSelectedHover",CardDeckCheckboxSelectedStandardClip:"clip16x16",CardDeckCheckboxSelectedStandardGlyph:"story_CheckboxSelectedStandard",CardProgressClip:"clip40x40",CardProgressCloseGlyph:"story_CardProgressClose",CardProgressCloseHoverGlyph:"story_CardProgressCloseHover",CardProgressClosePresssedGlyph:"story_CardProgressClosePressed",CardProgressPauseGlyph:"story_CardProgressPause",CardProgressPauseHoverGlyph:"story_CardProgressPauseHover",CardProgressPausePresssedGlyph:"story_CardProgressPausePressed",CardProgressPlayGlyph:"story_CardProgressPlay",CardProgressPlayHoverGlyph:"story_CardProgressPlayHover",CardProgressPlayPresssedGlyph:"story_CardProgressPlayPressed",CardProgressRetryGlyph:"story_CardProgressRetry",CardProgressRetryHoverGlyph:"story_CardProgressRetryHover",CardProgressRetryPresssedGlyph:"story_CardProgressRetryPressed",CardDeckCoAuthorPresenceClip:"clip16x16",CardDeckCoAuthorPresenceGlyph:"story_CoAuthorPresence",SetThumbCardIconClip:"clip16x16",WikipediaWIconClip:"clip20x20",WikipediaWIconGlyph:"story_WikipediaWIcon",BingbIconClip:"clip18x22",BingbIconGlyph:"story_BingbIcon",CardText:"story_CardText",CardHeader:"story_CardHeader",CardImage:"story_CardImage",CardVideo:"story_CardVideo",CardTweet:"story_CardTweet",CardEmbed:"story_CardEmbed",CardGroup:"story_CardGroup",CardGroupWhite:"story_CardGroupWhite",CardStack:"story_CardStack",CardStackWhite:"story_CardStackWhite",CardComparison:"story_Comparison",CardComparisonWhite:"story_ComparisonWhite",CardSlideshow:"story_Slideshow",CardSlideshowWhite:"story_SlideshowWhite",CardUniformGrid:"story_UniformGrid",CardUniformGridWhite:"story_UniformGridWhite",CardChart:"story_ChartImage",CardAudio:"story_CardAudio",CardDeckMenuBulletsClip:"clip14x14",CardDeckMenuBulletsGlyph:"story_CardDeckMenuBullets",CardDeckMenuEmphasizeClip:"clip16x16",CardDeckMenuEmphasizeGlyph:"story_CardDeckMenuEmphasize",CardDeckMenuSpecialClip:"clip16x16",CardDeckMenuSpecialGlyph:"story_CardDeckMenuSpecial",CardDeckMenuHeaderClip:"clip14x14",CardDeckMenuHeaderGlyph:"story_CardDeckMenuHeader",CardDeckMenuLinkClip:"clip14x14",CardDeckMenuLinkGlyph:"story_CardDeckMenuLink",CardDeckMenuNumbersClip:"clip14x14",CardDeckMenuNumbersGlyph:"story_CardDeckMenuNumbers",CardMenuDeleteClip:"clip16x16",CardMenuDeleteGlyph:"story_CardMenuDelete",CardMenuDeleteWhiteClip:"clip16x16",CardMenuDeleteWhiteGlyph:"story_CardMenuDeleteWhite",CardMenuFocusClip:"clip16x16",CardMenuFocusGlyph:"story_CardMenuFocus",CardMenuFocusWhiteClip:"clip16x16",CardMenuFocusWhiteGlyph:"story_CardMenuFocusWhite",CardMenuGroupClip:"clip16x16",CardMenuGroupGlyph:"story_CardMenuGroup",CardMenuGroupWhiteClip:"clip16x16",CardMenuGroupWhiteGlyph:"story_CardMenuGroupWhite",CardMenuUngroupClip:"clip16x16",CardMenuUngroupGlyph:"story_CardMenuUngroup",CardMenuUngroupWhiteClip:"clip16x16",CardMenuUngroupWhiteGlyph:"story_CardMenuUngroupWhite",CardMenuOptionsClip:"clip16x16",CardMenuOptionsGlyph:"story_CardMenuOptions",CardMenuOptionsWhiteClip:"clip16x16",CardMenuOptionsWhiteGlyph:"story_CardMenuOptionsWhite",CardDeckMenuFocusClip:"clip16x16",CardDeckMenuFocusGlyph:"story_FocusIcon",CardMenuOverflowClip:"clip16x16",CardMenuOverflowGlyph:"story_ExpandClusters",CardMenuOverflowWhiteGlyph:"story_ExpandClustersWhite",JackDiamondIconClip:"clip36x36",JackDiamondIconGlyph:"story_IPDiamondPlus",JackDefaultIconGlyph:"story_JackDefault",JackHoverFocusIconGlyph:"story_JackHoverFocus",JackPressedIconGlyph:"story_JackPressed",JackUploadIconGlyph:"story_CardUpload",JackCameraIconGlyph:"story_CardCamera",TransformCloseClip:"clip10x10",TransformCloseGlyph:"story_CloseIcon",CardOptionClip:"clip16x16",SelectionClip:"clip30x30",SelectionGlyph:"story_SelectionIconSelected",WarningClip:"clip16x16",WarningGlyph:"story_Warning",CastIconClip:"clip24x24",CastIconGlyph:"story_CastIcon",SocialClip:"clip32x32",SocialFacebookGlyph:"story_SocialFacebook",SocialFacebookHoverGlyph:"story_SocialFacebookHover",SocialFacebookKeyboardGlyph:"story_SocialFacebookKeyboard",SocialFacebookPressedGlyph:"story_SocialFacebookPressed",SocialGoogleplusGlyph:"story_SocialGoogleplus",SocialGoogleplusHoverGlyph:"story_SocialGoogleplusHover",SocialGoogleplusKeyboardGlyph:"story_SocialGoogleplusKeyboard",SocialGoogleplusPressedGlyph:"story_SocialGoogleplusPressed",SocialTwitterGlyph:"story_SocialTwitter",SocialTwitterHoverGlyph:"story_SocialTwitterHover",SocialTwitterKeyboardGlyph:"story_SocialTwitterKeyboard",SocialTwitterPressedGlyph:"story_SocialTwitterPressed",SocialYammerGlyph:"story_SocialYammer",SocialYammerHoverGlyph:"story_SocialYammerHover",SocialYammerKeyboardGlyph:"story_SocialYammerKeyboard",SocialYammerPressedGlyph:"story_SocialYammerPressed",SocialWordpressGlyph:"story_SocialWordpress",SocialWordpressHoverGlyph:"story_SocialWordpressHover",SocialWordpressKeyboardGlyph:"story_SocialWordpressKeyboard",SocialWordpressPressedGlyph:"story_SocialWordpressPressed",SocialTumblrGlyph:"story_SocialTumblr",SocialTumblrHoverGlyph:"story_SocialTumblrHover",SocialTumblrKeyboardGlyph:"story_SocialTumblrKeyboard",SocialTumblrPressedGlyph:"story_SocialTumblrPressed",SocialSharethisGlyph:"story_SocialSharethis",SocialSharethisHoverGlyph:"story_SocialSharethisHover",SocialSharethisKeyboardGlyph:"story_SocialSharethisKeyboard",SocialSharethisPressedGlyph:"story_SocialSharethisPressed",SocialRedditGlyph:"story_SocialReddit",SocialRedditHoverGlyph:"story_SocialRedditHover",SocialRedditPressedGlyph:"story_SocialRedditPressed",SocialPinterestGlyph:"story_SocialPinterest",SocialPinterestHoverGlyph:"story_SocialPinterestHover",SocialPinterestKeyboardGlyph:"story_SocialPinterestKeyboard",SocialPinterestPressedGlyph:"story_SocialPinterestPressed",SocialOverflowGlyph:"story_SocialOverflow",SocialOverflowHoverGlyph:"story_SocialOverflowHover",SocialOverflowKeyboardGlyph:"story_SocialOverflowKeyboard",SocialOverflowPressedGlyph:"story_SocialOverflowPressed",SocialOverflowSelectedGlyph:"story_SocialOverflowSelected"},function(n){function i(){return new r}n.hash=i;var r=function(){function n(){this.dict=new t("#",function(){return location.hash})}return n.prototype.has=function(n){return this.dict.has(n)},n.prototype.fetch=function(n){return this.dict.fetch(n)},n.prototype.fetcharray=function(n){return this.dict.fetcharray(n)},n.prototype.erase=function(n,t){var i=this.dict.erase(n)||"#";t?history.pushState?history.pushState(null,"",i):location.hash=i:history.replaceState?history.replaceState(null,"",i):location.replace(i)},n.prototype.push=function(n,t){history.pushState(null,"",this.dict.add(n,t))},n.prototype.pusharray=function(n,t){history.pushState(null,"",this.dict.addarray(n,t))},n.prototype.replace=function(n,t){location.replace(this.dict.add(n,t))},n.prototype.replacearray=function(n,t){location.replace(this.dict.addarray(n,t))},n}(),t=function(){function n(n,t,i){if(i===void 0&&(i=!1),this.symbol=n,this.value=t,i){var r=this.dict();this.dict=function(){return r}}}return n.prototype.has=function(n){return n in this.dict()},n.prototype.dict=function(){var n=this.value().substring(1);return n?n.split("&").todict(function(n,t){var i=n.split("=").map(function(n){return n.trim()}),r=i.first();r&&(t[r]=i[1]||"")}):{}},n.prototype.keys=function(){return Obj.keys(this.dict())},n.prototype.fetch=function(n){var t=this.dict()[n];return t||""},n.prototype.fetcharray=function(n){var t=this.dict()[n];return t?t.split(";"):[]},n.prototype.erase=function(n){var i=this.value(),t=i.substring(1).split(new RegExp("(?:^|&)"+n+"(?:=(?:\\w|;)*?)?(?:&|$)")).filter(function(n){return!!n}).join("&");return t?this.symbol+t:""},n.prototype.add=function(n,t){var i=this.dict();return i[n]=t||"",this.symbol+Obj.keys(i).map(function(n){var t=i[n];return n+(t?"="+t:"")}).join("&")},n.prototype.addarray=function(n,t){return this.add(n,t.map(function(n){return String(n)}).join(";"))},n}();n.UrlDict=t}(Utilities||(Utilities={}));HashMap=function(){function n(){var t=this;t._map={};n.current===undefined&&(n.current=0)}return n.prototype.getKey=function(n){var t=this,i=t._hash(n);return t._map[i]},n.prototype.setValue=function(n,t){var i=this,r=i._hash(n);return i._map[r]=t,i},n.prototype.removeKey=function(n){var t=this,i=t._hash(n),r=t[i];return r!==undefined&&delete t[i],t},n.prototype.hasKey=function(n){var t=this,i=t._hash(n);return t._map[i]!==undefined},n.prototype._hash=function(t){var i=typeof t+" ";return t instanceof Object?(t.__hash||(t.__hash=++n.current),i+=t.__hash):i+=t.toString(),i},n}();Icons={HomeVideoPoster:CommonSettings.ContentBaseUrl+"HomeVideoPoster.jpg",CanvasArrowIcon:CommonSettings.ContentBaseUrl+"CanvasArrow.png",CardHintLineIcon:CommonSettings.ContentBaseUrl+"DashedLine.png",CheckmarkIcon:CommonSettings.ContentBaseUrl+"Checkmark.png",CheckmarkGrayIcon:CommonSettings.ContentBaseUrl+"CheckmarkGray.png",JackArrowIcon:CommonSettings.ContentBaseUrl+"JackArrow.png",Doughboy24Icon:CommonSettings.ContentBaseUrl+"Doughboy.24x24x32.bmp",Doughboy36Icon:CommonSettings.ContentBaseUrl+"Doughboy.36x36x32.bmp",Doughboy72Icon:CommonSettings.ContentBaseUrl+"Doughboy.72x72x32.bmp",Doughboy20Icon:CommonSettings.ContentBaseUrl+"Doughboy.20x20x32.png",Doughboy48Icon:CommonSettings.ContentBaseUrl+"Doughboy.48x48x32.png",Sway42Icon:CommonSettings.ContentBaseUrl+"Sway.42x42x32.png",AddContentCameraIcon:CommonSettings.ContentBaseUrl+"CameraIcon.png",UploadingSpinner:CommonSettings.ContentBaseUrl+"whitespinner.32x32.gif",homePageIcon_0:"homepageiconreport.png",homePageIcon_1:"homepageiconpresentations.png",homePageIcon_2:"homepageiconnewsletter.png",homePageIcon_3:"homepageiconpersonalStory.png",homePageIcon_4:"homepageiconmore.png",homePageIcon_phone_0:"homepageiconreport_phone.png",homePageIcon_phone_1:"homepageiconpresentations_phone.png",homePageIcon_phone_2:"homepageiconnewsletter_phone.png",homePageIcon_phone_3:"homepageiconpersonalStory_phone.png",homePageIcon_phone_4:"homepageiconmore_phone.png",homePagePromoPillarIcon_0:"HomepageSlidingImage1.png",homePagePromoPillarIcon_1:"HomepageSlidingImage2.png",homePagePromoPillarIcon_2:"HomepageSlidingImage3.png",homePagePromoPillarIcon_3:"HomepageSlidingImage4.png",homePagePromoPillarIcon_4:"HomepageSlidingImage5.png",homePagePromoPillarIcon_phone_0:"HomepageSlidingImage1_phone.png",homePagePromoPillarIcon_phone_1:"HomepageSlidingImage2_phone.png",homePagePromoPillarIcon_phone_2:"HomepageSlidingImage3_phone.png",homePagePromoPillarIcon_phone_3:"HomepageSlidingImage4_phone.png",homePagePromoPillarIcon_phone_4:"HomepageSlidingImage5_phone.png",backgroundGradient_1920:"newhomepagebackgroundgradiant_1920.png",backgroundGradient_1366:"newhomepagebackgroundgradiant_1366.png",backgroundGradient_1024:"newhomepagebackgroundgradiant_1024.png",backgroundGradient_768:"newhomepagebackgroundgradiant_768.png",backgroundGradient_480:"newhomepagebackgroundgradiant_480.png",backgroundGradient_360:"newhomepagebackgroundgradiant_360.png",backgroundImage_1920:"newhomepagebackground_1920.jpg",backgroundImage_1366:"newhomepagebackground_1366.jpg",backgroundImage_1024:"newhomepagebackground_1024.jpg",backgroundImage_768:"newhomepagebackground_768.jpg",backgroundImage_480:"newhomepagebackground_480.jpg",backgroundImage_360:"newhomepagebackground_360.jpg"},function(n){var i=function(){function n(n,t){this.delay=t;this.handle=0;n&&n.addResource(this)}return n.prototype.getDelay=function(){return this.delay},n.prototype.started=function(){return!!this.handle},n.prototype.set=function(n){var t=this;this.clear();this.handle=setTimeout(function(){t.handle=0;n()},this.delay)},n.prototype.clear=function(){this.handle&&(clearTimeout(this.handle),this.handle=0)},n.prototype.dispose=function(){this.clear()},n}(),r,t,u;n.Timeout=i;r=function(){function t(n,t){this.delay=t;this.handle=null;n&&n.addResource(this)}return t.prototype.getDelay=function(){return this.delay},t.prototype.started=function(){return!!this.handle},t.prototype.set=function(t){var i=this;this.clear();this.handle=n.scheduler.schedule(this.delay,function(){i.handle=null;t()})},t.prototype.clear=function(){this.handle&&(this.handle.dispose(),this.handle=null)},t.prototype.dispose=function(){this.clear()},t}();n.ScheduledTimeout=r;t=function(){function n(){this.agenda={}}return n.prototype.schedule=function(n,t){var r="dt"+n,i=this.agenda[r];return i||(i=this.agenda[r]=new u(n,this.callback.bind(this))),i.schedule(t),{dispose:function(){return i.unschedule(t)}}},n.prototype.callback=function(n){var t=n.callbacks,i,r;for(t=t.splice(0,t.length),i=0,r=t.length;i<r;++i)t[i]();delete this.agenda["dt"+n.timeout.getDelay()]},n}();n.Scheduler=t;u=function(){function n(n,t){var r=this;this.callbacks=[];this.timeout=new i(null,n);this.handler=function(){return t(r)}}return n.prototype.schedule=function(n){this.callbacks.push(n);this.timeout.started()||this.timeout.set(this.handler)},n.prototype.unschedule=function(n){this.callbacks.removefirst(n);this.callbacks.length||this.timeout.clear()},n}();n.scheduler=new t}(Utilities||(Utilities={})),function(n){function c(t,i,r){n.CreateClickEater(t,r);t.show("slide",{direction:"up"},250,i)}function l(n,t){n.siblings(".clickEater").remove();n.hide("slide",{direction:"up"},250,t)}function a(n,t){var i=$('<div class="clickEater"/>');return i.click(function(){$(document).off(".clickEater");i.remove();t&&t()}),i.insertBefore(n),i}function v(){return t===undefined&&r(),t}function y(){var n=document.createElement("div"),t,i,r;return n.style.cssText="visibility:hidden;width:100px;height:100px;",t=document.createElement("p"),t.style.cssText="width:100%;height:200%;",n.appendChild(t),document.body.appendChild(n),i=t.offsetWidth,n.style.overflow="scroll",r=t.offsetWidth,document.body.removeChild(n),i-r}function p(){var t=!1,u=i.getCachedCanvas(),n,r;if(u)try{n=u.getContext("2d");r=n.font;n.font="99px Test,";t=n.font!==r;n.font=r}catch(f){t=!1;StoryLog.TraceTag(8233938,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.warning,"The following error was thrown while checking whether canvas contexts accept font families with an appended comma: "+f)}return t}function r(){var n=$('<div style="position:absolute;line-height:29.5px;white-space:pre">a\na<\/div>'),i=$('<div style="position:absolute;font-size:20.0px;white-space:pre">aaaaaaaaaaaaaaa<\/div>'),r=$('<div style="position:absolute;font-size:20.4px;white-space:pre">aaaaaaaaaaaaaaa<\/div>');$("body").append(n).append(i).append(r);t=y();u=n[0].clientHeight===59;f=i[0].clientWidth!==r[0].clientWidth;e=p();StoryLog.TraceTag(6841955,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"Browser scroll bar width: "+t);StoryLog.TraceTag(6841984,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"Browser uses exact line height: "+u);StoryLog.TraceTag(6841985,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"Browser uses exact font size: "+f);StoryLog.TraceTag(6841986,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"Browser accepts trailing commas on font families: "+e);n.remove();i.remove();r.remove()}function w(){return u===undefined&&r(),u}function b(){return f===undefined&&r(),f}function h(){return e===undefined&&r(),e}function k(t){return n.isFontSizeCorrect()?t:Math.round(t)}function d(t){return n.isLineHeightCorrect()?t:Math.ceil(t)}function g(n,t){var r=nt(t),u=i.getCachedCanvas(),f;if(!u)return o(n,r);try{f=u.getContext("2d");f.font=r}catch(e){if(StoryLog.TraceTag(8233939,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.warning,"The following error was thrown while setting a font to canvas context in getTextWidth method: "+e),u=i.retryWithNewCanvas(),!u)return o(n,r);f=u.getContext("2d");try{f.font=r}catch(e){return StoryLog.TraceTag(8233941,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.warning,"The following error was thrown while setting a font to just created canvas context in getTextWidth method: "+e),o(n,r)}}return f.measureText(n).width}function nt(n){return h()?(n=Utilities.trimEnd(n),n.length>=1&&n[n.length-1]!==","&&(n+=","),n):n}function o(n,t){var u=t.indexOf("px"),i,r,f;if(u===-1)return 0;for(i=-1,r=u-1;r>=0;r--)if(t.charAt(r)==" "){i=r;break}return i==-1?0:(f=parseFloat(t.substr(i,u-i)),isNaN(f)?0:n.length*.5*f)}var t,s,i,u,f,e;n.ShowMenu=c;n.HideMenu=l;n.CreateClickEater=a;n.GetScrollbarSize=v;s=function(){function n(){this._MAX_NUMBER_OF_RETRIES=10;this._numberOfCanvasRetries=0;this._cachedCanvasTimeout=new Utilities.ScheduledTimeout(null,300)}return n.prototype.getCachedCanvas=function(){var n=this;if(this._cachedCanvas)return this._cachedCanvasTimeout.set(function(){return n.resetCanvas()}),this._cachedCanvas;while(this._numberOfCanvasRetries<this._MAX_NUMBER_OF_RETRIES){if(this._cachedCanvas=document.createElement("canvas"),this._cachedCanvas)return this._cachedCanvasTimeout.set(function(){return n.resetCanvas()}),this._cachedCanvas;this._numberOfCanvasRetries++}return null},n.prototype.retryWithNewCanvas=function(){return StoryLog.TraceTag(8233940,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.warning,"Current number of created canvases is: "+this._numberOfCanvasRetries),this._numberOfCanvasRetries++,this.resetCanvas(),this.getCachedCanvas()},n.prototype.resetCanvas=function(){this._cachedCanvas=null},n}();i=new s;n.isLineHeightCorrect=w;n.isFontSizeCorrect=b;n.allowTrailingCommasOnFontFamilies=h;n.getAdjustedFontSize=k;n.getAdjustedLineHeight=d;n.getTextWidth=g;n.topBarHeight=50;n.showAppBarHoverRegionHeight=6;n.minPreviewHeight=0;n.minTopBarWidth=600;n.minChromelessTopBarWidth=100;n.cardDeckPeekWidth=84}(UX||(UX={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function t(){}return t.prototype.initDialog=function(t){var e=this,i=this,r=[{caption:Resources.ButtonClose,isDefault:!0,dismissOnAction:!0,id:"idshButtonOK"}],u,f;window.clipboardData&&window.clipboardData.setData&&r.push({caption:Resources.CopyToClipboard,onAction:$.proxy(this.onCopyClicked,this),id:"idshButtonCopy",isNeutralButton:!0});t.alternateText&&t.checkboxMessage&&t.checkboxId&&r.push({caption:t.checkboxMessage,isCheckbox:!0,onAction:function(n,r){var o=i._dlg.buttonsArgs().getValue(),u=o.firstOrDefault(function(n){var t=n;return t&&t.getArgs()==r}),f=u?u.buttonArgs():null,s=f&&f.isChecked.getValue();return e._textBox.setText(s?t.alternateText:t.text),ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(t.checkboxId,Diag.ULSCat.msoulscat_Story_Feedback)),!1},id:ClientAction.ButtonId[t.checkboxId],dismissOnAction:!1});u={title:t.title,messages:t.messages,width:500,noFocus:!0,DialogType:2,buttonsArgs:r};i._dlg=n.View.Common.DialogManager.createDialog(u);f={cssClass:"copyTextBox",readOnly:!0,text:t.text,selectTextOnFocus:!0,description:t.textBoxDescription};i._textBox=new n.View.ViewElements.TextBoxVE(i._dlg,f);i._dlg.updateContent(i._textBox);n.View.Common.DialogManager.showDialog(i._dlg)},t.show=function(n){var i=new t;i.initDialog(n)},t.prototype.onCopyClicked=function(){return window.clipboardData&&window.clipboardData.setData&&window.clipboardData.setData("Text",this._textBox.getText()),!1},t}();t.CopyTextDialog=i})(i=t.Common||(t.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={}));var AuthoringDisabledDialog=function(){function n(){}return n.prototype.initDialog=function(n,t){var i=this,r={title:n,messages:t,width:500,noFocus:!0,dialogType:2,buttonsArgs:[{caption:Resources.ButtonOK,isDefault:!0,dismissOnAction:!0,id:"idshButtonDismiss"}]};i._dlg=StoryApp.View.Common.DialogManager.createAndShow(r)},n.show=function(t,i){var r=new n;r.show(t,i)},n.prototype.show=function(n,t){var i=this;StoryLog.TraceTag(6391388,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User attempted to edit or create a Sway while Authoring is disabled.");i.initDialog(n,t)},n}(),BRSDialog=function(){function n(){}return n.prototype.initDialog=function(n,t){var i=this,r={title:n,messages:t,width:500,noFocus:!0,DialogType:2,buttonsArgs:[{caption:Resources.ButtonOK,isDefault:!0,dismissOnAction:!0,id:"idshButtonDismiss"}]};i._dlg=StoryApp.View.Common.DialogManager.createAndShow(r)},n.show=function(t,i){var r=new n;r.show(t,i)},n.showIfAuthoringDisabled=function(){return CommonSettings.InitialWatchableSwitches.authoringDisabled?(n.show(Resources.BRSDialogTitle,[Resources.BRSDialogMessage]),!0):!1},n.prototype.show=function(n,t){var i=this;i.initDialog(n,t)},n}(),ErrorDialog=function(){function n(){}return n.ShowErrorDialog=function(n,t,i,r){i===void 0&&(i="Undefined");$.browser.webkit?setTimeout($.proxy(function(){this.ShowError(n,t,i,r)},this),1e3):this.ShowError(n,t,i,r)},n.ShowError=function(n,t,i,r){var f=this,u={title:n,messages:[t],noFocus:!0,dialogLogMessage:i,dialogType:4,buttonsArgs:[{caption:Resources.ButtonOK,onAction:r!=null?r:undefined,isDefault:!0,dismissOnAction:!0,id:"iddlButtonOK"}]};StoryApp.View.Common.DialogManager.createAndShow(u)},n}(),NyiDialog=function(){function n(){}return n.prototype.initDialog=function(){var n=this,t={title:Resources.NyiDialogTitle,messages:[Resources.NyiDialogBody],width:500,noFocus:!0,dialogType:2,buttonsArgs:[{caption:Resources.ButtonCancel,isDefault:!0,dismissOnAction:!0,id:"idshButtonDismiss"}]};n._dlg=StoryApp.View.Common.DialogManager.createAndShow(t)},n.show=function(){var t=new n;t.show()},n.prototype.show=function(){var n=this;n.initDialog()},n}(),StoryApp;(function(n){var t;(function(t){var i;(function(t){var i=function(){function i(n,t){this._lookupId=n;this._isPublished=t}return i.createAndShow=function(n,t){var r=new i(n,t);r.show()},i.prototype.show=function(){var u=this,t,i,r,f;CommonSettings.SiteSocialShareDropdownEnabled?(t=Resources.SharingRevokeLinksDialogTitleNew,i=u._isPublished?[Resources.SharingRevokeLinksDialogBody,Resources.SharingRevokeLinksDialogBodyCastRemove]:[Resources.SharingRevokeLinksDialogBody],r=Resources.SharingRevokeLinksDialogOKButtonTextNew):(t=Resources.SharingRevokeLinksDialogTitle,i=[Resources.SharingRevokeLinksDialogBody],r=Resources.SharingRevokeLinksDialogOKButtonText);f={title:t,messages:i,width:500,noFocus:!0,dialogType:1,buttonsArgs:[{caption:Resources.ButtonCancel,id:"idshButtonDismiss",isNeutralButton:!0},{caption:r,onAction:$.proxy(this.onButtonOK,this),isDefault:!0,dismissOnAction:!1,id:"idshButtonOK"}]};u._dlg=n.View.Common.DialogManager.createAndShow(f)},i.prototype.onButtonOK=function(){var n=this,i=new t.DialogLoadingSpinnerVE(n._dlg);n._dlg.updateContent(i);n._dlg.updateButtons([]);n._dlg.updateContentMessage([]);SharingManager.changeAuthToken(n._lookupId,$.proxy(n.onSuccess,n),$.proxy(n.onError,n))},i.prototype.onSuccess=function(n){window.location.href=n.viewUrl},i.prototype.onError=function(n,t,i){$.browser.webkit&&n.status==0&&t=="error"&&i==""?setTimeout($.proxy(function(){this.showError()},this),1e3):this.showError(t,i)},i.prototype.showError=function(){var i=this,t;n.View.Common.DialogManager.closeCurrentDialog();t={dialogType:4,title:Resources.SharingRevokeLinksErrorTitleNew,messages:[Resources.SharingRevokeLinksErrorBody],width:500,noFocus:!0,buttonsArgs:[{caption:Resources.ButtonClose,isDefault:!0,dismissOnAction:!0,id:"idshButtonClose"}]};i._dlg=n.View.Common.DialogManager.createAndShow(t)},i}();t.RevokeSharingDialog=i})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))})(StoryApp||(StoryApp={})),function(n){var t;(function(t){var i;(function(t){var i=n.View.ViewElements,r=function(){function n(t){var i=this;if(n._instance)throw new Error("Error: Do not use Dialog constructor, use DialogManager.getInstance() instead.");i._context=t;i._currentDialogs=TDB.watchableTag(6156811,t,[])}return n.setContext=function(t){if(n._instance)throw new Error("Error: context has already been set.");n._instance=new n(t)},n.initialized=function(){return!!n._instance},n.getInstance=function(){return n._instance?n._instance:(StoryLog.TraceTag(6558553,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"DialogManager context has not been set"),undefined)},n.UseInstance=function(t){var i=n.getInstance();return i?t(i):undefined},n.createDialog=function(t){return n.UseInstance(function(n){return n.createDialog(t)})},n.createAndShow=function(t){return n.UseInstance(function(n){return n.createAndShow(t)})},n.showDialog=function(t){return n.UseInstance(function(n){return n.showDialog(t)})},n.closeCurrentDialog=function(t){return n.UseInstance(function(n){return n.closeCurrentDialog(t)})},n.getCurrentDialog=function(t){return n.UseInstance(function(n){return n.getCurrentDialog(t)})},n.prototype.createAndShow=function(n){var t=this,i=t.createDialog(n);return t.showDialog(i),i},n.prototype.getCurrentDialogs=function(n){var t=this;return t._currentDialogs.getWatchedValue(n)},n.prototype.showDialog=function(n){var t=this;TDB.applyUpdate(function(){var i=t.getCurrentDialogs();i.push(n);t._currentDialogs.notify();n===t.getCurrentDialog()&&n.show()})},n.prototype.getCurrentDialog=function(n){var i=this,t=i.getCurrentDialogs(n);return t.length>0?t[0]:null},n.prototype.closeCurrentDialog=function(n){var t=this;TDB.applyUpdate(function(){var i=t.getCurrentDialog();i&&i.close(function(){n&&n()})})},n.removeDialog=function(t){var i=n.getInstance(),u=i.getCurrentDialogs(),r=u.indexOf(t);r<0||TDB.applyUpdate(function(){u.splice(r,1);i._currentDialogs.notify();t.isVisible()&&t.close();var n=i.getCurrentDialog();n&&r==0&&n.show()},4)},n.prototype.createDialog=function(n){var t=this,r=new i.DialogVE(t._context,n);return t._context.addResource(r),r},n.prototype.getContext=function(){var n=this;return n._context},n._instance=null,n}();t.DialogManager=r})(i=t.Common||(t.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={}));var NewUserDialog=function(){function n(){}return n.prototype.initDialog=function(n){var t=this,r=t.buildParagraph2Html(),u={title:Resources.NewUserDialogTitleV2,messages:[Resources.NewUserDialogMessage1V2],noFocus:!0,dialogType:2,buttonsArgs:[{caption:Resources.NewUserDialogButton,isDefault:!0,dismissOnAction:!0,id:"firstRunDismiss"}],onClose:n},i;t._dlg=StoryApp.View.Common.DialogManager.createAndShow(u);i=new StoryApp.View.ViewElements.DialogHtmlContainerVE(t._dlg,{innerHTML:r});t._dlg.updateContent(i)},n.show=function(t){var i=new n;i.show(t)},n.prototype.show=function(n){var t=this;t.initDialog(n)},n.prototype.buildParagraph2Html=function(){var n=this,t=$("<p>").text(Resources.NewUserDialogMessage2V2).html(),i=$("<span role='text img' aria-labeledBy='menuAccessibilityText'>").text(n.getMenuCharacters()),r=$("<span class='inlineScreenReaderOnly' id='menuAccessibilityText'>").text(n.getMenuAccessibilityText()),u=$("<span>").append(r,i).html();return Utilities.formatString(t,[u])},n.prototype.getMenuCharacters=function(){return"···"},n.prototype.getMenuAccessibilityText=function(){return Resources.OverFlowButtonDescription},n}(),SurveyDialog=function(){function n(n){var t=this;t._args=n}return n.prototype.initDialog=function(){var n=this,i={title:n._args.title,messages:n._args.messages,noFocus:!0,dialogType:1,onCancel:$.proxy(n.onCancelClick,n),buttonsArgs:[{caption:Resources.ButtonSend,isDefault:!0,dismissOnAction:!0,id:"idButtonSubmit",onAction:$.proxy(n.onSubmitClick,n)},{caption:Resources.ButtonNotNow,dismissOnAction:!0,id:"idButtonNotNow",onAction:$.proxy(n.onCancelClick,n)}]},t;n._dlg=StoryApp.View.Common.DialogManager.createDialog(i);t={questions:n._args.questions};n._surveyBox=new StoryApp.View.ViewElements.SurveyBoxVE(n._dlg,t);n._dlg.updateContent(n._surveyBox);StoryApp.View.Common.DialogManager.showDialog(n._dlg)},n.prototype.show=function(){var n=this;StoryLog.TraceTag(7444511,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User opened survey dialog.");n.initDialog()},n.prototype.onSubmitClick=function(){var n=this;ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(282,Diag.ULSCat.msoulscat_Story_Site));n._args.context&&n._args.onSubmit&&n._args.onSubmit.call(n._args.context,n._surveyBox.getAnswers())},n.prototype.onCancelClick=function(){var n=this;ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(281,Diag.ULSCat.msoulscat_Story_Site));n._args.context&&n._args.onCancel&&n._args.onCancel.call(n._args.context)},n}(),OneNoteSurveyDialog=function(){function n(){var n=this,t={checkboxOptions:[Resources.OneNoteSurveyFirstQuestionFirstOption,Resources.OneNoteSurveyFirstQuestionSecondOption,Resources.OneNoteSurveyFirstQuestionThirdOption,Resources.OneNoteSurveyFirstQuestionFourthOption,Resources.OneNoteSurveyFirstQuestionFifthOption],hasTextBox:!0,textBoxPlaceholder:"",textBoxLabel:Resources.OneNoteSurveyFirstQuestionOtherOption,textBoxLength:240,question:Resources.OneNoteSurveyFirstQuestion,questionExplanation:Resources.OneNoteSurveyQuestionExplanation,id:"onenote-othercontent",questionType:1},i={checkboxOptions:[Resources.OneNoteSurveySecondQuestionFirstOption,Resources.OneNoteSurveySecondQuestionSecondOption,Resources.OneNoteSurveySecondQuestionThirdOption],hasTextBox:!0,textBoxPlaceholder:"",textBoxLabel:Resources.OneNoteSurveySecondQuestionOtherOption,textBoxLength:240,question:Resources.OneNoteSurveySecondQuestion,questionExplanation:Resources.OneNoteSurveyQuestionExplanation,id:"onenote-contenthelp",questionType:1},r=[t,i],u={onSubmit:n.onSubmit,onCancel:n.onCancel,context:n,questions:r,messages:[Resources.OneNoteSurveyText]};n._surveyDialog=new SurveyDialog(u)}return n.prototype.onSubmit=function(n){var e=this,i={},t,r,u,f;for(t in n){r=n[t];u=r.checkboxOptions;for(f in u)i[t+"/"+f]=u[f]?"true":"false";i[t+"/other"]=r.textboxValue}StoryLog.StructuredTraceTag(7455951,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Add Content : OneNote : Survey results",i)},n.prototype.onCancel=function(){var n=this;StoryLog.TraceTag(7455952,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Add Content : OneNote : User closed OneNote survey dialog")},n.prototype.getSurveyDialog=function(){var n=this;return n._surveyDialog},n}(),StoryApp;(function(n){var t;(function(t){var i;(function(t){var i=n.View.ViewElements,r=function(){function n(){this._initializedPromise=$.Deferred()}return n.getInstance=function(){return n._instance||(n._instance=new n),n._instance},n.prototype.initialized=function(){return this._context!=undefined},n.prototype.initializedPromise=function(){return this._initializedPromise.promise()},n.prototype.setContext=function(n){var t=this;if(t._context)throw new Error("NotificationBarManager context has already been set.");t._context=n;t._notificationBar=TDB.watchable(n,null);t._initializedPromise.resolve()},n.prototype.setCurrentNotificationBar=function(n,t){var i=this,r;if(i._context==undefined)throw new Error("Context has not been set. Call setContext before any methods can be called.");return(r=i._notificationBar.getValue(),r)?(t&&i.clearNotification(function(){i.setCurrentNotificationBar(n,t)}),t):(TDB.applyUpdate(function(){i._notificationBar.setValue(n);n.show()}),!0)},n.prototype.getCurrentNotificationBar=function(n){var t=this;if(t._context==undefined)throw new Error("Context has not been set. Call setContext before any methods can be called.");return t._notificationBar.getWatchedValue(n)},n.prototype.createNotificationBar=function(n){var t=this;if(t._context==undefined)throw new Error("Context has not been set. Call setContext before any methods can be called.");return new i.NotificationBarVE(t._context,n)},n.prototype.createAndShowNotificationBar=function(n,t){var i=this,r;if(i._context==undefined)throw new Error("Context has not been set. Call setContext before any methods can be called.");return i._notificationBar.getValue()!==null&&!t?null:(r=i.createNotificationBar(n),i.setCurrentNotificationBar(r,t),r)},n.prototype.clearNotification=function(n){var t=this,i;if(t._context==undefined)throw new Error("Context has not been set. Call setContext before any methods can be called.");i=t._notificationBar.getValue();i&&i.hide(function(){TDB.applyUpdate(function(){t._notificationBar.setValue(null)});n&&n()})},n}();t.NotificationBarManager=r})(i=t.Common||(t.Common={}))})(t=n.View||(n.View={}))})(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(t){var i=this;if(n._instance)throw new Error("Error: Do not use BlockingProgressManager constructor, use BlockingProgressManager.setContext() instead.");i._ve=t}return n.setContext=function(t){if(n._instance)throw new Error("Error: context has already been set.");n._instance=new n(t)},n.getInstance=function(){return n._instance?n._instance:(StoryLog.TraceTag(7463833,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"BlockingProgressManager context has not been set"),undefined)},n.UseInstance=function(t){var i=n.getInstance();return i?t(i):undefined},n.show=function(t){n.UseInstance(function(n){return n.show(t)})},n.prototype.show=function(n){var t=this;t._ve!=null&&t._ve.show(n)},n.hide=function(){n.UseInstance(function(n){return n.hide()})},n.prototype.hide=function(){var n=this;n._ve!=null&&n._ve.hide()},n._instance=null,n}();n.BlockingProgressManager=t})(t=n.Common||(n.Common={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){function i(n,i){t.getInstance().setContext(n,i)}function r(){t.getInstance().operationStarted()}function u(){t.getInstance().operationEnded(!0)}function f(){t.getInstance().flush()}function e(n){return t.getInstance().getCounterValue(n)}function o(n,i){i===void 0&&(i=null);t.getInstance().decrementCounter(n);null!==i&&t.getInstance().setContext(n,i)}function s(n,i){i===void 0&&(i=null);t.getInstance().incrementCounter(n);null!==i&&t.getInstance().setContext(n,i)}function h(n,i,r){i===void 0&&(i=0);r===void 0&&(r=null);t.getInstance().createCounter(n,i,r)}function c(n,i,r){r===void 0&&(r=null);t.getInstance().createMeasure(n,i,r)}function l(n,i){t.getInstance().observeValues(n,i)}function a(n){t.getInstance().resetCounter(n)}function v(n){t.getInstance().recordAction(n)}function y(n){t.getInstance().recordRenderTiming(n)}function p(n){t.getInstance().actionStarted(n)}function w(n){t.getInstance().registerActionCallback(n)}var t=function(){function n(){this.actions=[];this.actionsTypeName=[];this.aggregations={};this.renderTimes=[];this.actionInProgress=null;this.syncActionsStarted=0;this.syncActionsEnded=0;this.statMultivariateMeasures={};this.markTimingNonAtomic=!1;this.actionCallbacks=[];this.resetRecord()}return n.prototype.getStartTime=function(){return this.operationStart},n.prototype.decrementCounter=function(n){var t=this.getAggregationById(n);if(t)t.decrement();else throw new Error("ActionLogger.decrementCounter() called for uninitialized counter:"+n);},n.prototype.getCounterValue=function(n){var t=this.getAggregationById(n);return t?t.getValue():(StoryLog.TraceTag(6603167,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"ActionLogger.getCounterValue() called for uninitialized counter:"+n),-1)},n.prototype.incrementCounter=function(n){var t=this,i=t.getAggregationById(n);i?i.increment():(t.createCounter(n),t.incrementCounter(n))},n.prototype.createCounter=function(n,t,i){t===void 0&&(t=0);i===void 0&&(i=null);var r=this,u=r.getAggregationById(n);if(u)throw new Error("ActionLogger.createCounter() called for existing counter: "+n);else r.aggregations[n]=new ClientAction.CounterData(n,t,i)},n.prototype.createMeasure=function(n,t,i){i===void 0&&(i=null);var r=this,u=r.getAggregationById(n);if(u)throw new Error("ActionLogger.createMeasure() called for existing measure: "+n);else r.aggregations[n]=new ClientAction.StatisticalData(n,t,i)},n.prototype.resetCounter=function(n){var i=this,t=i.getAggregationById(n);if(t)i.logAction(t),t.reset();else throw new Error("ActionLogger.resetCounter() called for uninitialized counter.");},n.prototype.observeValues=function(n,t){var i=this,r=i.getAggregationById(n);r?r.observe(t):i.aggregations[n]=new ClientAction.StatisticalData(n,t)},n.prototype.setContext=function(n,t){var i=this.getAggregationById(n);if(i)i.setContext(t);else throw new Error("ActionLogger.setContext() called for uninitialized id: "+n);},n.prototype.actionStarted=function(n){var t=this;(t.actionCallbacks.forEach(function(t){return t(n,!0)}),n.isSyncAction())&&(t.syncActionsStarted!=0&&(t.markTimingNonAtomic=!0),t.actionInProgress=n,t.syncActionsStarted++)},n.prototype.recordAction=function(n){var t=this;t.actionCallbacks.forEach(function(t){return t(n,!1)});n.isSyncAction()?(t.syncActionsEnded++,n==t.actionInProgress?t.actionInProgress=null:t.markTimingNonAtomic=!0,(t.syncActionsStarted!=t.syncActionsEnded||t.syncActionsEnded!=1)&&(t.markTimingNonAtomic=!0),n.setOperationStartTime(t.operationStart),t.actions.push(n),t.actionsTypeName.push(n.getActionType()?ClientAction.ActionType[n.getActionType()]:"")):t.logAction(n)},n.prototype.recordRenderTiming=function(n){var t=this;t.syncActionsStarted>0&&t.renderTimes.push(n)},n.prototype.operationStarted=function(){var n=this;n.operationStart&&(n.operationStart=new Date);(n.syncActionsStarted!=1||n.syncActionsEnded!=0)&&(n.markTimingNonAtomic=!0)},n.prototype.operationEnded=function(n){var t=this,r,i;if(n)for(r=t.actions.length,i=0;i<r;i++)t.actions[i]?t.logAction(t.actions[i]):StoryLog.TraceTag(8938201,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"ActionLogger : operationEnded : Action initiated in this sync is null : Unable to log action : Action length = {0} : SyncActionsStarted = {1} : SyncActionsEnded = {2} : ActionInProgress = {3} : ActionTypeNames = {4}",[t.actions&&t.actions.length,t.syncActionsStarted,t.syncActionsEnded,!!t.actionInProgress,t.actionsTypeName]);t.resetRecord()},n.prototype.flush=function(){var n=this;for(var t in n.aggregations)n.logAction(n.aggregations[t]);n.operationStarted&&n.operationEnded(!0);return},n.prototype.logAction=function(n){var t=this;if(!n){StoryLog.TraceTag(8938202,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"ActionLogger : logAction : actionData is null : Unable to log action : Action length = {0}",[t.actions&&t.actions.length]);return}n.isSyncAction()&&(n.setElapsedTime((new Date).getTime()-n.getActionStartTime().getTime()),n.setRenderTimes(t.renderTimes.slice(0)),t.isAtomicChange()&&n.markAsAtomicOperation());StoryLog.TraceTag(5871705,n.getUlsCategory(),n.getUlsTraceLevel(),n.stringify())},n.prototype.getAggregationById=function(n){return this.aggregations[n]?this.aggregations[n]:null},n.prototype.isAtomicChange=function(){return!this.markTimingNonAtomic&&this.syncActionsStarted==1&&this.syncActionsEnded==1},n.prototype.registerActionCallback=function(n){this.actionCallbacks.push(n)},n.prototype.resetRecord=function(){var n=this;n.actionInProgress=null;n.operationStart=null;n.actions=[];n.markTimingNonAtomic=!1;n.syncActionsEnded=0;n.syncActionsStarted=0;n.renderTimes=[]},n.getInstance=function(){return n.instance||(n.instance=new n),n.instance},n}();n.SetContext=i;n.StartOperationLogging=r;n.EndOperationLogging=u;n.Flush=f;n.GetClientCounterValue=e;n.DecrementClientCounter=o;n.IncrementClientCounter=s;n.CreateClientCounter=h;n.CreateClientMeasure=c;n.ObserveClientMeasure=l;n.ResetClientCounter=a;n.RecordClientAction=v;n.RecordRenderTiming=y;n.BeginSyncAction=p;n.RegisterActionCallback=w}(ActionLogger||(ActionLogger={})),function(n){var t=function(){function n(){this.dependency=null;this.listeners=[]}return n.prototype.value=function(){return this.dependency},n.prototype.addListener=function(n){var t=this.listeners.indexOf(n);if(t!==-1)throw new Error("Tried adding a listener twice");this.dependency&&n.bound(this.dependency);this.listeners.push(n)},n.prototype.removeListener=function(n){var t=this.listeners.indexOf(n);if(t===-1)throw new Error("Tried removing a listener that wasn't registered");this.dependency&&n.unbound(this.dependency);this.listeners.splice(t,1)},n.prototype.bind=function(n){if(this.dependency)throw new Error("Tried binding a dependency twice");this.dependency=n;this.listeners.forEach(function(t){return t.bound(n)})},n.prototype.unbind=function(n){if(this.dependency!==n)throw new Error("Tried unbinding a dependency that wasn't bound");this.listeners.forEach(function(t){return t.unbound(n)});this.dependency=null},n.prototype.isEmpty=function(){return this.dependency===null&&this.listeners.length===0},n}(),i=function(){function n(){this.handles={}}return n.prototype.value=function(n){var t=this.handles[n];return t?t.value():null},n.prototype.addListener=function(n,t){this.getDependency(n).addListener(t)},n.prototype.removeListener=function(n,t){var i=this.getDependency(n);i.removeListener(t);i.isEmpty()&&delete this.handles[n]},n.prototype.bind=function(n,t){this.getDependency(n).bind(t)},n.prototype.unbind=function(n,t){var i=this.getDependency(n);i.unbind(t);i.isEmpty()&&delete this.handles[n]},n.prototype.getDependency=function(n){var i=this.handles[n];return i||(i=this.handles[n]=new t),i},n}();n.AsyncDependencySet=i}(Utilities||(Utilities={})),function(n){var t=function(){function n(){this.dict={}}return n.prototype.put=function(n,t,i){var r=this.dict[n];r||(r=this.dict[n]={});r[t]=i},n.prototype.find=function(n,t){var i=this.dict[n];return i?i[t]:undefined},n.prototype.remove=function(n,t){var i=this.dict[n],r,u;if(i){delete i[t];r=!0;for(u in i){r=!1;break}r&&delete this.dict[n]}},n.prototype.clear=function(){this.dict={}},n.prototype.enumerateValues=function(){var t=[],i,n,r;for(i in this.dict){n=this.dict[i];for(r in n)t.push(n[r])}return t},n}();n.BiDictionary=t}(Utilities||(Utilities={})),function(n){function r(n){var t=0,r,i;if(n&&n.length!=0)for(i=0;i<n.length;i++)r=n.charCodeAt(i),t=(t<<5)-t+r|0;return t}function eu(n){return f[n]}var fu=StoryApp.Common,c=StoryApp.View.Common.FRE,u,f,l,ou,su,a,hu,o,s,t,i,v,y,p,w,b,k,d,g,nt,tt,it,rt,e,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi,yi,pi,wi,bi,ki,di,gi,nr,tr,ir,h,rr,ur,fr,er,or,sr,hr,cr,lr,ar,vr,yr,pr,wr,br,kr,dr,gr,nu,tu,iu,ru,uu;n.getHashCode=r,function(n){n[n.AddContent=0]="AddContent";n[n.AddContent_AddBingImageContent=1]="AddContent_AddBingImageContent";n[n.AddContent_AddPicHitImageContent=2]="AddContent_AddPicHitImageContent";n[n.AddContent_AddOneNoteImageContent=3]="AddContent_AddOneNoteImageContent";n[n.AddContent_AddSuggestedImageContent=4]="AddContent_AddSuggestedImageContent";n[n.AddContent_CreateNewImageUnit=5]="AddContent_CreateNewImageUnit";n[n.AddContent_SuggestedContent=6]="AddContent_SuggestedContent";n[n.Aggregation=7]="Aggregation";n[n.ButtonClicked=8]="ButtonClicked";n[n.CalloutCloseButtonClicked=9]="CalloutCloseButtonClicked";n[n.CardDeck_Deserialize=10]="CardDeck_Deserialize";n[n.CardDeck_Serialize=11]="CardDeck_Serialize";n[n.CardDeck_Copy=12]="CardDeck_Copy";n[n.CardDeck_Cut=13]="CardDeck_Cut";n[n.CardDeck_Paste=14]="CardDeck_Paste";n[n.ClearAddContentSelection=15]="ClearAddContentSelection";n[n.CreateNew=16]="CreateNew";n[n.ChangeStyle=17]="ChangeStyle";n[n.ChangeWorld=18]="ChangeWorld";n[n.ChangeColor=19]="ChangeColor";n[n.ChangeColorImageOption=20]="ChangeColorImageOption";n[n.ChangeColorPalette=21]="ChangeColorPalette";n[n.CreateNewTile=22]="CreateNewTile";n[n.MyStoriesChangeSortType=23]="MyStoriesChangeSortType";n[n.MyStoriesViewAuthors=24]="MyStoriesViewAuthors";n[n.ContentAdded=25]="ContentAdded";n[n.Design_Override_ChangeFontSet=26]="Design_Override_ChangeFontSet";n[n.DeleteStory=27]="DeleteStory";n[n.RemoveEditor=28]="RemoveEditor";n[n.DeleteImageContent=29]="DeleteImageContent";n[n.FileUpload=30]="FileUpload";n[n.FileUpload_Pause=31]="FileUpload_Pause";n[n.FileUpload_Resume=32]="FileUpload_Resume";n[n.FileUpload_Retry=33]="FileUpload_Retry";n[n.FileUpload_Cancel=34]="FileUpload_Cancel";n[n.FirstRunExperience_CorrectCompletionAction=35]="FirstRunExperience_CorrectCompletionAction";n[n.FirstRunExperience_CalloutPhasedOut=36]="FirstRunExperience_CalloutPhasedOut";n[n.InvalidFileUpload=37]="InvalidFileUpload";n[n.GetSuggestedContent=38]="GetSuggestedContent";n[n.InitialAddContent=39]="InitialAddContent";n[n.PasteToTextBox=40]="PasteToTextBox";n[n.CloseStory=41]="CloseStory";n[n.OpenStoryline=42]="OpenStoryline";n[n.CloseStoryline=43]="CloseStoryline";n[n.OpenAddContent=44]="OpenAddContent";n[n.CloseAddContent=45]="CloseAddContent";n[n.OpenStylePane=46]="OpenStylePane";n[n.CloseStylePane=47]="CloseStylePane";n[n.OpenNavigationPane=48]="OpenNavigationPane";n[n.CloseNavigationPane=49]="CloseNavigationPane";n[n.OpenMoodMenu=50]="OpenMoodMenu";n[n.CloseMoodMenu=51]="CloseMoodMenu";n[n.OpenLayoutMenu=52]="OpenLayoutMenu";n[n.CloseLayoutMenu=53]="CloseLayoutMenu";n[n.OpenColorPane=54]="OpenColorPane";n[n.CloseColorPane=55]="CloseColorPane";n[n.OpenTransformMenu=56]="OpenTransformMenu";n[n.CloseTransformMenu=57]="CloseTransformMenu";n[n.ShareStory=58]="ShareStory";n[n.StatisticalMeasure=59]="StatisticalMeasure";n[n.PageLoad=60]="PageLoad";n[n.RenderModelLoad=61]="RenderModelLoad";n[n.OpenStoryTile=62]="OpenStoryTile";n[n.Edit_Canvas_SelectAction=63]="Edit_Canvas_SelectAction";n[n.Edit_Canvas_DeselectAction=64]="Edit_Canvas_DeselectAction";n[n.Edit_Canvas_OOUI_DeleteAction=65]="Edit_Canvas_OOUI_DeleteAction";n[n.Edit_Canvas_OOUI_EmphAction=66]="Edit_Canvas_OOUI_EmphAction";n[n.Edit_Canvas_OOUI_XformAction=67]="Edit_Canvas_OOUI_XformAction";n[n.Edit_Canvas_OOUI_EditAction=68]="Edit_Canvas_OOUI_EditAction";n[n.Edit_Canvas_OOUI_ChangeEmphAction=69]="Edit_Canvas_OOUI_ChangeEmphAction";n[n.Edit_Canvas_OOUI_EditImageAction=70]="Edit_Canvas_OOUI_EditImageAction";n[n.DeleteContent=71]="DeleteContent";n[n.ScrollDown=72]="ScrollDown";n[n.Edit_AddXFormUI_Opened=73]="Edit_AddXFormUI_Opened";n[n.Edit_AddXFormUI_SelectTransform=74]="Edit_AddXFormUI_SelectTransform";n[n.Edit_ChangeTransformUI_Opened=75]="Edit_ChangeTransformUI_Opened";n[n.Edit_ChangeTransformUI_Closed=76]="Edit_ChangeTransformUI_Closed";n[n.Edit_ChangeTransformUI_SelectTransform=77]="Edit_ChangeTransformUI_SelectTransform";n[n.DialogShown=78]="DialogShown";n[n.Edit_AddContentUI_Open=79]="Edit_AddContentUI_Open";n[n.Edit_AddContentUI_Close=80]="Edit_AddContentUI_Close";n[n.Edit_AddContentUI_SwitchSource=81]="Edit_AddContentUI_SwitchSource";n[n.Edit_AddContentUI_AddButtonClick=82]="Edit_AddContentUI_AddButtonClick";n[n.Edit_AddContentUI_Search=83]="Edit_AddContentUI_Search";n[n.Edit_AddContentUI_SearchSameQuery=84]="Edit_AddContentUI_SearchSameQuery";n[n.Edit_AddContentUI_SelectContent=85]="Edit_AddContentUI_SelectContent";n[n.Edit_AddContentUI_DeselectContent=86]="Edit_AddContentUI_DeselectContent";n[n.Edit_AddContentUI_ClearSelection=87]="Edit_AddContentUI_ClearSelection";n[n.Edit_AddContentUI_SelectSuggestedContentTag=88]="Edit_AddContentUI_SelectSuggestedContentTag";n[n.Edit_AddContentUI_DeselectSuggestedContentTag=89]="Edit_AddContentUI_DeselectSuggestedContentTag";n[n.Edit_AddContentUI_OpenSuggestedContentDrawer=90]="Edit_AddContentUI_OpenSuggestedContentDrawer";n[n.Edit_AddContentUI_OpenFolder=91]="Edit_AddContentUI_OpenFolder";n[n.Edit_AddContentUI_ChangeTab=92]="Edit_AddContentUI_ChangeTab";n[n.Edit_AddContentUI_NavBack=93]="Edit_AddContentUI_NavBack";n[n.Edit_AddContentUI_Drag=94]="Edit_AddContentUI_Drag";n[n.Edit_AddContentUI_AttributionClose=95]="Edit_AddContentUI_AttributionClose";n[n.Edit_AddContentUI_CreativeCommonsNotificationClose=96]="Edit_AddContentUI_CreativeCommonsNotificationClose";n[n.Edit_AddContentUI_UploadFileCountExceed=97]="Edit_AddContentUI_UploadFileCountExceed";n[n.Edit_AddContentUI_UploadFileInfo=98]="Edit_AddContentUI_UploadFileInfo";n[n.Edit_AddContentUI_UploadLocalVideo=99]="Edit_AddContentUI_UploadLocalVideo";n[n.Edit_AddContentUI_UploadViaMyDevice=100]="Edit_AddContentUI_UploadViaMyDevice";n[n.Edit_AddContentUI_UploadInvalidFiles=101]="Edit_AddContentUI_UploadInvalidFiles";n[n.Edit_AddContentUI_UploadNotificationOpen=102]="Edit_AddContentUI_UploadNotificationOpen";n[n.Edit_AddContentUI_UploadFileSuccess=103]="Edit_AddContentUI_UploadFileSuccess";n[n.Edit_AddContentUI_UploadFileError=104]="Edit_AddContentUI_UploadFileError";n[n.Edit_AddContentUI_IngestFileOneDriveSuccess=105]="Edit_AddContentUI_IngestFileOneDriveSuccess";n[n.Edit_AddContentUI_IngestFileOneDriveError=106]="Edit_AddContentUI_IngestFileOneDriveError";n[n.Site_YoutubePlayerStatusChange=107]="Site_YoutubePlayerStatusChange";n[n.SuggestedContent_CreateImageModel=108]="SuggestedContent_CreateImageModel";n[n.SuggestedContent_SelectContent=109]="SuggestedContent_SelectContent";n[n.SuggestedContent_SelectCluster=110]="SuggestedContent_SelectCluster";n[n.SuggestedContent_ShowMoreSearchTags=111]="SuggestedContent_ShowMoreSearchTags";n[n.SuggestedContent_UserTypedQuerySearch=112]="SuggestedContent_UserTypedQuerySearch";n[n.StorylinePasteContext=113]="StorylinePasteContext";n[n.StorylinePasteInfo=114]="StorylinePasteInfo";n[n.Storyline_Delete=115]="Storyline_Delete";n[n.Storyline_Explode=116]="Storyline_Explode";n[n.Storyline_Group_Clicked=117]="Storyline_Group_Clicked";n[n.Storyline_GroupType_Clicked=118]="Storyline_GroupType_Clicked";n[n.Storyline_Placeholder_Intent_CaptionThenContent=119]="Storyline_Placeholder_Intent_CaptionThenContent";n[n.Storyline_OpenTransform=120]="Storyline_OpenTransform";n[n.Storyline_OpenEmphasisDropdown=121]="Storyline_OpenEmphasisDropdown";n[n.Storyline_ChangeEmphAction=122]="Storyline_ChangeEmphAction";n[n.Storyline_SetGalleryStyle=123]="Storyline_SetGalleryStyle";n[n.Storyline_PlaceholderClicked=124]="Storyline_PlaceholderClicked";n[n.Storyline_CollapseClicked=125]="Storyline_CollapseClicked";n[n.Storyline_CardClicked=126]="Storyline_CardClicked";n[n.Storyline_SelectionToggled=127]="Storyline_SelectionToggled";n[n.Storyline_JackOpened=128]="Storyline_JackOpened";n[n.Storyline_JackTextClicked=129]="Storyline_JackTextClicked";n[n.Storyline_JackHeaderClicked=130]="Storyline_JackHeaderClicked";n[n.Storyline_JackMediaClicked=131]="Storyline_JackMediaClicked";n[n.Storyline_JackEmbedClicked=132]="Storyline_JackEmbedClicked";n[n.Storyline_JackTransformClicked=133]="Storyline_JackTransformClicked";n[n.Storyline_JackLocalClicked=134]="Storyline_JackLocalClicked";n[n.Storyline_JackCardClicked=135]="Storyline_JackCardClicked";n[n.SuggestedClusterDrawerVisibilityChange=136]="SuggestedClusterDrawerVisibilityChange";n[n.Storyline_PasteExceptionRTE=137]="Storyline_PasteExceptionRTE";n[n.Storyline_Text_Header=138]="Storyline_Text_Header";n[n.Storyline_Text_Link=139]="Storyline_Text_Link";n[n.Storyline_Text_RemoveLink=140]="Storyline_Text_RemoveLink";n[n.Storyline_Text_Emphasize=141]="Storyline_Text_Emphasize";n[n.Storyline_Text_Special=142]="Storyline_Text_Special";n[n.Storyline_Text_Bullets=143]="Storyline_Text_Bullets";n[n.Storyline_Text_Bullets_Auto=144]="Storyline_Text_Bullets_Auto";n[n.Storyline_Text_Numbers=145]="Storyline_Text_Numbers";n[n.Storyline_Text_Numbers_Auto=146]="Storyline_Text_Numbers_Auto";n[n.Storyline_Text_RemoveListItems=147]="Storyline_Text_RemoveListItems";n[n.Storyline_Text_Focus_Clicked=148]="Storyline_Text_Focus_Clicked";n[n.Storyline_Text_Focus_Visible=149]="Storyline_Text_Focus_Visible";n[n.Storyline_StorageException=150]="Storyline_StorageException";n[n.Storyline_StyleHints_ClickedOpen=151]="Storyline_StyleHints_ClickedOpen";n[n.YouTubeVideoStateChange=152]="YouTubeVideoStateChange";n[n.Edit_Undo_Keyboard_Undo=153]="Edit_Undo_Keyboard_Undo";n[n.Edit_Undo_Keyboard_Redo=154]="Edit_Undo_Keyboard_Redo";n[n.CreateFromDoc=155]="CreateFromDoc";n[n.Edit_CardGallery_Open=156]="Edit_CardGallery_Open";n[n.Edit_CardGallery_Close=157]="Edit_CardGallery_Close";n[n.Edit_AuthoringTab_Toggle=158]="Edit_AuthoringTab_Toggle";n[n.Edit_CardGallery_AddCard=159]="Edit_CardGallery_AddCard";n[n.Edit_CardGallery_DragCard=160]="Edit_CardGallery_DragCard";n[n.Add_Embed=161]="Add_Embed";n[n.Edit_StyleHintsGallery_Open=162]="Edit_StyleHintsGallery_Open";n[n.Edit_StyleHintsGallery_Close=163]="Edit_StyleHintsGallery_Close";n[n.ChangeStoryAudience=164]="ChangeStoryAudience";n[n.Edit_AuthoringPane_LightDismiss=165]="Edit_AuthoringPane_LightDismiss";n[n.Edit_Canvas_OOUI_CopyLinkAction=166]="Edit_Canvas_OOUI_CopyLinkAction";n[n.AuthorsManager_IPLocation=167]="AuthorsManager_IPLocation";n[n.Storyline_PlaceholderFilled=168]="Storyline_PlaceholderFilled";n[n.ButtonRightClicked=169]="ButtonRightClicked";n[n.Edit_EditImage_Open=170]="Edit_EditImage_Open";n[n.Edit_EditImage_Close=171]="Edit_EditImage_Close";n[n.FocusPane_FocusPointAdd=172]="FocusPane_FocusPointAdd";n[n.FocusPane_FocusPointDelete=173]="FocusPane_FocusPointDelete";n[n.FocusPane_FocusPointDragDrop=174]="FocusPane_FocusPointDragDrop";n[n.FocusPane_FocusPointsReset=175]="FocusPane_FocusPointsReset";n[n.FocusPane_KeepEntireImageChecked=176]="FocusPane_KeepEntireImageChecked";n[n.Add_Document_OneDrive_ImportButtonClick=177]="Add_Document_OneDrive_ImportButtonClick";n[n.Add_Document_OneDrive_EmbedButtonClick=178]="Add_Document_OneDrive_EmbedButtonClick";n[n.Add_Document_OneDrive_IngestSuccess=179]="Add_Document_OneDrive_IngestSuccess";n[n.Add_Document_OneDrive_IngestError=180]="Add_Document_OneDrive_IngestError";n[n.Add_Document_OneDrive_EmbedSuccess=181]="Add_Document_OneDrive_EmbedSuccess";n[n.Add_Document_OneDrive_EmbedError=182]="Add_Document_OneDrive_EmbedError";n[n.Add_Document_Upload_ImportButtonClick=183]="Add_Document_Upload_ImportButtonClick";n[n.Add_Document_Upload_EmbedButtonClick=184]="Add_Document_Upload_EmbedButtonClick";n[n.Add_Document_Upload_IngestSuccess=185]="Add_Document_Upload_IngestSuccess";n[n.Add_Document_Upload_IngestError=186]="Add_Document_Upload_IngestError";n[n.Add_Document_Upload_EmbedSuccess=187]="Add_Document_Upload_EmbedSuccess";n[n.Add_Document_Upload_EmbedError=188]="Add_Document_Upload_EmbedError";n[n.Edit_Emphasis_KeyboardShortcut=189]="Edit_Emphasis_KeyboardShortcut";n[n.Edit_Special_KeyboardShortcut=190]="Edit_Special_KeyboardShortcut";n[n.ViewEmbedCode=191]="ViewEmbedCode";n[n.Client_UserRequestedFlight=192]="Client_UserRequestedFlight";n[n.FileDraggedAndDropped=193]="FileDraggedAndDropped";n[n.TextDraggedAndDropped=194]="TextDraggedAndDropped";n[n.SlidebarChangedPosition=195]="SlidebarChangedPosition";n[n.Storyline_DragAndDrop_CreatedGroup=196]="Storyline_DragAndDrop_CreatedGroup";n[n.Storyline_StrictSizingAction=197]="Storyline_StrictSizingAction";n[n.Edit_AddContentUI_UploadLocalAudio=198]="Edit_AddContentUI_UploadLocalAudio"}(n.ActionType||(n.ActionType={}));u=n.ActionType,function(n){n[n.AboutPane_LicenseTerms=0]="AboutPane_LicenseTerms";n[n.AboutPane_Privacy=1]="AboutPane_Privacy";n[n.AboutPane_ThirdParty=2]="AboutPane_ThirdParty";n[n.AccountsPane_AddMsaAccount=3]="AccountsPane_AddMsaAccount";n[n.AccountsPane_AddOrgIdAccount=4]="AccountsPane_AddOrgIdAccount";n[n.AccountsPane_SignOut=5]="AccountsPane_SignOut";n[n.AccountsPane_CurrentAccount=6]="AccountsPane_CurrentAccount";n[n.AccountsPane_SwitchAccount=7]="AccountsPane_SwitchAccount";n[n.Add_Document_ImportButtonClick=8]="Add_Document_ImportButtonClick";n[n.Add_Document_EmbedButtonClick=9]="Add_Document_EmbedButtonClick";n[n.AddContent_Add=10]="AddContent_Add";n[n.AddContent_AddedOverlay=11]="AddContent_AddedOverlay";n[n.AddContent_AttributionClose=12]="AddContent_AttributionClose";n[n.AddContent_AttributionShowAll=13]="AddContent_AttributionShowAll";n[n.AddContent_ClearSelection=14]="AddContent_ClearSelection";n[n.AddContent_Close=15]="AddContent_Close";n[n.AddContent_CloseLicense=16]="AddContent_CloseLicense";n[n.AddContent_ConnectAccount=17]="AddContent_ConnectAccount";n[n.AddContent_ContentPieces=18]="AddContent_ContentPieces";n[n.AddContent_ContentSource_TextTab=19]="AddContent_ContentSource_TextTab";n[n.AddContent_CreativeCommonsClose=20]="AddContent_CreativeCommonsClose";n[n.AddContent_EmbedAdd=21]="AddContent_EmbedAdd";n[n.AddContent_EmbedText=22]="AddContent_EmbedText";n[n.AddContent_Open=23]="AddContent_Open";n[n.AddContent_RefreshAccount=24]="AddContent_RefreshAccount";n[n.AddContent_Search=25]="AddContent_Search";n[n.AddContent_SourceSelector=26]="AddContent_SourceSelector";n[n.AddContent_Survey=27]="AddContent_Survey";n[n.AppBar_About=28]="AppBar_About";n[n.AppBar_AccessibilityView=29]="AppBar_AccessibilityView";n[n.AppBar_AccessibilityViewExit=30]="AppBar_AccessibilityViewExit";n[n.AppBar_Authors=31]="AppBar_Authors";n[n.AppBar_CreateNew=32]="AppBar_CreateNew";n[n.AppBar_CreateNewFromFacebook=33]="AppBar_CreateNewFromFacebook";n[n.AppBar_CreateNewFromOfficeDocs=34]="AppBar_CreateNewFromOfficeDocs";n[n.AppBar_Download=35]="AppBar_Download";n[n.AppBar_Duplicate=36]="AppBar_Duplicate";n[n.AppBar_OpenUrl=37]="AppBar_OpenUrl";n[n.AppBar_Edit=38]="AppBar_Edit";n[n.AppBar_Feedback=39]="AppBar_Feedback";n[n.AppBar_Fullscreen=40]="AppBar_Fullscreen";n[n.AppBar_Home=41]="AppBar_Home";n[n.AppBar_Home_Inactive=42]="AppBar_Home_Inactive";n[n.AppBar_InternalFeatures=43]="AppBar_InternalFeatures";n[n.AppBar_MyStories=44]="AppBar_MyStories";n[n.AppBar_Overflow=45]="AppBar_Overflow";n[n.AppBar_Hamburger=46]="AppBar_Hamburger";n[n.AppBar_Preview=47]="AppBar_Preview";n[n.AppBar_Profile=48]="AppBar_Profile";n[n.AppBar_Redo=49]="AppBar_Redo";n[n.AppBar_Remix=50]="AppBar_Remix";n[n.AppBar_SignIn=51]="AppBar_SignIn";n[n.AppBar_SignOut=52]="AppBar_SignOut";n[n.AppBar_Style=53]="AppBar_Style";n[n.AppBar_TutorialVideos=54]="AppBar_TutorialVideos";n[n.AppBar_Undo=55]="AppBar_Undo";n[n.AppBar_RefreshStories=56]="AppBar_RefreshStories";n[n.AppSwitcher=57]="AppSwitcher";n[n.Audio_Play=58]="Audio_Play";n[n.AuthorDropDown_AddAuthor=59]="AuthorDropDown_AddAuthor";n[n.AuthDialog_Next=60]="AuthDialog_Next";n[n.Breadcrumb=61]="Breadcrumb";n[n.Callout_CloseButton=62]="Callout_CloseButton";n[n.CanvasPeek=63]="CanvasPeek";n[n.Card=64]="Card";n[n.Card_Placeholder=65]="Card_Placeholder";n[n.CardAction_CollapseOrExpand=66]="CardAction_CollapseOrExpand";n[n.CardAction_CollapseOrExpandLabelWithIcon=67]="CardAction_CollapseOrExpandLabelWithIcon";n[n.CardAction_Delete=68]="CardAction_Delete";n[n.CardAction_StyleHints=69]="CardAction_StyleHints";n[n.CardAction_Group=70]="CardAction_Group";n[n.CardAction_GroupType=71]="CardAction_GroupType";n[n.CardAction_Overflow=72]="CardAction_Overflow";n[n.CardAction_Select=73]="CardAction_Select";n[n.CardAction_UnGroup=74]="CardAction_UnGroup";n[n.CardDeck=75]="CardDeck";n[n.CardOption_Audio=76]="CardOption_Audio";n[n.CardOption_Chart=77]="CardOption_Chart";n[n.CardOption_Comparison=78]="CardOption_Comparison";n[n.CardOption_Document=79]="CardOption_Document";n[n.CardOption_Embed=80]="CardOption_Embed";n[n.CardOption_Grid=81]="CardOption_Grid";n[n.CardOption_Group=82]="CardOption_Group";n[n.CardOption_Header=83]="CardOption_Header";n[n.CardOption_Picture=84]="CardOption_Picture";n[n.CardOption_Slideshow=85]="CardOption_Slideshow";n[n.CardOption_Stack=86]="CardOption_Stack";n[n.CardOption_Text=87]="CardOption_Text";n[n.CardOption_Tweet=88]="CardOption_Tweet";n[n.CardOption_Video=89]="CardOption_Video";n[n.CardPane_Close=90]="CardPane_Close";n[n.CardPane_Open=91]="CardPane_Open";n[n.CardToolbar_Bullets=92]="CardToolbar_Bullets";n[n.CardToolbar_Emphasis=93]="CardToolbar_Emphasis";n[n.CardToolbar_Special=94]="CardToolbar_Special";n[n.CardToolbar_Heading=95]="CardToolbar_Heading";n[n.CardToolbar_Link=96]="CardToolbar_Link";n[n.CardToolbar_Link_RemoveLink=97]="CardToolbar_Link_RemoveLink";n[n.CardToolbar_Numbers=98]="CardToolbar_Numbers";n[n.CardToolbar_Overflow=99]="CardToolbar_Overflow";n[n.CardToolbar_Focus=100]="CardToolbar_Focus";n[n.Checkbox=101]="Checkbox";n[n.Chevron=102]="Chevron";n[n.ColorPane_ColorImageDefaultOption=103]="ColorPane_ColorImageDefaultOption";n[n.ColorPane_ColorImageOption=104]="ColorPane_ColorImageOption";n[n.ColorPane_ColorPaletteOption=105]="ColorPane_ColorPaletteOption";n[n.Dashboard_GetViewUrl=106]="Dashboard_GetViewUrl";n[n.Dashboard_ClickViewUrl=107]="Dashboard_ClickViewUrl";n[n.Delete=108]="Delete";n[n.DesignPane_CarouselNext=109]="DesignPane_CarouselNext";n[n.DesignPane_CarouselPrevious=110]="DesignPane_CarouselPrevious";n[n.DesignPane_CloseButton=111]="DesignPane_CloseButton";n[n.DesignPane_ColorDefaultOption=112]="DesignPane_ColorDefaultOption";n[n.DesignPane_ColorOption=113]="DesignPane_ColorOption";n[n.DesignPane_ColorPalette=114]="DesignPane_ColorPalette";n[n.DesignPane_CustomizeBackButton=115]="DesignPane_CustomizeBackButton";n[n.DesignPane_CustomizeButton=116]="DesignPane_CustomizeButton";n[n.DesignPane_FontSetChooser_Dropdown=117]="DesignPane_FontSetChooser_Dropdown";n[n.DesignPane_FontSetOption=118]="DesignPane_FontSetOption";n[n.DesignPane_Open=119]="DesignPane_Open";n[n.DesignPane_StructureTab=120]="DesignPane_StructureTab";n[n.DesignPane_StyleOption=121]="DesignPane_StyleOption";n[n.DesignPane_StyleTab=122]="DesignPane_StyleTab";n[n.DialogButton=123]="DialogButton";n[n.DialogCheckbox=124]="DialogCheckbox";n[n.DualAuthDialog_AAD=125]="DualAuthDialog_AAD";n[n.DualAuthDialog_MSA=126]="DualAuthDialog_MSA";n[n.Edit_Canvas_OOUI_CopyLinkButton=127]="Edit_Canvas_OOUI_CopyLinkButton";n[n.EditImagePane_Close=128]="EditImagePane_Close";n[n.EditImagePane_Reset=129]="EditImagePane_Reset";n[n.Embed_TextField=130]="Embed_TextField";n[n.Embed_ViewPlaceholder=131]="Embed_ViewPlaceholder";n[n.EndOfStory_Create=132]="EndOfStory_Create";n[n.EndOfStory_Create_SignedIn=133]="EndOfStory_Create_SignedIn";n[n.EndOfStory_Create_SignedOut=134]="EndOfStory_Create_SignedOut";n[n.EndOfStory_ShareFacebook=135]="EndOfStory_ShareFacebook";n[n.EndOfStory_ShareFacebook_ShareThis=136]="EndOfStory_ShareFacebook_ShareThis";n[n.EndOfStory_ShareLink=137]="EndOfStory_ShareLink";n[n.EndOfStory_ShareTwitter=138]="EndOfStory_ShareTwitter";n[n.EndOfStory_ShareTwitter_ShareThis=139]="EndOfStory_ShareTwitter_ShareThis";n[n.FeaturedSway_Next=140]="FeaturedSway_Next";n[n.FeaturedSway_Previous=141]="FeaturedSway_Previous";n[n.FileUpload=142]="FileUpload";n[n.FocusPane_Checkbox=143]="FocusPane_Checkbox";n[n.FollowLink_Blog=144]="FollowLink_Blog";n[n.FollowLink_Facebook=145]="FollowLink_Facebook";n[n.FollowLink_Twitter=146]="FollowLink_Twitter";n[n.GetSuggestedContent=147]="GetSuggestedContent";n[n.GetStartedBottom=148]="GetStartedBottom";n[n.GetStartedTop=149]="GetStartedTop";n[n.Heading_TextField=150]="Heading_TextField";n[n.Home_CallToAction=151]="Home_CallToAction";n[n.Jack_AddMoreContent=152]="Jack_AddMoreContent";n[n.Home_CarouselNext=153]="Home_CarouselNext";n[n.Home_CarouselPrevious=154]="Home_CarouselPrevious";n[n.Home_Platform_iOS=155]="Home_Platform_iOS";n[n.Home_Platform_iPad=156]="Home_Platform_iPad";n[n.Home_Platform_iPhone=157]="Home_Platform_iPhone";n[n.Home_Platform_Web=158]="Home_Platform_Web";n[n.Home_Platform_Windows=159]="Home_Platform_Windows";n[n.HowToVideoSwayInTwoMinutes=160]="HowToVideoSwayInTwoMinutes";n[n.HowToVideoMakeTutorial=161]="HowToVideoMakeTutorial";n[n.HowToVideoBuildPresentation=162]="HowToVideoBuildPresentation";n[n.HowToVideoCreateNewsletter=163]="HowToVideoCreateNewsletter";n[n.HowToVideoShareVacation=164]="HowToVideoShareVacation";n[n.Jack_AllCards=165]="Jack_AllCards";n[n.Jack_Upload=166]="Jack_Upload";n[n.Jack_Camera=167]="Jack_Camera";n[n.Map_Next=168]="Map_Next";n[n.Map_Previous=169]="Map_Previous";n[n.Media_TextField=170]="Media_TextField";n[n.MoodPane_MoodOption=171]="MoodPane_MoodOption";n[n.MyStories_Title=172]="MyStories_Title";n[n.MyStories_Title_AllSways=173]="MyStories_Title_AllSways";n[n.MyStories_Title_MySways=174]="MyStories_Title_MySways";n[n.MyStories_Title_SharedwithMeSways=175]="MyStories_Title_SharedwithMeSways";n[n.NavigationPane_CloseButton=176]="NavigationPane_CloseButton";n[n.NavigationPane_Open=177]="NavigationPane_Open";n[n.NavigationPane_LayoutOption=178]="NavigationPane_LayoutOption";n[n.NavigationPane_LayoutOption_DepthWorld=179]="NavigationPane_LayoutOption_DepthWorld";n[n.NavigationPane_LayoutOption_ExpolWorld=180]="NavigationPane_LayoutOption_ExpolWorld";n[n.NavigationPane_LayoutOption_NutWorld=181]="NavigationPane_LayoutOption_NutWorld";n[n.NavigationPane_LayoutOption_PanoramaWorld=182]="NavigationPane_LayoutOption_PanoramaWorld";n[n.NavigationPane_LayoutOption_TileWorld=183]="NavigationPane_LayoutOption_TileWorld";n[n.NavigationPane_LayoutOption_VerticalWorld=184]="NavigationPane_LayoutOption_VerticalWorld";n[n.Notification_Dismiss=185]="Notification_Dismiss";n[n.OOUI_Caption_TextField=186]="OOUI_Caption_TextField";n[n.OOUI_Delete=187]="OOUI_Delete";n[n.OOUI_Edit=188]="OOUI_Edit";n[n.OOUI_Emphasis=189]="OOUI_Emphasis";n[n.OOUI_Focus=190]="OOUI_Focus";n[n.OOUI_LessEmphasis=191]="OOUI_LessEmphasis";n[n.OOUI_MoreEmphasis=192]="OOUI_MoreEmphasis";n[n.OOUI_NoneEmphasis=193]="OOUI_NoneEmphasis";n[n.OOUI_Text_TextField=194]="OOUI_Text_TextField";n[n.OOUI_Title_TextField=195]="OOUI_Title_TextField";n[n.OOUI_Transform=196]="OOUI_Transform";n[n.OOUI_VeryEmphasis=197]="OOUI_VeryEmphasis";n[n.OptionsPane_EmphasizeButtons=198]="OptionsPane_EmphasizeButtons";n[n.OptionsPane_GalleryStyleHints=199]="OptionsPane_GalleryStyleHints";n[n.Remix_Confirm=200]="Remix_Confirm";n[n.RequestInvite=201]="RequestInvite";n[n.RichCheckbox=202]="RichCheckbox";n[n.RichCheckbox_BasicContentPage=203]="RichCheckbox_BasicContentPage";n[n.RichCheckbox_SuggestedContent=204]="RichCheckbox_SuggestedContent";n[n.RichCheckbox_FocusPane=205]="RichCheckbox_FocusPane";n[n.RichCheckbox_StrictSizing=206]="RichCheckbox_StrictSizing";n[n.ShareDropdown_CastPublish=207]="ShareDropdown_CastPublish";n[n.ShareDropdown_CastView=208]="ShareDropdown_CastView";n[n.ShareDropdown_CastUnpublish=209]="ShareDropdown_CastUnpublish";n[n.ShareDropdown_CopyShareLinkButton=210]="ShareDropdown_CopyShareLinkButton";n[n.ShareDropdown_EmbedCodeButton=211]="ShareDropdown_EmbedCodeButton";n[n.ShareDropdown_MoreOptionsButton=212]="ShareDropdown_MoreOptionsButton";n[n.ShareDropdown_MoreOptionsCheckbox=213]="ShareDropdown_MoreOptionsCheckbox";n[n.ShareDropdown_MoreOptionsCheckbox_DuplicateStory=214]="ShareDropdown_MoreOptionsCheckbox_DuplicateStory";n[n.ShareDropdown_MoreOptionsRevokeLink=215]="ShareDropdown_MoreOptionsRevokeLink";n[n.ShareDropdown_SocialFacebook=216]="ShareDropdown_SocialFacebook";n[n.ShareDropdown_SocialGooglePlus=217]="ShareDropdown_SocialGooglePlus";n[n.ShareDropdown_SocialOverflow=218]="ShareDropdown_SocialOverflow";n[n.ShareDropdown_SocialShareThis=219]="ShareDropdown_SocialShareThis";n[n.ShareDropdown_SocialTwitter=220]="ShareDropdown_SocialTwitter";n[n.ShareDropdown_SocialYammer=221]="ShareDropdown_SocialYammer";n[n.ShareDropdown_ToggleSwitch=222]="ShareDropdown_ToggleSwitch";n[n.ShareFlyout_EditLink=223]="ShareFlyout_EditLink";n[n.ShareFlyout_Email=224]="ShareFlyout_Email";n[n.ShareFlyout_Embed=225]="ShareFlyout_Embed";n[n.ShareFlyout_Facebook=226]="ShareFlyout_Facebook";n[n.ShareFlyout_Facebook_ShareThis=227]="ShareFlyout_Facebook_ShareThis";n[n.ShareFlyout_Link=228]="ShareFlyout_Link";n[n.ShareFlyout_RevokeShareLinks=229]="ShareFlyout_RevokeShareLinks";n[n.ShareFlyout_ShareThis=230]="ShareFlyout_ShareThis";n[n.ShareFlyout_Twitter=231]="ShareFlyout_Twitter";n[n.ShareFlyout_Twitter_ShareThis=232]="ShareFlyout_Twitter_ShareThis";n[n.ShareLink_AlternateUrl=233]="ShareLink_AlternateUrl";n[n.ShareThis_Facebook=234]="ShareThis_Facebook";n[n.ShareThis_FacebookLike=235]="ShareThis_FacebookLike";n[n.ShareThis_GooglePlus=236]="ShareThis_GooglePlus";n[n.ShareThis_Linkedin=237]="ShareThis_Linkedin";n[n.ShareThis_NullId=238]="ShareThis_NullId";n[n.ShareThis_Pinterest=239]="ShareThis_Pinterest";n[n.ShareThis_ShareThis=240]="ShareThis_ShareThis";n[n.ShareThis_Twitter=241]="ShareThis_Twitter";n[n.ShareThis_Yammer=242]="ShareThis_Yammer";n[n.ShowAllResults=243]="ShowAllResults";n[n.SocialFlyout_CopyText=244]="SocialFlyout_CopyText";n[n.SocialFlyout_GetEmbedCode=245]="SocialFlyout_GetEmbedCode";n[n.StatusMessageClose=246]="StatusMessageClose";n[n.StoryTile_AddAuthor=247]="StoryTile_AddAuthor";n[n.StoryTile_ShareEditLink=248]="StoryTile_ShareEditLink";n[n.StoryTile_ShareFacebook=249]="StoryTile_ShareFacebook";n[n.StoryTile_ShareFacebook_ShareThis=250]="StoryTile_ShareFacebook_ShareThis";n[n.StoryTile_ShareLink=251]="StoryTile_ShareLink";n[n.StoryTile_ShareTwitter=252]="StoryTile_ShareTwitter";n[n.StoryTile_ShareTwitter_ShareThis=253]="StoryTile_ShareTwitter_ShareThis";n[n.Story_AppBar_Embed=254]="Story_AppBar_Embed";n[n.Story_AppBar_Facebook=255]="Story_AppBar_Facebook";n[n.Story_AppBar_Home=256]="Story_AppBar_Home";n[n.Story_AppBar_Link=257]="Story_AppBar_Link";n[n.Story_AppBar_SocialFlyout=258]="Story_AppBar_SocialFlyout";n[n.Story_AppBar_Twitter=259]="Story_AppBar_Twitter";n[n.Story_Tile=260]="Story_Tile";n[n.StorylinePeek=261]="StorylinePeek";n[n.Storyline_OpenCloseIcon=262]="Storyline_OpenCloseIcon";n[n.Storyline_SidebarText=263]="Storyline_SidebarText";n[n.StructurePane_StructureOption=264]="StructurePane_StructureOption";n[n.StyleHintsPane_Close=265]="StyleHintsPane_Close";n[n.SubTileMenu_ConfirmDelete=266]="SubTileMenu_ConfirmDelete";n[n.SuggestedClustersDrawer=267]="SuggestedClustersDrawer";n[n.SuggestedContentCluster=268]="SuggestedContentCluster";n[n.SuggestedSource=269]="SuggestedSource";n[n.SuggestedSource_AddSource=270]="SuggestedSource_AddSource";n[n.SuggestedSource_Bing=271]="SuggestedSource_Bing";n[n.SuggestedSource_Facebook=272]="SuggestedSource_Facebook";n[n.SuggestedSource_Flickr=273]="SuggestedSource_Flickr";n[n.SuggestedSource_SkyDrive=274]="SuggestedSource_SkyDrive";n[n.SuggestedSource_OneNote=275]="SuggestedSource_OneNote";n[n.SuggestedSource_PicHit=276]="SuggestedSource_PicHit";n[n.SuggestedSource_SuggestedContent=277]="SuggestedSource_SuggestedContent";n[n.SuggestedSource_Twitter=278]="SuggestedSource_Twitter";n[n.SuggestedSource_Upload=279]="SuggestedSource_Upload";n[n.SuggestedSource_YouTube=280]="SuggestedSource_YouTube";n[n.Survey_Cancel=281]="Survey_Cancel";n[n.Survey_Submit=282]="Survey_Submit";n[n.Text_TextField=283]="Text_TextField";n[n.TileMenu_Delete=284]="TileMenu_Delete";n[n.TileMenu_Download=285]="TileMenu_Download";n[n.TileMenu_Duplicate=286]="TileMenu_Duplicate";n[n.TileMenu_Share=287]="TileMenu_Share";n[n.Tile_AddAuthor=288]="Tile_AddAuthor";n[n.Tile_Sync=289]="Tile_Sync";n[n.Tile_CreateNew=290]="Tile_CreateNew";n[n.Tile_CreateNewFromDoc=291]="Tile_CreateNewFromDoc";n[n.Tile_CreateNewFromUpload=292]="Tile_CreateNewFromUpload";n[n.Tile_Ellipses=293]="Tile_Ellipses";n[n.Tile_ViewCount=294]="Tile_ViewCount";n[n.TopMenu_Authors=295]="TopMenu_Authors";n[n.TopMenu_Fullscreen=296]="TopMenu_Fullscreen";n[n.TopMenu_Popout=297]="TopMenu_Popout";n[n.TopMenu_Share=298]="TopMenu_Share";n[n.TransformChooser_Close=299]="TransformChooser_Close";n[n.TutorialVideo_Next=300]="TutorialVideo_Next";n[n.TutorialVideo_Previous=301]="TutorialVideo_Previous";n[n.Upload_Cancel=302]="Upload_Cancel";n[n.Upload_Pause=303]="Upload_Pause";n[n.Upload_Resume=304]="Upload_Resume";n[n.Upload_Retry=305]="Upload_Retry";n[n.Video_Play=306]="Video_Play"}(n.ButtonId||(n.ButtonId={}));f=n.ButtonId;n.getButtonId=eu,function(n){n[n.AnimationLevelSlidebar=0]="AnimationLevelSlidebar"}(n.SlidebarId||(n.SlidebarId={}));l=n.SlidebarId,function(n){n[n.Arbitrary=0]="Arbitrary";n[n.ConsumptionClick=1]="ConsumptionClick";n[n.ConsumptionScrollbarClick=2]="ConsumptionScrollbarClick";n[n.ConsumptionKeyboard=3]="ConsumptionKeyboard";n[n.ConsumptionMouseDown=4]="ConsumptionMouseDown";n[n.ConsumptionMouseWheel=5]="ConsumptionMouseWheel";n[n.ConsumptionTouch=6]="ConsumptionTouch";n[n.ConsumptionRenderModels=7]="ConsumptionRenderModels";n[n.ConsumptionRenderModelSwaps=8]="ConsumptionRenderModelSwaps";n[n.HomePageClick=9]="HomePageClick";n[n.HomePageScrollbarClick=10]="HomePageScrollbarClick";n[n.HomePageMouseDown=11]="HomePageMouseDown";n[n.HomePageMouseWheel=12]="HomePageMouseWheel";n[n.HomePageKeyboard=13]="HomePageKeyboard"}(n.AggregationCounter||(n.AggregationCounter={}));ou=n.AggregationCounter,function(n){n[n.Arbitrary=0]="Arbitrary";n[n.ConsumptionScrollChange=1]="ConsumptionScrollChange";n[n.InitialConsumption=2]="InitialConsumption";n[n.ConsumptionChange=3]="ConsumptionChange";n[n.HomePageScrollChange=4]="HomePageScrollChange";n[n.OutputTextAdjustment=5]="OutputTextAdjustment"}(n.StatisticalMeasure||(n.StatisticalMeasure={}));su=n.StatisticalMeasure,function(n){n[n.Email=0]="Email";n[n.Embed=1]="Embed";n[n.Facebook=2]="Facebook";n[n.Link=3]="Link";n[n.Twitter=4]="Twitter";n[n.Edit=5]="Edit"}(n.ShareTargetId||(n.ShareTargetId={}));a=n.ShareTargetId,function(n){n[n.Bing=0]="Bing";n[n.Embed=1]="Embed";n[n.Facebook=2]="Facebook";n[n.MyDevice=3]="MyDevice";n[n.OneDrive=4]="OneDrive";n[n.OneNote=5]="OneNote";n[n.StockPhotos=6]="StockPhotos";n[n.SuggestedContent=7]="SuggestedContent";n[n.Twitter=8]="Twitter";n[n.Unknown=9]="Unknown";n[n.Youtube=10]="Youtube"}(n.AddContentSource||(n.AddContentSource={}));hu=n.AddContentSource,function(n){n[n.initial=0]="initial";n[n.undo=1]="undo";n[n.redo=2]="redo"}(n.UndoState||(n.UndoState={}));o=n.UndoState;s=function(){function n(){this.OperationStartTime=new Date;this.TELEM_DATACOLUMNS={};this.UndoState=o[0];StoryLog.SetupUlsLogData(this)}return n.prototype.clone=function(){var t=new n;for(var i in this)this.hasOwnProperty(i)&&(t[i]=this[i]);return t.OperationStartTime&&(t.OperationStartTime=new Date(t.OperationStartTime.getTime())),t.ActionStartTime&&(t.ActionStartTime=new Date(t.ActionStartTime.getTime())),t.RenderTimes&&(t.RenderTimes=t.RenderTimes.slice()),t.TELEM_DATACOLUMNS&&(t.TELEM_DATACOLUMNS=JSON.parse(JSON.stringify(t.TELEM_DATACOLUMNS))),t},n.prototype.createHashId=function(){var n=this,t=r(n.ActionStartTime.toString())^r(n.StoryId)^r(n.UserLogId)^r(n.TELEM_ACTIVITY_ACTIONNAME);this.ActionId=t},n.prototype.getDataColumnName=function(n){return"Column"+n},n.prototype.getActionStartTime=function(){return this.ActionStartTime},n.prototype.getOperationStartTime=function(){return this.OperationStartTime},n.prototype.setActionId=function(){this.ActionId},n.prototype.setAnonUserId=function(n){this.AnonUserId=n},n.prototype.setIsBrowserSupported=function(n){this.UnsupportedBrowser=n?!1:!0},n.prototype.setCustomReportingKey=function(n){this.TELEM_ACTIVITY_ACTIONNAME=n},n.prototype.setDescription=function(n){this.Description=n},n.prototype.setElapsedTime=function(n){this.ElapsedTime=n},n.prototype.setEditOccured=function(){this.EditOccured=!0},n.prototype.setIsAtomic=function(n){this.IsAtomic=n},n.prototype.setActionStartTime=function(n){this.ActionStartTime=n},n.prototype.setOperationStartTime=function(n){this.OperationStartTime=n},n.prototype.setRenderTimes=function(n){this.RenderTimes=n},n.prototype.setReportingKey=function(n){this.TELEM_ACTIVITY_ACTIONNAME=u[n]},n.prototype.setStoryId=function(n){this.StoryId=n},n.prototype.setUserId=function(n){this.UserLogId=n},n.prototype.setTelemetryData=function(n){this.TELEM_DATACOLUMNS=n},n}();n.UlsLogData=s;t=function(){function n(n){this._category=Diag.ULSCat.msoulscat_Story_RequestManager;this._telemetryContext={};this._traceLevel=Diag.ULSTraceLevel.info;this._ulsTag=0;this._logData=new s;this._telemetryData={};var t=this;t._type=n;t._logData.setReportingKey(n);t._logData.setAnonUserId(CommonSettings.AnonUserId||"null");t._logData.setIsAtomic(!1);t._logData.setUserId(CommonSettings.LogString||"null");t._logData.setIsBrowserSupported(CommonSettings.UnsupportedBrowser==!1);t.resetActionStartTime()}return n.prototype.clone=function(){var n=Object.create(Object.getPrototypeOf(this));return n._category=this._category,n._traceLevel=this._traceLevel,n._type=this._type,n._ulsTag=this._ulsTag,n._telemetryContext=JSON.parse(JSON.stringify(this._telemetryContext)),n._telemetryData=JSON.parse(JSON.stringify(this._telemetryData)),n._logData=this._logData.clone(),n},n.prototype.stringify=function(){var n=this,t;return n._logData.setTelemetryData(n.getTelemetryDataColumns()),t=JSON.stringify(n._logData),n._logData.setTelemetryData(null),t},n.prototype.getActionStartTime=function(){return this._logData.getActionStartTime()},n.prototype.resetActionStartTime=function(){this._logData.setActionStartTime(new Date);this._logData.createHashId()},n.prototype.getActionType=function(){return this._type},n.prototype.getDataColumnCount=function(){var n=0;for(var t in this._telemetryData)n++;return n},n.prototype.getDataColumnName=function(n){return"Column"+n},n.prototype.getTelemetryDataColumns=function(){var n=this,t={},i,r,u;for(i in n._telemetryData)t[n.getDataColumnName(i)]=n._telemetryData[i];r=n.getDataColumnCount()+1;for(u in n._telemetryContext)t[n.getDataColumnName(r)]=u+":"+n._telemetryContext[u],r++;return t},n.prototype.getUlsTraceLevel=function(){return this._traceLevel},n.prototype.setUlsTraceLevel=function(n){this._traceLevel=n},n.prototype.getUlsCategory=function(){return this._category},n.prototype.setUlsCategory=function(n){this._category=n},n.prototype.isSyncAction=function(){return!1},n.prototype.setEditOccured=function(){this._logData.setEditOccured()},n.prototype.getOperationStartTime=function(){return this._logData.getOperationStartTime()},n.prototype.setCustomReportingKey=function(n){this._logData.setCustomReportingKey(n)},n.prototype.setElapsedTime=function(n){this._logData.setElapsedTime(n)},n.prototype.setRenderTimes=function(n){this._logData.setRenderTimes(n)},n.prototype.markAsAtomicOperation=function(){this._logData.setIsAtomic(!0)},n.prototype.setOperationStartTime=function(n){this._logData.setOperationStartTime(n)},n.prototype.setStoryId=function(n){this._logData.setStoryId(n)},n.prototype.setTelemetryData=function(n){this._telemetryData=n},n.prototype.updateDataColumn=function(n,t){this._telemetryData[n]=t},n.prototype.setContext=function(n){this._telemetryContext=n},n.prototype.getUlsTagId=function(){return this._ulsTag},n.prototype.setActionName=function(n){this._logData.TELEM_ACTIVITY_ACTIONNAME=n},n.prototype.setUlsData=function(n,t,i){this.setUlsDataTag(6824781,n,t,i)},n.prototype.setUlsDataTag=function(n,t,i,r){this._ulsTag=n;this.setUlsCategory(t);this.setUlsTraceLevel(i);this._logData.Description=r},n.prototype.setLogReportingKey=function(n){this._logData.setCustomReportingKey(n)},n.prototype.setUndoState=function(n){this._logData.UndoState=o[n]},n}();n.ActionData=t;i=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.isSyncAction=function(){return!0},t}(t);n.ModelChangeActionData=i;v=function(n){function t(t,i){n.call(this,t);this.setUlsDataTag(6824782,i,Diag.ULSTraceLevel.info,"The user performed the action:"+u[t])}return __extends(t,n),t}(t);n.SimpleClientActionData=v;y=function(n){function t(t,i,r,u){n.call(this,60);var f=0,e=window.PageExecutionBegin;e&&(f=Date.now()-e.getTime());this.setUlsDataTag(7098911,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user loaded a page.");this.setTelemetryData({1:"PageType:"+t,2:"Referrer:"+i,3:"WorldId:"+r,4:"StyleId:"+u,5:"DocumentReadyToPageRoot:"+f})}return __extends(t,n),t}(t);n.PageLoadActionData=y;p=function(n){function t(t,i,r,u,f){n.call(this,161);this.setUlsDataTag(7448387,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user added an embed.");this.setTelemetryData({1:"Domain:"+i,2:"EmbedSource:"+t,3:"Height:"+r,4:"Width:"+u,5:"Allowed:"+f.toString()})}return __extends(t,n),t}(t);n.EmbedActionData=p;w=function(n){function t(t,i){n.call(this,164);this.setUlsDataTag(7611010,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user changed the audience for a story.");this.setTelemetryData({1:"NewAudience:"+StoryAudience[t],2:"OldAudience:"+StoryAudience[i]})}return __extends(t,n),t}(t);n.ChangeStoryAudienceData=w;b=function(n){function t(t,i,r,u){n.call(this,108);this.setUlsDataTag(7098914,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Created image unit.");this.setTelemetryData({1:"ImageUnitId:"+t,2:"ProviderType:"+i,3:"ImageHeight:"+r,4:"ImageWidth:"+u})}return __extends(t,n),t}(i);n.CreateImageModelActionData=b;k=function(n){function t(t,i,r,u,f,e,o,s,h,c,l){n.call(this,4);this.setUlsDataTag(6824788,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Adding Suggested Image");this.setTelemetryData({1:"NumberOfImagesOfferedToUser:"+t,2:"IndexOfInsertedImage:"+i,3:"NumberOfActiveClusters:"+r,4:"TotalNumberOfClusters:"+u,5:"QueryIDs:"+f,6:"ClustersCount:"+e,7:"ClusterClasses:"+o,8:"ClusterSubTypes:"+s,9:"ClusterIndex:"+h,10:"License:"+c,11:"ClusterVisualizationImage:"+l})}return __extends(t,n),t}(i);n.AddSuggestedContentImageData=k;d=function(n){function t(t,i,r,u,f){n.call(this,25);var e=this;e.setUlsData(Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Content added");e.setTelemetryData({1:"ContentSource:"+t,2:"ContentType:"+i,3:"SelectedSource:"+(r?r:""),4:"SelectedTabIndex:"+(u||u===0?u:-1),5:"SelectedTabId:"+(f?f:"")})}return __extends(t,n),t}(i);n.ContentAddedData=d;g=function(n){function t(t,i,r,u){n.call(this,1);var f=this;f.setUlsData(Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Adding Bing Image");f.setTelemetryData({1:"Index:"+t,2:"License:"+i,3:"ClusterIndex:"+r,5:"TotalClusters:"+u})}return __extends(t,n),t}(i);n.AddBingImageData=g;nt=function(n){function t(t,i,r,u){n.call(this,2);var f=this;f.setUlsData(Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Adding PicHit Image");f.setTelemetryData({1:"Index:"+t,2:"TabId:"+i,3:"CategoryInfo:"+r,4:"IsAuthenticated:"+u})}return __extends(t,n),t}(i);n.AddPicHitImageData=nt;tt=function(n){function t(t,i){n.call(this,3);var r=this;r.setUlsData(Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Adding OneNote Image");r.setTelemetryData({1:"ForeignKey:"+t,2:"SourceTabName:"+i})}return __extends(t,n),t}(i);n.AddOneNoteImageData=tt;it=function(n){function t(t,i,r,u,f,e,o,s,h,c,l){n.call(this,110);this.setUlsDataTag(7098944,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Cluster Clicked");this.setTelemetryData({1:"ClusterID:"+t,2:"ClusterIndex:"+i,3:"ClusterClass:"+r,4:"ClusterSubType:"+u,5:"ClusterQueryIDs:"+f,6:"OldClusterSelection:"+e,7:"NewClusterSelection:"+o,8:"ActiveClustersCount:"+s,9:"TotalClustersCount:"+h,10:"AllClustersTypeInfoEncoded:"+c,11:"SelectedSource:"+l})}return __extends(t,n),t}(t);n.SelectSuggestedContentClusterData=it;rt=function(n){function t(t,i){n.call(this,29);this.setUlsDataTag(7098945,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Deleting image.");this.setTelemetryData({1:"ImageId:"+t,2:"ImageUsedForColor:"+i})}return __extends(t,n),t}(i);n.DeleteImageActionData=rt;e=function(n){function t(t){n.call(this,7);var i=this;if(i.setUlsDataTag(6824791,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Aggregation data."),null===t)throw new Error("Key parameter is null, all aggregations must have a key to uniquely identify them.");this.setCustomReportingKey(t)}return __extends(t,n),t}(t);n.AggregationData=e;ut=function(n){function t(t,i,r){var u,f;i===void 0&&(i=0);r===void 0&&(r=null);n.call(this,t);this.counter=0;u=this;u.setUlsDataTag(6824792,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Long running client counter:"+t);u.counter=i;u.update();f=CommonSettings.FlightSettings?CommonSettings.FlightSettings.flightName:"N/A";u.updateDataColumn(2,"Flight:"+f);r!==null&&u.setContext(r)}return __extends(t,n),t.prototype.decrement=function(){var n=this;if(n.counter>0)n.counter--,n.update();else throw new Error("decrement() call would result in an invalid state (below 0) for self counter.");},t.prototype.getValue=function(){return this.counter},t.prototype.increment=function(){var n=this;n.counter++;n.update()},t.prototype.reset=function(){var n=this;n.counter=0;n.update()},t.prototype.update=function(){this.updateDataColumn(1,"Count:"+this.counter)},t}(e);n.CounterData=ut;ft=function(){function n(n){this.counter=0;this.product=1;n?this.observeNewValue(n):this.initializeToNaN()}return n.prototype.observeNewValue=function(n){var t=this;if(isNaN(n)){StoryLog.TraceTag(6901962,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Observation of a NaN value attempted for a aggregate measure or counter. Value is:"+n);return}if(null===n){StoryLog.TraceTag(6901963,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Observation of a null value attempted for a aggregate measure or counter.");return}isNaN(t.counter)?(t.initializeValuesToZero(),t.min=n,t.max=n):(n<t.min&&(t.min=n),n>t.max&&(t.max=n));t.counter++;t.sum=t.sum+n;t.reciprocalSum=t.reciprocalSum+1/n;t.mean=t.sum/t.counter;t.product=t.product*n;t.geometricMean=Math.pow(t.product,1/t.counter);t.harmonicMean=t.counter/t.reciprocalSum;t.sdev=Math.sqrt(t.sum*t.sum/t.counter-t.mean*t.mean)},n.prototype.initializeToNaN=function(){var n=this,t=parseInt("Not a number");n.counter=t;n.geometricMean=t;n.harmonicMean=t;n.max=t;n.mean=t;n.min=t;n.reciprocalSum=t;n.sdev=t;n.sum=t},n.prototype.initializeValuesToZero=function(){var n=this;n.counter=0;n.geometricMean=0;n.harmonicMean=0;n.max=0;n.mean=0;n.min=0;n.reciprocalSum=0;n.sdev=0;n.sum=0},n}();et=function(n){function t(t,i,r){var u,f;r===void 0&&(r=null);n.call(this,t);this.data={};u=this;u.setUlsDataTag(6824793,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Long running client aggregation measure:"+t);for(f in i)u.data[f]=new ft(i[f]);u.update();r&&u.setContext(r)}return __extends(t,n),t.prototype.observe=function(n){var t=this;for(var i in t.data)t.data[i].observeNewValue(n[i]);t.update()},t.prototype.update=function(){var i=this,n=1;for(var t in i.data)this.updateDataColumn(n,t+":"+JSON.stringify(this.data[t])),n++},t}(e);n.StatisticalData=et;ot=function(n){function t(t,i,r){n.call(this,8);this.setUlsDataTag(7098946,i,Diag.ULSTraceLevel.info,"Button click");this.setTelemetryData({1:"Target:"+f[t]});r&&this.setContext(r)}return __extends(t,n),t}(t);n.ButtonClickAction=ot;st=function(n){function t(t,i,r){n.call(this,169);this.setUlsDataTag(7872859,i,Diag.ULSTraceLevel.info,"Button right click");this.setTelemetryData({1:"Target:"+f[t]});r&&this.setContext(r)}return __extends(t,n),t}(t);n.ButtonRightClickAction=st;ht=function(n){function t(){n.call(this,16);var t=this;t.setUlsDataTag(6824796,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user created a new story.")}return __extends(t,n),t}(t);n.CreateNewActionData=ht;ct=function(n){function t(){n.call(this,27);var t=this;t.setUlsDataTag(6824797,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user deleted a story.")}return __extends(t,n),t}(t);n.DeleteStoryActionData=ct;lt=function(n){function t(){n.call(this,28);var t=this;t.setUlsData(Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user removed themselves from a story.")}return __extends(t,n),t}(t);n.RemoveEditorActionData=lt;at=function(n){function t(t,i){n.call(this,30);var r=this;this.setUlsDataTag(7098947,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user has uploaded some files.");this.setTelemetryData({1:"Count:"+t.length,2:"UploadSource:"+i,3:"TotalSize:"+this.getTotalFileSize(t)})}return __extends(t,n),t.prototype.getTotalFileSize=function(n){var t=0;for(var i in n)t+=n[i];return t},t}(t);n.FileUploadData=at;vt=function(n){function t(t,i,r){n.call(this,t);var u=this;this.setUlsDataTag(7479324,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User changed upload progress");this.setTelemetryData({1:"ModelID:"+i,2:"Progress:"+r})}return __extends(t,n),t}(t);n.FileUploadProgressData=vt;yt=function(n){function t(t,i,r){n.call(this,37);this.setUlsDataTag(7477377,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user uploaded a invalid file");this.setTelemetryData({1:"FileExists:"+t,2:"FileBlobExists:"+i,3:"FileTypeExists:"+r})}return __extends(t,n),t}(t);n.InvalidFileUploadData=yt;pt=function(n){function t(){n.call(this,38);var t=this;t.setUlsDataTag(6824799,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"The user asked for suggested content.")}return __extends(t,n),t}(t);n.GetSuggestedContentActionData=pt;wt=function(n){function t(t,i){n.call(this,62);var r=this;r.setUlsDataTag(6824802,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user opens a story tile.");this.setStoryId(t);this.setTelemetryData({1:"FeaturedStory:"+i})}return __extends(t,n),t}(t);n.OpenStoryTileData=wt;bt=function(n){function t(t,i,r,u,f){f===void 0&&(f=!1);n.call(this,18);var e=this;this.setUlsDataTag(7098949,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user changed to a new world.");this.setTelemetryData({1:"CurrentWorldId:"+t,2:"CurrentStyleId:"+r,3:"NewWorldId:"+i,4:"WorldForcedStyleChange:"+f,5:"NewStyleId:"+u})}return __extends(t,n),t}(i);n.WorldChangeData=bt;kt=function(n){function t(t,i,r,u,f){u===void 0&&(u="");f===void 0&&(f=!1);n.call(this,17);var e=this;this.setUlsDataTag(7098950,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user changed to a new style.");this.setTelemetryData({1:"CurrentWorldId:"+t,2:"CurrentStyleId:"+i,3:"NewWorldId:"+u,4:"NewStyleId:"+r,5:"WorldForcedStyleChange:"+f})}return __extends(t,n),t}(i);n.StyleChangeData=kt;dt=function(n){function t(t,i,r,u){n.call(this,26);var f=this;this.setUlsDataTag(7448212,Diag.ULSCat.msoulscat_Story_Style,Diag.ULSTraceLevel.info,"The user changed the font set override.");this.setTelemetryData({1:"CurrentFontSetId:"+i,2:"NewFontSetId:"+t,3:"CurrentStyleId:"+r,4:"CurrentWorldId:"+u})}return __extends(t,n),t}(i);n.FontSetChangeData=dt;gt=function(n){function t(t,i,r){n.call(this,195);this.setUlsDataTag(8201298,i,Diag.ULSTraceLevel.info,"Slidebar change");this.setTelemetryData({1:"Target:"+l[t]});r&&this.setContext(r)}return __extends(t,n),t}(t);n.SlidebarSlideAction=gt;ni=function(n){function t(t,i){i===void 0&&(i="");n.call(this,19);var r=this;this.setUlsDataTag(7098951,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user changed to a new color override.");this.setTelemetryData({1:"CurrentColorPalette:"+i,2:"NewColorPalette:"+t})}return __extends(t,n),t}(i);n.ColorChangeData=ni;ti=function(n){function t(t,i,r,u,f,e,o,s){n.call(this,21);var h=this;this.setUlsDataTag(7098953,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user elected a new palette from the list of options.");this.setTelemetryData({1:"Palette Position:"+t,2:"Number of Palettes for Image:"+i,3:"World:"+r,4:"Style:"+u,5:"Selected Palette:"+f,6:"Previous Palette:"+e,7:"Image Id:"+o,8:"BonusPaletteSelected:"+s})}return __extends(t,n),t}(t);n.ColorPaletteChangeData=ti;ii=function(n){function t(t,i){n.call(this,58);this.setUlsDataTag(7098954,Diag.ULSCat.msoulscat_Story_Feedback,Diag.ULSTraceLevel.info,"The user shared a story.");this.setTelemetryData({1:"TargetId:"+a[t],2:"",3:"HasCurrentLocationUrl:"+(!!i).toString(),4:"Supports browser clipboard:"+(!!(window.clipboardData&&window.clipboardData.setData)).toString()})}return __extends(t,n),t}(t);n.ShareStoryData=ii;ri=function(n){function t(t,i,r,u,f){n.call(this,t);var e=this;this.setTelemetryData({1:"SwayContentLength:"+r,2:"Position:"+u,3:"ContentType:"+f})}return __extends(t,n),t}(t);n.ContextualUIData=ri;ui=function(n){function t(t,i,r,u,f){n.call(this,t);this.setUlsDataTag(7635858,Diag.ULSCat.msoulscat_Story_Feedback,Diag.ULSTraceLevel.info,"The user shared a story from a content element.");this.setTelemetryData({1:"",2:"HasCurrentLocationUrl:"+i.toString(),3:"SupportsBrowserClipboard:"+(!!(window.clipboardData&&window.clipboardData.setData)).toString(),4:"SwayContentLength:"+r,5:"Position:"+u,6:"ContentType:"+f})}return __extends(t,n),t}(t);n.ShareStoryDataFromContextualUI=ui;fi=function(n){function t(t,i,r,u,f,e){n.call(this,i);var o=this;o.setUlsDataTag(6824838,t,Diag.ULSTraceLevel.info,r);this.setTelemetryData({1:"From: "+u,2:"To: "+f,3:"ModelIds: "+JSON.stringify(e)})}return __extends(t,n),t}(t);n.EmphasisLevelData=fi;ei=function(n){function t(t,i,r,u,f,e){n.call(this,i);var o=this;o.setUlsData(t,Diag.ULSTraceLevel.info,r);this.setTelemetryData({1:"From: "+u,2:"To: "+f,3:"ModelIds: "+JSON.stringify(e)})}return __extends(t,n),t}(t);n.StrictSizingData=ei;oi=function(n){function t(t,i,r,u,f,e){n.call(this,i);var o=this;o.setUlsData(t,Diag.ULSTraceLevel.info,r);this.setTelemetryData({1:"From: "+u,2:"To: "+f,3:"ModelIds: "+JSON.stringify(e)})}return __extends(t,n),t}(t);n.GalleryStyleData=oi;si=function(n){function t(t,i,r,u,f){n.call(this,t);var e=this;e.setUlsDataTag(6824839,Diag.ULSCat.msoulscat_Story_ContextualUI,Diag.ULSTraceLevel.info,i);this.setTelemetryData({1:"SwayContentLength:"+r,2:"ViewContext:"+u});f&&t==75&&this.updateDataColumn(3,"ContentTypes:"+JSON.stringify(f))}return __extends(t,n),t}(t);n.TransformUIOpenData=si;hi=function(n){function t(t,i,r,u,f,e){n.call(this,t);var o=this;this.setUlsDataTag(7098955,Diag.ULSCat.msoulscat_Story_ContextualUI,Diag.ULSTraceLevel.info,i);this.setTelemetryData({1:"SwayContentLength:"+r,2:"TransformType:"+u,3:"ViewContext:"+f,4:"contentTypesTransformed:"+e})}return __extends(t,n),t}(t);n.TransformActionData=hi;ci=function(n){function t(t,i,r,u){u===void 0&&(u="Undefined");n.call(this,78);var f=this;this.setUlsDataTag(6824841,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user was shown a dialog.");this.setTelemetryData({1:"Title:"+t,2:"Message:"+i,3:"DialogType:"+StoryApp.View.ViewElements.DialogType[r],4:"DialogLogMessage:"+u})}return __extends(t,n),t}(t);n.DialogShownData=ci;li=function(n){function t(t,i,r,u,f){n.call(this,t);var e=this;this.setUlsDataTag(6824842,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"The user did something in the add content pane.");this.setTelemetryData({1:"SwayLength:"+i,2:"CurrentSource:"+r,3:"SourceCardType"+(u===undefined)?"":u,4:"IsAADUser"+(f===undefined)?"":f})}return __extends(t,n),t}(t);n.AddContentUIPaneData=li;ai=function(n){function t(t,i,r,u,f){n.call(this,t);var e=this;this.setUlsDataTag(6824843,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"The user switched their add content source.");this.setTelemetryData({1:"SwayLength:"+i,2:"FromSource:"+r,3:"ToSource:"+u,4:"FirstRun:"+f})}return __extends(t,n),t}(t);n.AddContentUINavigation=ai;vi=function(n){function t(t,i,r,u){n.call(this,t);var f=this;this.setUlsDataTag(6824844,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"The user  used to add button to add content.");this.setTelemetryData({1:"SwayLength:"+i,2:"FromSource:"+r});u&&this.updateDataColumn(3,"SelectionLength:"+u)}return __extends(t,n),t}(t);n.AddContentUISelection=vi;yi=function(n){function t(t,i,r){n.call(this,92);var u=this;this.setUlsDataTag(6824846,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"The user opened a changed the content source tab.");this.setTelemetryData({1:"SwayLength:"+t,2:"CurrentSource:"+i,3:"TabName:"+r.Id})}return __extends(t,n),t}(t);n.AddContentUIChangeSourceTab=yi;pi=function(n){function t(t,i,r){n.call(this,92);var u=this;this.setUlsDataTag(7098958,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"AddContent Source Selected");this.setTelemetryData({1:"NewSource:"+t,2:"OldSource:"+i?i:"null",3:"RevertToSource:"+r?r:"null"})}return __extends(t,n),t}(t);n.AddContentUISwitchContentSource=pi;wi=function(n){function t(t,i){n.call(this,8);var r=this;this.setUlsDataTag(7963043,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Connect Button Clicked");this.setTelemetryData({1:"SelectedSource:"+t,2:"SelectedTabId:"+i})}return __extends(t,n),t}(t);n.AddContentConnectButtonClicked=wi;bi=function(n){function t(t,i,r,u){n.call(this,t);var f=this;this.setUlsDataTag(7747592,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,u);this.setTelemetryData({1:"ProviderType:"+i,2:"Extension:"+r})}return __extends(t,n),t}(t);n.ImportedOrEmbeddedDocumentUI=bi;ki=function(n){function t(t,i,r){n.call(this,t);this.setUlsDataTag(7964749,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,r);this.setTelemetryData({1:"EmbedLink:"+i})}return __extends(t,n),t}(t);n.EmbedCardUI=ki;di=function(n){function t(t){n.call(this,193);this.setUlsDataTag(8192914,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User dragged and dropped files from file system.");this.setTelemetryData({1:"FileCount:"+t})}return __extends(t,n),t}(t);n.FileDraggedAndDropped=di;gi=function(n){function t(t){n.call(this,194);this.setUlsDataTag(8758916,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User dragged and dropped text.");this.setTelemetryData({1:"Length:"+t})}return __extends(t,n),t}(t);n.TextDraggedAndDropped=gi;nr=function(n){function t(t,i,r){n.call(this,113);this.setUlsDataTag(7098959,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User scrolled to the bottom of suggestions. Decomposing next batch of suggestions.");this.setTelemetryData({1:"AvailableSuggestionsCount:"+t,2:"ActiveClustersCount:"+i,3:"NoMoreSuggestionsAvailable:"+r})}return __extends(t,n),t}(t);n.ScrollDownAction=nr;tr=function(n){function t(t,i){n.call(this,113);this.setUlsDataTag(6824850,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"The user pasted into a view element.");this.setTelemetryData({1:"Context:"+t});i&&this.updateDataColumn(2,"ElementName:"+i)}return __extends(t,n),t}(t);n.StorylinePasteContext=tr;ir=function(n){function t(t,i,r){n.call(this,114);var u=this;this.setUlsDataTag(7098960,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"The user pasted content into their Storyline.");this.setTelemetryData({1:"Length:"+t,2:"NumHeadings:"+i,3:"NumImages:"+r})}return __extends(t,n),t}(t);n.StorylinePasteInfo=ir;h=function(n){function t(t,i,r,u){n.call(this,t);var f=this;this.setUlsDataTag(7098961,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,i);this.setTelemetryData({1:"ModelIds: "+JSON.stringify(r),2:"CardTypes: "+JSON.stringify(u),3:"CardCount: "+r.length})}return __extends(t,n),t}(t);n.StorylineActionData=h;rr=function(n){function t(t,i,r,u){n.call(this,168,t,i,r);this.updateDataColumn(3,"ParentType: "+u)}return __extends(t,n),t}(h);n.StorylinePlaceholderFilled=rr;ur=function(n){function t(t,i,r,u){n.call(this,135);this.setUlsDataTag(7436322,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,t);this.setTelemetryData({1:"CardType: "+i,2:"ModelId: "+r,3:"JacksParentsType: "+u})}return __extends(t,n),t}(t);n.StorylineJackAddCard=ur;fr=function(n){function t(t){n.call(this,137);this.setUlsDataTag(7098963,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"Exception thrown by our Rich Text Editor");this.setTelemetryData({1:"Exception: "+JSON.stringify(t)})}return __extends(t,n),t}(t);n.StorylinePasteException=fr;er=function(n){function t(t,i,r,u,f,e){var o,s;if(n.call(this,t),o=this,o.setUlsData(Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,i),o.setTelemetryData({1:"StartParagraph: "+r,2:"EndParagraph: "+u,3:"SelectionLength: "+f}),o.setUlsDataTag(6824856,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,i),o.setTelemetryData({1:"StartParagraph:"+r,2:"EndParagraph:"+u,3:"SelectionLength:"+f}),e)for(s=0;s<e.length;s++)o.updateDataColumn(s+4,e[s])}return __extends(t,n),t}(t);n.StorylineTextActionData=er;or=function(n){function t(t,i,r,u){n.call(this,t);this.setUlsDataTag(6895648,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,i);this.setTelemetryData({1:"FocusedElement: "+r,2:"FocusedParentElement: "+u})}return __extends(t,n),t}(t);n.UndoActionData=or;sr=function(n){function t(t,i){n.call(this,107);var r=this;r.setUlsDataTag(6824857,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Youtube video status change");this.setTelemetryData({1:"VideoId:"+t,2:"NewStatus:"+i})}return __extends(t,n),t}(t);n.YouTubeVideoStateChange=sr;hr=function(n){function t(t,i,r,u,f){n.call(this,111);var e=this;e.setUlsData(Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User wants to see more search tags");this.setTelemetryData({1:"indexOfSelectedCluster: "+t,2:"numberOfVisibleClusters: "+i,3:"numberOfContentPieces: "+r,4:"license: "+u,5:"sourcePane: "+f})}return __extends(t,n),t}(t);n.SuggestedContentDrawerButtonClicked=hr;cr=function(n){function t(t,i,r){n.call(this,158);var u=this;u.setUlsData(Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,t);this.setTelemetryData({1:"PaneType:"+i,2:"ActionResult:"+r})}return __extends(t,n),t}(t);n.AuthoringTabToggleData=cr;lr=function(n){function t(t,i,r){n.call(this,t);var u=this;u.setUlsData(Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,i);this.setTelemetryData({1:"CardType:"+r})}return __extends(t,n),t}(t);n.CardGalleryAddCardData=lr;ar=function(n){function t(t,i){n.call(this,112);var r=this;r.setUlsData(Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User searched with user typed query");r.setTelemetryData({1:"SelectedSource:"+t,2:"QueryLenght:"+i})}return __extends(t,n),t}(t);n.UserTypeQuerySearchData=ar;vr=function(n){function t(t){n.call(this,165);var i=this;i.setUlsData(Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"An authoring pane was just light dismissed.");this.setTelemetryData({1:"PaneType:"+t})}return __extends(t,n),t}(t);n.AuthoringPaneLightDismissData=vr;yr=function(n){function t(t,i,r,u){n.call(this,167);var f=this;this.setUlsDataTag(7706049,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"Author IP Broadcasted");this.setTelemetryData({1:"modelId: "+t,2:"editorsInModel: "+i,3:"paragraphIds: "+JSON.stringify(r),4:"editorsInParagraph: "+u})}return __extends(t,n),t}(t);n.IPPositionActionData=yr;pr=function(n){function t(t){n.call(this,23);this.setUlsDataTag(7706050,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user changed the sorting type on MyStories");this.setTelemetryData({1:"type:"+t})}return __extends(t,n),t}(t);n.MyStoriesChangeSortTypeActionData=pr;wr=function(n){function t(t,i){n.call(this,t);var r=this;this.setUlsDataTag(7971350,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"The user clicked on keep entire image checkbox.");this.setTelemetryData({1:"KeepEntireImageChecked:"+i.toString()})}return __extends(t,n),t}(t);n.FocusPaneUIKeepEntireImageAction=wr;br=function(n){function t(t,i){n.call(this,t);var r=this;this.setUlsDataTag(7878601,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"The user made a focus point action.");this.setTelemetryData({1:"NumberOfFocusPoints:"+i.toString()})}return __extends(t,n),t}(t);n.FocusPaneUIFocusPointAction=br;kr=function(n){function t(t,i,r){n.call(this,192);this.setUlsDataTag(8185880,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Client code is determining whether a user is on a given flight.");this.setTelemetryData({1:"RequestedFlight:"+t,2:"AvailableFlights:"+i,3:"OnTreatmentFlight:"+r.toString()})}return __extends(t,n),t}(t);n.UserFlightAssignmentData=kr;dr=function(n){function t(t,i,r,u,f,e){n.call(this,61);var o=fu.Environment.getInstance().getWindowSize();this.setUlsDataTag(8451534,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"New RenderModel was loaded.");this.setTelemetryData({1:"ElapsedTime:"+t,2:"ContainerElementCount:"+i,3:"NonContainerElementCount:"+r,4:"ClientDevice:"+CommonSettings.ClientDevice,5:"Width:"+o.w,6:"Height:"+o.h,7:"IsNativeClient:"+f,8:"IsEmbedded:"+u,9:"UserAgent:"+navigator.userAgent,10:"IsComplete:"+e})}return __extends(t,n),t}(t);n.RenderModelLoadData=dr;gr=function(n){function t(t){n.call(this,12);this.setUlsDataTag(8988643,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"User copied cards from the storyline.");this.setTelemetryData({1:"ModelTypes:"+JSON.stringify(t)})}return __extends(t,n),t}(t);n.CardDeckCopyAction=gr;nu=function(n){function t(t){n.call(this,13);this.setUlsDataTag(8988672,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"User cut cards from the storyline.");this.setTelemetryData({1:"ModelTypes:"+JSON.stringify(t)})}return __extends(t,n),t}(t);n.CardDeckCutAction=nu;tu=function(n){function t(t,i,r){n.call(this,14);this.setUlsDataTag(8988673,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"Cards were serialized from the storyline.");this.setTelemetryData({1:"isSameSway:"+t,2:"isSameAuthor:"+i,3:"ModelTypes:"+JSON.stringify(r)})}return __extends(t,n),t}(t);n.CardDeckPasteAction=tu;iu=function(n){function t(t){n.call(this,10);this.setUlsDataTag(8988674,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.verbose,"Cards were deserialized into the storyline.");this.setTelemetryData({1:"ModelTypes:"+JSON.stringify(t)})}return __extends(t,n),t}(t);n.CardDeckDeserializeAction=iu;ru=function(n){function t(t){n.call(this,11);this.setUlsDataTag(8988675,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.verbose,"Cards were serialized from the storyline.");this.setTelemetryData({1:"ModelTypes:"+JSON.stringify(t)})}return __extends(t,n),t}(t);n.CardDeckSerializeAction=ru;uu=function(n){function t(t,i,r,f){n.call(this,t);this.setUlsDataTag(9310464,Diag.ULSCat.msoulscat_Story_ContextualUI,Diag.ULSTraceLevel.info,"First Run callout dismissed");this.setTelemetryData({1:"CalloutID:"+c.CalloutID[r],2:"DismissalAction:"+c.FirstRunActionType[i],3:"ActionType:"+u[t],4:"ElapsedTime:"+f})}return __extends(t,n),t}(t);n.FirstRunExperienceData=uu}(ClientAction||(ClientAction={}));WatchableSwitchesTransport=function(){function n(){}return n}(),function(n){function i(n,i){n===null||n.ingested===undefined||n.ingested===!1?(i&&i(null),ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewProcessingErrorTitle,Resources.DocumentIngestionUndefinedError,"Doc Ingestion failed")):n.uploadStatus!=2?(i&&i(n.authToken),window.setTimeout(function(){window.location.assign(StoryApp.Common.UrlHelper.getInstance().viewUrl(n.authToken))},0)):(i&&i(n.error.toString()),ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewProcessingErrorTitle,t.uploadErrorMessage(n.error),"Doc Ingestion: Import Failed"));StoryApp.View.Common.BlockingProgressManager.hide()}function r(n,t,i,r){t==="timeout"?(r&&r(t),StoryLog.TraceTag(6402332,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Document Importing reached timeout."),ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionImportInProgress,Resources.DocumentIngestionTimeoutError,"Doc Ingestion: Reached timeout")):i!==undefined?(r&&r(i),ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewProcessingErrorTitle,i,"Doc Ingestion: Import failed")):(t!==undefined?StoryLog.StructuredTraceTag(6402333,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Document Importing error",{errorCode:t}):StoryLog.TraceTag(6402334,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Document Importing encountered undefined error."),ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewProcessingErrorTitle,Resources.DocumentIngestionUndefinedError,"Doc Ingestion failed"),r&&r(null));StoryApp.View.Common.BlockingProgressManager.hide()}var t=function(){function n(){}return n.submitDocumentIngestionRequestForFiles=function(t,i,r,u){var f=new FormData,e,o;return f.append("file",t.getBlob(),t.getName()),i==null&&(e=n.getCappedFilenameString(t.getName()),o=ResourceManager.ResolveString(Resources.DocumentIngestionUploadDocumentUIMessage,[e]),StoryApp.View.Common.BlockingProgressManager.show(o)),n.completeDocumentIngestionRequest(f,i,r,u)},n.submitDocumentIngestionRequestForUrls=function(t,i,r,u){var f=new FormData;return f.append("file",t),n.completeDocumentIngestionRequest(f,i,r,u)},n.completeDocumentIngestionRequest=function(n,t,i,r){var f,e,u;return t&&n.append("modelId",t),i&&n.append("fileName",i),f={description:"Method to ingest documents to story.",type:"POST",data:n,processData:!1,dataType:"json",contentType:!1,timeout:CommonSettings.SiteDocumentIngestionAjaxTimeout},r===StoryApp.Common.UrlHelper.getInstance().documentIngestionCreateUrl()&&Cookie.setPageRequestInfo(r),e=$.ajax(r,f),u=Task.fromPromise(e),u.then(function(n){return n},function(n,t,i){StoryLog.StructuredTraceTag(7390371,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.warning,"Call to ingest document failed",{ErrorStatus:t,ErrorThrown:i})}),u},n.CreateStoryFromDocument=function(t,u){var f=CommonSettings.DocumentIngestionMaximumDocumentSize;return t.getSize()===0?(ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewClientErrorTitle,Resources.DocumentIngestionFileEmptyError,"Doc Ingestion: Upload Failed, file is corrupted"),null):t.getSize()>f?(ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewClientErrorTitle,ResourceManager.ResolveString(Resources.DocumentIngestionFileSizeTooBigError,[f/1048576]),"Doc Ingestion: Upload failed, file is too big"),null):n.isFileExtensionSupported(t.getName())?(StoryLog.StructuredTraceTag(7186374,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"Creating story from document.",{fileSize:t.getSize().toString(),fileType:t.getType()}),n.submitDocumentIngestionRequestForFiles(t,undefined,undefined,StoryApp.Common.UrlHelper.getInstance().documentIngestionCreateUrl()).then(function(n){return i(n,u),n},function(n,t,i){r(n,t,i,u)})):(ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewClientErrorTitle,Resources.DocumentIngestionFileTypeError,"Doc Ingestion: Upload failed, file type unsupported"),null)},n.InsertDocumentToStory=function(t,i){return StoryLog.StructuredTraceTag(7186375,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"Ingesting local file to story.",{fileSize:t.getSize().toString(),fileType:t.getType()}),n.submitDocumentIngestionRequestForFiles(t,t.getModelId(),undefined,StoryApp.Common.UrlHelper.getInstance().documentIngestionInsertUrl(i))},n.InsertDocumentToBlob=function(n,t){var i=new FormData;i.append("file",n.getBlob(),n.getName());i.append("modelId",n.getModelId());var u={description:"Method to upload document to blob.",type:"POST",data:i,processData:!1,dataType:"json",contentType:!1,timeout:CommonSettings.SiteDocumentIngestionAjaxTimeout},f=$.ajax(StoryApp.Common.UrlHelper.getInstance().uploadFileToBlobUrl(t),u),r=Task.fromPromise(f);return r.then(function(n){return n},function(n,t,i){StoryLog.StructuredTraceTag(7910617,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.warning,"Call to ingest document failed",{ErrorStatus:t,ErrorThrown:i})}),r},n.InsertDocumentFromBlobToStory=function(t,i,r,u,f){var s=n.getFileExtension(t),e=new FormData;e.append("fileName",t);e.append("modelId",r);e.append("documentID",u);StoryLog.StructuredTraceTag(7910618,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"Ingesting file using its Blob id to story.",{fileSize:f.toString(),fileType:s});var h={description:"Method to ingest document from Blob to Story.",type:"POST",data:e,processData:!1,dataType:"json",contentType:!1,timeout:CommonSettings.SiteDocumentIngestionAjaxTimeout},c=$.ajax(StoryApp.Common.UrlHelper.getInstance().documentIngestionInsertFromBlobIdUrl(i),h),o=Task.fromPromise(c);return o.then(function(n){return n},function(n,t,i){StoryLog.StructuredTraceTag(7910619,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.warning,"Call to ingest document failed",{ErrorStatus:t,ErrorThrown:i})}),o},n.InsertDocumentFromOneDriveToStory=function(t,i,r,u,f,e){return StoryLog.StructuredTraceTag(7186376,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"Ingesting file from OneDrive to story.",{fileSize:e,fileType:f}),n.submitDocumentIngestionRequestForUrls(t,r,u+"."+f,StoryApp.Common.UrlHelper.getInstance().documentIngestionInsertFromOneDriveUrl(i))},n.isFileExtensionSupported=function(t){var i=n.getFileExtension(t);return n._supportedExt.contains(i)||CommonSettings.DocumentIngestionExperimentalFormatsEnabled&&n._experimentallySupportedExt.contains(i)},n.getSupportedExtensionsList=function(){for(var i="",t=0;t<n._supportedExt.length;t++)i+="."+n._supportedExt[t]+",";if(CommonSettings.DocumentIngestionExperimentalFormatsEnabled)for(t=0;t<n._experimentallySupportedExt.length;t++)i+="."+n._experimentallySupportedExt[t]+",";return i},n.getFileExtension=function(n){var t=n.split(".");return t.length===1||t[0]===""&&t.length===2?"":t.pop().toLowerCase()},n.getFileNameWithoutExtension=function(n){var t=n.lastIndexOf(".");return t<=0?"":n.substr(0,t)},n.showDocumentIngestionErrorMessage=function(n,t){var i;switch(n){case 3:case 9:case 10:i=Resources.DocumentIngestionDocumentCorruptedOrProtected;break;case 5:i=Resources.DocumentIngestionSwayTooLarge;break;case 7:i=Resources.DocumentIngestionDocumentTooLongMessage;break;case 1:case 2:case 4:case 6:case 11:default:i=Resources.DocumentIngestionDocumentImportFailed}ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewProcessingErrorTitle,i,"Doc Ingestion: Import Failed",t)},n.uploadErrorMessage=function(n){switch(n){case 1:return Resources.UploadErrorTimeout;case 2:return Resources.DocumentIngestionDocumentCorruptedOrProtected;case 3:return Resources.DocumentIngestionDocumentImportFailed;case 4:return Resources.DocumentIngestionDocumentTooLongMessage;case 5:return Resources.DocumentIngestionDisabled;case 6:return Resources.DocumentIngestionFormatDisabled;case 8:return Resources.DocumentIngestionFileTypeError;case 0:case 7:default:return Resources.DocumentIngestionDocumentImportFailed}},n.showPdfNotification=function(n){var t="DIPdfNotif",i="notified",r,u;Cookie.getCookie(t)!==i&&(r={},Cookie.setCookie(t,i,r),u=StoryApp.View.Common.NotificationBarManager.getInstance(),u.createAndShowNotificationBar({text:n},!0))},n.getCappedFilenameString=function(n){var t=50,i=n;return n.length>t&&(i=n.slice(0,t-3)+"..."),i},n._supportedExt=CommonSettings.DocumentIngestionFormats?CommonSettings.DocumentIngestionFormats:["docx","pptx"],n._experimentallySupportedExt=CommonSettings.DocumentIngestionExperimentalFormats?CommonSettings.DocumentIngestionExperimentalFormats:["pdf"],n}();n.DocumentIngestionAPI=t;n.resultHandler=i;n.errorCreateFromOffice=r}(DocumentIngestion||(DocumentIngestion={})),function(n){function t(){Modernizr.addTest("preserve3d",function(){var n=document.createElement("div"),i=Modernizr.prefixed("transformStyle"),t,r;return n.style[i]="preserve-3d",document.body.appendChild(n),t=window.getComputedStyle?window.getComputedStyle(n):null,r=t?t[i]==="preserve-3d":!1,document.body.removeChild(n),r});Modernizr.addTest("dynamicscrollevents",function(){var t=navigator.userAgent,n,i;return!/iphone|ipad/i.test(t)||/windows/i.test(t)?!0:(n=/OS ([\d_]+)/i.exec(t),!n||n.length!==2)?!1:(i=n[1].split("_"),+i[0]>=8)});Modernizr.addTest("videoupload",function(){var t=navigator.userAgent,n,i;return/iphone|ipad/i.test(t)?/crios/i.test(t)?(n=/OS ([\d_]+)/i.exec(t),!n||n.length!==2)?!0:(i=n[1].split("_"),+i[0]<7):!0:!0})}n.initialize=t}(FeatureDetection||(FeatureDetection={}));FlightClientSettings=function(){function n(){}return n}(),function(n){var t;(function(t){var i=function(){function t(){this.showingGlobalErrorDialog=!1}return t.prototype.register=function(){var n=this;window.onerror=function(t,i,r,u,f){n.onError(t,i,r,u,f)}},t.prototype.unregister=function(){window.onerror=null},t.prototype.isWhitelistDomain=function(n){return this.isUrlInDomainList(n,t.DomainExceptionWhitelist)},t.prototype.isUrlInDomainList=function(n,t){var i=n.toUpperCase();return t.indexOfFirst(function(n){return i.indexOf(n)>=0})>=0},t.prototype.registerUndoManagerRecentActionsCallback=function(n){this.recentActionsLog=n},t.prototype.onError=function(n,t,i,r,u){var e=this,o=n,y=o,s=!1,h,c,l,a,v,f;o.indexOf("Access is denied")>=0&&!t&&i==1&&r==1&&(h=!0);o.indexOf("Permission denied")>=0&&u&&u.stack&&(l=u.stack,l&&l.indexOf("at Unknown script code")>=0&&(c=!0));o.indexOf("Error calling method on NPObject")>=0&&(a=!0);f={errorstr:y};t&&(s=e.isWhitelistDomain(t),s&&t.lastIndexOf(".js")<Math.max(0,t.length-3)&&(v=!0),f.errorUrl=t,i&&(f.errorUrl+="[line:"+i,f.errorUrl+=r?", col:"+r+"]":"]"));CommonSettings.UnsupportedBrowser?StoryLog.StructuredTraceTag(6650007,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: Unsupported Browser error",f):o.indexOf("887a0005")!==-1?StoryLog.StructuredTraceTag(6665824,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: DXGI_ERROR_DEVICE_REMOVED",f):s?h?StoryLog.StructuredTraceTag(7397717,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: From external domain",f):c?StoryLog.StructuredTraceTag(7897868,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: Permission denied for injected script.",f):a?StoryLog.StructuredTraceTag(8778017,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: Error calling method on NPObject.",f):v?StoryLog.StructuredTraceTag(8779923,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: Error caused by exception in external injected script.",f):y==="Script error"&&t&&!i?StoryLog.StructuredTraceTag(8983362,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Uncaught exception: Script error",f,u&&u.stack?u.stack:null):(e.recentActionsLog&&(f.actionlog=e.recentActionsLog()),StoryLog.StructuredTraceTag(6034319,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Uncaught exception: Unknown",f,u&&u.stack?u.stack:null)):StoryLog.StructuredTraceTag(6870810,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: From external domain",f);UnitTestMode||!s||h||c||a||v||setTimeout(function(){e.showingGlobalErrorDialog=!0;e.createAndShowExceptionDialog();ActionLogger&&ActionLogger.Flush();State.PauseUpdates=!0;State.DisableRequestManager=!0},0)},t.prototype.createAndShowExceptionDialog=function(){var t={title:Resources.GenericErrorDialogTitle,messages:[Resources.GenericErrorDialogText],dialogType:4,allowCancel:!1,dialogLogMessage:"Refresh Page",buttonsArgs:[{caption:Resources.GenericErrorDialogButtonText,isDefault:!0,dismissOnAction:!1,onAction:function(){location.reload()}}]};n.View.Common.DialogManager.createAndShow(t)},t.DomainExceptionWhitelist=["SWAY.COM","SWAY-CDN.COM","SWAY-INT.COM"],t}();t.GlobalExceptionHandler=i})(t=n.Common||(n.Common={}))}(StoryApp||(StoryApp={})),function(n){function u(t,i){var r={email:t,providerType:i};$.post(StoryApp.Common.UrlHelper.getInstance().signInUrlRedirect(),JSON.stringify(r)).done(function(n){location.href=n.signInUrl}).fail(function(){StoryLog.TraceTag(9217679,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Failed to get the redirect sign-in url. Redirecting to the default sign-in page");location.href=i===n.c_OrgId?CommonSettings.IdentityDefaultSignInUrlAAD:CommonSettings.IdentityDefaultSignInUrlMSA})}function f(){window.location.href=CommonSettings.SignOutUrl}function e(t,i){if(!CommonSettings.UseEmailSignInOnly){n.SignInHelperBothProviders(null);return}var r={showErrorMessage:t,emailId:i};StoryApp.View.ViewElements.AuthoringDialog.createAndShow(r)}function o(t){var u=new ClientAction.ButtonClickAction(60,Diag.ULSCat.msoulscat_Story_Site);ActionLogger.RecordClientAction(u);StoryLog.TraceTag(8210209,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User clicked the next button after entering email address");var f=function(u){var f=u.ProviderType;f.indexOf(n.c_OrgId)==0?n.SignInHelperAAD(t):f===n.c_MSAccount||f===i?n.SignInHelperMSA(t):f===r?n.SignInHelperBothProviders(t):n.SignInHelper(!0,t)},e=function(){n.SignInHelperBothProviders(t)},o={email:t,providerType:""};$.post(StoryApp.Common.UrlHelper.getInstance().providerType(),JSON.stringify(o)).done(f).fail(e)}function s(t){var i={title:ResourceManager.ResolveString(Resources.AuthenticationDialogTitle),messages:[ResourceManager.ResolveString(Resources.AuthenticationDialogSubTitle)],css:"AuthenticationDialog",noFocus:!0,dialogType:1,lightDismiss:!0,buttonsArgs:[{caption:ResourceManager.ResolveString(Resources.AuthenticationDialogMsaButtonCaption),onAction:function(){n.SignInHelperMSA(t)},isDefault:!0,dismissOnAction:!0,id:"MSADismiss"},{caption:ResourceManager.ResolveString(Resources.AuthenticationDialogOrgIdButtonCaption),onAction:function(){n.SignInHelperAAD(t)},isDefault:!1,dismissOnAction:!0,id:"OrgIdDismiss"}]};StoryApp.View.Common.DialogManager.createAndShow(i)}function h(t){var i=new ClientAction.ButtonClickAction(126,Diag.ULSCat.msoulscat_Story_Site);ActionLogger.RecordClientAction(i);StoryLog.TraceTag(7864857,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User authenticating using MSA");n.RedirectSignIn(t,n.c_MSAccount)}function c(t){var i=new ClientAction.ButtonClickAction(126,Diag.ULSCat.msoulscat_Story_Site);ActionLogger.RecordClientAction(i);StoryLog.TraceTag(7864858,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User authenticating using AAD");n.RedirectSignIn(t,n.c_OrgId)}function l(){var t="";CommonSettings.IsTenantUser?n.SignInHelperAAD(t):n.SignInHelperMSA(t)}function a(){if(CommonSettings.IsAuthenticated){var n=$("<iframe style='display: none' src='"+CommonSettings.SignInUrlSilent+"' />");n.on("load",null,null,t);$(document.body).append(n)}}function t(n){var t=$(n.delegateTarget),i=!1;try{i=t[0].contentWindow.IsAuthenticated}catch(n){}i&&t.remove()}n.c_OrgId="OrgId";n.c_MSAccount="MSAccount";var i="Neither",r="Both";n.RedirectSignIn=u;n.SignOutHelper=f;n.SignInHelper=e;n.SingleSignIn=o;n.SignInHelperBothProviders=s;n.SignInHelperMSA=h;n.SignInHelperAAD=c;n.SignInSkipDialog=l;n.RenewToken=a;n.RenewTokenIFrameOnLoad=t}(Identity||(Identity={})),function(n){function i(n){OfficeBrowserFeedback.StoryId=n;OfficeBrowserFeedback.focusedElement=document.activeElement;var i=new t;OfficeBrowserFeedback.InitAll(CommonSettings.ContentBaseUrl,i,r,Diag.ULSCat.msoulscat_Story_Feedback,Diag.ULSCat.msoulscat_Story_FeedbackData)}function r(){OfficeBrowserFeedback.focusedElement&&$(OfficeBrowserFeedback.focusedElement).focus()}var t=function(){function n(){this.l_Close=ResourceManager.ResolveString(Resources.ButtonClose);this.l_CommentPlaceholder=ResourceManager.ResolveString(Resources.FeedbackCommentPlaceholder);this.l_DontLike=ResourceManager.ResolveString(Resources.FeedbackDontLike);this.l_FeedbackOverall=ResourceManager.ResolveString(Resources.FeedbackOverall);this.l_FeedbackTitle=ResourceManager.ResolveString(Resources.FeedbackTitle);this.l_Like=ResourceManager.ResolveString(Resources.FeedbackLike);this.l_PrivacyStatement=ResourceManager.ResolveString(Resources.FeedbackPrivacyStatement);this.l_Submit=ResourceManager.ResolveString(Resources.FeedbackSubmit);this.l_Suggestion=ResourceManager.ResolveString(Resources.FeedbackSuggestion);this.l_WhatLike=ResourceManager.ResolveString(Resources.FeedbackWhatLike);this.l_WhatDontLike=ResourceManager.ResolveString(Resources.FeedbackWhatDontLike);this.l_DocumentPermission="";this.l_EmailRequest="";this.l_IncludeScreenshot="";this.l_Optional="";this.l_UservoiceInformation="";this.l_WhatSuggest=""}return n}();n.OnFeedbackClick=i}(Feedback||(Feedback={})),function(n){var t,i;n.StoryId;n.focusedElement,function(n){var t;(function(n){n.FeedbackQuestionRightText="officeBrowserFeedbackQuestionRightText";n.SuggestionsLink="officeBrowserFeedbackPrivacyStatementLink";n.SuggestionsLinkDiv="officeBrowserFeedbackSuggestionsLinkDiv";n.HelpLink="officeBrowserFeedbackPrivacyStatementLink";n.HelpLinkDiv="officeBrowserFeedbackHelpLinkDiv";n.SupportLink="officeBrowserFeedbackPrivacyStatementLink";n.SupportLinkDiv="officeBrowserFeedbackSupportLinkDiv";n.ReportLink="officeBrowserFeedbackPrivacyStatementLink";n.ReportLinkDiv="officeBrowserFeedbackReportLinkDiv"})(t=n.IDs||(n.IDs={}))}(t=n.Constants||(n.Constants={})),function(i){var r;(function(r){r.GenerateSchema=function(){var r={id:t.IDs.OverlayBackground,classes:[n.Constants.Classes.OverlayMinWidth,n.WindowProperties.IsNarrow()?"FeedbackOverlayBackground_Narrow":""],children:[{id:t.IDs.MainContainer,classes:n.WindowProperties.IsNarrow()?["FeedbackMainContainer_Narrow"]:[""],children:[{id:t.IDs.MainContentHolder,tag:t.Tags.Form,classes:[t.Classes.Hidden],children:[{id:t.IDs.LeftFormContainer,classes:[t.Classes.FormContainer],children:[{id:t.IDs.FeedbackTitle,classes:[t.Classes.FontTitle,t.Classes.TextAlginLeft,t.Classes.LineHeight],innerText:i.Strings.l_FeedbackTitle},{id:t.IDs.ColumnSeparatorDiv,classes:[t.UseNarrowScreenLayout?"":t.Classes.ShowRightBorder],children:[{id:t.IDs.FeedbackQuestionLeftText,classes:[t.Classes.FontSubtitle,t.Classes.TextAlginLeft,t.Classes.LineHeight],innerText:i.Strings.l_FeedbackOverall},{id:t.IDs.FeedbackOverallLikeAnchor,classes:[t.Classes.FeedbackOverallAnchor,t.Classes.BackgroundGrey],tag:t.Tags.Anchor,attributes:[{name:t.AttributeName.HRef,value:"#"},{name:t.AttributeName.Value,value:i.Strings.l_Like},{name:t.AttributeName.Role,value:t.AttributeValue.Button},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}],children:[{id:t.IDs.FeedbackOverallLikeImage,classes:[t.Classes.FeedbackOverallImage],tag:t.Tags.Img},{id:t.IDs.FeedbackOverallLikeText,classes:[t.Classes.FontText,t.Classes.FeedbackOverallText,t.Classes.LineHeight],innerText:i.Strings.l_Like}]},{id:t.IDs.PlaceHolderDiv1,classes:[t.Classes.FullWidth20pxHeight]},{id:t.IDs.FeedbackOverallDontLikeAnchor,classes:[t.Classes.FeedbackOverallAnchor,t.Classes.BackgroundGrey],tag:t.Tags.Anchor,attributes:[{name:t.AttributeName.HRef,value:"#"},{name:t.AttributeName.Value,value:i.Strings.l_DontLike},{name:t.AttributeName.Role,value:t.AttributeValue.Button},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}],children:[{id:t.IDs.FeedbackOverallDontLikeImage,classes:[t.Classes.FeedbackOverallImage],tag:t.Tags.Img},{id:t.IDs.FeedbackOverallDontLikeText,classes:[t.Classes.FontText,t.Classes.FeedbackOverallText,t.Classes.LineHeight],innerText:i.Strings.l_DontLike}]}]},{id:t.IDs.PrivacyStatementLinkDiv,classes:[t.Classes.FontText,t.Classes.LineHeight,t.Classes.TextAlginLeft],children:[{id:t.IDs.PrivacyStatementLink,tag:t.Tags.Anchor,innerText:i.Strings.l_PrivacyStatement,attributes:[{name:t.AttributeName.HRef,value:"http://go.microsoft.com/fwlink/?LinkID=507380"},{name:t.AttributeName.Target,value:t.AttributeValue.BlankWindow},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}]}]}]},{id:t.IDs.MiddleFormContainer,classes:[t.Classes.FormContainer,t.Classes.Hidden],children:[{id:t.IDs.ColumnSeparatorDiv,classes:[t.UseNarrowScreenLayout?"":t.Classes.ShowRightBorder],children:[{id:t.IDs.FeedbackQuestionMiddleText,classes:[t.Classes.FontSubtitle,t.Classes.MarginLeft36px,t.Classes.LineHeight,t.Classes.TextAlginLeft],attributes:[{name:t.AttributeName.AriaLive,value:t.AttributeValue.Polite}]},{id:t.IDs.FeedbackComment,classes:[t.Classes.FontText,t.Classes.MarginLeft36px],tag:t.Tags.TextArea,attributes:[{name:t.AttributeName.Name,value:t.IDs.FeedbackComment},{name:t.AttributeName.Placeholder,value:i.Strings.l_CommentPlaceholder},{name:t.AttributeName.MaxLength,value:t.AttributeValue.TextAreaMaxLength},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}]},]},{id:t.IDs.SubmitButtonContainer,children:[{id:t.IDs.SubmitButton,classes:[t.Classes.FontText,t.Classes.LineHeight],tag:t.Tags.Input,attributes:[{name:t.AttributeName.Type,value:t.AttributeValue.Submit},{name:t.AttributeName.Value,value:i.Strings.l_Submit},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}]}]}]},{id:t.IDs.RightFormContainer,classes:[t.Classes.FormContainer],children:[{id:t.IDs.ColumnSeparatorDiv,children:[{id:t.IDs.FeedbackQuestionRightText,classes:[t.Classes.FontSubtitle,t.Classes.TextAlginLeft,t.Classes.LineHeight],innerText:ResourceManager.ResolveString(Resources.FeedbackIdeaHelp)},{id:t.IDs.SuggestionsLinkDiv,classes:[t.Classes.FontText,t.Classes.LineHeight,t.Classes.TextAlginLeft],children:[{id:t.IDs.SuggestionsLink,tag:t.Tags.Anchor,innerText:i.Strings.l_Suggestion,attributes:[{name:t.AttributeName.HRef,value:"http://go.microsoft.com/?linkid=9862901"},{name:t.AttributeName.Target,value:t.AttributeValue.BlankWindow},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}]}]},{id:t.IDs.PlaceHolderDiv1,classes:[t.Classes.FullWidth20pxHeight]},{id:t.IDs.HelpLinkDiv,classes:[t.Classes.FontText,t.Classes.LineHeight,t.Classes.TextAlginLeft],children:[{id:t.IDs.HelpLink,tag:t.Tags.Anchor,innerText:ResourceManager.ResolveString(Resources.FeedbackHelp),attributes:[{name:t.AttributeName.HRef,value:"http://go.microsoft.com/?linkid=9862902"},{name:t.AttributeName.Target,value:t.AttributeValue.BlankWindow},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}]}]},{id:t.IDs.PlaceHolderDiv2,classes:[t.Classes.FullWidth20pxHeight]},{id:t.IDs.SupportLinkDiv,classes:[t.Classes.FontText,t.Classes.LineHeight,t.Classes.TextAlginLeft],children:[{id:t.IDs.SupportLink,tag:t.Tags.Anchor,innerText:ResourceManager.ResolveString(Resources.FeedbackSwayForum),attributes:[{name:t.AttributeName.HRef,value:"http://go.microsoft.com/?linkid=9862903"},{name:t.AttributeName.Target,value:t.AttributeValue.BlankWindow},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}]}]},{id:t.IDs.PlaceHolderDiv2,classes:[t.Classes.FullWidth20pxHeight]},{id:t.IDs.ReportLinkDiv,classes:[t.Classes.FontText,t.Classes.LineHeight,t.Classes.TextAlginLeft],children:[{id:t.IDs.ReportLink,tag:t.Tags.Anchor,innerText:ResourceManager.ResolveString(Resources.FeedbackReportViolation),attributes:[{name:t.AttributeName.HRef,value:StoryApp.Common.UrlHelper.getInstance().feedbackUrl(n.StoryId)},{name:t.AttributeName.Target,value:t.AttributeValue.BlankWindow},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}]}]}]}]}]}]}]};return CommonSettings.BlockSite_ReportAViolationForm&&(delete r.children[0].children[0].children[2].children[0].children[7],delete r.children[0].children[0].children[2].children[0].children[6]),r}})(r=i.Layout||(i.Layout={}));i.MainContentHolderSlideLeft=function(){n.Utils.SetElementVisibility(t.IDs.MiddleFormContainer,!0);t.UseNarrowScreenLayout?n.Utils.SetElementVisibility(t.IDs.LeftFormContainer,!1):$("#"+t.IDs.LeftFormContainer).css("margin-left","0px")}}(i=n.UI||(n.UI={}))}(OfficeBrowserFeedback||(OfficeBrowserFeedback={})),function(n){function t(n,t,i){var o=n.width/n.height,h=i.width/i.height;if(!(o<=h)){var f=i.left,e=t.width-i.left-i.width,r=o*i.height-i.width,u=Math.min(f,r/2),s=Math.min(e,r/2);i.left-=u;i.width+=u+s;f=i.left;e=t.width-i.left-i.width;r=o*i.height-i.width;r>0&&(f>0?(u=Math.min(f,r),i.left-=u,i.width+=u):e>0&&(s=Math.min(e,r),i.width+=s))}}function i(t,i,r){var f=t.flipped(),e=i.flipped(),u=r.flipped();n.expandWidth(f,e,u);r.set(u.flipped())}function r(t,i,r){var u=t.width/t.height,f=r.width/r.height;u>f?n.expandWidth(t,i,r):u<f&&n.expandHeight(t,i,r)}function u(n,t,i,r){var u=new Size,o=t.width/Math.max(1,t.height),s=r.width/Math.max(1,r.height),f=0;!n&&o>s||n&&o<s?(u.width=t.width,f=r.width/(u.width==0?1:u.width),u.height=r.height/(f==0?1:f)):(u.height=t.height,f=r.height/(u.height==0?1:u.height),u.width=r.width/(f==0?1:f));var e=new Rect,h=u.width/r.width,c=u.height/r.height;return e.width=i.width*h,e.height=i.height*c,e.left=-r.left*h+(t.width-u.width)/2,e.top=-r.top*c+(t.height-u.height)/2,e}n.expandWidth=t;n.expandHeight=i;n.expandRegion=r;n.scaleDimensionsToRect=u}(ImageUtils||(ImageUtils={})),function(n){var t;(function(n){function u(n,t){n.next=t;t.prev=n}function e(n){return!!n.prev}function t(n){var t=n.prev,i=n.next;t&&(t.next=i);i&&(i.prev=t);n.prev=n.next=undefined}var f=function(){function n(){this.hook=new r}return n.prototype.push=function(n){this.hook.push(n)},n.prototype.pop=function(){var n=this.hook.next;return n&&t(n),n},n.prototype.top=function(){return this.hook.next},n.prototype.empty=function(){return!this.hook.next},n.prototype.removeAt=function(n){for(var i=this.itr(),r=0;i.valid();i.advance(),r++)if(n===r)return t(i.current()),!0;return!1},n.prototype.length=function(){for(var n=0,t=this.itr();t.valid();t.advance(),n++);return n},n.prototype.toArray=function(){for(var t=[],n=this.itr();n.valid();n.advance())t.push(n.current());return t},n.prototype.itr=function(){return new i(this.hook.next)},n}(),i,r;n.Stack=f;i=function(){function n(n){this.iter=n}return n.prototype.current=function(){return this.iter},n.prototype.advance=function(){if(!this.iter)return undefined;var n=this.iter;return this.iter=this.iter.next,n},n.prototype.valid=function(){return!!this.iter},n}();n.StackIter=i;r=function(){function n(){}return n.prototype.push=function(n){t(n);this.next?(u(n,this.next),u(this,n)):this.hook(n)},n.prototype.hook=function(n){this.next=n;n.prev=this},n}();n.contained=e;n.disconnect=t})(t=n.Intrinsic||(n.Intrinsic={}))}(Containers||(Containers={})),function(n){function t(){var n=new Date;if(StoryLog.init(),setTimeout(StoryLog.LogPlt,0,n),Utilities.addUnloadEventListener(function(){State.DocumentUnloading=!0}),!document.body){StoryLog.StructuredTraceTag(8787666,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Something has gone wrong with a page load, we got no document body.",{CurrentPage:window.location.pathname,IsAuthenticated:CommonSettings.IsAuthenticated.toString(),AnonUserId:CommonSettings.AnonUserId});Utilities.tryRefreshOnce();return}FeatureDetection.initialize()}function i(n){StoryLog.StructuredTraceTag(8988371,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"CommonMain : goToMyStories",{CurrentPage:window.location.pathname,EntryPoint:n,IsAuthenticated:CommonSettings.IsAuthenticated.toString(),AnonUserId:CommonSettings.AnonUserId});CommonSettings.IsAuthenticated?(Cookie.setPageRequestInfo(StoryApp.Common.UrlHelper.getInstance().mySwaysUrl()),window.location.assign(StoryApp.Common.UrlHelper.getInstance().mySwaysUrl())):Identity.SignInHelper(!1,null);return}n.goToMyStoriesOrSignIn=i;$(t)}(CommonMain||(CommonMain={})),function(n){var t;(function(n){var t=function(){function n(n,t,i){this.url=t.url;this.verb=t.type;this.data=t.data;this.contentType=t.contentType;this.responseType=t.dataType;this.name=t.name;this.description=t.description;this.requestId=t.requestId;this.time=new Date;this.callstack=i;this.omitLog=t.omitLog}return n.prototype.getLoggingData=function(){return{URL:this.url,Verb:this.verb,"Content type":this.contentType,"Expected response type":this.responseType,"Request name":this.name,"Request description":this.description,"Request ID":this.requestId.toString(),"Request time":Utilities.getShortTimeString(this.time),Callstack:this.callstack,"Canary:":CommonSettings.Canary}},n}();n.Request=t})(t=n.RequestManager||(n.RequestManager={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(t){function f(){var n=$(document);n.on("ajaxStart"+r,c);n.on("ajaxSend"+r,l);n.on("ajaxSuccess"+r,a);n.on("ajaxError"+r,v);n.on("ajaxComplete"+r,y);n.on("ajaxStop"+r,p);$.ajaxPrefilter(function(n,t,i){t.retryCount=t.retryCount==undefined?0:++t.retryCount;var r=$.Deferred();return i.done(r.resolve),i.fail(function(u,f,e){t.retryCount<s?w(u,f,e,n.error,n.url,t,r):(n.error&&r.fail(n.error),r.rejectWith(i,[u,f,e]))}),r.promise(i)})}function h(){$(document).off(r)}function c(){}function l(n,i,r){var f,u;if(State.DisableRequestManager)return i.abort(),!1;if(r.requestId=o++,t.commonHeaders)for(f in t.commonHeaders)i.setRequestHeader(f,t.commonHeaders[f]);return CommonSettings.UserSessionId&&i.setRequestHeader(t.UserSessionIdHeader,CommonSettings.UserSessionId),CommonSettings.Canary&&r.type=="POST"&&i.setRequestHeader(CommonSettings.CanaryHeader,CommonSettings.Canary),r.timeout===undefined&&(r.timeout=CommonSettings.DefaultAjaxTimeout),u=new t.Request(i,r,Utilities.getStackTrace()),t.Data&&t.LogToDiagnosticPane&&t.Data.AppendRequest(u),r.storyRequest=u,r.omitLog||StoryLog.StructuredTraceTag(3781846,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"Request",u.getLoggingData()),!0}function a(n,i,r){CommonSettings.UserSessionId||(CommonSettings.UserSessionId=i.getResponseHeader(t.UserSessionIdHeader));var u=new t.Response(r.storyRequest,i,r,undefined);setTimeout(function(){t.Data&&t.Data.RemoveRequest(r.storyRequest)},5e3);t.Data&&t.LogToDiagnosticPane&&t.Data.AppendResponse(u);r.omitLog||StoryLog.StructuredTraceTag(3781847,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"Response",u.getLoggingData())}function v(n,i,r,u){var f=new t.Response(r.storyRequest,i,r,u);t.Data&&(t.Data.RemoveRequest(r.storyRequest),t.LogToDiagnosticPane&&t.Data.AppendResponse(f));State.DocumentUnloading||State.DisableRequestManager?n.stopImmediatePropagation():r.omitLog||StoryLog.StructuredTraceTag(3781848,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.warning,"Response",f.getLoggingData())}function y(){}function p(){}function w(n,i,r,f,o,s,h){var c,l,a,v;switch(n.status){case 401:if(c=Utilities.extractHostnameFromUrl(o),(c===o||c===location.hostname)&&n.statusText=="User unauthenticated"){StoryLog.TraceTag(6320150,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"AJAX request failed with 401 response.  Sending user to MSA sign-in page.");e(o,s,h);h.rejectWith(n,[n,i,r]);return}break;case 403:if(l=n.getResponseHeader(t.RPSTicketExpirationHeader),l!==null){StoryLog.TraceTag(6162244,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"AJAX request failed because RPS ticket expired.  Attempting to renew the ticket and replay the request.  Header value = "+l);e(o,s,h);return}StoryLog.TraceTag(6162247,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"403, but no OdsiHttpModule header found");break;case 412:if(CommonSettings&&CommonSettings.NewCanaryHeader&&(a=n.getResponseHeader(CommonSettings.NewCanaryHeader),a)){StoryLog.TraceTag(6608930,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"412, canary validation failed");CommonSettings.Canary=a;u(o,s,h);return}break;case 503:if(n.getResponseHeader("X-Sway503Reason")=="BRS"){v=n.getResponseHeader("X-Sway503SubReason");BRSDialog.show(Resources.BRSDialogTitle,[Resources.BRSDialogMessage]);h.rejectWith(n,[n,i,r]);return}if(n.statusText!="Feature unavailable"){u(o,s,h);return}}f&&h.fail(f);h.rejectWith(n,[n,i,r])}function e(n,t,r){i===null?(i=$.Deferred(),i.done(function(){return u(n,t,r)}),b(n,t)):(StoryLog.TraceTag(7738584,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"RPS ticket renewal already in progress, queuing another failed AJAX request for replay."),i.done(function(){return u(n,t,r)}))}function b(){StoryLog.TraceTag(6162245,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"Opening iframe to renew RPS ticket");var n=$("<iframe style='display: none' src='"+CommonSettings.SignInUrlSilent+"' />");n.on("load",null,null,k);$(document.body).append(n);setTimeout(d,CommonSettings.DefaultAjaxTimeout)}function k(n){try{StoryLog.TraceTag(6162248,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"RPS ticket renewal iframe page loaded");var t=$(n.delegateTarget),i=t[0].contentWindow.IsAuthenticated;(typeof i=="undefined"||i===null)&&StoryLog.TraceTag(6854785,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.warning,"RPS ticket renewal got undefined result from page: {0} using SignInUrlSilent: {1}",[t[0].contentWindow.location.href,CommonSettings.SignInUrlSilent]);t.remove();g(i)}catch(r){StoryLog.TraceTag(6162249,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"Exception accessing RPS ticket renewal iframe contents, probably not back to our site yet.  Exception: "+r)}}function d(){i&&i.state()==="pending"&&(StoryLog.TraceTag(6162250,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.warning,"RPS ticket renewal timed out"),i.reject(),Identity.SignInSkipDialog())}function g(n){if(typeof n=="undefined"||n===null){StoryLog.TraceTag(6162251,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.warning,"RPS ticket renewal returned undefined result");i.reject();Identity.SignInSkipDialog();return}if(!n){StoryLog.TraceTag(6162252,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.warning,"RPS ticket renewal failed");i.reject();Identity.SignInSkipDialog();return}StoryLog.TraceTag(6162253,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"RPS ticket renewal succeeded, queued AJAX calls will now be replayed");i.resolve();i=null}function u(n,t,i){return StoryLog.TraceTag(6162254,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"Replaying request to "+n),$.ajax(n,t).then(i.resolve,i.reject)}function nt(n){$.ajax(CommonSettings.CanaryUrl,{name:"EnsureValidCanary",description:"Ensure we have a valid canary",type:"POST",contentType:"application/json; charset=utf-8",dataType:"json"}).then(tt.bind(this,n),it)}function tt(n){for(var i,r=$("input"),t=0;t<r.length;t++)i=$(r[t]),i.attr("name")==CommonSettings.CanaryHeader&&i.attr("value",CommonSettings.Canary);n()}function it(){var t={title:Resources.GenericErrorDialogTitle,messages:[Resources.GenericErrorDialogText],dialogLogMessage:"Refresh Page",dialogType:4,buttonsArgs:[{caption:Resources.ButtonOK,isDefault:!0,dismissOnAction:!0}]};n.View.Common.DialogManager.createAndShow(t)}var r;t.JsonContentType="application/json; charset=utf-8";t.ContentTypeHeader="Content-Type";t.CorrelationIdHeader="X-CorrelationId";t.UserSessionIdHeader="X-UserSessionId";t.StoryIdHeader="X-StoryId";t.LookupIdHeader="X-LookupId";t.RPSTicketExpirationHeader="odsiHttpModule";t.LogToDiagnosticPane=!0;r=".storyRequestManager";t.Data;var o=1,s=2,i=null;t.commonHeaders={};t.init=f;t.Unregister=h;t.ensureValidCanary=nt;f()})(t=n.RequestManager||(n.RequestManager={}))}(StoryApp||(StoryApp={})),function(n){var t;(function(n){var t=function(){function t(t,i){this.request=t;this.data=i.responseText;this.contentType=i.getResponseHeader(n.ContentTypeHeader);this.allHeaders=i.getAllResponseHeaders();this.statusCode=i.status;this.statusText=i.statusText;this.correlationId=i.getResponseHeader(n.CorrelationIdHeader);this.time=new Date}return t.prototype.getLoggingData=function(){return{"Request ID":this.request.requestId.toString(),URL:this.request.url,"Response time":Utilities.getShortTimeString(this.time),"Content type":this.contentType,"Status code":this.statusCode.toString(),"Status text":this.statusText,"Correlation ID":this.correlationId,"Response headers":this.allHeaders}},t}();n.Response=t})(t=n.RequestManager||(n.RequestManager={}))}(StoryApp||(StoryApp={})),function(n){n[n.Unknown=0]="Unknown";n[n.Owner=1]="Owner";n[n.TenantWithLink=2]="TenantWithLink";n[n.AnyoneWithLink=3]="AnyoneWithLink";n[n.Public=4]="Public";n[n.Published=5]="Published"}(StoryAudience||(StoryAudience={})),function(n){function c(n,t){i=TDB.watchableTag(7611011,null,n);e=t}function s(n){return i.getWatchedValue(n)}function l(){return e}function a(){var n=s();return n!=2&&n!=1}function v(n){h("http://www.facebook.com/sharer.php?u="+encodeURIComponent(n)+"&display=popup","location=1,resizable=1",670,340)}function y(n,t){h("https://twitter.com/share?url="+encodeURIComponent(n)+"&text="+encodeURIComponent(t),"location=1,resizable=1,scrollbars=1",550,420)}function p(n,t){var i=CommonSettings.ContentNavigationEnabled,r={title:Resources.LinkSwayTitle,messages:[Resources.LinkSwayBody],text:n,textBoxDescription:Resources.ShareByLinkTextBoxDescription,alternateText:i?t:null,checkboxMessage:i?Resources.LinkSwayAlternateCheckBoxText:null,checkboxId:i?233:null};StoryApp.View.Common.CopyTextDialog.show(r)}function w(n){var t={title:Resources.EditLinkSwayTitle,messages:[Resources.EditLinkSwayBody],text:n,textBoxDescription:Resources.ShareByLinkTextBoxDescription};StoryApp.View.Common.CopyTextDialog.show(t)}function b(i,r,u){var f=$.Deferred(),e;return t=r,i||!CommonSettings.DeepSocialEnabled||o?f.resolve():(window.switchTo5x=!0,e=$.ajaxSettings.cache,$.ajaxSetup({cache:!0}),$.getScript("https://ws.sharethis.com/button/buttons.js").done(function(){window.stLight&&window.stButtons&&(window.stLight.options({publisher:"aa0b70b7-de60-462b-bfd6-044e9e7425d7",doNotHash:!0,onhover:!1,servicePopup:!0}),TDB.applyUpdate(function(){n.IsShareThisReady.setValue(!0)}),u&&r&&u.call(r))}).fail(function(){StoryLog.TraceTag(7935626,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Failed to initialize ShareThis script.")}).always(function(){$.ajaxSetup({cache:e});f.resolve()})),o=!0,f}function h(n,t,i,r){return window.open(n,"_blank",t+",width="+i+",height="+r+",left=20,top=20")}function k(n,t,i){var u=new ChangeLinkRequest;u.newViewAuthToken=!0;u.newEditAuthToken=!0;r(u,n,t,i)}function d(n,t,i){var u=new ChangeLinkRequest;u.newEditAuthToken=!0;r(u,n,t,i)}function g(n,t,i,u){var f=new ChangeLinkRequest;f.blockDuplication=n;r(f,t,i,u)}function nt(n,t,u){if(CommonSettings.SitePublishToCastFeatureEnabled){TDB.applyUpdate(function(){return i.setValue(5)});var f=new ChangeLinkRequest;f.publishToCast=!0;r(f,n,t,u)}}function tt(t,u,f,e){var o,s;CommonSettings.SitePublishToCastFeatureEnabled&&(o=u,o==0&&(o=n.getStoryDefaultAudience()),TDB.applyUpdate(function(){return i.setValue(o)}),s=new ChangeLinkRequest,s.unpublishFromCast=!0,s.audience=StoryAudience[o],r(s,t,f,e))}function it(n,t,r,u){var f=i.getValue(),o,s,e;TDB.applyUpdate(function(){return i.setValue(n)});o=function(t,i,r){return et(n,f,u,t,i,r)};s=function(){return ft(n,f,r)};StoryLog.StructuredTraceTag(7611013,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Queueing up change audience request",{newAudience:n.toString(),oldAudience:f.toString()});e=new ChangeLinkRequest;e.audience=StoryAudience[n];rt(e,t,s,o)}function rt(n,t,i,e){var o=function(){return u=r(n,t,i,e)};u?f.push(o):o()}function r(n,t,i,r){return $.ajax(StoryApp.Common.UrlHelper.getInstance().sharingChangeLinkUrl(t),{name:"SharingChangeLink",description:"Change sharing",type:"POST",data:JSON.stringify(n),contentType:StoryApp.RequestManager.JsonContentType,dataType:"json"}).then(function(n,t,r){ut(n,t,r,i)},r)}function ut(t,r,f,e){var o=StoryAudience[t.audience];u==null&&t.audience&&n.getCurrentStoryAudience()!=o&&TDB.applyUpdate(function(){i.setValue(o)});e&&e(t,r,f)}function ft(n,t,i){if(StoryLog.StructuredTraceTag(7709640,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Audience change request succeeded",{newAudience:n.toString(),oldAudience:t.toString()}),u=null,f.length>0){var r=f.shift();r()}i()}function et(n,t,r,e,o,s){StoryLog.StructuredTraceTag(7611012,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Audience change request failed",{newAudience:n.toString(),oldAudience:t.toString(),textStatus:o,errorThrown:s});f=[];u=null;TDB.applyUpdate(function(){return i.setValue(t)});r(e,o,s)}var i,e,f=[],u,t,o;n.IsShareThisReady=TDB.watchableTag(7935625,null,!1);n.facebookFallbackClickHandler=function(n){return t&&t.shareToFacebook?t.shareToFacebook.call(t,[n]):!1};n.twitterFallbackClickHandler=function(n){return t&&t.shareToTwitter?t.shareToTwitter.call(t,[n]):!1};n.setup=c;n.getCurrentStoryAudience=s;n.getStoryDefaultAudience=l;n.isPublicSharingAllowed=a;n.shareToFacebook=v;n.shareToTwitter=y;n.shareLink=p;n.shareEditLink=w;n.setupShareThis=b;n.changeAuthToken=k;n.changeEditToken=d;n.changeBlockDuplication=g;n.publishSwayToCast=nt;n.unpublishFromCast=tt;n.changeStoryAudience=it}(SharingManager||(SharingManager={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(){}return n.shareToFacebook=function(){var n=this;CommonSettings.SiteFacebookSharingEnabled?SharingManager.shareToFacebook(CommonSettings.SiteRootUrl):NyiDialog.show()},n.shareToTwitter=function(n){var t=this;CommonSettings.SiteTwitterSharingEnabled?SharingManager.shareToTwitter(CommonSettings.SiteRootUrl,n):NyiDialog.show()},n}();n.SiteShareAction=t})(t=n.ViewElements||(n.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){function s(n,i,u){r=n;o=i;t=u}function h(){var i=new f,r,t;Diag.ULS.setUlsHost(i);t=function(){r||(ActionLogger&&ActionLogger.Flush(),r=!0,i.dispose())};Utilities.addUnloadEventListener(t);Utilities.isIeOrEdge()||window.addEventListener("unload",t);n.StructuredTrace(Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Instantiated UploadingUlsHost.",{UserSessionId:CommonSettings?CommonSettings.UserSessionId:"CommonSettings not available"});TDB.setLoggingFunction(function(t,i){var r;switch(t){case 0:r=Diag.ULSTraceLevel.verbose;break;case 1:r=Diag.ULSTraceLevel.info;break;case 2:r=Diag.ULSTraceLevel.warning;break;case 3:r=Diag.ULSTraceLevel.error}n.Trace(Diag.ULSCat.msoulscat_Story_Site,r,i)});TDB.setRaiseRecoverableErrorFunction(n.RaiseRecoverableError)}function c(i){var f=new Date,e=this.PageExecutionBegin,o=CommonSettings.RequestTime,s,h;if(e&&f&&i){var c=(i.getTime()-e.getTime()).toString(),l=(f.getTime()-e.getTime()).toString(),u=undefined;o&&(u=(f.getTime()-o).toString());u&&(Number(u)>6e4||Number(u)<0)&&(n.TraceTag(4789061,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Anomalous inclusive page load time: "+u+" ms. Likely to be caused by stale URL or subsequently-resumed action."),u=undefined);s=CommonSettings.IsNewlyCreated?"CreateStory":CommonSettings.Action;h=top!=window;n.StructuredTraceTag(4587730,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Page loaded.",{Action:s,Mode:StoryViewMode[t],DocumentReadyMs:c,PageResponsiveMs:l,LatencyInclusiveTimeMs:u,StoryId:r,IsInIFrame:h?"true":"false"})}}function l(n){n.StoryId=r;t===2&&(n.setEditOccured(),n.IsEditing=!0);n.ViewMode=StoryViewMode[t]}function a(t,i,r,u,f){n.TraceTag(t,i,r,u,f)}function v(t,i,r,u,f){n.TraceTag(0,t,i,r,u,f)}function e(n,t,r,u,f,e){var s,o;if(typeof ManagedCallback!="undefined"&&r!=Diag.ULSTraceLevel.spam&&r!=Diag.ULSTraceLevel.verbose&&ManagedCallback.log(Utilities.formatString(u,f)),CommonSettings.UnsupportedBrowser&&(r==Diag.ULSTraceLevel.error||r==Diag.ULSTraceLevel.warning)&&(u+=" [Unsupported Browser error. Previous log level was "+(r==Diag.ULSTraceLevel.error?"error]":"warning]"),r=Diag.ULSTraceLevel.info),s=window.StoryPageSettings,s&&u.charAt(0)!="{"&&(u+="#ViewMode:"+StoryViewMode[s.Mode]),r==Diag.ULSTraceLevel.error&&typeof e=="undefined")try{throw new Error;}catch(h){e=h.stack}if(e){i++;u+="\nStack Trace #"+i+":\n"+e;try{$.ajax({type:"POST",timeout:CommonSettings.LoadTimeoutMilliseconds,url:StoryApp.Common.UrlHelper.getInstance().stackTraceUrl(),data:{stackTraceB64:window.btoa(e),stackTraceCounter:i},cache:!1,dataType:"json",traditional:!0})}catch(c){}}o=[n,t,g(r),u];f&&f.length>0&&(o=o.concat(f));Diag.ULS.sendTraceTag.apply(null,o)}function y(t,i,r,u,f){n.StructuredTraceTag(0,t,i,r,u,f)}function p(t,i,r,u,f,e){f.Purpose=u;f.UnsupportedBrowser=CommonSettings.UnsupportedBrowser?"true":"false";CommonSettings.UnsupportedBrowser&&(r==Diag.ULSTraceLevel.error||r==Diag.ULSTraceLevel.warning)&&(f.UnsupportedBrowserLevelChange="Log level was demoted to info. Previous value was "+(r==Diag.ULSTraceLevel.error?"error":"warning"),r=Diag.ULSTraceLevel.info);var o=window.StoryPageSettings;o&&(f.ViewMode=StoryViewMode[o.Mode]);n.TraceTag(t,i,r,JSON.stringify(f),null,e)}function w(t,i,r,u,f,e){n.StructuredActivityTag(0,t,i,r,u,f,e)}function b(t,i,r,u,f,e,o){var s=k(o);s.TELEM_ACTIVITY_ACTIONNAME=u;s.StoryId=e;s.Purpose=f;n.TraceTag(t,i,r,JSON.stringify(s))}function k(n){var t=Obj.properties(n).sort();return t.map(function(t){return t+":"+n[t]}).todict(function(n,t,i){return t["Column"+(i+1)]=n})}function d(n,t){var r=[],u,i;r.push('data: [{ "LogType:"'+n);for(u in t){if(i=t[u],typeof i=="string"&&i.indexOf("\n")!=-1)i="\n"+i,i=i.replace(/(\r\n|\n|\r)/gm,"\n        ");else if(typeof i=="undefined")continue;r.push('"'+u+":"+i+",")}return r.push("}]"),r.join("\n")}function g(n){return CommonSettings&&CommonSettings.FlightSettings&&CommonSettings.FlightSettings.logVerboseTraces&&n==Diag.ULSTraceLevel.verbose?Diag.ULSTraceLevel.info:n}function nt(n){u=n}function tt(n){if(u&&CommonSettings.TelemetryReportEnvironmentSetting.length>0&&location.pathname=="/"&&n){if(CommonSettings.UseGoogleAnalyticsTelemetry){var t=StoryApp.Common.UrlHelper.getInstance().refactorReferrerUrl(document.referrer),i=StoryApp.Common.UrlHelper.getInstance().refactorUrlForCampaignTracking(location.href);ga("send",{hitType:"event",eventCategory:"button",eventAction:"click",eventLabel:n,location:i,page:"/",title:"Homepage",referrer:t})}CommonSettings.UseWEDCSTelemetry&&typeof MscomCustomEvent!="undefined"&&MscomCustomEvent("ms.InteractionType","1","ms.cmpnm",n)}}function it(n){var t=StoryApp.Common.Environment.getInstance();if(t.isProductionEnvironment())e(7120353,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,n);else throw new Error(n);}var i=0,u=!1,f=function(n){function t(){var t="SessionId0";CommonSettings&&CommonSettings.UserSessionId&&(t=CommonSettings.UserSessionId);n.call(this,t,StoryApp.Common.UrlHelper.getInstance().remoteUlsUrl())}return __extends(t,n),t}(Diag.UploadingUlsHost),r,o,t;n.StoryUlsHost=f;n.setupForStoryPage=s;n.init=h;n.LogPlt=c;n.SetupUlsLogData=l;n.ClientActionTrace=a;n.Trace=v;n.TraceTag=e;n.StructuredTrace=y;n.StructuredTraceTag=p;n.StructuredActivity=w;n.StructuredActivityTag=b;n.FromDictionary=d;n.SetAllowAnalyticsTelemetryReporting=nt;n.ReportAnalyticsTelemetry=tt;n.RaiseRecoverableError=it}(StoryLog||(StoryLog={})),function(n){function t(n){n.click(function(n){return Cookie.setPageRequestInfo($(n.currentTarget).attr("href")),!0});n.mouseup(function(n){return Cookie.setPageRequestInfo($(n.currentTarget).attr("href")),!0})}function i(){t($("a.homeLink"))}n.WriteRequestTimeOnClick=t;n.SetupTimestampEvents=i}(StoryLogUtilities||(StoryLogUtilities={}));$(document).ready(function(){StoryLogUtilities.SetupTimestampEvents()}),function(n){function t(n){n([])}n.loadMyStories=t}(StoryManager||(StoryManager={})),function(n){function r(n,t){return i(0,n,t)}function i(n,i,r){if(!i)throw new Error("StoryMonitoredScope.CreateTag: Monitored scopes must be initialized with a descriptive name.");var u=new t;return u._stopped=!1,u._name=i,u._tag=n,u._category=r,u._begin=new Date,StoryLog.TraceTag(4477004,r,Diag.ULSTraceLevel.info,"Scope started: {0}",[u._name]),u}var t=function(){function n(){}return n.prototype.End=function(){if(!this._name)throw new Error("StoryMonitoredScope.End: Monitored scopes must be initialized through either Create or CreateTag, not the no-argument constructor.");if(!this._stopped){this._end=new Date;var n=(this._end.getTime()-this._begin.getTime()).toString(),t=this._tag,i=this._category,r=this._name;StoryLog.TraceTag(t,i,Diag.ULSTraceLevel.info,"Scope ended: Scope='"+r+"'; Time="+n+" milliseconds");console.log("Scope ended: Scope ='"+this._name+"'; Time="+(this._end.getTime()-this._begin.getTime()).toString()+".");this._stopped=!0}},n}();n.StoryMonitoredScope=t;n.Create=r;n.CreateTag=i}(MonitoredScope||(MonitoredScope={}));StoryReference=function(){function n(){this.title="";this.id="";this.created="";this.lastModified="";this.owner="";this.token=""}return n}(),function(n){var t;(function(t){var i;(function(t){var i=function(){function t(){}return t.shareToFacebook=function(n,t){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(t,Diag.ULSCat.msoulscat_Story_Site));CommonSettings.SiteFacebookSharingEnabled?(ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(2)),SharingManager.shareToFacebook(n)):NyiDialog.show()},t.shareToTwitter=function(n,t,i,r){if(r||(r=""),ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(i,Diag.ULSCat.msoulscat_Story_Site)),CommonSettings.SiteTwitterSharingEnabled){ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(4));var u;u=t?Resources.SharingTwitterAuthorMessage:Resources.SharingTwitterConsumerMessage;SharingManager.shareToTwitter(n,ResourceManager.ResolveString(u,[r]))}else NyiDialog.show()},t.shareViewLink=function(n,t,i){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(t,Diag.ULSCat.msoulscat_Story_Site));var r=i&&i!=n;ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(3,r));SharingManager.shareLink(n,r?i:null)},t.shareEditLink=function(n,t,i){var r=this;ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(5));n?SharingManager.shareEditLink(n):SharingManager.changeEditToken(t,function(n){i&&i(n.editUrl);SharingManager.shareEditLink(n.editUrl)},function(){ErrorDialog.ShowErrorDialog(Resources.EditLinkErrorTitle,Resources.EditLinkErrorBody,"Sharing: Edit Link failed to load")})},t.embed=function(i){if(ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(225,Diag.ULSCat.msoulscat_Story_Site)),CommonSettings.SiteEmbeddedSwaysEnabled){ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(1));var r={title:Resources.EmbedSway,messages:[],text:t.generateEmbedCode(n.Common.UrlHelper.getInstance().embedUrl(i)),textBoxDescription:Resources.EmbedSwayTextBoxDescription};n.View.Common.CopyTextDialog.show(r)}else NyiDialog.show()},t.generateEmbedCode=function(n){return'<iframe width="760px" height="500px" src="'+n+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border: none; max-width:100%; max-height:100vh" allowfullscreen webkitallowfullscreen mozallowfullscreen msallowfullscreen><\/iframe>'},t}();t.StoryShareAction=i})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){n[n.Preview=1]="Preview";n[n.Edit=2]="Edit";n[n.Embedded=3]="Embedded";n[n.AuthoringDisabled=4]="AuthoringDisabled"}(StoryViewMode||(StoryViewMode={}));var Task=function(){function n(n){var t=this;t._promise=n}return n.fromPromise=function(t){return new n(t)},n.fromResult=function(n){var t=new DeferredTask;return t.resolve(n),t},n.unwrap=function(n){var i=n._promise,t=new DeferredTask;return n.then(function(n){n.then(function(n){t.resolve(n)},function(){t.reject()})},function(){t.reject()}),t},n.prototype.then=function(t,i){var r=this;return n.fromPromise(r._promise.pipe(t,i))},n}(),DeferredTask=function(n){function t(){var t=this;t._deferred=$.Deferred();n.call(this,t._deferred)}return __extends(t,n),t.prototype.reject=function(){var n=this;n._deferred.reject()},t.prototype.resolve=function(n){var t=this;t._deferred.resolve(n)},t}(Task),TaskPool=function(){function n(n){var t=this;t._maxTaskCount=n;t._currentTaskCount=0;t._queuedTasks=[]}return n.createTaskMutex=function(){return new n(1)},n.prototype.onTaskComplete=function(){var n=this,t;n._queuedTasks.length>0?(t=n._queuedTasks.shift(),t.resolve(undefined)):n._currentTaskCount--},n.prototype.continueTask=function(n){var t=this;return n().then(function(n){return t.onTaskComplete(),n},function(){t.onTaskComplete()})},n.prototype.runTask=function(n){var t=this,i,r;return t._currentTaskCount<t._maxTaskCount?(t._currentTaskCount++,t.continueTask(n)):(i=new DeferredTask,r=i.then(function(){return t.continueTask(n)},function(){throw new Error("Task pool deferred task failed");}),t._queuedTasks.push(i),Task.unwrap(r))},n}(),DropShadow;(function(n){function t(n){var t="",i;return t+=Utilities.cvtServerToPxStr(n.scale,n.xOffset),t+=" "+Utilities.cvtServerToPxStr(n.scale,n.yOffset),n.blur<=0&&(n.blur=0),t+=" "+Utilities.cvtServerToPxStr(n.scale,n.blur),n.spread<=0&&(n.spread=0),t+=" "+Utilities.cvtServerToPxStr(n.scale,n.spread),n.color&&(i=n.color,t+=" "+i.toRGBAString()),n.inset&&(t+=" inset"),t}function i(n){return n.xOffset==0&&n.yOffset==0&&n.blur==0&&n.color.toArgbString()=="#00000000"&&n.spread==0&&n.inset==!1}function r(n){var t=n.color;return t.a>0&&(n.xOffset!=0||n.yOffset!=0||n.blur!=0||n.spread!=0)}n.cssFromDropShadow=t;n.isDropShadowDefault=i;n.isDropShadowVisible=r})(DropShadow||(DropShadow={})),function(n){function t(n,t){var i="",r;return i+=Utilities.cvtServerToPxStr(t.scale,t.xOffset),i+=" "+Utilities.cvtServerToPxStr(t.scale,t.yOffset),t.blur<=0&&(t.blur=0),i+=" "+Utilities.cvtServerToPxStr(t.scale,t.blur),t.color&&(r=new Color(t.color),i+=" "+r.toRGBAString()),i}function i(n){return n.xOffset==0&&n.yOffset==0&&n.blur==0&&n.color=="#00000000"}n.cssFromTextShadow=t;n.isTextShadowDefault=i;$(function(){$.cssHooks.textShadow={get:function(n){return n.textShadow||{xOffset:0,yOffset:0,blur:0,color:"#00000000",scale:1}},set:function(n,r){if(!i(r)){var u=t(n,r);n.style.textShadow=u;n.textShadow=r}}};$.cssNumber.textShadow=!0})}(TextShadow||(TextShadow={})),function(n){var t;(function(n){var t=function(){function n(){}return n.getInstance=function(){return n.instance||(n.instance=new n),n.instance},n.setInstance=function(t){n.instance=t},n.clearInstance=function(){n.instance=undefined},n.prototype.baseStoryUrl=function(n){return"/s/"+n},n.prototype.baseDecomposeUrl=function(n){return"/decompose/"+n},n.prototype.errorUrl=function(n){var t="/oops?UserSessionId="+CommonSettings.UserSessionId;return n&&(t+="&eventId="+n),t},n.prototype.signInUrlRedirect=function(){return"/json/signinurl"},n.prototype.stackTraceUrl=function(){return"/json/stackTrace"},n.prototype.exploreUrl=function(){return"/"},n.prototype.mySwaysUrl=function(){return"/my"},n.prototype.tutorialVideosUrl=function(){return"http://go.microsoft.com/fwlink/?LinkID=620102"},n.prototype.viewUrl=function(n){return CommonSettings.SiteRootUrl+n},n.prototype.shareLinkUrl=function(n){return n?CommonSettings.SiteRootUrl+n:""},n.prototype.embedUrl=function(n){return CommonSettings.SiteRootUrl+"s/"+n+"/embed"},n.prototype.deleteStoryUrl=function(n){return this.baseStoryUrl(n)+"/delete"},n.prototype.sharingChangeLinkUrl=function(n){return"/sharing/"+n+"/change"},n.prototype.syncUrl=function(n,t){return this.baseStoryUrl(n)+"/sync?blobContext="+t},n.prototype.joinUrl=function(n){return this.baseStoryUrl(n)+"/join"},n.prototype.renewSubscriptionUrl=function(n,t,i){return this.baseStoryUrl(n)+"/renew/"+t+"?editToken="+i},n.prototype.leaveUrl=function(n,t){return this.baseStoryUrl(n)+"/leave/"+t},n.prototype.readOnlyUrl=function(n){return this.viewUrl(n)+"?readonly=true"},n.prototype.knownWorldsUrl=function(){return"/knownworlds"},n.prototype.listFontSetOptionsUrl=function(t,i,r){return n.ApiBaseUrl+"fontsetoptions("+t+","+i+","+(r?r:"")+")"},n.prototype.getBase64StylePreviewImagesUrl=function(){return n.ApiBaseUrl+"style/base64previewimages"},n.prototype.getStyleGalleryUrl=function(t){return n.ApiBaseUrl+"style/gallery("+t+")"},n.prototype.getAnimationLevelForStyleUrl=function(t){return n.ApiBaseUrl+"styleanimationlevel("+t+")"},n.prototype.suggestedColorSetsUrl=function(n,t){return this.baseStoryUrl(n)+"/suggestedcolors?maxVariationsPerImage="+t},n.prototype.duplicateStoryUrl=function(n){return this.baseStoryUrl(n)+"/duplicate"},n.prototype.addAuthorUrl=function(n,t){return this.baseStoryUrl(t)+"/addauthor"},n.prototype.getAuthorsUrl=function(n){return this.baseStoryUrl(n)+"/authors"},n.prototype.getEditorsUrl=function(n){return this.baseStoryUrl(n)+"/editors"},n.prototype.removeEditorUrl=function(n,t){return this.baseStoryUrl(t)+"/removeEditor?editorId="+n},n.prototype.imageUrl=function(n,t,i,r,u){var f=u?CommonSettings.SiteCDNRootUrl:CommonSettings.SiteRootUrl;return f+"s/"+n+"/images/"+i+"?quality="+t.toString()+"&allowAnimation="+r},n.prototype.remoteStaticImageUrl=function(n){return"/story/remotestaticimages/"+n},n.prototype.getImageCropsUrl=function(n){return this.baseStoryUrl(n)+"/imagecrops"},n.prototype.beginUploadUrl=function(t){return CommonSettings.IsMocked?"":n.ApiBaseUrl+"upload/"+t+"/begin"},n.prototype.uploadFragmentUrl=function(t,i,r,u){return CommonSettings.IsMocked?"":n.ApiBaseUrl+"upload/"+t+"/"+i+"/fragment/"+r+"/"+u},n.prototype.endUploadUrl=function(t,i){return CommonSettings.IsMocked?"":n.ApiBaseUrl+"upload/"+t+"/"+i+"/end"},n.prototype.decomposeSearchUrl=function(n){return this.baseDecomposeUrl(n)+"/search"},n.prototype.decomposeBrowseUrl=function(n){return this.baseDecomposeUrl(n)+"/browse"},n.prototype.decomposeNextUrl=function(n){return this.baseDecomposeUrl(n)+"/next"},n.prototype.decomposeUploadUrl=function(n){return this.baseDecomposeUrl(n)+"/upload"},n.prototype.getSuggestionsUrl=function(n){return this.baseDecomposeUrl(n)+"/getsuggestions"},n.prototype.getSuggestionClustersUrl=function(n){return this.baseDecomposeUrl(n)+"/getsuggestionclusters"},n.prototype.getSuggestedContentDumpUrl=function(n){return"/story/"+n+"/scdump"},n.prototype.getDocumentClassUrl=function(n){return"/story/"+n+"/documentclass"},n.prototype.getMyStoriesUrl=function(){return"/home/getmystories"},n.prototype.getMyEditableStoriesUrl=function(){return"/home/getmyeditablestories"},n.prototype.storyUploadUrl=function(){return"/json/storyupload"},n.prototype.getStoriesUrl=function(){return"/home/getstories"},n.prototype.getEmbeddedStoryInfoUrl=function(n){return"/"+n+"/embeddedStoryInfo"},n.prototype.getEmbeddedOneDriveInfoUrl=function(){return"json/embeddedOneDriveInfo"},n.prototype.accessibilityViewUrl=function(t,i){var u=new RegExp(t+"/embed$","i").test(window.location.pathname),r=u?this.embedUrl(t):CommonSettings.SiteRootUrl+t;return i?r:r+"?"+n.accessibilityFlag+"="+n.accessibilityFlagEnabledValue},n.prototype.isAccessiblityView=function(){var t=Utilities.query.fetch(n.accessibilityFlag).toLowerCase();return t===n.accessibilityFlagEnabledValue},n.prototype.storyRestoreUrl=function(n,t){return this.viewUrl(n)+"#content="+t},n.prototype.getStoryUrl=function(n,t){return this.baseStoryUrl(n)+"/get?currentClientVersion="+t},n.prototype.documentIngestionCreateUrl=function(){return n.ApiBaseUrl+"story/createfromdoc"},n.prototype.documentEmbedFromBlobIdUrl=function(t){return n.ApiBaseUrl+"story("+t+")/documentembedfromblobid"},n.prototype.documentIngestionInsertUrl=function(t){return n.ApiBaseUrl+"story("+t+")/appenddoc"},n.prototype.documentEmbedFromOneDriveUrl=function(t){return n.ApiBaseUrl+"story("+t+")/documentembedfromonedrive"},n.prototype.uploadFileToBlobUrl=function(t){return n.ApiBaseUrl+"story("+t+")/createblobidfromfile"},n.prototype.documentIngestionInsertFromBlobIdUrl=function(t){return n.ApiBaseUrl+"story("+t+")/appenddocfromblobid"},n.prototype.documentIngestionInsertFromOneDriveUrl=function(t){return n.ApiBaseUrl+"story("+t+")/appendoddoc"},n.prototype.feedbackUrl=function(n){return"home/report?path="+encodeURIComponent(window.location.pathname)+"&cid="+CommonSettings.UserSessionId+(n?"&sid="+n:"")},n.prototype.remoteUlsUrl=function(){return CommonSettings.SiteRootUrl+Diag.UploadingUlsHost.defaultRemoteUlsUrl},n.prototype.internalFlightUrl=function(){return CommonSettings.SiteRootUrl+"home/internalflight?redirectUrl="+window.location.href},n.prototype.agaveHostResourcesUrl=function(){return CommonSettings.ContentBaseUrl+"AppsForOffice/"},n.prototype.twitterIFrameUrl=function(n){return CommonSettings.ContentBaseUrl+"TwitterFrame.html#"+n},n.prototype.siteDisabledUrl=function(){return CommonSettings.SiteRootUrl+"home/error/brs"},n.prototype.providerType=function(){return"/json/providertype"},n.prototype.nlSearchUrl=function(n){return this.baseStoryUrl(n)+"/nlsearch"},n.prototype.getDownloadUrl=function(n){var t=n;return t+=t.indexOf("?")<0?"?":"&",t+"download=true"},n.prototype.refactorReferrerUrl=function(n){var t="";return n&&(t=n.replace(/\?.*/,"")),t},n.prototype.refactorUrlForCampaignTracking=function(n){var f="",u="",e=!0,i,r,t;if(n){if(i=n.split("?"),i.length>1)for(r=i[1].split("&"),t=0;t<r.length;t++)r[t].indexOf("utm_")===0&&(e?(e=!1,u="?"+r[t]):u+="&"+r[t]);f=u===""?i[0]:i[0]+u}return f},n.prototype.getUrlForUnprocessedImage=function(n){return n},n.accessibilityFlag="accessible",n.accessibilityFlagEnabledValue="true",n.ApiBaseUrl="/api/1.0/",n}();n.UrlHelper=t})(t=n.Common||(n.Common={}))}(StoryApp||(StoryApp={})),function(n){function c(){}function l(){return $.browser.msie&&parseInt($.browser.version,10)<10}function a(){return!1||!!document.documentMode}function v(){return $.browser.webkit&&!t}function y(){return $.browser.msie||t||!window.ActiveXObject&&"ActiveXObject"in window}function p(){return $.browser.safari}function w(){return $.browser.mozilla}function b(n){if(!(n instanceof Array))return!1;if(n&&n.length!==0){var t=n.length;if(n[0])return!0;while(t--)if(n[t])return!0;return!1}return!1}function k(){if(typeof CurrentStoryAppOM=="undefined"||CurrentStoryAppOM===null||!CurrentStoryAppOM.inAutomation)return"";try{throw new Error;}catch(n){return n.stack?n.stack.replace("Error\n",""):""}}function d(n){function t(n,t){for(var i=""+n;i.length<t;)i="0"+i;return i}return t(n.getHours(),2)+":"+t(n.getMinutes(),2)+":"+t(n.getSeconds(),2)+"."+t(n.getMilliseconds(),3)}function u(n,t){var f,r,u;if(t)for(f=t.length,r=0;r<f;++r)u=i[r],u||(u=i[r]=new RegExp("\\{"+r+"\\}","g")),n=n.replace(u,t[r]);return n}function g(n){return n.replace(/^\s+/,"")}function nt(n){return n.replace(/\s+$/,"")}function tt(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return u(n,i)}function f(n){return n.toFixed(2)+"px"}function it(n,t){return f(n*t)}function rt(n,t){return o(n*t)}function o(n){return e(n*100)/100}function ut(n){var t=n.toString(),i=t.indexOf("e"),e,r,u,f;if(i>=0){if(e=t[0]==="-",e&&(t=t.substr(1),--i),r=t.substr(0,1)+t.substr(2,i-2),u=parseInt(t.substr(i+1),10),u<0){for(t="0.",f=-1;f>u;--f)t+="0";t+=r}else if(u<r.length-1)i=u+1,t=r.substr(0,i)+"."+r.substr(i);else for(t=r,f=r.length-1;f<u;++f)t+="0";e&&(t="-"+t)}return t}function ft(n,t){var i;if(n===null&&t===null||n===null&&t!==null&&t.length===0||t===null&&n!==null&&n.length===0)return!0;for(i=0;i<n.length;i++)if(t.indexOf(n[i])===-1)return!1;for(i=0;i<t.length;i++)if(n.indexOf(t[i])===-1)return!1;return!0}function et(n,t){if(n===null&&t===null||n===null&&t!==null&&t.length===0||t===null&&n!==null&&n.length===0)return!0;if(n.length!==t.length)return!1;for(var i=0;i<n.length;i++)if(t[i]!==n[i])return!1;return!0}function ot(n,t,i){for(var r=0;r<n.length;++r)if(i(t,n[r]))break;n.splice(r,0,t)}function st(n){var t=new Date,i=t.getTimezoneOffset()*6e4,r=Date.parse(n),u=new Date(r-i);return $.datepicker.formatDate("MM dd, yy",u)}function r(n){var t=0;for(var i in n)t++;return t}function ht(n){for(var t in n)return!1;return!0}function s(n,t){var i,u,f;if(r(n)!=r(t))return!1;for(i in n)if(n[i]&&typeof n[i]=="object"){if(u=n[i],f=t[i],typeof u.serialize=="function"&&(u=u.serialize()),typeof f.serialize=="function"&&(f=f.serialize()),!s(u,f))return!1}else if(n[i]!==t[i])return!1;return!0}function ct(n){var t=[];for(var i in n)t.push(n[i]);return t}function lt(n,t){var i=jQuery.Deferred(),r;return t&&t.registerOnCancelled(i,function(){clearTimeout(r);i.reject()}),r=setTimeout(function(){i.resolve()},n),i}function at(n){var t="",i=n.split("//"),r;return i.length>1?(r=/[\/\?#]/,t=i[1].split(r)[0]):t=n,t}function vt(n,t,i,r){function f(){u&&clearTimeout(u);u=setTimeout(function(){r&&r();u=null},t)}var u=null;n(function(){i?i().pipe(f):f()})}function yt(n,t){return function(){try{return n.apply(this,arguments)}catch(i){return platform.setImmediate(function(){throw i;}),t}}}function pt(n){return function(){var t=arguments;platform.setImmediate(function(){return n.apply(null,t)})}}function wt(n){return h(n.src)}function h(n){for(var t=n.split(",")[0].indexOf("base64")>=0?window.atob(n.split(",")[1]):decodeURI(n.split(",")[1]),u=n.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),f=new DataView(r),i=t.length;i--;)f.setUint8(i,t.charCodeAt(i));return new Blob([r],{type:u})}function bt(n,t,i){i&&$.ajax(n,i)}function kt(t){var i="beforeunload";n.isIeOrEdge()?i="unload":n.ios&&(i="pagehide");window.addEventListener(i,t)}function dt(t){window.location.href=n.query.has("retry")?StoryApp.Common.UrlHelper.getInstance().errorUrl(t):window.location.pathname+n.query.add("retry")}function gt(){return!!(window.clipboardData&&window.clipboardData.setData)}var t,i,e;n.eventWrapperSelector=".eventWrapper";n.query=new n.UrlDict("?",function(){return location.search});n.ios=/iphone|ipad/i.test(navigator.userAgent);n.ipad=/ipad/i.test(navigator.userAgent);n.isMacOsX=/mac os x/i.test(navigator.userAgent);t=/edge/i.test(navigator.userAgent);n.ios7=n.ios&&!Modernizr.dynamicscrollevents;n.noop=c;n.browserIsIE9=l;n.isIE=a;n.isWebkit=v;n.isIeOrEdge=y;n.isSafari=p;n.isFireFox=w;n.arrayContainsAtLeastOneNonNullValue=b;n.getStackTrace=k;n.getShortTimeString=d;i=[];n.formatString=u;n.trimStart=g;n.trimEnd=nt;n.format=tt;n.toPxStr=f;n.cvtServerToPxStr=it;n.cvtServerToPx=rt;e=Math.round;n.roundPx=o;n.toNonExponential=ut;n.setEquals=ft;n.sequenceEquals=et;n.insertInOrder=ot;n.adjustDateToUserTime=st;n.collectionLength=r;n.isCollectionEmpty=ht;n.collectionEquals=s;n.collectionToArray=ct;n.weblog=function(){var t=new n.UrlDict("&",function(){return location.search}),i;return t.has("weblog")?(i=t.fetch("weblog").split(";"),function(n,t){i.contains(n)&&console.log("["+n.toUpperCase()+"] "+t)}):function(){}}();n.waitForTimer=lt;n.extractHostnameFromUrl=at;n.throttledEvent=vt;n.safeCallback=yt;n.deferredEventHandler=pt;n.convertBase64ImageToBlob=wt;n.getBlobFromDataUri=h;n.sendBeacon=bt;n.addUnloadEventListener=kt;n.tryRefreshOnce=dt;n.supportsClipboard=gt}(Utilities||(Utilities={})),function(n){function i(n){return new r(n)}n.sequence=i;var r=function(){function n(n){this.delegates=[];var t=this;t.completed=n}return n.prototype.run=function(n){for(var r,i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return r=this,this.delegates.push(function(){n.apply(null,i);r.next()}),this},n.prototype.wait=function(n){var t=this;return this.delegates.push(function(){setTimeout(function(){return t.next()},n)}),this},n.prototype.defer=function(){var n=this;return this.delegates.push(function(){platform.setImmediate(function(){return n.next()})}),this},n.prototype.waitfor=function(n,t,i){function u(){if(n())r.next();else if(f-->0)r.delegates.unshift(u),setTimeout(function(){return r.next()},t);else throw new Error("Maximum number of retries exceeded while waiting for "+n.toString());}var r=this,f=i?i:Number.MAX_VALUE;return this.delegates.push(u),this},n.prototype.barrier=function(){var t=this,n=0;return this.delegates.push(function(){n===2?t.next():n=1}),function(){if(n===1)t.next();else if(n===0)n=2;else throw new Error("unblocked barrier more than once");}},n.prototype.start=function(){if(this.delegates.length!==0)try{this.delegates[0]()}catch(n){this.complete(n)}else this.complete()},n.prototype.next=function(){this.delegates.shift();this.start()},n.prototype.complete=function(n){var t=this;if(t.completed)t.completed(n);else if(n)throw n;},n}(),t;(function(n){n[n.NONE=0]="NONE";n[n.BLOCKED=1]="BLOCKED";n[n.UNBLOCKED=2]="UNBLOCKED"})(t||(t={}))}(Utilities||(Utilities={})),function(n){var t=function(){function t(){this.rules=[]}return t.prototype.rule=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return this.rules.push(n.formatString(t,r)),this},t}(),i,r;n.StyleFactory=t;i=function(n){function i(t){n.call(this,t);var i=this.el=window.document.createElement("style");i.type="text/css";window.document.head.appendChild(i)}return __extends(i,n),i.prototype.define=function(n){var r=new t,i;n(r);i=r.rules.join("\n");i!==this.el.innerHTML&&(this.el.innerHTML=i)},i.prototype.dispose=function(){window.document.head.removeChild(this.el);n.prototype.dispose.call(this)},i}(Disposable);n.DynamicStyle=i;r=function(n){function i(t){n.call(this,t);this.elements={}}return __extends(i,n),i.prototype.define=function(n){var i=this,e=new t,f,u,r,o;n(e);f=[];u={};e.rules.forEach(function(n){var t=i.elements[n];t?(delete i.elements[n],u[n]=t):f.push(n)});r=[];for(o in i.elements)r.push(i.elements[o]);f.forEach(function(n){var t;r.length>0?t=r.pop():(t=window.document.createElement("style"),t.type="text/css",document.head.appendChild(t));t.innerHTML=n;u[n]=t});r.forEach(function(n){window.document.head.removeChild(n)});i.elements=u},i.prototype.dispose=function(){for(var t in this.elements)document.head.removeChild(this.elements[t]);n.prototype.dispose.call(this)},i}(Disposable);n.EditableDynamicStyle=r}(Utilities||(Utilities={}));var Account=function(){function n(){}return n}(),ChangeLinkRequest=function(){function n(){}return n}(),ChangeLinkResponse=function(){function n(n,t,i,r,u,f,e){this.viewUrl=n;this.editUrl=t;this.authTokens=i;this.audience=r;this.blockDuplication=u;this.castId=f;this.castViewUrl=e}return n}(),DocumentIngestion;(function(n){var t=function(){function n(){}return n}();n.DI_Response=t})(DocumentIngestion||(DocumentIngestion={}));var DynamicStyleInfo=function(){function n(){}return n}(),EmbeddedOneDriveInfo=function(){function n(){}return n}(),EmbeddedStoryInfo=function(){function n(){}return n}(),EmbeddedOneDriveInfoRequest=function(){function n(){}return n}(),SignInRequest=function(){function n(){}return n}(),SignInResponse=function(){function n(){}return n}(),ImageCropsResponse=function(){function n(){}return n}(),ImageCropRequest=function(){function n(){}return n}(),ImageCropsRequest=function(){function n(){}return n}(),IdentityProviderTypeResponse=function(){function n(){}return n}(),O365ShellServiceResponse=function(){function n(){}return n}(),OneDriveEmbedType;(function(n){n[n.Unknown=0]="Unknown";n[n.Word=1]="Word";n[n.Excel=2]="Excel";n[n.Powerpoint=3]="Powerpoint"})(OneDriveEmbedType||(OneDriveEmbedType={}));StoryTile=function(n){function t(){n.call(this)}return __extends(t,n),t}(ObjectOM),function(n){var t=function(){function n(){}return n.isAPILoaded=function(){return n._isAPILoaded},n.loadAPI=function(){var t=document.createElement("script"),n;t.src="https://www.youtube.com/iframe_api";n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)},n.onAPILoaded=function(){n._isAPILoaded=!0;for(var t=0;t<n._queuedWork.length;t++)n._queuedWork[t]()},n.queueWork=function(t){n._isAPILoaded?t():n._queuedWork.push(t)},n._isAPILoaded=!1,n._queuedWork=[],n}();n.YouTubeAPILoader=t}(Common||(Common={})),function(n){var t,i,r,u,f,e,o,s,h,c,l,a,v,y;(function(n){n[n.Unstarted=-1]="Unstarted";n[n.Ended=0]="Ended";n[n.Playing=1]="Playing";n[n.Paused=2]="Paused";n[n.Buffering=3]="Buffering";n[n.Cued=5]="Cued"})(n.PlayerState||(n.PlayerState={}));t=n.PlayerState,function(n){n[n.InvalidParam=2]="InvalidParam";n[n.Html5error=5]="Html5error";n[n.VideoNotFound=100]="VideoNotFound";n[n.EmbeddingNotAllowed=101]="EmbeddingNotAllowed";n[n.EmbeddingNotAllowed2=150]="EmbeddingNotAllowed2"}(n.ErrorType||(n.ErrorType={}));i=n.ErrorType,function(n){n[n.AlwaysVisible=0]="AlwaysVisible";n[n.HideAllControls=1]="HideAllControls";n[n.HideProgressBar=2]="HideProgressBar"}(n.AutoHideVals||(n.AutoHideVals={}));r=n.AutoHideVals,function(n){n[n.NoAutoPlay=0]="NoAutoPlay";n[n.AutoPlay=1]="AutoPlay"}(n.AutoPlayVals||(n.AutoPlayVals={}));u=n.AutoPlayVals,function(n){n[n.UserDefault=0]="UserDefault";n[n.ForceOn=1]="ForceOn"}(n.ClosedCaptionsLoadPolicyVals||(n.ClosedCaptionsLoadPolicyVals={}));f=n.ClosedCaptionsLoadPolicyVals,function(n){n[n.Hide=0]="Hide";n[n.ShowLoadPlayer=1]="ShowLoadPlayer";n[n.ShowDelayLoadPlayer=2]="ShowDelayLoadPlayer"}(n.ControlsVals||(n.ControlsVals={}));e=n.ControlsVals,function(n){n[n.Enable=0]="Enable";n[n.Disable=1]="Disable"}(n.KeyboardControlsVals||(n.KeyboardControlsVals={}));o=n.KeyboardControlsVals,function(n){n[n.Disable=0]="Disable";n[n.Enable=1]="Enable"}(n.JsApiVals||(n.JsApiVals={}));s=n.JsApiVals,function(n){n[n.Hide=0]="Hide";n[n.Show=1]="Show"}(n.FullscreenButtonVals||(n.FullscreenButtonVals={}));h=n.FullscreenButtonVals,function(n){n[n.Show=1]="Show";n[n.Hide=3]="Hide"}(n.IvLoadPolicyVals||(n.IvLoadPolicyVals={}));c=n.IvLoadPolicyVals,function(n){n[n.SinglePlay=0]="SinglePlay";n[n.Loop=1]="Loop"}(n.LoopVals||(n.LoopVals={}));l=n.LoopVals,function(n){n[n.Full=0]="Full";n[n.Modest=1]="Modest"}(n.ModestBrandingVals||(n.ModestBrandingVals={}));a=n.ModestBrandingVals,function(n){n[n.Hide=0]="Hide";n[n.Show=1]="Show"}(n.RelatedVideosVals||(n.RelatedVideosVals={}));v=n.RelatedVideosVals,function(n){n[n.Hide=0]="Hide";n[n.Show=1]="Show"}(n.ShowInfoVals||(n.ShowInfoVals={}));y=n.ShowInfoVals}(YT||(YT={})),function(n){var t;(function(t){var i;(function(t){var i=n.View.Common.FRE,r=function(){function n(t){if(this._eventHandlers=[],this.gesturemanager=new TDB.Touch.GestureAnalyzer(n.minimumSwipeInPixels,n.tapToleranceInPixels),this.touchEnabled=!0,this.authoringStateModes={},n._instance)throw new Error("Error: Do not use constructor. Use DomEventRegister.getInstance() instead.");var i=this;i._rootElement=t;i._mousedownObjectId=undefined;i.currentAuthoringState=0}return n.setRoot=function(t){if(n._instance)throw new Error("Error: Cannot set root twice");var i=n._instance=new n(t);return i.initializeMouseEvents(),i.initializeKeyboardEvents(),i.initializeTouch(),i.initializeDragDropEvents(),n.getInstance()},n.getInstance=function(){if(!n._instance)throw new Error("Error: setRoot should be called before getting an instance of DomEventManager");return n._instance},n.prototype.disableTouch=function(){this.touchEnabled&&(this.touchEnabled=!1,this.touchmanager.unregister())},n.prototype.enableTouch=function(){this.touchEnabled||(this.touchEnabled=!0,this.touchmanager.register())},n.prototype.setTouchForAuthoringState=function(n,i){this.authoringStateModes[t.AuthoringState[n]]=i;this.currentAuthoringState==n&&this.setAuthoringState(n)},n.prototype.setAuthoringState=function(n){(this.currentAuthoringState=n,t.AuthoringState[n]in this.authoringStateModes)&&(this.authoringStateModes[t.AuthoringState[n]]?this.enableTouch():this.disableTouch())},n.prototype.registerEventHandler=function(n){var t=this;t._eventHandlers.push(n)},n.prototype.unregisterEventHandler=function(n){var t=this,i=t._eventHandlers.indexOf(n);i>=0&&t._eventHandlers.splice(i,1)},n.prototype.initializeMouseEvents=function(){this.registerMouseDownEvent();this.registerMouseUpEvent();this.registerClickEvent();this.registerdblclickEvent();this.registerMouseScrollEvent()},n.prototype.initializeKeyboardEvents=function(){this.registerKeyDownEvent();this.registerKeyPressEvent();this.registerKeyUpEvent()},n.prototype.initializeTouch=function(){this.touchmanager=TDB.Touch.CreateTouchManager();this.touchmanager.addTouchListener(this);this.touchmanager.addTouchListener(this.gesturemanager);this.gesturemanager.addGestureListener(this)},n.prototype.initializeDragDropEvents=function(){this.registerDragOverEvent();this.registerDragLeaveEvent();this.registerDropEvent()},n.prototype.focusedMouseEventHandler=function(n,t,i){var u=this,r=u.getInputTarget();return!r||r===i?!0:r.firstChanceMouseEvent(n,t,i)},n.prototype.registerMouseDownEvent=function(){var n=this;$(document).mousedown(function(t){var i=TDB.ViewElement.dataFor(t.target),r;n._mousedownObjectId=i?i.id:undefined;n.notifyMouseHandlers(t,i,1);r=n.focusedMouseEventHandler(t,1,i);r||t.preventDefault();r&&i&&i.handleMouseEvent&&i.handleMouseEvent(t,1)})},n.prototype.registerMouseUpEvent=function(){var n=this;$(document).mouseup(function(t){var i=TDB.ViewElement.dataFor(t.target),r;n.notifyMouseHandlers(t,i,2);r=n.focusedMouseEventHandler(t,2,i);r||t.preventDefault();r&&i&&i.handleMouseEvent&&i.handleMouseEvent(t,2)})},n.prototype.registerClickEvent=function(){var n=this;$(Utilities.eventWrapperSelector).click(function(t){var r=TDB.ViewElement.dataFor(t.target),f=n._mousedownObjectId,u;(n._mousedownObjectId=undefined,f&&r&&r.id!==f)||(n.notifyMouseHandlers(t,r,3),u=n.focusedMouseEventHandler(t,3,r),u||t.preventDefault(),u&&r&&r.handleMouseEvent&&(r.handleMouseEvent(t,3),i.getFirstRunManager().handleClick()))})},n.prototype.registerdblclickEvent=function(){var n=this;$(document).dblclick(function(t){var i=TDB.ViewElement.dataFor(t.target),r=n.focusedMouseEventHandler(t,4,i);i!=null&&(r=i.handleMouseEvent(t,4));r||t.preventDefault()})},n.prototype.registerMouseScrollEvent=function(){var n=this;$(document).bind("mousewheel DOMMouseScroll",function(t){return n.handleScrollEvt(t)});$(document).bind("MozMousePixelScroll",function(t){return t.originalEvent.wheelDelta=-t.originalEvent.detail/2,n.handleScrollEvt(t)})},n.prototype.handleScrollEvt=function(n){var i=this,t=TDB.ViewElement.dataFor(n.target);if(i.notifyMouseHandlers(n.originalEvent,t,6),t!=null)return t.handleMouseEvent(n.originalEvent,6)},n.handleKeyEvent=function(n,t,i){var r,u;(n.notifyKeyHandlers(t,i),t.isPropagationStopped())||(r=n.getInputTarget(),r&&(u=r.handleKeyEvent(t,i),u&6&&t.stopPropagation(),u&2&&t.preventDefault()))},n.prototype.registerKeyDownEvent=function(){var t=this;$(document).keydown(function(i){return n.handleKeyEvent(t,i,1)})},n.prototype.registerKeyPressEvent=function(){var t=this;$(document).keypress(function(i){return n.handleKeyEvent(t,i,2)})},n.prototype.registerKeyUpEvent=function(){var t=this;$(document).keyup(function(i){return n.handleKeyEvent(t,i,3)})},n.prototype.registerDragOverEvent=function(){var n=this;$(document).on("dragover",function(n){var t=TDB.ViewElement.dataFor(n.target);return t!=null&&t.handleDragOrDropEvent(n,1),n.preventDefault(),!1})},n.prototype.registerDragLeaveEvent=function(){var n=this;$(document).on("dragleave",function(n){var t=TDB.ViewElement.dataFor(n.target);t!=null&&t.handleDragOrDropEvent(n,2)})},n.prototype.registerDropEvent=function(){var n=this;window.addEventListener("drop",function(n){var t=TDB.ViewElement.dataFor(n.target);t!=null&&t.handleDragOrDropEvent(n,3)},!0)},n.prototype.notifyMouseHandlers=function(n,t,i){for(var u=this,r=0;r<u._eventHandlers.length;r++)u._eventHandlers[r].handleGlobalMouseEvent(n,t,i)},n.prototype.notifyKeyHandlers=function(n,t){for(var r=this,i=0;i<r._eventHandlers.length;i++)r._eventHandlers[i].handleGlobalKeyEvent(n,t)},n.prototype.notifyTouchMoveHandlers=function(n){for(var i=this,t=0;t<i._eventHandlers.length;t++)i._eventHandlers[t].touchMove(n)},n.prototype.notifyTouchStartHandlers=function(n){for(var i=this,t=0;t<i._eventHandlers.length;t++)i._eventHandlers[t].touchStart(n)},n.prototype.notifyTouchStopHandlers=function(n){for(var i=this,t=0;t<i._eventHandlers.length;t++)i._eventHandlers[t].touchStop(n)},n.prototype.dispatchTouchStart=function(n){var i=this,t;(i.notifyTouchStartHandlers(n),t=TDB.ViewElement.dataFor(n.originalEvent.target),t&&t.handleTouchStartEvent)&&t.handleTouchStartEvent(n)},n.prototype.dispatchTouchMove=function(n){var i=this,t=TDB.ViewElement.dataFor(n.originalEvent.target);(i.notifyTouchMoveHandlers(n),t&&t.handleTouchMoveEvent)&&t.handleTouchMoveEvent(n)},n.prototype.dispatchTouchStop=function(n){var i=this,t;(i.notifyTouchStopHandlers(n),t=TDB.ViewElement.dataFor(n.originalEvent.target),t&&t.handleTouchStopEvent)&&t.handleTouchStopEvent(n)},n.prototype.dispatchSwipe=function(n){var t=TDB.ViewElement.dataFor(n.target);t&&t.handleSwipeEvent&&t.handleSwipeEvent(n)},n.prototype.dispatchTap=function(n){var t=TDB.ViewElement.dataFor(n.target);t&&t.handleTapEvent&&(t.handleTapEvent(n),i.getFirstRunManager().handleClick())},n.prototype.getInputTarget=function(){var i=this,r=TDB.FocusableViewElement.getFocusedElement(),n,u,t;return r?r:(n=document.activeElement,n&&n!==document.body)?undefined:(u=i._rootElement,t=u.lastActivationChain,t?t.firstOrDefault():i.getDefaultInputTarget())},n.prototype.getDefaultInputTarget=function(){var t=this,n=[];return t._rootElement.traverseFocusable(function(n){return n.isDefaultInputTarget?n:null},function(){return n.length===0},n).firstOrDefault()},n.prototype.updateMouseclickTarget=function(n){var i=this,t=TDB.ViewElement.dataFor(n);i._mousedownObjectId=t?t.id:undefined},n.prototype.getRootPanelElement=function(){var n=this;return n._rootElement},n.tapToleranceInPixels=30,n.minimumSwipeInPixels=100,n}();t.DomEventRegister=r})(i=t.ViewElements||(t.ViewElements={}))})(t=n.View||(n.View={}))}(StoryApp||(StoryApp={})),function(n){(function(n){n[n.Ok=0]="Ok";n[n.EmptyFileError=1]="EmptyFileError";n[n.FileTooLargeError=2]="FileTooLargeError"})(n.FileStatus||(n.FileStatus={}));var i=n.FileStatus,t=function(n){function t(t,i){n.call(this,t);var r=this;r._args=i;r._fileHandles=[];r._currentUploadCount=0}return __extends(t,n),t.prototype.upload=function(n,t,i){for(var f,r=this,u=0;u<n.length;u++){if(StoryLog.TraceTag(5903239,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"File Uploader : upload : Uploading file of size "+n[u].size),f=r.checkFile(n[u],i),f!=0){r._args.context!=undefined&&r._args.onInvalidFile!=undefined&&r._args.onInvalidFile.call(r._args.context,n[u],f);continue}r._fileHandles.push({file:n[u],descriptor:t})}r.startNewFileBatch()},t.prototype.checkFile=function(n,t){var r=CommonSettings.MaxHttpRequestLength,i;return t&&(r=t),i=0,n.size>r?i=2:n.size===0&&(i=1),i},t.prototype.startNewFileBatch=function(){for(var n=this,i;n._currentUploadCount<t._maxConcurrentUploads&&n._fileHandles.length>0;)n._currentUploadCount++,i=n._fileHandles.splice(0,1)[0],n.uploadFile(i)},t.prototype.onSuccess=function(n,t,i,r){var u=this,f=r.file;u._args.context!=undefined&&u._args.onUploadComplete!=undefined&&u._args.onUploadComplete.call(u._args.context,f,t);u._currentUploadCount--;u.startNewFileBatch()},t.prototype.onError=function(n,t,i,r){var u=this,f=r.file;StoryLog.TraceTag(5903240,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Failed to upload file type : "+f.type+" : file size : "+f.size,null);u._args.context!=undefined&&u._args.onUploadError!=undefined&&u._args.onUploadError.call(u._args.context,t,i,f);u._currentUploadCount--;u.startNewFileBatch()},t.prototype.uploadFile=function(n){var i=this,t=n.file,f=function(t,r,u){i.onSuccess(u,t,r,n)},e=function(t,r,u){i.onError(t,r,u,n)},r=new FormData,u;r.append("file",t);u={name:"FileUploader: uploadFile",description:"Uploading "+t.name+" ("+t.size+" bytes) to "+n.descriptor,type:"POST",url:n.descriptor,data:r,dataType:"json",processData:!1,contentType:!1,timeout:12e4,success:f,error:e,fileHandle:n};StoryApp.RequestManager.ensureValidCanary(function(){$.ajax(u)})},t._maxConcurrentUploads=5,t}(Disposable);n.FileUploader=t}(FileUploader||(FileUploader={}));
//# sourceMappingURL=Common_min.js.map
