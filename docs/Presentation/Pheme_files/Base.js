var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},DisposableHolder=function(){function n(n){var t=this;t.resources=[];n&&n.addResource(t)}return n.prototype.addResource=function(n){var t=this;t.resources.push(n)},n.prototype.removeResource=function(n){var t=this;t.resources.removefirst(n)},n.prototype.dispose=function(){for(var n=this,t=n.resources.shift();t;)t.dispose(),t=n.resources.shift();n.resources=[]},n}(),Disposable=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(DisposableHolder),IdGenerator,ObjectOM,DisposableObjectOM,Obj,Exe,PlatformPolyFill,platform,Utilities,UTF;(function(n){function u(){return r(t-1)+"A"}function f(n,i){var r=String.fromCharCode("A".charCodeAt(0)+i+1),u=t-1<n.length?t-1:n.length;return n.substring(0,u)+r}function r(n){for(var t=[],r=0;r<n;r++)t.push(i.charAt(Math.floor(Math.random()*i.length)));return t.join("")}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=20;n.generate=u;n.generateChild=f;n.generateId=r})(IdGenerator||(IdGenerator={}));ObjectOM=function(){function n(){var n=this;n._id=IdGenerator.generate()}return n}();DisposableObjectOM=function(n){function t(t){n.call(this,t);var i=this;i._id=IdGenerator.generate()}return __extends(t,n),t}(Disposable);Object.defineProperties(Array.prototype,{empty:{value:function(){return this.length===0}},first:{value:function(n){var t=this.firstOrDefault(n);if(!t)if(this.empty())throw new Error("tried fetching first of an empty array");else if(n&&!n(t))throw new Error("predicate didn't match any element in the array");return t}},firstOrDefault:{value:function(n){var t,i;if(this.length===0)return null;if(!n)return this[0];for(t=0;t<this.length;++t)if(i=this[t],n(i))return i;return null}},last:{value:function(n){var t=this.lastOrDefault(n);if(t===null)if(this.empty())throw new Error("tried fetching last of an empty array");else throw new Error("predicate didn't match any element in the array");return t}},lastOrDefault:{value:function(n){var t,i;if(this.length===0)return null;if(!n)return this[this.length-1];for(t=this.length-1;t>=0;--t)if(i=this[t],n(i))return i;return null}},contains:{value:function(n){return this.indexOf(n)!==-1}},addunique:{value:function(n){return this.contains(n)?!1:(this.push(n),!0)}},count:{value:function(n){for(var i=0,t=0;t<this.length;++t)n(this[t])&&i++;return i}},mapmany:{value:function(n){for(var t=[],i=0;i<this.length;++i)t.push.apply(t,n(this[i]));return t}},todict:{value:function(n){for(var i={},t=0;t<this.length;++t)n(this[t],i,t);return i}},homogeneous:{value:function(){for(var i,r,u,n=[],t=0;t<arguments.length;t++)n[+t]=arguments[t];if(this.length===0)return!0;if(i=this,n.length===0){if(r=i.map(function(n){return Obj.properties(n)}),!r.homogeneous("length"))return!1;n=r[0]}return u=this[0],i.every(function(t){return n.every(function(n){return u[n]===t[n]})})}},groupby:{value:function(n){for(var t={},i=0;i<this.length;++i){var u=this[i],f=n(u),r=t[f];r||(t[f]=r=[]);r.push(u)}return t}},unique:{value:function(n){for(var i,r,u={},f=[],t=0;t<this.length;++t)(i=this[t],r=n(i),u[r])||(u[r]=!0,f.push(i));return f}},removefirst:{value:function(n){var t=this.indexOf(n);return t===-1?!1:(this.splice(t,1),!0)}},notNullOrUndefined:{value:function(){return this.filter(function(n){return n!==null&&n!==undefined})}},truthy:{value:function(){return this.filter(function(n){return!!n})}},section:{value:function(n,t){var i,r,u,f;if(this.length===0)return[];for(i=[this[0]],r=[],u=1;u<this.length;++u)f=this[u],n(i[i.length-1],f)?i.push(f):(r.push(t(i.slice())),i.length=0,i.push(f));return i.length&&r.push(t(i)),r}},indexOfFirst:{value:function(n){for(var t=0,i=this.length;t<i;++t)if(n(this[t]))return t;return-1}},mapSome:{value:function(n){for(var i,r=[],t=0,u=this.length;t<u;++t)i=n(this[t]),i&&r.push(i);return r}},bubbleSort:{value:function(n){var r=this.length,i=!1,t,u;do{for(i=!1,t=1;t<r;t++)n(this[t-1],this[t])>0&&(u=this[t-1],this[t-1]=this[t],this[t]=u,i=!0);r--}while(i===!0);return this}}}),function(n){function t(n){var t=[];for(var i in n)t.push(i.toString());return t}function u(n){var t=[];for(var i in n)t.push(n[i]);return t}function f(n,t){var i,r;if(n==null||t==null)return!1;for(i in n)if(n[i]!=t[i])return!1;for(r in t)if(n[r]!=t[r])return!1;return!0}function i(n,t){for(var i in t)n[i]=t[i];return n}function e(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];return t.reduce(i,{})}function o(){for(var i,r,u=[],t=0;t<arguments.length;t++)u[+t]=arguments[t];for(i={},r=0;r<u.length;++r)i=n.extend(i,u[r]);return i}function s(n,t){for(var r={},i=0;i<n.length;++i)r[n[i]]=t[i];return r}function h(n,t){var i,r;for(i in t)r=t[i],t[i]=r.bind(n);return t}function r(n,t,i,u){var f,e;return u||(u=[]),f=t(n),f&&u.push(f),e=i(n),e&&e.forEach(function(n){return r(n,t,i,u)}),u}n.properties=t;n.keys=t;n.values=u;n.equals=f;n.extend=i;n.extendAll=e;n.combine=o;n.keyval=s;n.implement=h;n.traverse=r}(Obj||(Obj={})),function(n){function i(n,i){if(t[n])throw new Error("duplicate definition for main: "+n);t[n]=i}function r(n){for(var r,u,f=[],i=1;i<arguments.length;i++)f[i-1]=arguments[i];if(r=location.search.match(/main=(\w+)/),r&&(n=r[1]),u=t[n],!u)throw new Error("error "+n+" is not loaded");u.apply(null,f)}var t={};n.main=i;n.run=r}(Exe||(Exe={})),function(n){function r(){return{setImmediate:t.create(),now:i.create()}}var t,i;(function(n){function i(){if(typeof postMessage=="undefined"||$.browser.mozilla)return!1;var n=!0,t=window.onmessage;return window.onmessage=function(){return n=!1},window.postMessage("","*"),window.onmessage=t,n}function r(){return!!(window.setImmediate||window.msSetImmediate)}function u(){return window.addEventListener("message",function(n){n.data==="setImmediate"&&t.runImmediates()},!1),function(n){t.scheduleImmediate(n,function(){window.postMessage("setImmediate","*")})}}function f(){var n=window.setImmediate||window.msSetImmediate;return function(i){t.scheduleImmediate(i,function(){n(t.runImmediates)})}}function e(){return function(n){t.scheduleImmediate(n,function(){window.setTimeout(t.runImmediates,0)})}}function o(){return r()?f():i()?u():e()}var t;(function(n){function r(){var r,n,u;for(t=!1,r=i.splice(0,i.length),n=0,u=r.length;n<u;++n)r[n]()}function u(n,r){(i.push(n),t)||(r(),t=!0)}var t=!1,i=[];n.runImmediates=r;n.scheduleImmediate=u})(t||(t={}));n.create=o})(t||(t={})),function(n){function t(){return Date.now?Date.now.bind(Date):function(){return(new Date).getTime()}}n.create=t}(i||(i={}));n.create=r}(PlatformPolyFill||(PlatformPolyFill={}));platform=PlatformPolyFill.create(),function(n){function r(n,r){var u=new i(n,r);return t.push(u),u}var t=[],i;addEventListener("resize",function(){platform.setImmediate(function(){for(var n=0,i=t.length;n<i;++n)t[n].run()})});i=function(){function n(n,t){this.fn=n;this.context=t}return n.prototype.dispose=function(){t.removefirst(this)},n.prototype.run=function(){this.fn.call(this.context)},n}();n.onResize=r}(Utilities||(Utilities={})),function(n){function b(n,i){var r=t;i&&(r=t.filter(function(n){return n.modulename===i}));w(0,r).always(function(t){return n(t)})}function k(){return t.mapmany(function(n){return n.timed.map(function(t){var i=n.modulename+"."+t.name,r=st(i,t);return{name:i,timing:r}})})}function d(){return t.map(function(n){return n.modulename})}function g(n,r){var f=i.indexOf(r),u,e;if(f!==-1?(u=i[f],u.modulename=n):u=a(n,r),t.contains(u))throw new Error("tried registering module more than once");t.push(u);e=ft(u);e.forEach(function(n){ut(u,n)})}function nt(n,t,i){for(var o,e,u=[],f=3;f<arguments.length;f++)u[f-3]=arguments[f];o=r(n);u=u||[];e=u.map(function(n,i){return{name:t+i,params:n}});e.empty()&&e.push({name:t,params:[]});e.forEach(function(n){s(o,n.name,i.bind.apply(i,[i].concat(n.params)))})}function tt(n,t,i){var u=r(n);h(u,t,i)}function it(n,t,i,u){var f=r(n);c(f,[t],i,u)}function rt(n,t,i,u){var f=r(n);c(f,t,i,u)}function e(){return document.getElementById("testing-state")||document.body}function s(n,t,i){n.unittests.push({name:t,test:l.bind(l,t,i)})}function h(n,t,i){n.unittests.push({name:t,test:function(){return y("waiting for: "+t),i.apply(i,arguments)}})}function ut(n,t){t.testfunctions.forEach(function(i){s(n,t.name+"."+i.name,i.test)});t.testpromises.forEach(function(i){h(n,t.name+"."+i.name,i.test)})}function c(n,t,i,r){n.timed=n.timed.concat(t.map(function(n,t){return{name:n,variation:t,setup:i,fun:r}}))}function l(n,t){var i=$.Deferred();return u(n,t,i),i.promise()}function ft(n){var t=Obj.properties(n).map(function(t){return n[t]}).filter(function(n){return n.prototype instanceof UnitTest});return t.map(et)}function et(n){var t=Object.create(n.prototype);if(n.call(t),!(t instanceof UnitTest))throw new Error("tried creating unittest that doesn't inherit from UnitTest");return t}function a(n,t){var i=t;return i.modulename=n,i.unittests=[],i.timed=[],i}function r(n){var r=i.indexOf(n),t;return r!==-1?i[r]:(t=a("{anonymous}",n),i.push(t),t)}function u(t,i,r){if(n.CatchExceptions)try{v(t,i,r)}catch(u){if(u instanceof UnitTestError)r.resolve(new UnitTestResult(t,!1,u.message));else{var f="Unexpected exception: "+u.message;r.resolve(new UnitTestResult(t,!1,f))}}else v(t,i,r)}function v(n,t,i){var f=t(),r;f instanceof UnitTestAsync?(r=f,setTimeout(function(){u(n,r.callback,i)},r.delay)):i.resolve(new UnitTestResult(n,!0))}function ot(n,t,i){t.delay>0?setTimeout(function(){u(n,t.callback,i)},t.delay):u(n,t.callback,i)}function y(n){$("<p>").text(n).prependTo(e())}function p(n,t,i,r){if(r===void 0&&(r=$.Deferred()),n>=t.length)return r.resolve(i),r;var u=t[n];return u.test().always(function(f,e){typeof f=="boolean"&&(f=new UnitTestResult(u.name,f,e?e.toString():undefined));i.add(f);p(n+1,t,i,r)}),r}function w(n,t,i,r){if(i===void 0&&(i=[]),r===void 0&&(r=$.Deferred()),n>=t.length)return y(""),r.resolve(i),r;var u=t[n];return p(0,u.unittests,new UnitTestModuleResult(u.modulename)).always(function(u){i.push(u);platform.setImmediate(function(){w(n+1,t,i,r)})}),r}function st(n,t){var u=1e3,i=new Array(u),c=t.fun,e=t.variation,l=t.setup(e),r,o,s,h;for(console.profile(n),r=0;r<u;++r)o=f(),c(l,e),s=f(),i[r]=s-o;return console.profileEnd(),h=i.reduce(function(n,t){return n+t},0),{min:Math.min.apply(null,i),max:Math.max.apply(null,i),avg:h/i.length}}var o,t,i,f;n.CatchExceptions=!0;n.AlertExceptions=!1;n.runtests=b;n.runtimed=k;n.modulenames=d;n.registermodule=g;n.testfun=nt;n.testpromise=tt;n.timefun=it;n.timefuns=rt;n.output=e;o=function(){function n(){}return n.Equal=function(n,t,i){if(t!==i)throw new UnitTestError(n+" (expected "+t+", actual "+i+")");},n.True=function(n,t){if(!0!==t)throw new UnitTestError(n+" (expected true, actual "+t+")");},n.False=function(n,t){if(!1!==t)throw new UnitTestError(n+" (expected false, actual "+t+")");},n.Exists=function(n,t){if(t===null||t===undefined)throw new UnitTestError(n+" (expected not null or undefined, actual "+t+")");},n.NullOrUndefined=function(n,t){if(t!==null&&t!==undefined)throw new UnitTestError(n+" (expected null or undefined, actual "+t+")");},n.AllEqual=function(t,i,r,u){if(u===void 0&&(u=!1),i.length!==r.length)throw new UnitTestError(t+" (lengths are not equal: "+i.length+" !== "+r.length+")");for(var f=0;f<i.length;++f)if(u){if(typeof i[f]!=typeof r[f])throw new UnitTestError(t+" (expected type "+typeof i[f]+", actual type "+typeof r[f]+" at index "+f+" )");if(typeof i[f]=="object")n.ObjectsEqual(t,i[f],r[f],!0);else if($.isArray(i[f]))n.AllEqual(t,i[f],r[f],!0);else if(i[f]!==r[f])throw new UnitTestError(t+" (expected "+i[f]+", actual "+r[f]+" at index "+f+" )");}else if(i[f]!==r[f])throw new UnitTestError(t+" (expected "+i[f]+", actual "+r[f]+" at index "+f+" )");},n.ObjectsEqual=function(t,i,r,u){var s,f;u===void 0&&(u=!1);s=Obj.properties(i).sort();n.AllEqual(t+": doesn't contain the same property keys",s,Obj.properties(r).sort());u&&n.Equal(i+" constructor is not actual constructor: "+r.constructor,i.constructor,r.constructor);for(f in i){var e=i[f],o=r[f],h=typeof e;n.Equal(i+" type is not actual type: "+typeof o,h,typeof o);$.isArray(e)?n.AllEqual("arrays in property "+f+" are not the same",e,o,u):u&&h==="object"?n.ObjectsEqual(t,e,o,!0):n.Equal(t+": "+f+" properties aren't the same",e,o)}},n.Throws=function(n,t){try{t()}catch(i){return}throw new UnitTestError(n+" (expected function to throw)");},n}();n.Assert=o;t=[];i=[];n.runcheck=ot;f=window.performance&&window.performance.now?window.performance.now.bind(window.performance):platform.now}(UTF||(UTF={}));var UnitTest=function(){function n(n){this.testfunctions=[];this.testpromises=[];var t=this;t.name=n}return n.prototype.setup=function(){},n.prototype.teardown=function(){},n.prototype.addfn=function(n,t){var i=this;this.testfunctions.push({name:n,test:function(){i.setup();t.call(i);i.teardown()}})},n.prototype.addpromise=function(n,t){this.testpromises.push({name:n,test:t.bind(this)})},n.prototype.addprefixed=function(n){var t=this,i=Obj.properties(this).filter(function(i){return t.constructor.prototype.hasOwnProperty(i)&&i.substring(0,n.length)===n&&t[i]instanceof Function});i.forEach(function(n){t.testfunctions.push({name:n.charAt(0).toUpperCase()+n.substring(1),test:function(){t.setup();t[n]();t.teardown()}})})},n.prototype.runCases=function(n,t){for(var o=n.length,i=0;i<o;++i){var r=n[i],u=r.inputs,f=t.apply(this,u),e=r.result;if(f!==e)throw new UnitTestError("Inputs: ["+u+"], actual: "+f+", expected: "+e);}},n}(),UnitTestAsync=function(){function n(n,t){t===void 0&&(t=0);var i=this;i.callback=n;i.delay=t}return n}(),UnitTestError=function(){function n(n){var t=this;t.message=n;UTF.AlertExceptions&&alert(n)}return n.prototype.toString=function(){return this.message},n}(),UnitTestModuleResult=function(n){function t(t){n.call(this);this.name=t;this.tests=0;this.passed=0;this.results=[]}return __extends(t,n),t.prototype.add=function(n){this.results.push(n);this.tests=this.results.length;n.success&&this.passed++},t}(ObjectOM),UnitTestResult=function(n){function t(t,i,r){n.call(this);var u=this;u.name=t;u.success=i;u.details=r}return __extends(t,n),t}(ObjectOM);
//# sourceMappingURL=Base_min.js.map
