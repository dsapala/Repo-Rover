/*! Version=16.0.0.0 */
Type.registerNamespace("Diag");Diag.ULSCat=function(){};Diag.ULSCat.prototype={msoulscat_ES_EWAJS:0,msoulscat_ES_EWAJSGrid:1,msoulscat_ES_EWAJSHeaderResize:2,msoulscat_ES_EWAJSKeyboard:3,msoulscat_ES_EWAJSTest:4,msoulscat_ES_EWAJSFloatingObjects:5,msoulscat_ES_EWAJSChart:6,msoulscat_ES_MobileEwa:7,msoulscat_ES_EWAJSBIExplore:8,msoulscat_ES_EWAJSNov:9,msoulscat_ES_EWAJSExcelEverywhere:10,msoulscat_ES_EWAJSTp:11,msoulscat_ES_EWAJSComment:12,msoulscat_bULS_Uploader:100,msoulscat_bULS_CachingHost:101,msoulscat_bULS_Core:102,msoulscat_Osi_MsoSpLogging:200,msoulscat_MSOSP_Error:201,msoulscat_MSOSP_FileMenuCommands:202,msoulscat_MSOSP_MsoSpRenameManager:203,msoulscat_MSOSP_CrossDocumentMessenger:204,msoulscat_MSOSP_ClientRequestManager:205,msoulscat_MSOSP_DownloadQueue:206,msoulscat_MSOSP_CommandUI:207,msoulscat_MSOSP_AppSettings:208,msoulscat_MSOSP_CommonDebug:209,msoulscat_MSOSP_DomUtils:210,msoulscat_MSOSP_OIC:211,msoulscat_MSOSP_AnonEdit:212,msoulscat_MSOSP_Activity:213,msoulscat_MSOSP_AnonCreate:214,msoulscat_MSOSP_O365ShellService:215,msoulscat_MSOSP_SaveToCloudStorage:216,msoulscat_MSOSP_SessionExpirationManager:217,msoulscat_MSOSP_TaskManager:218,msoulscat_MSOSP_SaveAsToHost:219,msoulscat_Wac_WordMerge:300,msoulscat_WAC_WordViewer:301,msoulscat_Wac_WordPresence:302,msoulscat_Wac_RevisionDiffer:303,msoulscat_Wac_WordCoauth:304,msoulscat_Wac_Replication:305,msoulscat_Wac_BrowserGeneral:306,msoulscat_Box4_CopyPaste:307,msoulscat_Wac_WordEditorFootnoteEndnote:308,msoulscat_Wac_WordEditorPageNumber:309,msoulscat_Wac_EventManager:310,msoulscat_Wac_WordEditorTableStyle:311,msoulscat_Wac_WordEditorFindReplace:312,msoulscat_Wac_FindReplace:313,msoulscat_Wac_WordEditorPageBreak:314,msoulscat_WAC_Box4Crash:315,msoulscat_Wac_WordEditorBlobFormatting:316,msoulscat_Wac_WordEditorHeaderFooter:317,msoulscat_Wac_WordEditorSelection:318,msoulscat_Wac_NodeLogger:319,msoulscat_Wac_TaskPaneFramework:320,msoulscat_Wac_Focus:321,msoulscat_Wac_ImageEditor:322,msoulscat_Wac_EditingView:323,msoulscat_Wac_Box4General:324,msoulscat_Wac_PeoplesWell:325,msoulscat_Wac_PageView:326,msoulscat_Wac_Comments:327,msoulscat_Wac_DirectPrint:328,msoulscat_Wac_GraphValidation:329,msoulscat_Wac_OneNotePrint:330,msoulscat_Wac_AppSettings:331,msoulscat_Wac_Embed:332,msoulscat_Wac_SkypeChat:333,msoulscat_WAC_Accessibility:334,msoulscat_Wac_Aggregator:335,msoulscat_Wac_WordEditorPagination:336,msoulscat_WAC_WordEditorSave:337,msoulscat_Wac_WoncaGeneral:338,msoulscat_Wac_OneNoteGeneral:339,msoulscat_Wac_Ribbon:340,msoulscat_Wac_WordEditorAppsForOffice:341,msoulscat_Wac_SendUsYourFile:342,msoulscat_WAC_DocxSaveMonitor:343,msoulscat_Wac_AppsForOffice:344,msoulscat_Wac_BrowserPerformance:345,msoulscat_Wac_WordEditorShapes:346,msoulscat_Wac_WordEditorFeatureHelper:347,msoulscat_Wac_InsertSymbol:348,msoulscat_Wac_WebAppsPortal:349,msoulscat_Wac_Yammer:350,msoulscat_Wac_OoXml:351,msoulscat_Wac_InsertMedia:352,msoulscat_Wac_WordZoom:353,msoulscat_Wac_WordEditorFormatPainter:354,msoulscat_Wac_WordRealTimeTyping:355,msoulscat_Wac_WacFeedback:356,msoulscat_Wac_WacFeedbackExcelOnlineViewMode:357,msoulscat_Wac_WacFeedbackExcelOnlineEditMode:358,msoulscat_Wac_WacFeedbackExcelOnlineSurveyMode:359,msoulscat_Wac_WacFeedbackPptOnlineViewMode:360,msoulscat_Wac_WacFeedbackPptOnlineEditMode:361,msoulscat_Wac_WacFeedbackOneNoteOnline:362,msoulscat_Wac_WacFeedbackWordOnlineViewMode:363,msoulscat_Wac_WacFeedbackWordOnlineEditMode:364,msoulscat_Wac_WordEditorUndo:365,msoulscat_Wac_WordEditorCustomXml:366,msoulscat_Wac_WordEditorNavigationPane:367,msoulscat_Wac_WordEditorContentControl:368,msoulscat_Wac_WordEditorExtension:369,msoulscat_OneService_Site:400,msoulscat_OneService_UnitTests:401,msoulscat_OneService_ClipperInstall:402,msoulscat_OneService_ClipperUsage:403,msoulscat_OneService_Site_EmailSettings:404,msoulscat_OneService_Site_Notebooks:405,msoulscat_OneService_Site_DevSite:406,msoulscat_OneService_Site_FeaturedApps:407,msoulscat_OneService_Site_FeedbackPage:408,msoulscat_OneService_Augmentation:409,msoulscat_OneService_AugmentationProvider_UrlEnhancer:410,msoulscat_OneService_AugmentationProvider_DomEnhancer:411,msoulscat_OneService_AugmentationProvider_Entitization:412,msoulscat_OneService_ClipperTooltip:413,msoulscat_OneService_Site_Students:414,msoulscat_OneService_AugmentationProvider_BizcardExtractor:415,msoulscat_OneService_Site_ClassNotebook:416,msoulscat_WAC_RealtimeChannel:500,msoulscat_WAC_RealtimeChannelTest:501,msoulscat_WAC_Signalr:600,msoulscat_WAC_VisioApp:700,msoulscat_WAC_VisioLoader:701,msoulscat_WAC_VisioDataModel:702,msoulscat_WAC_VisioRenderer:703,msoulscat_WAC_VisioRecalc:704,msoulscat_WAC_VisioCommand:705,msoulscat_WAC_VisioController:706,msoulscat_WAC_VisioShapePanel:707,msoulscat_WAC_VisioAppControls:708,msoulscat_WAC_VisioSync:709,msoulscat_Wac_PptAnimation:800,msoulscat_Wac_PptAppEvents:801,msoulscat_Wac_PptAppsForOffice:802,msoulscat_Wac_PptBrowserLayer:803,msoulscat_Wac_PptCoauthoring:804,msoulscat_Wac_PptComments:805,msoulscat_Wac_PptEditingManager:806,msoulscat_Wac_PptFocus:807,msoulscat_Wac_PptGraph:808,msoulscat_Wac_PptInit:809,msoulscat_Wac_PptNavigation:810,msoulscat_Wac_PptNone:811,msoulscat_Wac_PptNotes:812,msoulscat_Wac_PptPerf:813,msoulscat_Wac_PptPresence:814,msoulscat_Wac_PptShape:815,msoulscat_Wac_PptSelection:816,msoulscat_Wac_PptSession:817,msoulscat_Wac_PptTasks:818,msoulscat_Wac_PptThumbnailPane:819,msoulscat_Wac_PptText:820,msoulscat_Wac_PptUtil:821,msoulscat_Wac_PptView:822,msoulscat_Wac_PptSynchronization:823,msoulscat_Wac_PptWebService:824,msoulscat_Wac_PptMedia:825,msoulscat_Wac_PptCopyPaste:826,msoulscat_Wac_PptZoom:827,msoulscat_Uci_CommandsClient:1300,msoulscat_Uci_InsightsClient:1301,msoulscat_Uci_Assistance:1302,msoulscat_Uci_Insights:1303,msoulscat_Uci_Insights_Overview:1304,msoulscat_Uci_Insights_DrillIn:1306,msoulscat_Osf_Latency:1401,msoulscat_Osf_Notification:1402,msoulscat_Osf_Runtime:1403,msoulscat_Osf_AppManagementMenu:1404,msoulscat_Osf_InsertionDialogSession:1405,msoulscat_OneNoteOnline_Navigation:1600,msoulscat_Alchemy_Browser:1700,msoulscat_Ice_EmailHrd:1800,msoulscat_Ice_InsertMedia:1801,msoulscat_Met_Broadcast:1900};Diag.ULSCat.registerEnum("Diag.ULSCat",false);Diag.LogCategory=function(){};Diag.LogCategory.prototype={msoSpLogging:200,wordMerge:300,wordViewer:301,wordPresence:302,revisionDiffer:303,wordCoauth:304,wacReplication:305,wacBrowserGeneral:306,box4CopyPaste:307,wordEditorFootnoteEndnote:308,wordEditorPageNumber:309,wacEventManager:310,wordEditorTableStyle:311,wordEditorFindReplace:312,wacFindReplace:313,wordEditorPageBreak:314,box4Crash:315,wordEditorBlobFormatting:316,wordEditorHeaderFooter:317,wacGraphValidation:329};Diag.LogCategory.registerEnum("Diag.LogCategory",false);Diag.LogType=function(){};Diag.LogType.prototype={trace:0,"assert":1};Diag.LogType.registerEnum("Diag.LogType",false);Diag.IUlsHost=function(){};Diag.IUlsHost.registerInterface("Diag.IUlsHost");Diag.ULSTraceLevel=function(){};Diag.ULSTraceLevel.prototype={error:10,warning:15,info:50,verbose:100,spam:200,shiftFactor:1e3};Diag.ULSTraceLevel.registerEnum("Diag.ULSTraceLevel",false);Diag.LoggingArgs=function(f,b,e,c,d,a){this.timestamp=f;this.category=b;this.tag=e;this.level=c;this.message=d||"";this.logType=a};Diag.LoggingArgs.prototype={timestamp:0,category:0,tag:0,level:0,message:null,logType:0};Diag.UlsLoggingEventArgs=function(a){Diag.UlsLoggingEventArgs.initializeBase(this);this.args=a};Diag.UlsLoggingEventArgs.prototype={args:null};Diag.UlsHostStub=function(){};Diag.UlsHostStub.prototype={handleTrace:function(){},showAssertDialog:function(){},handoffToNewHost:function(){},flushAsynchronous:function(){},add_onUlsTrace:function(){},remove_onUlsTrace:function(){},dispose:function(){}};Diag.LoggingArgs.registerClass("Diag.LoggingArgs");Diag.UlsLoggingEventArgs.registerClass("Diag.UlsLoggingEventArgs",Sys.EventArgs);Diag.UlsHostStub.registerClass("Diag.UlsHostStub",null,Diag.IUlsHost,Sys.IDisposable);Type.registerNamespace("Diag");Diag.IUlsImpl=function(){};Diag.IUlsImpl.registerInterface("Diag.IUlsImpl");Diag.CachingUlsHost=function(b,a){this.$$d_$y_1=Function.createDelegate(this,this.$y_1);Diag.CachingUlsHost.initializeBase(this);this.$p_1=b;this.$y_1(a)};Diag.CachingUlsHost.prototype={$p_1:null,$A_1:null,$y_1:function(a){this.$A_1=[];!a&&window.setTimeout(this.$$d_$y_1,6e4);Diag.ULS.sendTraceTag(3973958,101,50,"Reset")},handleTrace:function(a){a&&Array.add(this.$A_1,a)},handoffToNewHost:function(c){var b=this.$A_1.length;Diag.ULS.sendTraceTag(3973959,101,50,"Cached {0} logs",b);for(var a=0;a<b;a++)c.handleTrace(this.$A_1[a])},flushAsynchronous:function(){}};Diag.UlsImplStub=function(){this.$1_0=new Diag.UlsHostStub};Diag.UlsImplStub.prototype={get_host:function(){return this.$1_0},set_host:function(a){return a},logImpl:function(){},assertImpl:function(){},shouldTrace:function(){return false},setTraceLevel:function(){},get_ulsCallDepth:function(){return 0}};Diag.Log=function(){};Diag.Log.$Q=function(a,b,c){try{Diag.Log.traceTag(a,200,10,"Exception was thrown while {0}: {1}",b,c.toString())}catch(d){}};Diag.Log.traceTag=function(c,e,f,d){for(var b=[],a=4;a<arguments.length;++a)b[a-4]=arguments[a];try{Diag.ULS.sendTraceTag.apply(null,[c,Diag.Log.$g(e),Diag.Log.$w(f),d].concat(b))}catch(g){Diag.Log.$Q(c,"logging",g)}};Diag.Log.shouldTrace=function(a,b){try{return Diag.ULS.shouldTrace(Diag.Log.$g(a),Diag.Log.$w(b))}catch(c){Diag.Log.$Q(0,"checking ShouldTrace",c);return false}};Diag.Log.debugAssertTag=function(c){for(var b=[],a=4;a<arguments.length;++a)b[a-4]=arguments[a];try{}catch(g){Diag.Log.$Q(c,"asserting",g)}};Diag.Log.shipAssertTag=function(c,f,e,d){for(var b=[],a=4;a<arguments.length;++a)b[a-4]=arguments[a];try{Diag.ULS.shipAssertTag.apply(null,[c,Diag.Log.$g(f),e,d].concat(b))}catch(g){Diag.Log.$Q(c,"asserting",g)}};Diag.Log.$g=function(a){return a};Diag.Log.$w=function(a){return a};Diag.Log.Level=function(){};Diag.Log.Level.prototype={spam:200,verbose:100,info:50,warning:15,error:10};Diag.Log.Level.registerEnum("Diag.Log.Level",false);Diag.ULS=function(){};Diag.ULS.setUlsHost=function(a){if(Diag.ULS.$K)Diag.ULS.$2=new Diag.UlsImpl;Diag.ULS.$2.set_host(a);Diag.ULS.$K=false};Diag.ULS.get_host=function(){return Diag.ULS.$2.get_host()};Diag.ULS.disable=function(){Diag.ULS.$2=new Diag.UlsImplStub;Diag.ULS.$K=true};Diag.ULS.sendTraceTag=function(f,c,e,d){for(var b=[],a=4;a<arguments.length;++a)b[a-4]=arguments[a];Diag.ULS.$2.logImpl(f,c,e,0,false,d,b)};Diag.ULS.shipAssertTag=function(f,c,d,e){for(var b=[],a=4;a<arguments.length;++a)b[a-4]=arguments[a];Diag.ULS.$2.assertImpl(f,c,d,e,b)};Diag.ULS.debugAssertTag=function(){for(var b=[],a=4;a<arguments.length;++a)b[a-4]=arguments[a]};Diag.ULS.shouldTrace=function(a,b){return Diag.ULS.$2.shouldTrace(a,b)};Diag.ULS.setTraceLevel=function(a){Diag.ULS.$2.setTraceLevel(a)};Diag.ULS.get_ulsCallDepth=function(){return Diag.ULS.$2.get_ulsCallDepth()};Diag.ULS.concatArray=function(b){var a;return(a=[]).concat.apply(a,b).join("")};Diag.ULS.jsonSerialize=function(a){return window.JSON?JSON.stringify(a):Sys.Serialization.JavaScriptSerializer.serialize(a)};Diag.UlsImpl=function(){this.$1_0=new Diag.UlsHostStub};Diag.UlsImpl.$r=function(d,a){if(!a||!a.length)return d||"";for(var c=0,f=a.length;c<f;++c){var b=a[c];if(b&&typeof b==="object"){var e=Object.getType(b).prototype.toString;if(e===Diag.UlsImpl.$x||!e)if(b.nodeType===1)a[c]=Diag.ULS.concatArray([b.tagName,"#",b.id,".",b.className]);else try{a[c]=Diag.ULS.jsonSerialize(b)}catch(g){a[c]=g}}}return!d?a.join(", "):String.format.apply(null,[d].concat(a))};Diag.UlsImpl.prototype={$d_0:50,get_ulsCallDepth:function(){return this.$5_0},$5_0:0,$J_0:false,get_host:function(){return this.$1_0},set_host:function(a){if(a===this.$1_0)return a;if(this.$J_0)return a;this.$J_0=true;if(!a){this.$1_0.dispose();this.$1_0=new Diag.UlsHostStub}else{this.$1_0.handoffToNewHost(a);this.$1_0.dispose();this.$1_0=a}this.$J_0=false;return a},logImpl:function(f,b,c,d,a,e,i){if(!d&&!this.shouldTrace(b,c)||this.$5_0>1)return;if(!a)this.$5_0++;try{var g=new Date,h=new Diag.LoggingArgs(g.getTime(),b,f,c,Diag.UlsImpl.$r(e,i),d);this.$1_0.handleTrace(h)}finally{if(!a)this.$5_0--}},assertImpl:function(d,a,b,c,f){if(!b&&this.$5_0<=1){this.$5_0++;try{var e=Diag.UlsImpl.$r(c,f);this.logImpl(d,a,10,1,true,e,null)}finally{this.$5_0--}}},shouldTrace:function(b,a){return a<=this.$d_0},setTraceLevel:function(a){this.$d_0=a}};Diag.UULS=function(){};Diag.TaggingUtilities=function(){};Diag.TaggingUtilities.getTagFromiTag=function(a){if(a<=65535)return a.toString();if(a>>>24>=36)return String.fromCharCode.call(null,a>>>24&255,a>>>16&255,a>>>8&255,a&255);var b="abcdefghijklmnopqrstuvwxyz0123456789";return""+b.charAt(a>>>24&63)+b.charAt(a>>>18&63)+b.charAt(a>>>12&63)+b.charAt(a>>>6&63)+b.charAt(a&63)};Diag.TaggingUtilities.getiTagFromTag=function(a){var b=0;b=parseInt(a);if(b.toString(10)===a&&b<=65535)return b;if(a.length===4)b=a.charAt(0)<<24|a.charAt(1)<<16|a.charAt(2)<<8|a.charAt(3);else{var c="abcdefghijklmnopqrstuvwxyz0123456789";b=c.indexOf(a.charAt(0))<<24|c.indexOf(a.charAt(1))<<18|c.indexOf(a.charAt(2))<<12|c.indexOf(a.charAt(3))<<6|c.indexOf(a.charAt(4))}return b};Diag.TaggingUtilities.reserveTag=function(a){return a};Diag.CachingUlsHost.registerClass("Diag.CachingUlsHost",Diag.UlsHostStub);Diag.UlsImplStub.registerClass("Diag.UlsImplStub",null,Diag.IUlsImpl);Diag.Log.registerClass("Diag.Log");Diag.ULS.registerClass("Diag.ULS");Diag.UlsImpl.registerClass("Diag.UlsImpl",null,Diag.IUlsImpl);Diag.UULS.registerClass("Diag.UULS");Diag.TaggingUtilities.registerClass("Diag.TaggingUtilities");Diag.ULS.$2=new Diag.UlsImpl;Diag.ULS.$K=false;Diag.UlsImpl.$x=Object.prototype.toString;Diag.UULS.trace=Diag.ULS.sendTraceTag;Type.registerNamespace("Diag");Diag.ILogCache=function(){};Diag.ILogCache.registerInterface("Diag.ILogCache");Diag.SerializableLogCache=function(a,b,c,d,e){this.T=a;this.L=b;this.S=c;this.I=d;this.V=e};Diag.LogCache=function(a,b,c){this.$W_0=a;this.$L_0=b;this.$a_0=c;this.reset()};Diag.LogCache.prototype={$N_0:0,$E_0:null,$a_0:null,$I_0:0,$W_0:0,$L_0:0,reset:function(){this.$E_0=[];this.$I_0=25;this.$N_0=+new Date},get_count:function(){return this.$E_0.length},$H_0:0,get_uploadId:function(){return this.$H_0},set_uploadId:function(a){this.$H_0=a;return a},addLog:function(a){if(!a)return;if(a.message.length>this.$L_0){a.message=a.message.substr(0,this.$L_0-13)+"... [trimmed]";Diag.ULS.sendTraceTag(3465240,100,50,"Trimmed message for log {0}",Diag.TaggingUtilities.getTagFromiTag(a.tag))}var b=new Diag.SerializableLogEntry(a.message,a.category,a.level,a.timestamp-this.$N_0,a.logType,a.tag),c=b.$10_0();Array.add(this.$E_0,b);this.$I_0+=c},get_isDataSizeThresholdExceeded:function(){return this.$I_0>this.$W_0},serialize:function(){return Diag.ULS.jsonSerialize(new Diag.SerializableLogCache(this.$N_0,this.$E_0,this.$a_0,this.$H_0,1))}};Diag.SerializableLogEntry=function(a,b,c,d,e,f){this.G=f;this.T=d;this.M=a;this.C=b;this.D=e*1e3+c};Diag.SerializableLogEntry.$O=function(b){var a=""+b;return a.length};Diag.SerializableLogEntry.prototype={G:0,T:0,M:null,C:null,D:0,$10_0:function(){return 31+Diag.SerializableLogEntry.$O(this.G)+Diag.SerializableLogEntry.$O(this.T)+this.M.length+Diag.SerializableLogEntry.$O(this.C)+Diag.SerializableLogEntry.$O(this.D)}};Diag.UlsUtils=function(){};Diag.UlsUtils.get_$13=function(){if(!Diag.UlsUtils.$4){Diag.UlsUtils.$4=[];Diag.UlsUtils.$4[10]="Unexpected";Diag.UlsUtils.$4[15]="Monitorable";Diag.UlsUtils.$4[50]="Medium";Diag.UlsUtils.$4[100]="Verbose";Diag.UlsUtils.$4[200]="VerboseEx"}return Diag.UlsUtils.$4};Diag.UlsUtils.convertLevelToStandardUlsLevel=function(a){return Diag.UlsUtils.get_$13()[a]||"VerboseEx"};Diag.UlsUtils.convertMillisecondsToTimestamp=function(b){var a=new Date(b),c=[Diag.UlsUtils.$z(a.getUTCFullYear()),"-",Diag.UlsUtils.$9(a.getUTCMonth()+1),"-",Diag.UlsUtils.$9(a.getUTCDate()),"T",Diag.UlsUtils.$9(a.getUTCHours()),":",Diag.UlsUtils.$9(a.getUTCMinutes()),":",Diag.UlsUtils.$9(a.getUTCSeconds()),".",Diag.UlsUtils.$q(a.getUTCMilliseconds()),"Z"];return Diag.ULS.concatArray(c)};Diag.UlsUtils.$z=function(a){return a<1e3?"0"+Diag.UlsUtils.$q(a):a.toString()};Diag.UlsUtils.$q=function(a){return a<100?"0"+Diag.UlsUtils.$9(a):a.toString()};Diag.UlsUtils.$9=function(a){return a<10?"0"+a:a.toString()};Diag.UlsUploadConfiguration=function(d,e,f,c,a,b,g){if(d!=null)this.$h_0=d;if(e!=null)this.$m_0=e;if(f!=null)this.$o_0=f;if(c!=null)this.$n_0=c;if(a!=null)this.$e_0=a;if(b!=null)this.$c_0=b;if(g!=null)this.$b_0=g};Diag.UlsUploadConfiguration.prototype={$h_0:3072,$m_0:65536,$o_0:6e4,$n_0:2e3,$e_0:1e4,$c_0:5e3,$b_0:false};Diag.UploadingUlsHost=function(b,c,a){this.$$d_$s_0=Function.createDelegate(this,this.$s_0);this.$$d_$f_0=Function.createDelegate(this,this.$f_0);this.$$d_$v_0=Function.createDelegate(this,this.$v_0);if(!a)a=new Diag.UlsUploadConfiguration(null,null,null,null,null,null,null);this.$V_0=b;this.uploadUrl=c;this.uploadUrl.toLowerCase().startsWith("http:")&&document.URL.toLowerCase().startsWith("https:")&&Diag.ULS.disable();this.$Y_0=a.$o_0;this.$X_0=a.$n_0;this.$T_0=a.$e_0;this.$Z_0=a.$c_0;this.$S_0=a.$b_0;this.$3_0=new Diag.LogCache(a.$m_0,a.$h_0,b);this.$j_0();this.$8_0=[];this.$k_0()};Diag.UploadingUlsHost.prototype={uploadUrl:null,$D_0:0,$Y_0:0,$X_0:0,$T_0:0,$Z_0:0,$S_0:false,$V_0:null,nextUploadId:0,$3_0:null,$8_0:null,$6_0:0,$0_0:null,$U_0:false,handleTrace:function(a){if(this.get_ulsCallDepth()>1){Array.add(this.$8_0,a);return}this.$3_0.addLog(a);if(this.logIndicatesError(a)){this.$u_0("LogIndicatesError in HandleTrace");Diag.ULS.sendTraceTag(3731793,100,200,"Flushing error-level log (tag {0}) synchronously",Diag.TaggingUtilities.getTagFromiTag(a.tag))}else if(this.$3_0.get_isDataSizeThresholdExceeded()){this.flushAsynchronous();Diag.ULS.sendTraceTag(3731794,100,200,"Flushing asynchronously due to cache size")}},logIndicatesError:function(a){return!!a&&(a.logType===1||a.level===10)},dispose:function(){if(this.$U_0)return;this.$U_0=true;this.flushForAppClose();Diag.ULS.setUlsHost(null);window.clearTimeout(this.$7_0);window.clearTimeout(this.$C_0);window.clearTimeout(this.$B_0);this.$7_0=0;this.$C_0=0;this.$B_0=0},flushForAppClose:function(){this.set_$i_0(2);this.$v_0();this.$G_0=false;this.$s_0();this.$u_0("FlushForAppClose")},uploadLogs:function(a,b){a.set_uploadId(this.nextUploadId);if(this.uploadSerializedLogs(a.serialize(),b)){this.nextUploadId++;return true}return false},uploadSerializedLogs:function(b,c){var a=this.$S_0||!c;if(!this.$0_0||!a)this.$0_0=new XMLHttpRequest;if(!this.$0_0.readyState||this.$0_0.readyState===4){this.$0_0.open("POST",this.uploadUrl,a);this.$0_0.setRequestHeader("Content-Type","application/json");this.$0_0.setRequestHeader("X-UserSessionId",this.$V_0);if(a)this.$0_0.timeout=this.$Z_0;this.modifyHttpRequestBeforeUploading(this.$0_0);this.$0_0.send(b);return true}Diag.ULS.sendTraceTag(3731796,100,50,"Could not initiate upload {0}",{UploadId:this.nextUploadId,XhrReadyState:this.$0_0.readyState});return false},onUploadException:function(){this.$0_0&&this.$0_0.abort()},modifyHttpRequestBeforeUploading:function(){},$P_0:function(b,a,c){var d=this;return window.setTimeout(function(){Diag.ULS.sendTraceTag(3731797,100,200,"Timeout ({0} ms) set by {1} is now firing.",a,c);b()},a)},$C_0:0,$k_0:function(){window.clearTimeout(this.$C_0);this.$C_0=this.$P_0(this.$$d_$v_0,this.$T_0,"ResetDelayedLoggingTimer")},get_ulsCallDepth:function(){return Diag.ULS.get_ulsCallDepth()+this.$6_0},$v_0:function(){var a=this.$8_0.length;if(!a){this.$k_0();return}var c=[];Array.addRange(c,this.$8_0);this.$8_0=[];Diag.ULS.sendTraceTag(3731798,100,50,"HandleDelayedLogs {0}",{Count:a});this.$6_0++;for(var b=0;b<a;b++)this.handleTrace(c[b]);this.$6_0--;this.$k_0()},$B_0:0,$j_0:function(){window.clearTimeout(this.$B_0);this.$B_0=this.$P_0(this.$$d_$f_0,this.$Y_0,"ResetCadenceTimer")},$M_0:0,$F_0:0,set_$i_0:function(a){if(!a){window.clearTimeout(this.$M_0);this.$M_0=0}else if(!this.$F_0)this.$M_0=this.$P_0(this.$$d_$s_0,this.$X_0,"ThrottlingMode Setter");this.$F_0=a;return a},$s_0:function(){this.set_$i_0(0);if(this.$G_0){this.$G_0=false;this.$f_0()}},$G_0:false,$12_0:function(a){return this.$F_0===2||this.$F_0===1&&!a},$u_0:function(a){Diag.ULS.sendTraceTag(3731800,100,200,"Flushing Synchronous due to {0}",a);this.$f_0(true)},$7_0:0,flushAsynchronous:function(){this.$t_0(0)},$t_0:function(a){if(!this.$7_0)this.$7_0=this.$P_0(this.$$d_$f_0,a,"FlushAsynchronous")},$f_0:function(a){this.$6_0++;window.clearTimeout(this.$7_0);this.$7_0=0;if(!this.$3_0.get_count()){this.$j_0();this.$6_0--;return}if(this.$12_0(a)){Diag.ULS.sendTraceTag(3731801,100,200,"Not flushing ({0}) due to throttling",a?"sync":"async");this.$G_0=true;this.$6_0--;return}this.set_$i_0(a?2:1);this.$j_0();Diag.ULS.sendTraceTag(3731803,100,200,"Flushing ({0}) cached bULS logs ({1} logs)",a?"sync":"async",this.$3_0.get_count());var b;try{b=this.uploadLogs(this.$3_0,a)}catch(c){this.onUploadException(c);b=false}if(b){this.$3_0.reset();this.$D_0=0}else{this.$D_0++;if(this.$D_0<3)this.$t_0(15e3);else{this.$3_0.reset();this.nextUploadId++;this.$D_0=0}}this.$6_0--},showAssertDialog:function(){},handoffToNewHost:function(){},add_onUlsTrace:function(){},remove_onUlsTrace:function(){}};Diag.SerializableLogCache.registerClass("Diag.SerializableLogCache");Diag.LogCache.registerClass("Diag.LogCache",null,Diag.ILogCache);Diag.SerializableLogEntry.registerClass("Diag.SerializableLogEntry");Diag.UlsUtils.registerClass("Diag.UlsUtils");Diag.UlsUploadConfiguration.registerClass("Diag.UlsUploadConfiguration");Diag.UploadingUlsHost.registerClass("Diag.UploadingUlsHost",null,Diag.IUlsHost,Sys.IDisposable);Diag.UlsUtils.$4=null;Diag.UploadingUlsHost.defaultRemoteUlsUrl="RemoteUls.ashx";Diag.UploadingUlsHost.maxUploadAttempts=3;Diag.UploadingUlsHost.retryDelay=15e3;Diag.UploadingUlsHost.sessionIdHeaderName="X-UserSessionId"